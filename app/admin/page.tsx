'use client';

import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import Image from 'next/image';
import * as XLSX from 'xlsx';
import InviteCreatorModal from '@/components/InviteCreatorModal';
import InviteTracker from '@/components/InviteTracker';
import ProjectsManager from '@/components/ProjectsManager';
import InvoiceManager from '@/components/InvoiceManager';
import DashboardAnalytics from '@/components/DashboardAnalytics';
import PipelineManager from '@/components/PipelineManager';
import { supabase } from '@/lib/supabase';

// Projects data - stored in localStorage for persistence
const sampleSubmissions: any[] = [];


export default function AdminDashboard() {
  const router = useRouter();
  const [isAuthorized, setIsAuthorized] = useState(false);
  const [authLoading, setAuthLoading] = useState(true);
  const [activeTab, setActiveTab] = useState<'overview' | 'submissions' | 'library' | 'projects' | 'documents' | 'invites' | 'invoices' | 'reports'>('overview');
  const [showInviteTracker, setShowInviteTracker] = useState(false);

  // Check if user is @stage.in admin
  useEffect(() => {
    const checkAuth = async () => {
      try {
        const { data: { session } } = await supabase.auth.getSession();

        if (!session?.user) {
          router.push('/login');
          return;
        }

        const userEmail = session.user.email || '';

        // Check if user is @stage.in OR has admin role in profile
        if (userEmail.endsWith('@stage.in')) {
          setIsAuthorized(true);
        } else {
          // Check profile role
          const { data: profile } = await supabase
            .from('profiles')
            .select('role')
            .eq('id', session.user.id)
            .single();

          if (profile?.role === 'admin') {
            setIsAuthorized(true);
          } else {
            // Not authorized - redirect to creator
            router.push('/creator');
            return;
          }
        }
      } catch (e) {
        console.log('Auth check error');
        router.push('/login');
      } finally {
        setAuthLoading(false);
      }
    };

    checkAuth();
  }, [router]);
  const [productionDocs, setProductionDocs] = useState<{id: string, name: string, category: string, url: string, uploadedAt: string}[]>([]);
  const [selectedDocCategory, setSelectedDocCategory] = useState<string | null>(null);
  const [expandedSopSections, setExpandedSopSections] = useState<{[key: string]: boolean}>({});
  const [filterStatus, setFilterStatus] = useState<string>('all');
  const [filterFormat, setFilterFormat] = useState<string>('all');
  const [filterCulture, setFilterCulture] = useState<string>('all');
  const [selectedSubmission, setSelectedSubmission] = useState<any>(null);
  const [detailView, setDetailView] = useState<'project' | 'creator' | 'budget' | 'timeline' | 'crew' | 'cast' | 'technical' | 'cashflow' | 'documents' | 'missing' | 'agreement' | 'activity' | 'sop'>('project');
  const [showDeleteConfirm, setShowDeleteConfirm] = useState<number | null>(null);
  const [showStatusMenu, setShowStatusMenu] = useState<number | null>(null);
  const [submissions, setSubmissions] = useState<any[]>(sampleSubmissions);
  const [localSubmissionsLoaded, setLocalSubmissionsLoaded] = useState(false);
  const [expandedBudgetCulture, setExpandedBudgetCulture] = useState<string | null>(null);
  const [showBudgetBreakdown, setShowBudgetBreakdown] = useState(false);
  const [viewedProjects, setViewedProjects] = useState<Set<number>>(new Set());
  const [editAccessRequests, setEditAccessRequests] = useState<any[]>([]);
  const [showEditRequestsPanel, setShowEditRequestsPanel] = useState(false);
  const [showNotificationsPanel, setShowNotificationsPanel] = useState(false);
  const [denyReason, setDenyReason] = useState('');
  const [customDocuments, setCustomDocuments] = useState<{id: string, name: string, content: string, createdAt: string}[]>([]);
  const [showAddDocModal, setShowAddDocModal] = useState(false);
  const [newDocName, setNewDocName] = useState('');
  const [newDocContent, setNewDocContent] = useState('');
  const [savedDPRs, setSavedDPRs] = useState<{id: string, title: string, data: any, createdAt: string, sharedWith: string[]}[]>([]);
  const [currentDPR, setCurrentDPR] = useState<any>({
    title: '', date: '', dayNumber: '', producer: '', director: '',
    firstShootDate: '', scheduledFinish: '', revisedFinish: '', location: '',
    crewCall: '', rollTime: '', firstShot: '', mealBreakStart: '', mealBreakEnd: '',
    firstShotAfter: '', packup: '', lastPersonOut: '', lastPersonDept: '',
    scriptScenes: '', scriptPages: '', prevScenes: '', prevPages: '',
    todayScenes: '', todayPages: '', totalScenes: '', totalPages: '',
    remainingScenes: '', remainingPages: '',
    prevSetups: '', todaySetups: '', totalSetups: '', remainingSetups: '',
    comments: '', nextDate: '', nextLocation: '', nextCallTime: '', nextScenes: '',
    preparedBy: '', approvedBy: ''
  });
  const [showAddProjectModal, setShowAddProjectModal] = useState(false);
  const [showInviteCreatorModal, setShowInviteCreatorModal] = useState(false);
  const [newProject, setNewProject] = useState({
    projectName: '', creator: '', culture: '', format: '', genre: '',
    totalBudget: '', episodes: '', status: 'pending',
    productionPOC: '', productionPOCPhone: '', productionPOCEmail: '',
    contentPOC: '', contentPOCPhone: '', contentPOCEmail: '',
    logline: '', synopsis: '', language: '', productionCompany: ''
  });
  const [activityNote, setActivityNote] = useState('');
  const [projectsCultureFilter, setProjectsCultureFilter] = useState<string>('all');
  const [selectedPOC, setSelectedPOC] = useState<string | null>(null);
  const [draggedRowId, setDraggedRowId] = useState<string | null>(null);
  const [projectsOrder, setProjectsOrder] = useState<string[]>([]);
  const [customPOCs, setCustomPOCs] = useState<string[]>([]);
  const [showAddPOCModal, setShowAddPOCModal] = useState(false);
  const [newPOCName, setNewPOCName] = useState('');
  const [customCultures, setCustomCultures] = useState<string[]>([]);
  const [showAddCultureModal, setShowAddCultureModal] = useState(false);
  const [newCultureName, setNewCultureName] = useState('');
  const [customFormats, setCustomFormats] = useState<string[]>([]);
  const [showAddFormatModal, setShowAddFormatModal] = useState(false);
  const [newFormatName, setNewFormatName] = useState('');
  const [expandedBudgetProject, setExpandedBudgetProject] = useState<string | null>(null);
  const [activityNoteType, setActivityNoteType] = useState('note');

  // Internal Projects (separate from submissions - for internal tracking only)
  const [internalProjects, setInternalProjects] = useState<any[]>([]);

  // Status change with comment modal states
  const [showStatusChangeModal, setShowStatusChangeModal] = useState(false);
  const [statusChangeComment, setStatusChangeComment] = useState('');
  const [pendingStatusChange, setPendingStatusChange] = useState<{ submissionId: number; newStatus: string } | null>(null);

  // Search & Sort states
  const [searchQuery, setSearchQuery] = useState('');
  const [sortBy, setSortBy] = useState<'date' | 'name' | 'budget' | 'status'>('date');
  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');
  const [showAnalytics, setShowAnalytics] = useState(true); // Show by default

  // Advanced Filter states
  const [dateRangeFrom, setDateRangeFrom] = useState('');
  const [dateRangeTo, setDateRangeTo] = useState('');
  const [budgetMin, setBudgetMin] = useState('');
  const [budgetMax, setBudgetMax] = useState('');
  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);

  // Document Preview state
  const [previewDocument, setPreviewDocument] = useState<{ url: string; name: string; type: string } | null>(null);

  // Admin Notifications (from creators)
  const [adminNotifications, setAdminNotifications] = useState<any[]>([]);
  const [showCreatorUpdatesPanel, setShowCreatorUpdatesPanel] = useState(false);

  // Talent Library states
  const [talentLibrary, setTalentLibrary] = useState<any[]>([]);
  const [selectedTalent, setSelectedTalent] = useState<any>(null);
  const [showAddTalentModal, setShowAddTalentModal] = useState(false);
  const [selectedDepartment, setSelectedDepartment] = useState<string>('all');
  const [librarySearchQuery, setLibrarySearchQuery] = useState('');
  const [newTalent, setNewTalent] = useState({
    name: '', role: '', department: 'direction', phone: '', email: '', workLink: '', culture: 'Haryanvi', notes: ''
  });
  const [showTalentShareMenu, setShowTalentShareMenu] = useState(false);
  const [showTalentDownloadMenu, setShowTalentDownloadMenu] = useState(false);

  // Share individual talent profile
  const shareTalentProfile = (talent: any, platform: string) => {
    const profileText = `üé¨ STAGE Talent: ${talent.name}\nüìã Role: ${talent.role}\nüé≠ Department: ${talent.department}\nüåç Culture: ${talent.culture}\n${talent.phone ? `üì± Phone: ${talent.phone}\n` : ''}${talent.email ? `üìß Email: ${talent.email}\n` : ''}${talent.workLink ? `üîó Portfolio: ${talent.workLink}\n` : ''}${talent.projects?.length > 0 ? `üé¨ Projects: ${talent.projects.map((p: any) => p.name || p).join(', ')}\n` : ''}\nüéØ From STAGE OTT Platform`;

    switch(platform) {
      case 'whatsapp':
        window.open(`https://wa.me/?text=${encodeURIComponent(profileText)}`, '_blank');
        break;
      case 'twitter':
        window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(profileText.substring(0, 280))}`, '_blank');
        break;
      case 'linkedin':
        window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent('https://stage.in')}&title=${encodeURIComponent(`STAGE Talent: ${talent.name}`)}&summary=${encodeURIComponent(profileText)}`, '_blank');
        break;
      case 'email':
        window.location.href = `mailto:?subject=${encodeURIComponent(`STAGE Talent Profile: ${talent.name}`)}&body=${encodeURIComponent(profileText)}`;
        break;
      case 'copy':
        navigator.clipboard.writeText(profileText);
        alert('Profile copied to clipboard!');
        break;
    }
    setShowTalentShareMenu(false);
  };

  // Download individual talent profile
  const downloadTalentProfile = (talent: any, format: string) => {
    switch(format) {
      case 'pdf':
        const pdfContent = `
          <html>
            <head>
              <title>${talent.name} - STAGE Talent Profile</title>
              <style>
                body { font-family: Arial, sans-serif; padding: 40px; max-width: 600px; margin: 0 auto; }
                .header { background: linear-gradient(135deg, #8B5CF6, #6366F1); color: white; padding: 30px; border-radius: 16px; margin-bottom: 24px; }
                .avatar { width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 36px; font-weight: bold; margin-bottom: 16px; }
                .name { font-size: 28px; font-weight: bold; margin: 0; }
                .role { font-size: 18px; opacity: 0.9; margin: 4px 0; }
                .badge { display: inline-block; background: rgba(255,255,255,0.2); padding: 4px 12px; border-radius: 20px; font-size: 14px; margin-top: 8px; }
                .section { background: #f8f9fa; border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; margin-bottom: 16px; }
                .section-title { font-weight: bold; color: #374151; margin-bottom: 12px; font-size: 16px; }
                .info-row { display: flex; margin-bottom: 8px; }
                .info-label { color: #6b7280; width: 100px; }
                .info-value { color: #1f2937; }
                .footer { text-align: center; color: #9ca3af; font-size: 12px; margin-top: 32px; }
              </style>
            </head>
            <body>
              <div class="header">
                <div class="avatar">${talent.name.charAt(0).toUpperCase()}</div>
                <p class="name">${talent.name}</p>
                <p class="role">${talent.role}</p>
                <span class="badge">${talent.department}</span>
              </div>
              <div class="section">
                <div class="section-title">üìû Contact Information</div>
                <div class="info-row"><span class="info-label">Phone:</span><span class="info-value">${talent.phone || 'Not provided'}</span></div>
                <div class="info-row"><span class="info-label">Email:</span><span class="info-value">${talent.email || 'Not provided'}</span></div>
              </div>
              <div class="section">
                <div class="section-title">üîó Portfolio</div>
                <p style="color: #3b82f6;">${talent.workLink || 'Not provided'}</p>
              </div>
              <div class="section">
                <div class="section-title">üé≠ Culture</div>
                <span style="background: #f3e8ff; color: #7c3aed; padding: 4px 16px; border-radius: 20px; font-weight: bold;">${talent.culture}</span>
              </div>
              ${talent.projects?.length > 0 ? `
              <div class="section">
                <div class="section-title">üé¨ STAGE Projects</div>
                ${talent.projects.map((p: any) => `<p style="margin: 4px 0;">‚Ä¢ ${p.name || p} ${p.status ? `(${p.status})` : ''}</p>`).join('')}
              </div>
              ` : ''}
              ${talent.notes ? `
              <div class="section">
                <div class="section-title">üìù Notes</div>
                <p>${talent.notes}</p>
              </div>
              ` : ''}
              <div class="footer">Generated from STAGE OTT Platform ‚Ä¢ ${new Date().toLocaleDateString()}</div>
            </body>
          </html>
        `;
        const pdfWindow = window.open('', '_blank');
        if (pdfWindow) {
          pdfWindow.document.write(pdfContent);
          pdfWindow.document.close();
          pdfWindow.print();
        }
        break;
      case 'vcard':
        const vcard = `BEGIN:VCARD
VERSION:3.0
FN:${talent.name}
TITLE:${talent.role}
ORG:STAGE OTT - ${talent.department}
TEL:${talent.phone || ''}
EMAIL:${talent.email || ''}
URL:${talent.workLink || ''}
NOTE:Culture: ${talent.culture}${talent.projects?.length > 0 ? ` | Projects: ${talent.projects.map((p: any) => p.name || p).join(', ')}` : ''}
END:VCARD`;
        const vcardBlob = new Blob([vcard], { type: 'text/vcard' });
        const vcardUrl = URL.createObjectURL(vcardBlob);
        const vcardLink = document.createElement('a');
        vcardLink.href = vcardUrl;
        vcardLink.download = `${talent.name.replace(/\s+/g, '_')}_STAGE.vcf`;
        vcardLink.click();
        URL.revokeObjectURL(vcardUrl);
        break;
      case 'json':
        const jsonData = JSON.stringify(talent, null, 2);
        const jsonBlob = new Blob([jsonData], { type: 'application/json' });
        const jsonUrl = URL.createObjectURL(jsonBlob);
        const jsonLink = document.createElement('a');
        jsonLink.href = jsonUrl;
        jsonLink.download = `${talent.name.replace(/\s+/g, '_')}_STAGE.json`;
        jsonLink.click();
        URL.revokeObjectURL(jsonUrl);
        break;
    }
    setShowTalentDownloadMenu(false);
  };

  // Load viewed projects from localStorage
  useEffect(() => {
    if (typeof window !== 'undefined') {
      // One-time reset - clear all old data for fresh start
      const hasReset = localStorage.getItem('stage_data_reset_v2');
      if (!hasReset) {
        localStorage.removeItem('stage_submissions');
        localStorage.removeItem('stage_talent_library');
        localStorage.removeItem('stage_viewed_projects');
        localStorage.removeItem('stage_edit_requests');
        localStorage.removeItem('creator_submissions');
        localStorage.setItem('stage_data_reset_v2', 'true');
      }

      const viewed = JSON.parse(localStorage.getItem('stage_viewed_projects') || '[]');
      setViewedProjects(new Set(viewed));

      // Load edit access requests
      const editRequests = JSON.parse(localStorage.getItem('stage_edit_requests') || '[]');
      setEditAccessRequests(editRequests);

      // Load talent library
      const savedTalents = JSON.parse(localStorage.getItem('stage_talent_library') || '[]');
      setTalentLibrary(savedTalents);

      // Load production documents
      const savedDocs = JSON.parse(localStorage.getItem('production_docs') || '[]');
      setProductionDocs(savedDocs);

      // Load custom documents for Others section
      const savedCustomDocs = JSON.parse(localStorage.getItem('custom_documents') || '[]');
      setCustomDocuments(savedCustomDocs);

      // Load saved DPRs
      const dprs = JSON.parse(localStorage.getItem('saved_dprs') || '[]');
      setSavedDPRs(dprs);

      // Load custom cultures, formats, and POCs
      const savedCustomCultures = JSON.parse(localStorage.getItem('stage_custom_cultures') || '[]');
      setCustomCultures(savedCustomCultures);
      const savedCustomFormats = JSON.parse(localStorage.getItem('stage_custom_formats') || '[]');
      setCustomFormats(savedCustomFormats);
      const savedCustomPOCs = JSON.parse(localStorage.getItem('stage_custom_pocs') || '[]');
      setCustomPOCs(savedCustomPOCs);

      // Load internal projects (separate from submissions)
      const savedInternalProjects = JSON.parse(localStorage.getItem('stage_internal_projects') || '[]');
      setInternalProjects(savedInternalProjects);
    }
  }, []);

  // Save custom cultures, formats, and POCs to localStorage when they change
  useEffect(() => {
    if (typeof window !== 'undefined' && customCultures.length > 0) {
      localStorage.setItem('stage_custom_cultures', JSON.stringify(customCultures));
    }
  }, [customCultures]);

  useEffect(() => {
    if (typeof window !== 'undefined' && customFormats.length > 0) {
      localStorage.setItem('stage_custom_formats', JSON.stringify(customFormats));
    }
  }, [customFormats]);

  useEffect(() => {
    if (typeof window !== 'undefined' && customPOCs.length > 0) {
      localStorage.setItem('stage_custom_pocs', JSON.stringify(customPOCs));
    }
  }, [customPOCs]);

  // Extract talents from a project and add to library
  const extractTalentsFromProject = (project: any) => {
    const talents: any[] = [];
    const addTalent = (name: string | undefined, role: string, department: string, email?: string, phone?: string, workLink?: string) => {
      if (name && name.trim()) {
        talents.push({
          id: `talent_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
          name: name.trim(),
          role,
          department,
          phone: phone || '',
          email: email || '',
          workLink: workLink || '',
          culture: project.culture || 'Not Specified',
          projects: [{ id: project.id, name: project.projectName, status: project.status }],
          addedFrom: project.projectName,
          addedAt: new Date().toISOString(),
          notes: '',
          projectCulture: project.culture,
          previousProjects: project.previousProjects || ''
        });
      }
    };

    // Direction Team
    addTalent(project.director, 'Director', 'direction');
    addTalent(project.associateDirector, 'Associate Director', 'direction');
    addTalent(project.assistantDirector1, 'Assistant Director 1', 'direction');
    addTalent(project.assistantDirector2, 'Assistant Director 2', 'direction');
    addTalent(project.showRunner, 'Show Runner', 'direction');
    addTalent(project.creativeDirector, 'Creative Director', 'direction');
    addTalent(project.castingDirector, 'Casting Director', 'direction');

    // Production Team
    addTalent(project.headOfProduction, 'Head of Production', 'production');
    addTalent(project.executiveProducer, 'Executive Producer', 'production');
    addTalent(project.lineProducer, 'Line Producer', 'production');
    addTalent(project.projectHead, 'Project Head', 'production');
    addTalent(project.productionManager, 'Production Manager', 'production');
    addTalent(project.productionController, 'Production Controller', 'production');
    // Creator/Producer with their contact details
    addTalent(project.creator || project.creatorName, 'Creator/Producer', 'production', project.officialEmail, project.phone);

    // Writing Team
    addTalent(project.writer, 'Writer', 'writing');
    addTalent(project.storyBy, 'Story Writer', 'writing');
    addTalent(project.screenplayBy, 'Screenplay Writer', 'writing');
    addTalent(project.dialoguesBy, 'Dialogue Writer', 'writing');

    // Camera Department
    addTalent(project.dop, 'DOP (Director of Photography)', 'camera');
    addTalent(project.firstCameraOperator, 'Camera Operator', 'camera');
    addTalent(project.steadicamOperator, 'Steadicam Operator', 'camera');
    addTalent(project.stillPhotographer, 'Still Photographer', 'camera');
    addTalent(project.btsVideographer, 'BTS Videographer', 'camera');

    // Editing / Post-Production
    addTalent(project.editor, 'Editor', 'editing');
    addTalent(project.colorist, 'Colorist', 'editing');
    addTalent(project.onLocationEditor, 'On-Location Editor', 'editing');

    // Sound Department
    addTalent(project.soundRecordist, 'Sound Recordist', 'sound');
    addTalent(project.soundDesigner, 'Sound Designer', 'sound');
    addTalent(project.foleyArtist, 'Foley Artist', 'sound');
    addTalent(project.reRecordingMixer, 'Re-Recording Mixer', 'sound');

    // Music Team
    addTalent(project.musicComposer, 'Music Composer', 'music');
    addTalent(project.bgmComposer, 'BGM Composer', 'music');
    addTalent(project.playbackSinger, 'Playback Singer', 'music');
    addTalent(project.lyricist, 'Lyricist', 'music');

    // Art Department
    addTalent(project.productionDesigner, 'Production Designer', 'art');
    addTalent(project.artDirector, 'Art Director', 'art');
    addTalent(project.setDesigner, 'Set Designer', 'art');

    // Costume & Makeup
    addTalent(project.costumeDesigner, 'Costume Designer', 'costume');
    addTalent(project.makeupArtist, 'Makeup Artist', 'costume');
    addTalent(project.hairStylist, 'Hair Stylist', 'costume');

    // VFX & Post
    addTalent(project.vfxSupervisor, 'VFX Supervisor', 'vfx');
    addTalent(project.diArtist, 'DI Artist', 'vfx');

    // Cast from castData (with social media links)
    if (project.castData) {
      // Primary Cast
      if (project.castData.primaryCast && Array.isArray(project.castData.primaryCast)) {
        project.castData.primaryCast.forEach((castMember: any) => {
          if (castMember.artistName) {
            addTalent(
              castMember.artistName,
              `Lead Actor (${castMember.characterName || 'Character'})`,
              'cast',
              '',
              '',
              castMember.socialMediaLink || ''
            );
          }
        });
      }
      // Secondary Cast
      if (project.castData.secondaryCast && Array.isArray(project.castData.secondaryCast)) {
        project.castData.secondaryCast.forEach((castMember: any) => {
          if (castMember.artistName) {
            addTalent(
              castMember.artistName,
              `Supporting Actor (${castMember.characterName || 'Character'})`,
              'cast',
              '',
              '',
              castMember.socialMediaLink || ''
            );
          }
        });
      }
      // Tertiary Cast
      if (project.castData.tertiaryCast && Array.isArray(project.castData.tertiaryCast)) {
        project.castData.tertiaryCast.forEach((castMember: any) => {
          if (castMember.artistName) {
            addTalent(
              castMember.artistName,
              `Actor (${castMember.characterName || 'Character'})`,
              'cast',
              '',
              '',
              castMember.socialMediaLink || ''
            );
          }
        });
      }
    }

    // Legacy cast array support
    if (project.cast && Array.isArray(project.cast)) {
      project.cast.forEach((castMember: any) => {
        addTalent(castMember.name || castMember.artistName, castMember.role || 'Actor', 'cast');
      });
    }

    return talents;
  };

  // Add talents to library (merging duplicates)
  const addTalentsToLibrary = (newTalents: any[]) => {
    setTalentLibrary(prev => {
      const updated = [...prev];
      newTalents.forEach(talent => {
        const existing = updated.find(t =>
          t.name.toLowerCase() === talent.name.toLowerCase() &&
          t.role.toLowerCase() === talent.role.toLowerCase()
        );
        if (existing) {
          // Merge projects
          const projectExists = existing.projects.some((p: any) => p.id === talent.projects[0]?.id);
          if (!projectExists && talent.projects[0]) {
            existing.projects.push(talent.projects[0]);
          }
          // Update contact info if missing
          if (!existing.phone && talent.phone) existing.phone = talent.phone;
          if (!existing.email && talent.email) existing.email = talent.email;
          if (!existing.workLink && talent.workLink) existing.workLink = talent.workLink;
          if (!existing.culture && talent.culture) existing.culture = talent.culture;
          if (!existing.previousProjects && talent.previousProjects) existing.previousProjects = talent.previousProjects;
        } else {
          updated.push(talent);
        }
      });
      // Save to localStorage
      if (typeof window !== 'undefined') {
        localStorage.setItem('stage_talent_library', JSON.stringify(updated));
      }
      return updated;
    });
  };

  // Add single talent manually
  const handleAddTalent = () => {
    if (!newTalent.name.trim() || !newTalent.role.trim()) {
      alert('Name and Role are required!');
      return;
    }
    const talent = {
      id: `talent_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
      ...newTalent,
      projects: [],
      addedFrom: 'Manual Entry',
      addedAt: new Date().toISOString()
    };
    setTalentLibrary(prev => {
      const updated = [...prev, talent];
      if (typeof window !== 'undefined') {
        localStorage.setItem('stage_talent_library', JSON.stringify(updated));
      }
      return updated;
    });
    setNewTalent({ name: '', role: '', department: 'direction', phone: '', email: '', workLink: '', culture: 'Haryanvi', notes: '' });
    setShowAddTalentModal(false);
  };

  // Update talent
  const handleUpdateTalent = (updatedTalent: any) => {
    setTalentLibrary(prev => {
      const updated = prev.map(t => t.id === updatedTalent.id ? updatedTalent : t);
      if (typeof window !== 'undefined') {
        localStorage.setItem('stage_talent_library', JSON.stringify(updated));
      }
      return updated;
    });
    setSelectedTalent(updatedTalent);
  };

  // Delete talent
  const handleDeleteTalent = (talentId: string) => {
    if (!confirm('Are you sure you want to delete this talent from the library?')) return;
    setTalentLibrary(prev => {
      const updated = prev.filter(t => t.id !== talentId);
      if (typeof window !== 'undefined') {
        localStorage.setItem('stage_talent_library', JSON.stringify(updated));
      }
      return updated;
    });
    setSelectedTalent(null);
  };

  // Share functionality
  const handleShare = async (title: string, text: string, url?: string) => {
    const shareData = {
      title: title,
      text: text,
      url: url || window.location.href
    };

    if (navigator.share) {
      try {
        await navigator.share(shareData);
      } catch (err) {
        console.log('Share cancelled');
      }
    } else {
      // Fallback - copy to clipboard
      const shareText = `${title}\n\n${text}\n\n${url || window.location.href}`;
      navigator.clipboard.writeText(shareText);
      alert('Link copied to clipboard! Share it anywhere.');
    }
  };

  // Share to specific platforms
  const shareToWhatsApp = (text: string) => {
    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
  };

  const shareToTwitter = (text: string) => {
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
  };

  const shareToLinkedIn = (text: string, url: string) => {
    window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`, '_blank');
  };

  const shareToEmail = (subject: string, body: string) => {
    window.open(`mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');
  };

  // Download talents as Excel
  const downloadTalentsExcel = (talents: any[], filename: string) => {
    const data = talents.map(t => ({
      'Name': t.name,
      'Role': t.role,
      'Department': t.department,
      'Phone': t.phone || '',
      'Email': t.email || '',
      'Work Link': t.workLink || '',
      'Culture': t.culture || '',
      'Projects': t.projects?.map((p: any) => p.name || p).join(', ') || '',
      'Notes': t.notes || ''
    }));

    const ws = XLSX.utils.json_to_sheet(data);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, 'Talents');

    // Set column widths
    ws['!cols'] = [
      { wch: 20 }, { wch: 25 }, { wch: 15 }, { wch: 15 },
      { wch: 25 }, { wch: 30 }, { wch: 12 }, { wch: 40 }, { wch: 30 }
    ];

    XLSX.writeFile(wb, `${filename}.xlsx`);
  };

  // Download talents as CSV
  const downloadTalentsCSV = (talents: any[], filename: string) => {
    const headers = ['Name', 'Role', 'Department', 'Phone', 'Email', 'Work Link', 'Culture', 'Projects', 'Notes'];
    const rows = talents.map(t => [
      t.name,
      t.role,
      t.department,
      t.phone || '',
      t.email || '',
      t.workLink || '',
      t.culture || '',
      t.projects?.map((p: any) => p.name || p).join('; ') || '',
      t.notes || ''
    ]);

    const csvContent = [headers, ...rows].map(row =>
      row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',')
    ).join('\n');

    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = `${filename}.csv`;
    link.click();
  };

  // Download talents as PDF (simple text format)
  const downloadTalentsPDF = (talents: any[], title: string) => {
    // Create printable HTML
    const printContent = `
      <html>
        <head>
          <title>${title}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { color: #7c3aed; border-bottom: 2px solid #7c3aed; padding-bottom: 10px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th { background: #7c3aed; color: white; padding: 10px; text-align: left; }
            td { padding: 8px; border-bottom: 1px solid #ddd; }
            tr:nth-child(even) { background: #f9fafb; }
            .header { display: flex; justify-content: space-between; align-items: center; }
            .logo { font-size: 24px; font-weight: bold; color: #7c3aed; }
            .date { color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
            <div class="logo">STAGE OTT - Talent Library</div>
            <div class="date">${new Date().toLocaleDateString('en-IN')}</div>
          </div>
          <h1>${title}</h1>
          <table>
            <tr>
              <th>Name</th>
              <th>Role</th>
              <th>Department</th>
              <th>Contact</th>
              <th>Culture</th>
              <th>Projects</th>
            </tr>
            ${talents.map(t => `
              <tr>
                <td><strong>${t.name}</strong></td>
                <td>${t.role}</td>
                <td>${t.department}</td>
                <td>${t.phone || t.email || '-'}</td>
                <td>${t.culture || '-'}</td>
                <td>${t.projects?.map((p: any) => p.name || p).join(', ') || '-'}</td>
              </tr>
            `).join('')}
          </table>
          <p style="margin-top: 30px; color: #666; font-size: 12px;">
            Generated by STAGE OTT Creator Portal ‚Ä¢ Total: ${talents.length} talents
          </p>
        </body>
      </html>
    `;

    const printWindow = window.open('', '_blank');
    if (printWindow) {
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.print();
    }
  };

  // Download project as various formats
  const downloadProjectData = (project: any, format: 'excel' | 'pdf' | 'json') => {
    if (format === 'excel') {
      exportToExcel(project);
    } else if (format === 'json') {
      const blob = new Blob([JSON.stringify(project, null, 2)], { type: 'application/json' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `${project.projectName || 'project'}_data.json`;
      link.click();
    } else if (format === 'pdf') {
      // Use print for PDF
      const printContent = `
        <html>
          <head>
            <title>${project.projectName} - Project Details</title>
            <style>
              body { font-family: Arial, sans-serif; padding: 20px; }
              h1 { color: #dc2626; }
              h2 { color: #7c3aed; margin-top: 20px; }
              .section { background: #f9fafb; padding: 15px; border-radius: 8px; margin: 10px 0; }
              .row { display: flex; margin: 5px 0; }
              .label { font-weight: bold; width: 200px; color: #666; }
              .value { flex: 1; }
            </style>
          </head>
          <body>
            <h1>${project.projectName}</h1>
            <div class="section">
              <div class="row"><span class="label">Culture:</span><span class="value">${project.culture}</span></div>
              <div class="row"><span class="label">Format:</span><span class="value">${project.format}</span></div>
              <div class="row"><span class="label">Genre:</span><span class="value">${project.genre}</span></div>
              <div class="row"><span class="label">Budget:</span><span class="value">‚Çπ${(project.totalBudget || 0).toLocaleString('en-IN')}</span></div>
              <div class="row"><span class="label">Status:</span><span class="value">${project.status}</span></div>
            </div>
            <h2>Creator Details</h2>
            <div class="section">
              <div class="row"><span class="label">Creator:</span><span class="value">${project.creator || project.creatorName || '-'}</span></div>
              <div class="row"><span class="label">Email:</span><span class="value">${project.officialEmail || '-'}</span></div>
              <div class="row"><span class="label">Phone:</span><span class="value">${project.phone || '-'}</span></div>
            </div>
            <h2>Key Crew</h2>
            <div class="section">
              <div class="row"><span class="label">Director:</span><span class="value">${project.director || '-'}</span></div>
              <div class="row"><span class="label">DOP:</span><span class="value">${project.dop || '-'}</span></div>
              <div class="row"><span class="label">Editor:</span><span class="value">${project.editor || '-'}</span></div>
              <div class="row"><span class="label">Music:</span><span class="value">${project.musicComposer || '-'}</span></div>
            </div>
          </body>
        </html>
      `;
      const printWindow = window.open('', '_blank');
      if (printWindow) {
        printWindow.document.write(printContent);
        printWindow.document.close();
        printWindow.print();
      }
    }
  };

  // Mark project as viewed
  const markAsViewed = (projectId: number) => {
    setViewedProjects(prev => {
      const newSet = new Set(prev);
      newSet.add(projectId);
      // Save to localStorage
      if (typeof window !== 'undefined') {
        localStorage.setItem('stage_viewed_projects', JSON.stringify([...newSet]));
      }
      return newSet;
    });
  };

  // Load submissions from localStorage on mount
  useEffect(() => {
    if (typeof window !== 'undefined' && !localSubmissionsLoaded) {
      const localSubmissions = JSON.parse(localStorage.getItem('stage_submissions') || '[]');
      if (localSubmissions.length > 0) {
        // Transform local submissions to match the format
        const transformedSubmissions = localSubmissions.map((sub: any, idx: number) => {
          // eslint-disable-next-line @typescript-eslint/no-unused-vars
          const { id: _oldId, ...subWithoutId } = sub; // Remove old id to prevent duplicates
          return {
            ...subWithoutId, // Spread first so our values take precedence
            id: `local-${1000 + idx}`, // Use string ID with prefix to ensure uniqueness
            projectName: sub.projectName || 'Untitled Project',
            creator: sub.creatorName || 'Unknown Creator',
            culture: sub.culture || 'Not Specified',
            format: sub.format || 'Not Specified',
            genre: sub.genre || 'Not Specified',
            subGenre: sub.subGenre || '',
            contentRating: sub.contentRating || 'Not Rated',
            totalBudget: parseFloat(sub.estimatedBudget) || sub.totalBudget || 0,
            completeness: 50, // Placeholder
            warnings: 0,
            status: sub.status || 'pending',
            submittedDate: sub.submitted_at ? sub.submitted_at.split('T')[0] : new Date().toISOString().split('T')[0],
            episodes: sub.episodesPerSeason || 1,
            thumbnail: '/api/placeholder/400/225',
            productionPOC: sub.productionPOC || '',
            contentPOC: sub.contentPOC || '',
            activityLog: sub.activityLog || [
              {
                date: sub.submitted_at ? sub.submitted_at.split('T')[0] : new Date().toISOString().split('T')[0],
                time: sub.submitted_at ? new Date(sub.submitted_at).toLocaleTimeString() : new Date().toLocaleTimeString(),
                action: 'Project Submitted',
                description: 'Creator submitted project for review (via local storage)',
                user: sub.creatorName || 'Creator',
                type: 'submit'
              }
            ],
            isLocalSubmission: true,
          };
        });

        setSubmissions(transformedSubmissions);
      }
      setLocalSubmissionsLoaded(true);

      // Load admin notifications (from creators)
      const savedAdminNotifs = JSON.parse(localStorage.getItem('stage_admin_notifications') || '[]');
      setAdminNotifications(savedAdminNotifs);
    }
  }, [localSubmissionsLoaded]);

  // Auto-sync talents from approved/in-production projects
  useEffect(() => {
    if (localSubmissionsLoaded && submissions.length > 0) {
      const approvedProjects = submissions.filter(s =>
        s.status === 'approved' || s.status === 'in-production'
      );

      if (approvedProjects.length > 0) {
        // Check which projects are already synced
        const syncedProjectIds = new Set(
          talentLibrary.flatMap(t => t.projects?.map((p: any) => p.id) || [])
        );

        const projectsToSync = approvedProjects.filter(p => !syncedProjectIds.has(p.id));

        if (projectsToSync.length > 0) {
          console.log(`Auto-syncing talents from ${projectsToSync.length} approved projects...`);
          projectsToSync.forEach(project => {
            const talents = extractTalentsFromProject(project);
            if (talents.length > 0) {
              addTalentsToLibrary(talents);
            }
          });
        }
      }
    }
  }, [localSubmissionsLoaded, submissions]);

  const [expandedBudgetStatus, setExpandedBudgetStatus] = useState<string | null>(null);
  const [expandedDepartment, setExpandedDepartment] = useState<string | null>(null);
  const [expandedTranche, setExpandedTranche] = useState<number | null>(null);
  const [collapsedSections, setCollapsedSections] = useState<{[key: string]: boolean}>({
    paymentTranches: true,
    crewDetails: true,
    timeline: true,
    cashFlow: true,
    documents: true,
  });
  const [editingPOC, setEditingPOC] = useState<{ submissionId: number; field: 'productionPOC' | 'contentPOC' } | null>(null);

  const toggleSection = (section: string) => {
    setCollapsedSections(prev => ({
      ...prev,
      [section]: !prev[section]
    }));
  };
  const [tempPOCValue, setTempPOCValue] = useState<string>('');

  const formatBudget = (amount: number) => {
    if (amount >= 10000000) {
      return `‚Çπ${(amount / 10000000).toFixed(2)} Cr`;
    } else if (amount >= 100000) {
      return `‚Çπ${(amount / 100000).toFixed(2)} L`;
    }
    return `‚Çπ${amount.toLocaleString('en-IN')}`;
  };

  const formatBudgetInWords = (amount: number) => {
    const crores = Math.floor(amount / 10000000);
    const lakhs = Math.floor((amount % 10000000) / 100000);
    const thousands = Math.floor((amount % 100000) / 1000);

    const parts = [];
    if (crores > 0) parts.push(`${crores} Crore${crores > 1 ? 's' : ''}`);
    if (lakhs > 0) parts.push(`${lakhs} Lakh${lakhs > 1 ? 's' : ''}`);
    if (thousands > 0) parts.push(`${thousands} Thousand`);

    return parts.length > 0 ? `‚Çπ${parts.join(' ')}` : '‚Çπ0';
  };

  // Check if submission is new (submitted in last 48 hours AND not yet viewed)
  const isNewSubmission = (submittedDate: string, projectId: number) => {
    // If already viewed, not new
    if (viewedProjects.has(projectId)) {
      return false;
    }
    const submitted = new Date(submittedDate);
    const now = new Date();
    const hoursDiff = (now.getTime() - submitted.getTime()) / (1000 * 60 * 60);
    return hoursDiff <= 48;
  };

  // Format time elapsed since submission
  const getTimeElapsed = (submittedDate: string) => {
    const submitted = new Date(submittedDate);
    const now = new Date();
    const hoursDiff = Math.floor((now.getTime() - submitted.getTime()) / (1000 * 60 * 60));
    const minutesDiff = Math.floor((now.getTime() - submitted.getTime()) / (1000 * 60));

    if (minutesDiff < 60) {
      return `${minutesDiff} minute${minutesDiff !== 1 ? 's' : ''} ago`;
    } else if (hoursDiff < 24) {
      return `${hoursDiff} hour${hoursDiff !== 1 ? 's' : ''} ago`;
    } else {
      const daysDiff = Math.floor(hoursDiff / 24);
      return `${daysDiff} day${daysDiff !== 1 ? 's' : ''} ago`;
    }
  };

  // Format date consistently across server and client
  const formatDate = (dateString: string | Date) => {
    const date = new Date(dateString);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    return `${day}/${month}/${year}`;
  };

  // Format date with month name (short)
  const formatDateWithMonth = (dateString: string | Date) => {
    const date = new Date(dateString);
    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
    const day = date.getDate();
    const month = months[date.getMonth()];
    const year = date.getFullYear();
    return `${day} ${month} ${year}`;
  };

  // Format date with full month name
  const formatDateLong = (dateString: string | Date) => {
    const date = new Date(dateString);
    const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    const day = date.getDate();
    const month = months[date.getMonth()];
    const year = date.getFullYear();
    return `${day} ${month} ${year}`;
  };

  // Count new submissions
  const newSubmissionsCount = submissions.filter(s => isNewSubmission(s.submittedDate, s.id)).length;

  // Generate default payment tranches based on project format
  const getDefaultTranches = (format: string, totalBudget: number) => {
    const isMicrodrama = format?.toLowerCase().includes('micro');

    if (isMicrodrama) {
      return [
        { name: 'Tranche 1 - Agreement Signing', description: 'Due upon the signing of the agreement, against a duly approved invoice. Payment will be made within 15 days of the approved invoice date.', percentage: 50, amount: Math.round(totalBudget * 0.5), status: 'pending' },
        { name: 'Tranche 2 - Final Deliverables', description: 'Due after the submission and approval of all final deliverables (TC, QC, and any other agreed-upon items), against a duly approved invoice. Payment will be processed within 15 days of the approved invoice date.', percentage: 50, amount: Math.round(totalBudget * 0.5), status: 'pending' },
      ];
    }

    // Default 4-tranche structure for Feature/Series/Mini
    return [
      { name: 'Tranche 1 - Agreement Signing', description: 'Upon signing of the agreement. Payment released within 15 days of approved invoice.', percentage: 25, amount: Math.round(totalBudget * 0.25), status: 'pending' },
      { name: 'Tranche 2 - Offline Edit Approval', description: 'Following the successful completion and approval of the offline edit. Payment released within 15 days of approved invoice.', percentage: 25, amount: Math.round(totalBudget * 0.25), status: 'pending' },
      { name: 'Tranche 3 - Final Delivery & QC', description: 'After final Technical Check (TC), Quality Check (QC), and approval of all project deliverables. Payment released within 15 days of approved invoice.', percentage: 40, amount: Math.round(totalBudget * 0.40), status: 'pending' },
      { name: 'Tranche 4 - Post-Delivery Payment', description: 'Payable 60 days after the final delivery, contingent upon the receipt of a duly approved invoice. Payment released within 15 days thereafter.', percentage: 10, amount: Math.round(totalBudget * 0.10), status: 'pending' },
    ];
  };

  const getStatusConfig = (status: string) => {
    switch (status) {
      case 'approved':
        return { color: 'from-green-500 to-emerald-600', icon: '‚úì APPROVED', text: 'Approved', badge: 'bg-green-100 border-green-500 text-green-800' };
      case 'under-review':
        return { color: 'from-blue-500 to-cyan-600', icon: 'üëÅ REVIEW', text: 'Under Review', badge: 'bg-blue-100 border-blue-500 text-blue-800' };
      case 'pending':
        return { color: 'from-yellow-500 to-orange-600', icon: '‚è≥ PENDING', text: 'Pending', badge: 'bg-yellow-100 border-yellow-500 text-yellow-800' };
      case 'revision-requested':
        return { color: 'from-purple-500 to-pink-600', icon: 'üìù REVISION', text: 'Revision Needed', badge: 'bg-purple-100 border-purple-500 text-purple-800' };
      case 'on-hold':
        return { color: 'from-orange-500 to-amber-600', icon: '‚è∏ ON HOLD', text: 'On Hold', badge: 'bg-orange-100 border-orange-500 text-orange-800' };
      case 'scrapped':
        return { color: 'from-gray-500 to-gray-600', icon: 'üóë SCRAPPED', text: 'Scrapped', badge: 'bg-gray-100 border-gray-500 text-gray-800' };
      case 'in-production':
        return { color: 'from-cyan-500 to-blue-600', icon: 'üé¨ PRODUCTION', text: 'In Production', badge: 'bg-cyan-100 border-cyan-500 text-cyan-800' };
      case 'agreement-signed':
        return { color: 'from-teal-500 to-cyan-600', icon: 'üìÑ AGREEMENT', text: 'Agreement Signed', badge: 'bg-teal-100 border-teal-500 text-teal-800' };
      default:
        return { color: 'from-gray-500 to-gray-600', icon: '‚Ä¢ ' + status.toUpperCase(), text: status, badge: 'bg-gray-100 border-gray-500 text-gray-800' };
    }
  };

  // Helper function for culture colors - only 4 cultures supported
  const getCultureColor = (culture: string): string => {
    const cultureLower = culture?.toLowerCase() || '';
    switch (cultureLower) {
      case 'haryanvi':
        return 'from-green-600 to-teal-700';
      case 'rajasthani':
        return 'from-pink-600 to-purple-700';
      case 'bhojpuri':
        return 'from-orange-600 to-red-700';
      case 'gujarati':
        return 'from-amber-500 to-yellow-600';
      default:
        return 'from-gray-600 to-slate-700';
    }
  };

  // Activity Log Helper - Save activity for a project (unified format)
  const addActivityLog = (projectId: number | string, action: string, description: string, type: string, user: string = 'Admin Team', source: string = 'admin') => {
    const now = new Date();
    const activity = {
      id: `activity_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
      projectId,
      action,
      description,
      type, // 'submit' | 'status' | 'assign' | 'feedback' | 'review' | 'edit' | 'access'
      user,
      source, // 'creator' or 'admin'
      date: now.toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' }),
      time: now.toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit', hour12: true }),
      timestamp: now.toISOString(),
    };

    // Save to localStorage
    if (typeof window !== 'undefined') {
      const existingLogs = JSON.parse(localStorage.getItem('stage_activity_logs') || '{}');
      if (!existingLogs[projectId]) {
        existingLogs[projectId] = [];
      }
      existingLogs[projectId].unshift(activity); // Add to beginning (newest first)
      localStorage.setItem('stage_activity_logs', JSON.stringify(existingLogs));
    }

    // Also update the submission's activityLog in state
    setSubmissions(prev => prev.map(s => {
      if (s.id === projectId) {
        const currentLog = s.activityLog || [];
        return { ...s, activityLog: [activity, ...currentLog] };
      }
      return s;
    }));

    return activity;
  };

  // Get activity logs for a project
  const getActivityLogs = (projectId: number) => {
    if (typeof window !== 'undefined') {
      const allLogs = JSON.parse(localStorage.getItem('stage_activity_logs') || '{}');
      return allLogs[projectId] || [];
    }
    return [];
  };

  // Open status change modal with comment field
  const handleStatusChange = (submissionId: number, newStatus: string) => {
    setPendingStatusChange({ submissionId, newStatus });
    setStatusChangeComment('');
    setShowStatusChangeModal(true);
    setShowStatusMenu(null);
  };

  // Confirm status change with comment
  const confirmStatusChange = () => {
    if (!pendingStatusChange) return;

    const { submissionId, newStatus } = pendingStatusChange;
    const submission = submissions.find(s => s.id === submissionId);
    const oldStatus = submission?.status || 'pending';

    // Update submission status
    setSubmissions(prevSubmissions =>
      prevSubmissions.map(s =>
        s.id === submissionId ? { ...s, status: newStatus, statusChangedDate: new Date().toISOString() } : s
      )
    );

    // Update selectedSubmission if it's the one being changed
    if (selectedSubmission && selectedSubmission.id === submissionId) {
      setSelectedSubmission({ ...selectedSubmission, status: newStatus, statusChangedDate: new Date().toISOString() });
    }

    // Add Activity Log with comment
    if (submission && oldStatus !== newStatus) {
      const statusLabels: Record<string, string> = {
        'approved': 'Approved',
        'in-production': 'In Production',
        'rejected': 'Rejected',
        'scrapped': 'Scrapped',
        'under-review': 'Under Review',
        'revision-requested': 'Revision Requested',
        'on-hold': 'On Hold',
        'pending': 'Pending',
      };

      const description = statusChangeComment.trim()
        ? `Project status updated from "${statusLabels[oldStatus] || oldStatus}" to "${statusLabels[newStatus] || newStatus}".\n\nüí¨ Admin Comment: ${statusChangeComment}`
        : `Project status updated from "${statusLabels[oldStatus] || oldStatus}" to "${statusLabels[newStatus] || newStatus}"`;

      addActivityLog(
        submissionId,
        `Status Changed: ${statusLabels[oldStatus] || oldStatus} ‚Üí ${statusLabels[newStatus] || newStatus}`,
        description,
        'status'
      );

      // Create notification for creator with comment
      createCreatorNotification(submission, oldStatus, newStatus, statusChangeComment.trim());
    }

    // Auto-export agreement when moving to production
    if (newStatus === 'in-production' && submission) {
      setTimeout(() => {
        exportToExcel(submission);
        alert(`üé¨ Project "${submission.projectName}" moved to Production!\n\nAgreement Excel has been automatically downloaded with all project details.\n\nüìß Creator has been notified via email at ${submission.officialEmail || 'their registered email'}.`);
      }, 300);
    }

    // Auto-add talents to library when approved or in-production
    if ((newStatus === 'approved' || newStatus === 'in-production') && submission) {
      const talents = extractTalentsFromProject(submission);
      if (talents.length > 0) {
        addTalentsToLibrary(talents);
        console.log(`Added ${talents.length} talents to library from project: ${submission.projectName}`);
      }
    }

    // Reset modal state
    setShowStatusChangeModal(false);
    setStatusChangeComment('');
    setPendingStatusChange(null);
    console.log(`Changed submission ${submissionId} to status: ${newStatus}`);
  };

  // Create notification for creator when status changes
  const createCreatorNotification = (submission: any, oldStatus: string, newStatus: string, adminComment?: string) => {
    const statusMessages: Record<string, string> = {
      'approved': `üéâ Congratulations! Your project "${submission.projectName}" has been APPROVED by STAGE!`,
      'in-production': `üé¨ Exciting news! Your project "${submission.projectName}" is now IN PRODUCTION!`,
      'rejected': `Your project "${submission.projectName}" was not selected at this time.`,
      'scrapped': `Your project "${submission.projectName}" has been scrapped.`,
      'under-review': `Your project "${submission.projectName}" is now under review by our team.`,
      'revision-requested': `üìù Revisions requested for "${submission.projectName}". Please update and resubmit.`,
      'on-hold': `Your project "${submission.projectName}" has been put on hold.`,
      'pending': `Your project "${submission.projectName}" status has been reset to pending.`,
    };

    const baseMessage = statusMessages[newStatus] || `Status updated for "${submission.projectName}": ${newStatus}`;
    const fullMessage = adminComment
      ? `${baseMessage}\n\nüí¨ Admin Comment: "${adminComment}"`
      : baseMessage;

    const notification = {
      id: `notif_${Date.now()}_${submission.id}`,
      projectId: submission.id,
      projectName: submission.projectName || 'Untitled Project',
      oldStatus: oldStatus,
      newStatus: newStatus,
      message: fullMessage,
      adminComment: adminComment || '',
      timestamp: new Date().toISOString(),
      read: false,
      creatorEmail: submission.officialEmail || '',
    };

    // Save notification to localStorage
    const existingNotifications = JSON.parse(localStorage.getItem('stage_notifications') || '[]');
    const updatedNotifications = [notification, ...existingNotifications];
    localStorage.setItem('stage_notifications', JSON.stringify(updatedNotifications));

    // Update localStorage submissions with new status and admin comment
    const localSubmissions = JSON.parse(localStorage.getItem('stage_submissions') || '[]');
    const updatedSubmissions = localSubmissions.map((s: any) =>
      s.id === submission.id ? { ...s, status: newStatus, lastAdminComment: adminComment || '' } : s
    );
    localStorage.setItem('stage_submissions', JSON.stringify(updatedSubmissions));

    // Show confirmation with email info
    const emailMessage = submission.officialEmail
      ? `\n\nüìß Notification sent to: ${submission.officialEmail}`
      : '\n\n‚ö†Ô∏è No email on file - Creator will see notification on their dashboard.';

    // Don't show alert for every status change, just for important ones
    if (['approved', 'in-production', 'rejected'].includes(newStatus)) {
      setTimeout(() => {
        alert(`‚úÖ Status Updated: ${newStatus.toUpperCase()}\n\nProject: ${submission.projectName}${emailMessage}`);
      }, 100);
    }

    console.log('Notification created:', notification);
  };

  const handleDeleteProject = (submissionId: number | string) => {
    // Remove submission from list
    const updatedSubmissions = submissions.filter(s => s.id !== submissionId);
    setSubmissions(updatedSubmissions);

    // Persist to localStorage
    if (typeof window !== 'undefined') {
      localStorage.setItem('stage_submissions', JSON.stringify(updatedSubmissions));
    }

    setShowDeleteConfirm(null);
    if (selectedSubmission?.id === submissionId) {
      setSelectedSubmission(null);
    }
    console.log(`Deleted submission ${submissionId}`);
  };

  // Handle granting edit access
  const handleGrantEditAccess = (request: any) => {
    // Update request status
    const updatedRequests = editAccessRequests.map(r =>
      r.id === request.id
        ? { ...r, status: 'approved', respondedAt: new Date().toISOString() }
        : r
    );
    setEditAccessRequests(updatedRequests);
    localStorage.setItem('stage_edit_requests', JSON.stringify(updatedRequests));

    // Add project to granted access list
    const grantedAccess = JSON.parse(localStorage.getItem('stage_edit_access_granted') || '[]');
    if (!grantedAccess.includes(request.projectId)) {
      grantedAccess.push(request.projectId);
      localStorage.setItem('stage_edit_access_granted', JSON.stringify(grantedAccess));
    }

    // Create notification for creator
    const notification = {
      id: `notif_${Date.now()}_grant_${request.projectId}`,
      projectId: request.projectId,
      projectName: request.projectName,
      oldStatus: 'locked',
      newStatus: 'edit_granted',
      message: `‚úÖ Edit access GRANTED for "${request.projectName}"! You can now make changes to your project.`,
      timestamp: new Date().toISOString(),
      read: false,
    };
    const existingNotifications = JSON.parse(localStorage.getItem('stage_notifications') || '[]');
    localStorage.setItem('stage_notifications', JSON.stringify([notification, ...existingNotifications]));

    // Add Activity Log
    addActivityLog(
      request.projectId,
      'Edit Access Granted',
      `Edit access granted to ${request.creatorEmail} for project "${request.projectName}"`,
      'access'
    );

    alert(`‚úÖ Edit Access Granted!\n\nProject: ${request.projectName}\nCreator: ${request.creatorEmail}\n\nThe creator can now edit this project.`);
  };

  // Handle denying edit access
  const handleDenyEditAccess = (request: any, reason: string) => {
    // Update request status
    const updatedRequests = editAccessRequests.map(r =>
      r.id === request.id
        ? { ...r, status: 'denied', respondedAt: new Date().toISOString(), adminMessage: reason || 'Request denied by admin.' }
        : r
    );
    setEditAccessRequests(updatedRequests);
    localStorage.setItem('stage_edit_requests', JSON.stringify(updatedRequests));

    // Create notification for creator
    const notification = {
      id: `notif_${Date.now()}_deny_${request.projectId}`,
      projectId: request.projectId,
      projectName: request.projectName,
      oldStatus: 'locked',
      newStatus: 'edit_denied',
      message: `‚ùå Edit access DENIED for "${request.projectName}". ${reason || 'Contact admin for more details.'}`,
      timestamp: new Date().toISOString(),
      read: false,
    };
    const existingNotifications = JSON.parse(localStorage.getItem('stage_notifications') || '[]');
    localStorage.setItem('stage_notifications', JSON.stringify([notification, ...existingNotifications]));

    // Add Activity Log
    addActivityLog(
      request.projectId,
      'Edit Access Denied',
      `Edit access denied for ${request.creatorEmail}. Reason: ${reason || 'Not specified'}`,
      'access'
    );

    setDenyReason('');
    alert(`Edit Access Denied\n\nProject: ${request.projectName}\nReason: ${reason || 'Not specified'}\n\nThe creator has been notified.`);
  };

  // Revoke edit access
  const handleRevokeEditAccess = (projectId: string) => {
    const grantedAccess = JSON.parse(localStorage.getItem('stage_edit_access_granted') || '[]');
    const updatedAccess = grantedAccess.filter((id: string) => id !== projectId);
    localStorage.setItem('stage_edit_access_granted', JSON.stringify(updatedAccess));

    // Update request status back to denied/revoked
    const updatedRequests = editAccessRequests.map(r =>
      r.projectId === projectId && r.status === 'approved'
        ? { ...r, status: 'revoked', respondedAt: new Date().toISOString(), adminMessage: 'Edit access revoked by admin.' }
        : r
    );
    setEditAccessRequests(updatedRequests);
    localStorage.setItem('stage_edit_requests', JSON.stringify(updatedRequests));

    // Create notification for creator
    const request = editAccessRequests.find(r => r.projectId === projectId);
    if (request) {
      const notification = {
        id: `notif_${Date.now()}_revoke_${projectId}`,
        projectId: projectId,
        projectName: request.projectName,
        oldStatus: 'edit_granted',
        newStatus: 'edit_revoked',
        message: `üîí Edit access REVOKED for "${request.projectName}". The project is now locked again.`,
        timestamp: new Date().toISOString(),
        read: false,
      };
      const existingNotifications = JSON.parse(localStorage.getItem('stage_notifications') || '[]');
      localStorage.setItem('stage_notifications', JSON.stringify([notification, ...existingNotifications]));

      // Add Activity Log
      addActivityLog(
        projectId,
        'Edit Access Revoked',
        `Edit access revoked for project "${request.projectName}". Project is now locked.`,
        'access'
      );
    }

    alert('Edit access has been revoked. The project is now locked again.');
  };

  // Get pending edit requests count
  const pendingEditRequestsCount = editAccessRequests.filter(r => r.status === 'pending').length;

  // Export to Excel function
  const exportToExcel = (submission: any) => {
    const agreementDate = new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });

    // Create workbook
    const wb = XLSX.utils.book_new();

    // Sheet 1: Agreement Summary
    const summaryData = [
      ['STAGE OTT - PROJECT AGREEMENT DETAILS'],
      [''],
      ['1. AGREEMENT DATE', agreementDate],
      [''],
      ['2. CONTENT NAME', submission.projectName || 'N/A'],
      ['   Culture', submission.culture || 'N/A'],
      ['   Format', submission.format || 'N/A'],
      ['   Genre', submission.genre || 'N/A'],
      [''],
      ['3. CREATOR / COMPANY DETAILS'],
      ['   Name', submission.creatorName || submission.creator || 'N/A'],
      ['   Company', submission.productionCompany || 'N/A'],
      ['   Father\'s Name', submission.fatherName || 'N/A'],
      ['   Authorized Signatory', submission.authorizedSignatory || 'N/A'],
      ['   Address', submission.permanentAddress || submission.currentAddress || 'N/A'],
      ['   PAN Number', submission.panNumber || 'N/A'],
      ['   GST Number', submission.gstNumber || 'N/A'],
      ['   Email', submission.officialEmail || 'N/A'],
      ['   Phone', submission.phone || 'N/A'],
      [''],
      ['4. TOTAL BUDGET', formatBudgetInWords(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0)],
      ['   In Figures', `‚Çπ${(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0).toLocaleString('en-IN')}`],
      [''],
      ['5. DIRECTOR & WRITER'],
      ['   Director', submission.director || 'N/A'],
      ['   Story By', submission.storyBy || 'N/A'],
      ['   Screenplay By', submission.screenplayBy || 'N/A'],
      ['   Dialogues By', submission.dialoguesBy || 'N/A'],
      [''],
      ['6. CONTENT DURATION & EPISODES'],
      ['   Total Duration (mins)', submission.totalDuration || 'N/A'],
      ['   Number of Episodes', submission.episodes || submission.episodesPerSeason || 'N/A'],
      ['   Format', submission.format || 'N/A'],
      [''],
      ['7. PROJECT DELIVERY DATE'],
      ['   Final Delivery', submission.contentTimeline?.finalDeliveryDate || 'N/A'],
      ['   Shoot Start Date', submission.shootStartDate || 'N/A'],
      ['   Shoot End Date', submission.shootEndDate || 'N/A'],
      ['   Total Shoot Days', submission.shootDays || 'N/A'],
      [''],
      ['8. CONTENT CREATION SCHEDULE'],
      ['   Pre-Production Start', submission.contentTimeline?.preProductionStart || 'N/A'],
      ['   Pre-Production End', submission.contentTimeline?.preProductionEnd || 'N/A'],
      ['   Principal Photography', `${submission.shootStartDate || 'N/A'} to ${submission.shootEndDate || 'N/A'}`],
      ['   Post-Production Start', submission.contentTimeline?.postProductionStart || 'N/A'],
      ['   Post-Production End', submission.contentTimeline?.postProductionEnd || 'N/A'],
      [''],
      ['9. TECHNICAL SPECIFICATIONS'],
      ['   Camera Model', submission.technicalSpecs?.cameraModel || 'N/A'],
      ['   Camera Setup', submission.technicalSpecs?.cameraSetupType || 'N/A'],
      ['   Number of Lens Types', submission.technicalSpecs?.lensTypes?.length || 0],
      ['   Lighting Equipment', submission.technicalSpecs?.lightingEquipment?.length || 0],
      ['   Sound Equipment', submission.technicalSpecs?.soundEquipment?.length || 0],
      ['   Drones', submission.technicalSpecs?.droneModels?.length || 0],
    ];

    const ws1 = XLSX.utils.aoa_to_sheet(summaryData);
    ws1['!cols'] = [{ wch: 30 }, { wch: 50 }];
    XLSX.utils.book_append_sheet(wb, ws1, 'Agreement Summary');

    // Sheet 2: Cash Flow / Payment Terms
    const cashFlowData = [
      ['CASH FLOW - PAYMENT TERMS'],
      [''],
      ['Tranche', 'Milestone', 'Percentage', 'Amount', 'Date'],
    ];
    if (submission.cashFlowTranches && submission.cashFlowTranches.length > 0) {
      submission.cashFlowTranches.forEach((tranche: any, idx: number) => {
        cashFlowData.push([
          `Tranche ${idx + 1}`,
          tranche.milestone || '',
          tranche.percentage ? `${tranche.percentage}%` : '',
          tranche.amount ? `‚Çπ${tranche.amount.toLocaleString('en-IN')}` : '',
          tranche.date || ''
        ]);
      });
    } else {
      cashFlowData.push(['No cash flow tranches defined', '', '', '', '']);
    }
    const ws2 = XLSX.utils.aoa_to_sheet(cashFlowData);
    ws2['!cols'] = [{ wch: 15 }, { wch: 30 }, { wch: 15 }, { wch: 20 }, { wch: 15 }];
    XLSX.utils.book_append_sheet(wb, ws2, 'Cash Flow');

    // Sheet 3: Budget Breakdown
    const budgetData = [
      ['BUDGET SHEET - CATEGORY WISE BREAKDOWN'],
      [''],
      ['Category', 'Amount (‚Çπ)', 'Percentage'],
    ];
    if (submission.budgetBreakdown && submission.budgetBreakdown.length > 0) {
      submission.budgetBreakdown.forEach((item: any) => {
        budgetData.push([
          item.category || '',
          item.amount ? `‚Çπ${item.amount.toLocaleString('en-IN')}` : '‚Çπ0',
          item.percentage ? `${item.percentage}%` : ''
        ]);
      });
    }
    budgetData.push(['']);
    budgetData.push(['TOTAL BUDGET', formatBudgetInWords(submission.totalBudget || 0), '100%']);
    const ws3 = XLSX.utils.aoa_to_sheet(budgetData);
    ws3['!cols'] = [{ wch: 35 }, { wch: 25 }, { wch: 15 }];
    XLSX.utils.book_append_sheet(wb, ws3, 'Budget Sheet');

    // Sheet 4: Key Crew
    const crewData = [
      ['KEY CREW DETAILS'],
      [''],
      ['Department', 'Role', 'Name'],
      ['Direction', 'Director', submission.director || 'N/A'],
      ['Direction', 'Associate Director', submission.associateDirector || 'N/A'],
      ['Direction', 'Assistant Director', submission.assistantDirector1 || 'N/A'],
      ['Production', 'Head of Production', submission.headOfProduction || 'N/A'],
      ['Production', 'Executive Producer', submission.executiveProducer || 'N/A'],
      ['Production', 'Line Producer', submission.lineProducer || 'N/A'],
      ['Writing', 'Story', submission.storyBy || 'N/A'],
      ['Writing', 'Screenplay', submission.screenplayBy || 'N/A'],
      ['Writing', 'Dialogues', submission.dialoguesBy || 'N/A'],
      ['Camera', 'DOP', submission.dop || 'N/A'],
      ['Camera', 'Camera Operator', submission.cameraOperator || 'N/A'],
      ['Post-Production', 'Editor', submission.editor || 'N/A'],
      ['Post-Production', 'Colorist', submission.colorist || 'N/A'],
      ['Sound', 'Sound Designer', submission.soundDesigner || 'N/A'],
      ['Sound', 'Sound Recordist', submission.soundRecordist || 'N/A'],
      ['Music', 'Music Composer', submission.musicComposer || 'N/A'],
      ['Art', 'Production Designer', submission.productionDesigner || 'N/A'],
      ['Costume', 'Costume Designer', submission.costumeDesigner || 'N/A'],
      ['VFX', 'VFX Supervisor', submission.vfxSupervisor || 'N/A'],
    ];
    const ws4 = XLSX.utils.aoa_to_sheet(crewData);
    ws4['!cols'] = [{ wch: 20 }, { wch: 25 }, { wch: 30 }];
    XLSX.utils.book_append_sheet(wb, ws4, 'Key Crew');

    // Download
    const fileName = `Agreement_${submission.projectName?.replace(/[^a-zA-Z0-9]/g, '_') || 'Project'}_${new Date().toISOString().split('T')[0]}.xlsx`;
    XLSX.writeFile(wb, fileName);
  };

  // Export to PDF function (generates printable HTML)
  const exportToPDF = (submission: any) => {
    const agreementDate = new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });

    const printContent = `
      <!DOCTYPE html>
      <html>
      <head>
        <title>Agreement - ${submission.projectName || 'Project'}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
          h1 { text-align: center; border-bottom: 3px solid #333; padding-bottom: 10px; }
          h2 { background: #f5f5f5; padding: 10px; margin-top: 30px; border-left: 4px solid #e53e3e; }
          .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
          .label { font-weight: bold; color: #555; }
          .value { text-align: right; }
          .highlight { font-size: 24px; color: #16a34a; font-weight: bold; }
          table { width: 100%; border-collapse: collapse; margin: 15px 0; }
          th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
          th { background: #f5f5f5; }
          .footer { margin-top: 50px; text-align: center; font-size: 12px; color: #888; }
          @media print { body { padding: 20px; } }
        </style>
      </head>
      <body>
        <h1>STAGE OTT - PROJECT AGREEMENT</h1>

        <h2>1. Agreement Date</h2>
        <div class="row"><span class="label">Date:</span><span class="value">${agreementDate}</span></div>

        <h2>2. Content Name</h2>
        <div class="row"><span class="label">Project Name:</span><span class="value">${submission.projectName || 'N/A'}</span></div>
        <div class="row"><span class="label">Culture:</span><span class="value">${submission.culture || 'N/A'}</span></div>
        <div class="row"><span class="label">Format:</span><span class="value">${submission.format || 'N/A'}</span></div>

        <h2>3. Creator / Company Details</h2>
        <div class="row"><span class="label">Name:</span><span class="value">${submission.creatorName || submission.creator || 'N/A'}</span></div>
        <div class="row"><span class="label">Company:</span><span class="value">${submission.productionCompany || 'N/A'}</span></div>
        <div class="row"><span class="label">Father's Name:</span><span class="value">${submission.fatherName || 'N/A'}</span></div>
        <div class="row"><span class="label">Authorized Signatory:</span><span class="value">${submission.authorizedSignatory || 'N/A'}</span></div>
        <div class="row"><span class="label">Address:</span><span class="value">${submission.permanentAddress || submission.currentAddress || 'N/A'}</span></div>
        <div class="row"><span class="label">PAN Number:</span><span class="value">${submission.panNumber || 'N/A'}</span></div>
        <div class="row"><span class="label">GST Number:</span><span class="value">${submission.gstNumber || 'N/A'}</span></div>
        <div class="row"><span class="label">Email:</span><span class="value">${submission.officialEmail || 'N/A'}</span></div>
        <div class="row"><span class="label">Phone:</span><span class="value">${submission.phone || 'N/A'}</span></div>

        <h2>4. Total Budget</h2>
        <div class="row"><span class="label">Amount:</span><span class="value highlight">${formatBudgetInWords(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0)}</span></div>

        <h2>4.1 Detailed Budget Breakdown (Department-wise)</h2>
        ${submission.budgetCategories && submission.budgetCategories.length > 0 ? `
          <table style="width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 11px;">
            <thead>
              <tr style="background: #1a1a2e; color: white;">
                <th style="border: 1px solid #333; padding: 8px; text-align: left;">Department</th>
                <th style="border: 1px solid #333; padding: 8px; text-align: left;">Item Description</th>
                <th style="border: 1px solid #333; padding: 8px; text-align: center;">Days</th>
                <th style="border: 1px solid #333; padding: 8px; text-align: center;">Qty/People</th>
                <th style="border: 1px solid #333; padding: 8px; text-align: right;">Per Day (‚Çπ)</th>
                <th style="border: 1px solid #333; padding: 8px; text-align: right;">Lumpsum (‚Çπ)</th>
                <th style="border: 1px solid #333; padding: 8px; text-align: right;">Total (‚Çπ)</th>
              </tr>
            </thead>
            <tbody>
              ${submission.budgetCategories.map((category: any) => {
                const filledItems = category.items?.filter((item: any) => item.total > 0 || item.description) || [];
                if (filledItems.length === 0) return '';

                return `
                  <tr style="background: #f8f9fa;">
                    <td colspan="6" style="border: 1px solid #ddd; padding: 10px; font-weight: bold; background: #e9ecef;">
                      ${category.icon || 'üìÅ'} ${category.name}
                    </td>
                    <td style="border: 1px solid #ddd; padding: 10px; font-weight: bold; background: #e9ecef; text-align: right;">
                      ‚Çπ${(category.amount || 0).toLocaleString('en-IN')}
                    </td>
                  </tr>
                  ${filledItems.map((item: any) => `
                    <tr>
                      <td style="border: 1px solid #ddd; padding: 6px;"></td>
                      <td style="border: 1px solid #ddd; padding: 6px;">${item.description || 'N/A'}</td>
                      <td style="border: 1px solid #ddd; padding: 6px; text-align: center;">${item.noOfDays || item.days || '-'}</td>
                      <td style="border: 1px solid #ddd; padding: 6px; text-align: center;">${item.noOfPeople || item.people || item.noOfRooms || '-'}</td>
                      <td style="border: 1px solid #ddd; padding: 6px; text-align: right;">${item.perDay ? '‚Çπ' + item.perDay.toLocaleString('en-IN') : '-'}</td>
                      <td style="border: 1px solid #ddd; padding: 6px; text-align: right;">${(item.lumpsumFixed || item.lumpsum) ? '‚Çπ' + (item.lumpsumFixed || item.lumpsum).toLocaleString('en-IN') : '-'}</td>
                      <td style="border: 1px solid #ddd; padding: 6px; text-align: right; font-weight: bold;">‚Çπ${(item.total || 0).toLocaleString('en-IN')}</td>
                    </tr>
                  `).join('')}
                `;
              }).join('')}
            </tbody>
            <tfoot>
              <tr style="background: #16a34a; color: white; font-weight: bold;">
                <td colspan="6" style="border: 1px solid #333; padding: 12px; text-align: right; font-size: 14px;">GRAND TOTAL:</td>
                <td style="border: 1px solid #333; padding: 12px; text-align: right; font-size: 14px;">
                  ‚Çπ${(submission.budgetCategories.reduce((sum: number, cat: any) => sum + (cat.amount || 0), 0)).toLocaleString('en-IN')}
                </td>
              </tr>
            </tfoot>
          </table>

          <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd;">
            <h4 style="margin: 0 0 10px 0; color: #333;">Budget Summary by Department:</h4>
            <table style="width: 100%; border-collapse: collapse;">
              ${submission.budgetCategories.filter((cat: any) => cat.amount > 0).map((cat: any) => `
                <tr>
                  <td style="padding: 5px 10px; border-bottom: 1px solid #eee;">${cat.icon || 'üìÅ'} ${cat.name}</td>
                  <td style="padding: 5px 10px; border-bottom: 1px solid #eee; text-align: right; font-weight: bold;">‚Çπ${(cat.amount || 0).toLocaleString('en-IN')}</td>
                  <td style="padding: 5px 10px; border-bottom: 1px solid #eee; text-align: right; color: #666;">${(cat.yourPercentage || 0).toFixed(1)}%</td>
                </tr>
              `).join('')}
            </table>
          </div>
        ` : `
          <p style="color: #888; font-style: italic;">No detailed budget breakdown available</p>
        `}

        <h2>5. Director & Writer</h2>
        <div class="row"><span class="label">Director:</span><span class="value">${submission.director || 'N/A'}</span></div>
        <div class="row"><span class="label">Story By:</span><span class="value">${submission.storyBy || 'N/A'}</span></div>
        <div class="row"><span class="label">Screenplay:</span><span class="value">${submission.screenplayBy || 'N/A'}</span></div>
        <div class="row"><span class="label">Dialogues:</span><span class="value">${submission.dialoguesBy || 'N/A'}</span></div>

        <h2>6. Content Duration & Episodes</h2>
        <div class="row"><span class="label">Total Duration:</span><span class="value">${submission.totalDuration || 'N/A'} minutes</span></div>
        <div class="row"><span class="label">Episodes:</span><span class="value">${submission.episodes || submission.episodesPerSeason || 'N/A'}</span></div>

        <h2>7. Project Delivery Date</h2>
        <div class="row"><span class="label">Final Delivery:</span><span class="value">${submission.contentTimeline?.finalDeliveryDate || 'N/A'}</span></div>
        <div class="row"><span class="label">Shoot Period:</span><span class="value">${submission.shootStartDate || 'N/A'} to ${submission.shootEndDate || 'N/A'}</span></div>

        <h2>8. Cash Flow (Payment Terms)</h2>
        <table>
          <tr><th>Tranche</th><th>Milestone</th><th>Percentage/Amount</th></tr>
          ${submission.cashFlowTranches?.map((t: any, i: number) => `
            <tr><td>Tranche ${i + 1}</td><td>${t.milestone || '-'}</td><td>${t.percentage ? t.percentage + '%' : formatBudget(t.amount || 0)}</td></tr>
          `).join('') || '<tr><td colspan="3">No tranches defined</td></tr>'}
        </table>

        <h2>9. Content Creation Schedule</h2>
        <div class="row"><span class="label">Pre-Production:</span><span class="value">${submission.contentTimeline?.preProductionStart || 'N/A'} - ${submission.contentTimeline?.preProductionEnd || 'N/A'}</span></div>
        <div class="row"><span class="label">Principal Photography:</span><span class="value">${submission.shootStartDate || 'N/A'} - ${submission.shootEndDate || 'N/A'} (${submission.shootDays || 'N/A'} days)</span></div>
        <div class="row"><span class="label">Post-Production:</span><span class="value">${submission.contentTimeline?.postProductionStart || 'N/A'} - ${submission.contentTimeline?.postProductionEnd || 'N/A'}</span></div>

        <h2>10. Technical Specifications</h2>
        <div class="row"><span class="label">Camera:</span><span class="value">${submission.technicalSpecs?.cameraModel || 'N/A'} (${submission.technicalSpecs?.cameraSetupType || 'N/A'})</span></div>

        <div class="footer">
          <p>Generated on ${agreementDate} | STAGE OTT Creator Portal</p>
        </div>
      </body>
      </html>
    `;

    const printWindow = window.open('', '_blank');
    if (printWindow) {
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.onload = () => {
        printWindow.print();
      };
    }
  };

  // Export individual tab to Excel
  const exportTabToExcel = (submission: any, tabName: string) => {
    const wb = XLSX.utils.book_new();
    const projectName = submission.projectName || 'Project';
    const date = new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });

    let sheetData: any[][] = [];

    switch (tabName) {
      case 'project':
        sheetData = [
          [`PROJECT DETAILS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['PROJECT INFORMATION'],
          ['Project Name', submission.projectName || 'N/A'],
          ['Production Company', submission.productionCompany || 'N/A'],
          ['Culture', submission.culture || 'N/A'],
          ['Format', submission.format || 'N/A'],
          ['Genre', submission.genre || 'N/A'],
          ['Sub-Genre', submission.subGenre || 'N/A'],
          ['Content Rating', submission.contentRating || 'N/A'],
          ['Production Type', submission.productionType || 'N/A'],
          ['Language', submission.language || 'N/A'],
          [''],
          ['CONTENT DETAILS'],
          ['Episodes', submission.episodes || submission.episodesPerSeason || 'N/A'],
          ['Total Duration (mins)', submission.totalDuration || 'N/A'],
          ['Episode Duration (mins)', submission.episodeDuration || 'N/A'],
          ['Logline', submission.logline || 'N/A'],
          ['Synopsis', submission.synopsis || 'N/A'],
          [''],
          ['POINT OF CONTACT'],
          ['Production POC', submission.productionPOC || 'N/A'],
          ['Content POC', submission.contentPOC || 'N/A'],
          [''],
          ['SUBMISSION DETAILS'],
          ['Status', submission.status || 'N/A'],
          ['Submitted At', submission.submitted_at || 'N/A'],
        ];
        break;

      case 'creator':
        sheetData = [
          [`CREATOR DETAILS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['PERSONAL INFORMATION'],
          ['Creator Name', submission.creatorName || submission.creator || 'N/A'],
          ['Father\'s Name', submission.fatherName || 'N/A'],
          ['Date of Birth', submission.dateOfBirth || 'N/A'],
          ['Phone', submission.phone || 'N/A'],
          ['Email', submission.officialEmail || 'N/A'],
          [''],
          ['ADDRESS DETAILS'],
          ['Permanent Address', submission.permanentAddress || 'N/A'],
          ['Current Address', submission.currentAddress || 'N/A'],
          [''],
          ['COMPANY DETAILS'],
          ['Production Company', submission.productionCompany || 'N/A'],
          ['Authorized Signatory', submission.authorizedSignatory || 'N/A'],
          ['PAN Number', submission.panNumber || 'N/A'],
          ['GST Number', submission.gstNumber || 'N/A'],
          [''],
          ['BANK DETAILS'],
          ['Bank Name', submission.bankName || 'N/A'],
          ['Account Number', submission.accountNumber || 'N/A'],
          ['IFSC Code', submission.ifscCode || 'N/A'],
          ['Account Holder Name', submission.accountHolderName || 'N/A'],
        ];
        break;

      case 'budget':
        sheetData = [
          [`BUDGET DETAILS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['BUDGET SUMMARY'],
          ['Total Budget', `‚Çπ${(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0).toLocaleString('en-IN')}`],
          ['Production Cost', `‚Çπ${(submission.productionCost || 0).toLocaleString('en-IN')}`],
          ['Creator Margin', `‚Çπ${(submission.creatorMargin || 0).toLocaleString('en-IN')}`],
          ['Insurance', `‚Çπ${(submission.insurance || 0).toLocaleString('en-IN')}`],
          ['Celebrity Fees', `‚Çπ${(submission.celebrityFees || 0).toLocaleString('en-IN')}`],
          [''],
          ['BUDGET BREAKDOWN'],
          ['Category', 'Amount (‚Çπ)', 'Percentage'],
        ];
        if (submission.budgetBreakdown && submission.budgetBreakdown.length > 0) {
          submission.budgetBreakdown.forEach((item: any) => {
            sheetData.push([item.category || '', `‚Çπ${(item.amount || 0).toLocaleString('en-IN')}`, item.percentage ? `${item.percentage}%` : '']);
          });
        }
        break;

      case 'timeline':
        sheetData = [
          [`TIMELINE DETAILS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['DEVELOPMENT PHASE'],
          ['Start Date', submission.contentTimeline?.developmentStart || 'N/A'],
          ['End Date', submission.contentTimeline?.developmentEnd || 'N/A'],
          ['Duration', submission.contentTimeline?.developmentDuration || 'N/A'],
          ['Comments', submission.contentTimeline?.developmentComments || 'N/A'],
          [''],
          ['PRE-PRODUCTION PHASE'],
          ['Start Date', submission.contentTimeline?.preProductionStart || 'N/A'],
          ['End Date', submission.contentTimeline?.preProductionEnd || 'N/A'],
          ['Duration', submission.contentTimeline?.preProductionDuration || 'N/A'],
          ['Comments', submission.contentTimeline?.preProductionComments || 'N/A'],
          [''],
          ['PRODUCTION / SHOOT PHASE'],
          ['Start Date', submission.shootStartDate || submission.contentTimeline?.shootStart || 'N/A'],
          ['End Date', submission.shootEndDate || submission.contentTimeline?.shootEnd || 'N/A'],
          ['Shoot Days', submission.shootDays || submission.contentTimeline?.shootDays || 'N/A'],
          ['Comments', submission.contentTimeline?.shootComments || 'N/A'],
          [''],
          ['POST-PRODUCTION PHASE'],
          ['Start Date', submission.contentTimeline?.postProductionStart || 'N/A'],
          ['End Date', submission.contentTimeline?.postProductionEnd || 'N/A'],
          ['Duration', submission.contentTimeline?.postProductionDuration || 'N/A'],
          ['Comments', submission.contentTimeline?.postProductionComments || 'N/A'],
          [''],
          ['FINAL DELIVERY'],
          ['Delivery Date', submission.contentTimeline?.finalDeliveryDate || 'N/A'],
          ['Comments', submission.contentTimeline?.deliveryComments || 'N/A'],
        ];
        break;

      case 'crew':
        sheetData = [
          [`CREW DETAILS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['Department', 'Role', 'Name'],
          ['Direction', 'Director', submission.director || 'N/A'],
          ['Direction', 'Associate Director', submission.associateDirector || 'N/A'],
          ['Direction', 'Assistant Director 1', submission.assistantDirector1 || 'N/A'],
          ['Direction', 'Assistant Director 2', submission.assistantDirector2 || 'N/A'],
          [''],
          ['Production', 'Head of Production', submission.headOfProduction || 'N/A'],
          ['Production', 'Executive Producer', submission.executiveProducer || 'N/A'],
          ['Production', 'Line Producer', submission.lineProducer || 'N/A'],
          ['Production', 'Production Manager', submission.productionManager || 'N/A'],
          [''],
          ['Writing', 'Story By', submission.storyBy || 'N/A'],
          ['Writing', 'Screenplay By', submission.screenplayBy || 'N/A'],
          ['Writing', 'Dialogues By', submission.dialoguesBy || 'N/A'],
          [''],
          ['Camera', 'DOP', submission.dop || 'N/A'],
          ['Camera', 'Camera Operator', submission.cameraOperator || 'N/A'],
          ['Camera', 'Focus Puller', submission.focusPuller || 'N/A'],
          [''],
          ['Art & Design', 'Production Designer', submission.productionDesigner || 'N/A'],
          ['Art & Design', 'Art Director', submission.artDirector || 'N/A'],
          ['Art & Design', 'Costume Designer', submission.costumeDesigner || 'N/A'],
          ['Art & Design', 'Makeup Artist', submission.makeupArtist || 'N/A'],
          [''],
          ['Sound', 'Sound Designer', submission.soundDesigner || 'N/A'],
          ['Sound', 'Sound Recordist', submission.soundRecordist || 'N/A'],
          ['Sound', 'Music Composer', submission.musicComposer || 'N/A'],
          [''],
          ['Post-Production', 'Editor', submission.editor || 'N/A'],
          ['Post-Production', 'Colorist', submission.colorist || 'N/A'],
          ['Post-Production', 'VFX Supervisor', submission.vfxSupervisor || 'N/A'],
          ['Post-Production', 'DI Colorist', submission.diColorist || 'N/A'],
        ];
        break;

      case 'cast':
        sheetData = [
          [`CAST DETAILS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['#', 'Character Name', 'Actor Name', 'Role Type', 'Profile Link'],
        ];
        if (submission.castMembers && submission.castMembers.length > 0) {
          submission.castMembers.forEach((cast: any, idx: number) => {
            sheetData.push([
              idx + 1,
              cast.characterName || 'N/A',
              cast.actorName || 'N/A',
              cast.roleType || 'N/A',
              cast.profileLink || 'N/A',
            ]);
          });
        } else {
          sheetData.push(['No cast members added']);
        }
        break;

      case 'technical':
        sheetData = [
          [`TECHNICAL SPECIFICATIONS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['CAMERA'],
          ['Camera Model', submission.technicalSpecs?.cameraModel || 'N/A'],
          ['Camera Setup Type', submission.technicalSpecs?.cameraSetupType || 'N/A'],
          ['Resolution', submission.technicalSpecs?.resolution || 'N/A'],
          ['Frame Rate', submission.technicalSpecs?.frameRate || 'N/A'],
          ['Aspect Ratio', submission.technicalSpecs?.aspectRatio || 'N/A'],
          [''],
          ['LENSES'],
          ['Lens Types', (submission.technicalSpecs?.lensTypes || []).join(', ') || 'N/A'],
          [''],
          ['LIGHTING'],
          ['Lighting Equipment', (submission.technicalSpecs?.lightingEquipment || []).join(', ') || 'N/A'],
          [''],
          ['SOUND'],
          ['Sound Equipment', (submission.technicalSpecs?.soundEquipment || []).join(', ') || 'N/A'],
          [''],
          ['SPECIAL EQUIPMENT'],
          ['Stabilizers', (submission.technicalSpecs?.stabilizers || []).join(', ') || 'N/A'],
          ['Drones', (submission.technicalSpecs?.droneModels || []).join(', ') || 'N/A'],
          ['Special Rigs', (submission.technicalSpecs?.specialRigs || []).join(', ') || 'N/A'],
          [''],
          ['POST-PRODUCTION'],
          ['Editing Software', submission.technicalSpecs?.editingSoftware || 'N/A'],
          ['Color Grading', submission.technicalSpecs?.colorGrading || 'N/A'],
          ['VFX Software', submission.technicalSpecs?.vfxSoftware || 'N/A'],
          ['Final Delivery Format', submission.technicalSpecs?.deliveryFormat || 'N/A'],
        ];
        break;

      case 'cashflow':
        sheetData = [
          [`CASH FLOW - PAYMENT TERMS - ${projectName}`],
          [`Generated: ${date}`],
          [''],
          ['Total Budget', `‚Çπ${(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0).toLocaleString('en-IN')}`],
          [''],
          ['#', 'Milestone', 'Description', 'Percentage', 'Base Amount', 'GST (18%)', 'Total with GST', 'Expected Date', 'Status'],
        ];
        if (submission.cashFlowTranches && submission.cashFlowTranches.length > 0) {
          submission.cashFlowTranches.forEach((tranche: any, idx: number) => {
            const gst = Math.round((tranche.amount || 0) * 0.18);
            const total = (tranche.amount || 0) + gst;
            sheetData.push([
              idx + 1,
              tranche.name || tranche.milestone || `Tranche ${idx + 1}`,
              tranche.description || '',
              `${tranche.percentage || 0}%`,
              `‚Çπ${(tranche.amount || 0).toLocaleString('en-IN')}`,
              `‚Çπ${gst.toLocaleString('en-IN')}`,
              `‚Çπ${total.toLocaleString('en-IN')}`,
              tranche.expectedDate || 'N/A',
              tranche.status || 'Pending',
            ]);
          });
          const totalBase = submission.cashFlowTranches.reduce((sum: number, t: any) => sum + (t.amount || 0), 0);
          const totalGST = Math.round(totalBase * 0.18);
          sheetData.push(['']);
          sheetData.push(['', 'TOTAL', '', '100%', `‚Çπ${totalBase.toLocaleString('en-IN')}`, `‚Çπ${totalGST.toLocaleString('en-IN')}`, `‚Çπ${(totalBase + totalGST).toLocaleString('en-IN')}`, '', '']);
        }
        break;

      default:
        sheetData = [['No data available for this tab']];
    }

    const ws = XLSX.utils.aoa_to_sheet(sheetData);
    ws['!cols'] = Array(10).fill({ wch: 25 });
    XLSX.utils.book_append_sheet(wb, ws, tabName.charAt(0).toUpperCase() + tabName.slice(1));

    const fileName = `${projectName.replace(/[^a-zA-Z0-9]/g, '_')}_${tabName}_${new Date().toISOString().split('T')[0]}.xlsx`;
    XLSX.writeFile(wb, fileName);
  };

  // Export individual tab to PDF
  const exportTabToPDF = (submission: any, tabName: string) => {
    const projectName = submission.projectName || 'Project';
    const date = new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' });

    let content = '';

    const getTabContent = () => {
      switch (tabName) {
        case 'project':
          return `
            <h2>Project Information</h2>
            <div class="row"><span class="label">Project Name:</span><span class="value">${submission.projectName || 'N/A'}</span></div>
            <div class="row"><span class="label">Production Company:</span><span class="value">${submission.productionCompany || 'N/A'}</span></div>
            <div class="row"><span class="label">Culture:</span><span class="value">${submission.culture || 'N/A'}</span></div>
            <div class="row"><span class="label">Format:</span><span class="value">${submission.format || 'N/A'}</span></div>
            <div class="row"><span class="label">Genre:</span><span class="value">${submission.genre || 'N/A'}</span></div>
            <div class="row"><span class="label">Sub-Genre:</span><span class="value">${submission.subGenre || 'N/A'}</span></div>
            <div class="row"><span class="label">Content Rating:</span><span class="value">${submission.contentRating || 'N/A'}</span></div>
            <div class="row"><span class="label">Production Type:</span><span class="value">${submission.productionType || 'N/A'}</span></div>
            <div class="row"><span class="label">Language:</span><span class="value">${submission.language || 'N/A'}</span></div>
            <h2>Content Details</h2>
            <div class="row"><span class="label">Episodes:</span><span class="value">${submission.episodes || submission.episodesPerSeason || 'N/A'}</span></div>
            <div class="row"><span class="label">Total Duration:</span><span class="value">${submission.totalDuration || 'N/A'} mins</span></div>
            <div class="row"><span class="label">Episode Duration:</span><span class="value">${submission.episodeDuration || 'N/A'} mins</span></div>
            <h2>Logline</h2>
            <div class="row"><span class="value" style="text-align:left">${submission.logline || 'N/A'}</span></div>
            <h2>Synopsis</h2>
            <div class="row"><span class="value" style="text-align:left">${submission.synopsis || 'N/A'}</span></div>
            <h2>Point of Contact</h2>
            <div class="row"><span class="label">Production POC:</span><span class="value">${submission.productionPOC || 'N/A'}</span></div>
            <div class="row"><span class="label">Content POC:</span><span class="value">${submission.contentPOC || 'N/A'}</span></div>
          `;
        case 'creator':
          return `
            <h2>Personal Information</h2>
            <div class="row"><span class="label">Creator Name:</span><span class="value">${submission.creatorName || submission.creator || 'N/A'}</span></div>
            <div class="row"><span class="label">Father's Name:</span><span class="value">${submission.fatherName || 'N/A'}</span></div>
            <div class="row"><span class="label">Date of Birth:</span><span class="value">${submission.dateOfBirth || 'N/A'}</span></div>
            <div class="row"><span class="label">Phone:</span><span class="value">${submission.phone || 'N/A'}</span></div>
            <div class="row"><span class="label">Email:</span><span class="value">${submission.officialEmail || 'N/A'}</span></div>
            <h2>Address Details</h2>
            <div class="row"><span class="label">Permanent Address:</span><span class="value">${submission.permanentAddress || 'N/A'}</span></div>
            <div class="row"><span class="label">Current Address:</span><span class="value">${submission.currentAddress || 'N/A'}</span></div>
            <h2>Company Details</h2>
            <div class="row"><span class="label">Production Company:</span><span class="value">${submission.productionCompany || 'N/A'}</span></div>
            <div class="row"><span class="label">Authorized Signatory:</span><span class="value">${submission.authorizedSignatory || 'N/A'}</span></div>
            <div class="row"><span class="label">PAN Number:</span><span class="value">${submission.panNumber || 'N/A'}</span></div>
            <div class="row"><span class="label">GST Number:</span><span class="value">${submission.gstNumber || 'N/A'}</span></div>
            <h2>Bank Details</h2>
            <div class="row"><span class="label">Bank Name:</span><span class="value">${submission.bankName || 'N/A'}</span></div>
            <div class="row"><span class="label">Account Number:</span><span class="value">${submission.accountNumber || 'N/A'}</span></div>
            <div class="row"><span class="label">IFSC Code:</span><span class="value">${submission.ifscCode || 'N/A'}</span></div>
          `;
        case 'budget':
          let budgetRows = '';
          if (submission.budgetBreakdown && submission.budgetBreakdown.length > 0) {
            budgetRows = submission.budgetBreakdown.map((item: any) =>
              `<tr><td>${item.category || ''}</td><td>‚Çπ${(item.amount || 0).toLocaleString('en-IN')}</td><td>${item.percentage || ''}%</td></tr>`
            ).join('');
          }
          return `
            <h2>Budget Summary</h2>
            <div class="row highlight-box"><span class="label">Total Budget:</span><span class="value highlight">‚Çπ${(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0).toLocaleString('en-IN')}</span></div>
            <div class="row"><span class="label">Production Cost:</span><span class="value">‚Çπ${(submission.productionCost || 0).toLocaleString('en-IN')}</span></div>
            <div class="row"><span class="label">Creator Margin:</span><span class="value">‚Çπ${(submission.creatorMargin || 0).toLocaleString('en-IN')}</span></div>
            <div class="row"><span class="label">Insurance:</span><span class="value">‚Çπ${(submission.insurance || 0).toLocaleString('en-IN')}</span></div>
            <div class="row"><span class="label">Celebrity Fees:</span><span class="value">‚Çπ${(submission.celebrityFees || 0).toLocaleString('en-IN')}</span></div>
            <h2>Budget Breakdown</h2>
            <table><thead><tr><th>Category</th><th>Amount</th><th>%</th></tr></thead><tbody>${budgetRows}</tbody></table>
          `;
        case 'timeline':
          return `
            <h2>Development Phase</h2>
            <div class="row"><span class="label">Start Date:</span><span class="value">${submission.contentTimeline?.developmentStart || 'N/A'}</span></div>
            <div class="row"><span class="label">End Date:</span><span class="value">${submission.contentTimeline?.developmentEnd || 'N/A'}</span></div>
            <div class="row"><span class="label">Duration:</span><span class="value">${submission.contentTimeline?.developmentDuration || 'N/A'}</span></div>
            <h2>Pre-Production Phase</h2>
            <div class="row"><span class="label">Start Date:</span><span class="value">${submission.contentTimeline?.preProductionStart || 'N/A'}</span></div>
            <div class="row"><span class="label">End Date:</span><span class="value">${submission.contentTimeline?.preProductionEnd || 'N/A'}</span></div>
            <div class="row"><span class="label">Duration:</span><span class="value">${submission.contentTimeline?.preProductionDuration || 'N/A'}</span></div>
            <h2>Production / Shoot Phase</h2>
            <div class="row"><span class="label">Start Date:</span><span class="value">${submission.shootStartDate || submission.contentTimeline?.shootStart || 'N/A'}</span></div>
            <div class="row"><span class="label">End Date:</span><span class="value">${submission.shootEndDate || submission.contentTimeline?.shootEnd || 'N/A'}</span></div>
            <div class="row"><span class="label">Shoot Days:</span><span class="value">${submission.shootDays || submission.contentTimeline?.shootDays || 'N/A'}</span></div>
            <h2>Post-Production Phase</h2>
            <div class="row"><span class="label">Start Date:</span><span class="value">${submission.contentTimeline?.postProductionStart || 'N/A'}</span></div>
            <div class="row"><span class="label">End Date:</span><span class="value">${submission.contentTimeline?.postProductionEnd || 'N/A'}</span></div>
            <div class="row"><span class="label">Duration:</span><span class="value">${submission.contentTimeline?.postProductionDuration || 'N/A'}</span></div>
            <h2>Final Delivery</h2>
            <div class="row"><span class="label">Delivery Date:</span><span class="value">${submission.contentTimeline?.finalDeliveryDate || 'N/A'}</span></div>
          `;
        case 'crew':
          return `
            <h2>Direction Department</h2>
            <div class="row"><span class="label">Director:</span><span class="value">${submission.director || 'N/A'}</span></div>
            <div class="row"><span class="label">Associate Director:</span><span class="value">${submission.associateDirector || 'N/A'}</span></div>
            <div class="row"><span class="label">Assistant Director:</span><span class="value">${submission.assistantDirector1 || 'N/A'}</span></div>
            <h2>Production Department</h2>
            <div class="row"><span class="label">Head of Production:</span><span class="value">${submission.headOfProduction || 'N/A'}</span></div>
            <div class="row"><span class="label">Executive Producer:</span><span class="value">${submission.executiveProducer || 'N/A'}</span></div>
            <div class="row"><span class="label">Line Producer:</span><span class="value">${submission.lineProducer || 'N/A'}</span></div>
            <h2>Writing Department</h2>
            <div class="row"><span class="label">Story By:</span><span class="value">${submission.storyBy || 'N/A'}</span></div>
            <div class="row"><span class="label">Screenplay By:</span><span class="value">${submission.screenplayBy || 'N/A'}</span></div>
            <div class="row"><span class="label">Dialogues By:</span><span class="value">${submission.dialoguesBy || 'N/A'}</span></div>
            <h2>Camera Department</h2>
            <div class="row"><span class="label">DOP:</span><span class="value">${submission.dop || 'N/A'}</span></div>
            <div class="row"><span class="label">Camera Operator:</span><span class="value">${submission.cameraOperator || 'N/A'}</span></div>
            <h2>Art & Design</h2>
            <div class="row"><span class="label">Production Designer:</span><span class="value">${submission.productionDesigner || 'N/A'}</span></div>
            <div class="row"><span class="label">Costume Designer:</span><span class="value">${submission.costumeDesigner || 'N/A'}</span></div>
            <h2>Sound & Music</h2>
            <div class="row"><span class="label">Sound Designer:</span><span class="value">${submission.soundDesigner || 'N/A'}</span></div>
            <div class="row"><span class="label">Music Composer:</span><span class="value">${submission.musicComposer || 'N/A'}</span></div>
            <h2>Post-Production</h2>
            <div class="row"><span class="label">Editor:</span><span class="value">${submission.editor || 'N/A'}</span></div>
            <div class="row"><span class="label">Colorist:</span><span class="value">${submission.colorist || 'N/A'}</span></div>
            <div class="row"><span class="label">VFX Supervisor:</span><span class="value">${submission.vfxSupervisor || 'N/A'}</span></div>
          `;
        case 'cast':
          let castRows = '';
          if (submission.castMembers && submission.castMembers.length > 0) {
            castRows = submission.castMembers.map((cast: any, idx: number) =>
              `<tr><td>${idx + 1}</td><td>${cast.characterName || 'N/A'}</td><td>${cast.actorName || 'N/A'}</td><td>${cast.roleType || 'N/A'}</td></tr>`
            ).join('');
          } else {
            castRows = '<tr><td colspan="4">No cast members added</td></tr>';
          }
          return `
            <h2>Cast Members</h2>
            <table><thead><tr><th>#</th><th>Character</th><th>Actor</th><th>Role Type</th></tr></thead><tbody>${castRows}</tbody></table>
          `;
        case 'technical':
          return `
            <h2>Camera Specifications</h2>
            <div class="row"><span class="label">Camera Model:</span><span class="value">${submission.technicalSpecs?.cameraModel || 'N/A'}</span></div>
            <div class="row"><span class="label">Setup Type:</span><span class="value">${submission.technicalSpecs?.cameraSetupType || 'N/A'}</span></div>
            <div class="row"><span class="label">Resolution:</span><span class="value">${submission.technicalSpecs?.resolution || 'N/A'}</span></div>
            <div class="row"><span class="label">Frame Rate:</span><span class="value">${submission.technicalSpecs?.frameRate || 'N/A'}</span></div>
            <div class="row"><span class="label">Aspect Ratio:</span><span class="value">${submission.technicalSpecs?.aspectRatio || 'N/A'}</span></div>
            <h2>Lenses</h2>
            <div class="row"><span class="label">Lens Types:</span><span class="value">${(submission.technicalSpecs?.lensTypes || []).join(', ') || 'N/A'}</span></div>
            <h2>Lighting</h2>
            <div class="row"><span class="label">Equipment:</span><span class="value">${(submission.technicalSpecs?.lightingEquipment || []).join(', ') || 'N/A'}</span></div>
            <h2>Sound</h2>
            <div class="row"><span class="label">Equipment:</span><span class="value">${(submission.technicalSpecs?.soundEquipment || []).join(', ') || 'N/A'}</span></div>
            <h2>Special Equipment</h2>
            <div class="row"><span class="label">Stabilizers:</span><span class="value">${(submission.technicalSpecs?.stabilizers || []).join(', ') || 'N/A'}</span></div>
            <div class="row"><span class="label">Drones:</span><span class="value">${(submission.technicalSpecs?.droneModels || []).join(', ') || 'N/A'}</span></div>
            <h2>Post-Production</h2>
            <div class="row"><span class="label">Editing Software:</span><span class="value">${submission.technicalSpecs?.editingSoftware || 'N/A'}</span></div>
            <div class="row"><span class="label">Color Grading:</span><span class="value">${submission.technicalSpecs?.colorGrading || 'N/A'}</span></div>
            <div class="row"><span class="label">Delivery Format:</span><span class="value">${submission.technicalSpecs?.deliveryFormat || 'N/A'}</span></div>
          `;
        case 'cashflow':
          let cashflowRows = '';
          if (submission.cashFlowTranches && submission.cashFlowTranches.length > 0) {
            cashflowRows = submission.cashFlowTranches.map((tranche: any, idx: number) => {
              const gst = Math.round((tranche.amount || 0) * 0.18);
              const total = (tranche.amount || 0) + gst;
              return `<tr>
                <td>${idx + 1}</td>
                <td>${tranche.name || tranche.milestone || `Tranche ${idx + 1}`}</td>
                <td>${tranche.percentage || 0}%</td>
                <td>‚Çπ${(tranche.amount || 0).toLocaleString('en-IN')}</td>
                <td>‚Çπ${gst.toLocaleString('en-IN')}</td>
                <td>‚Çπ${total.toLocaleString('en-IN')}</td>
              </tr>
              <tr class="description-row"><td colspan="6"><strong>Description:</strong> ${tranche.description || 'N/A'}</td></tr>`;
            }).join('');
          }
          return `
            <h2>Payment Schedule</h2>
            <div class="row highlight-box"><span class="label">Total Budget:</span><span class="value highlight">‚Çπ${(submission.totalBudget || parseFloat(submission.estimatedBudget) || 0).toLocaleString('en-IN')}</span></div>
            <table>
              <thead><tr><th>#</th><th>Milestone</th><th>%</th><th>Base</th><th>GST</th><th>Total</th></tr></thead>
              <tbody>${cashflowRows}</tbody>
            </table>
          `;
        default:
          return '<p>No data available</p>';
      }
    };

    const tabTitle = tabName.charAt(0).toUpperCase() + tabName.slice(1);
    const printContent = `
      <!DOCTYPE html>
      <html>
      <head>
        <title>${tabTitle} - ${projectName}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; }
          h1 { text-align: center; border-bottom: 3px solid #e53e3e; padding-bottom: 10px; color: #333; }
          h2 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 10px 15px; margin-top: 25px; border-radius: 5px; font-size: 14px; }
          .subtitle { text-align: center; color: #666; margin-bottom: 30px; }
          .row { display: flex; justify-content: space-between; padding: 10px 15px; border-bottom: 1px solid #eee; }
          .row:hover { background: #f9f9f9; }
          .label { font-weight: bold; color: #555; }
          .value { text-align: right; color: #333; }
          .highlight { font-size: 20px; color: #16a34a; font-weight: bold; }
          .highlight-box { background: #f0fdf4; border: 2px solid #16a34a; border-radius: 8px; margin: 10px 0; }
          table { width: 100%; border-collapse: collapse; margin: 15px 0; }
          th { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 12px; text-align: left; font-size: 12px; }
          td { border: 1px solid #ddd; padding: 10px; font-size: 12px; }
          tr:nth-child(even) { background: #f9f9f9; }
          .description-row { background: #fffbeb !important; }
          .description-row td { font-size: 11px; color: #666; border-top: none; }
          .footer { margin-top: 50px; text-align: center; font-size: 11px; color: #888; border-top: 1px solid #eee; padding-top: 20px; }
          @media print {
            body { padding: 20px; }
            h2 { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            th { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
          }
        </style>
      </head>
      <body>
        <h1>STAGE OTT - ${tabTitle.toUpperCase()} DETAILS</h1>
        <p class="subtitle">Project: ${projectName} | Generated: ${date}</p>
        ${getTabContent()}
        <div class="footer">
          <p>Generated by STAGE OTT Creator Portal</p>
          <p>¬© ${new Date().getFullYear()} STAGE OTT Platform. All rights reserved.</p>
        </div>
      </body>
      </html>
    `;

    const printWindow = window.open('', '_blank');
    if (printWindow) {
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.onload = () => {
        printWindow.print();
      };
    }
  };

  const handleStartEditPOC = (submissionId: number, field: 'productionPOC' | 'contentPOC', currentValue: string) => {
    setEditingPOC({ submissionId, field });
    setTempPOCValue(currentValue || '');
  };

  const handleSavePOC = () => {
    if (!editingPOC) return;

    const submission = submissions.find(s => s.id === editingPOC.submissionId);
    const oldValue = submission?.[editingPOC.field] || '';
    const pocLabel = editingPOC.field === 'productionPOC' ? 'Production POC' : 'Content POC';

    // Update submission POC
    setSubmissions(prevSubmissions =>
      prevSubmissions.map(s =>
        s.id === editingPOC.submissionId
          ? { ...s, [editingPOC.field]: tempPOCValue }
          : s
      )
    );

    // Update selectedSubmission if it's the one being changed
    if (selectedSubmission && selectedSubmission.id === editingPOC.submissionId) {
      setSelectedSubmission({ ...selectedSubmission, [editingPOC.field]: tempPOCValue });
    }

    // Add Activity Log for POC assignment
    if (tempPOCValue && tempPOCValue !== oldValue) {
      addActivityLog(
        editingPOC.submissionId,
        oldValue ? `${pocLabel} Changed` : `${pocLabel} Assigned`,
        oldValue
          ? `${pocLabel} changed from "${oldValue}" to "${tempPOCValue}"`
          : `${tempPOCValue} assigned as ${pocLabel}`,
        'assign'
      );
    }

    setEditingPOC(null);
    setTempPOCValue('');
  };

  const handleCancelEditPOC = () => {
    setEditingPOC(null);
    setTempPOCValue('');
  };

  // Only approved and in-production projects for budget calculation
  const approvedProjects = submissions.filter(s =>
    s.status === 'approved' || s.status === 'in-production'
  );

  const stats = {
    total: submissions.length,
    pending: submissions.filter(s => s.status === 'pending').length,
    underReview: submissions.filter(s => s.status === 'under-review').length,
    approved: submissions.filter(s => s.status === 'approved').length,
    revisionRequested: submissions.filter(s => s.status === 'revision-requested').length,
    onHold: submissions.filter(s => s.status === 'on-hold').length,
    scrapped: submissions.filter(s => s.status === 'scrapped').length,
    inProduction: submissions.filter(s => s.status === 'in-production').length,

    // Total budget only from approved/in-production projects
    totalBudget: approvedProjects.reduce((sum, s) => sum + s.totalBudget, 0),

    // Format breakdown
    byFormat: submissions.reduce((acc: any, s) => {
      acc[s.format] = (acc[s.format] || 0) + 1;
      return acc;
    }, {}),

    // Culture breakdown with project count
    byCulture: submissions.reduce((acc: any, s) => {
      acc[s.culture] = (acc[s.culture] || 0) + 1;
      return acc;
    }, {}),

    // Budget by Culture - only approved/in-production
    budgetByCulture: approvedProjects.reduce((acc: any, s) => {
      acc[s.culture] = (acc[s.culture] || 0) + s.totalBudget;
      return acc;
    }, {}),

    // Culture with Format subsections
    cultureWithFormats: submissions.reduce((acc: any, s) => {
      if (!acc[s.culture]) {
        acc[s.culture] = {};
      }
      acc[s.culture][s.format] = (acc[s.culture][s.format] || 0) + 1;
      return acc;
    }, {}),
  };

  const filteredSubmissions = submissions
    .filter(s => {
      const statusMatch = filterStatus === 'all' || s.status === filterStatus;
      const formatMatch = filterFormat === 'all' || s.format === filterFormat;
      const cultureMatch = filterCulture === 'all' || s.culture?.toLowerCase() === filterCulture.toLowerCase();

      // Search filter
      const searchLower = searchQuery.toLowerCase();
      const searchMatch = searchQuery === '' ||
        s.projectName?.toLowerCase().includes(searchLower) ||
        s.creator?.toLowerCase().includes(searchLower) ||
        s.creatorName?.toLowerCase().includes(searchLower) ||
        s.director?.toLowerCase().includes(searchLower) ||
        s.culture?.toLowerCase().includes(searchLower) ||
        s.format?.toLowerCase().includes(searchLower) ||
        s.genre?.toLowerCase().includes(searchLower) ||
        s.officialEmail?.toLowerCase().includes(searchLower);

      // Date range filter
      let dateMatch = true;
      if (dateRangeFrom) {
        const fromDate = new Date(dateRangeFrom);
        const submitDate = new Date(s.submittedDate || s.submitted_at);
        dateMatch = dateMatch && submitDate >= fromDate;
      }
      if (dateRangeTo) {
        const toDate = new Date(dateRangeTo);
        toDate.setHours(23, 59, 59); // Include the entire day
        const submitDate = new Date(s.submittedDate || s.submitted_at);
        dateMatch = dateMatch && submitDate <= toDate;
      }

      // Budget range filter
      let budgetMatch = true;
      const projectBudget = s.totalBudget || s.estimatedBudget || 0;
      if (budgetMin) {
        budgetMatch = budgetMatch && projectBudget >= parseInt(budgetMin);
      }
      if (budgetMax) {
        budgetMatch = budgetMatch && projectBudget <= parseInt(budgetMax);
      }

      return statusMatch && formatMatch && cultureMatch && searchMatch && dateMatch && budgetMatch;
    })
    .sort((a, b) => {
      let comparison = 0;

      switch (sortBy) {
        case 'date':
          comparison = new Date(a.submittedDate).getTime() - new Date(b.submittedDate).getTime();
          break;
        case 'name':
          comparison = (a.projectName || '').localeCompare(b.projectName || '');
          break;
        case 'budget':
          comparison = (a.totalBudget || 0) - (b.totalBudget || 0);
          break;
        case 'status':
          comparison = (a.status || '').localeCompare(b.status || '');
          break;
        default:
          comparison = new Date(a.submittedDate).getTime() - new Date(b.submittedDate).getTime();
      }

      return sortOrder === 'desc' ? -comparison : comparison;
    });

  // Show loading while checking auth
  if (authLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50">
        <div className="text-center">
          <div className="w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
          <p className="text-gray-600">Loading...</p>
        </div>
      </div>
    );
  }

  // If not authorized, show nothing (redirect will happen)
  if (!isAuthorized) {
    return null;
  }

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 via-white to-blue-50 text-gray-800">
      {/* Subtle Background Decoration */}
      <div className="absolute inset-0 overflow-hidden pointer-events-none">
        <div className="absolute -top-1/2 -left-1/2 w-full h-full bg-gradient-to-br from-blue-100/30 to-transparent rounded-full blur-3xl"></div>
        <div className="absolute -bottom-1/2 -right-1/2 w-full h-full bg-gradient-to-tl from-indigo-100/30 to-transparent rounded-full blur-3xl"></div>
      </div>

      <div className="relative z-10">
        {/* Header - Mobile Responsive */}
        <header className="border-b border-gray-200 bg-white shadow-sm sticky top-0 z-50">
          <div className="max-w-7xl mx-auto px-3 md:px-6 py-3 md:py-4">
            {/* Top Row - Logo & Actions */}
            <div className="flex items-center justify-between mb-3 md:mb-0">
              <div className="flex items-center gap-2 md:gap-8">
                <Image
                  src="/images/stage-logo-official.png"
                  alt="STAGE OTT"
                  width={150}
                  height={45}
                  className="h-8 md:h-12 w-auto"
                />
              </div>
              {/* Right side actions */}
              <div className="flex items-center gap-3">
                <button
                  className="relative p-2 bg-gray-100 rounded-lg hover:bg-gray-200 transition-all"
                  onClick={() => setShowNotificationsPanel(!showNotificationsPanel)}
                  title="Notifications"
                >
                  <svg className="w-5 h-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                  </svg>
                  {newSubmissionsCount > 0 && (
                    <span className="absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-[10px] font-bold text-white">
                      {newSubmissionsCount}
                    </span>
                  )}
                </button>
                <Link href="/" className="px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800 transition-colors">
                  Exit
                </Link>
              </div>
            </div>

            {/* Navigation Tabs - Clean Design */}
            <div className="border-b border-gray-200">
              <nav className="flex items-center gap-1 overflow-x-auto scrollbar-hide px-2 -mb-px">
                {[
                  { id: 'overview', label: 'Dashboard', icon: 'üìä' },
                  { id: 'submissions', label: 'Pipeline', icon: 'üéØ', badge: newSubmissionsCount },
                  { id: 'projects', label: 'Production', icon: 'üé¨' },
                  { id: 'invoices', label: 'Invoices', icon: 'üí∞' },
                  { id: 'reports', label: 'Reports', icon: 'üìà' },
                  { id: 'invites', label: 'Invites', icon: 'üì®' },
                  { id: 'library', label: 'Talent', icon: 'üë•' },
                  { id: 'documents', label: 'Docs', icon: 'üìÅ' },
                ].map((tab) => (
                  <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id as any)}
                    className={`relative flex items-center gap-2 px-4 py-3 text-sm font-medium whitespace-nowrap border-b-2 transition-all ${
                      activeTab === tab.id
                        ? 'border-red-500 text-red-600 bg-red-50/50'
                        : 'border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300'
                    }`}
                  >
                    <span>{tab.icon}</span>
                    <span>{tab.label}</span>
                    {tab.badge && tab.badge > 0 && (
                      <span className="ml-1 px-1.5 py-0.5 bg-red-500 text-white text-[10px] font-bold rounded-full">
                        {tab.badge}
                      </span>
                    )}
                  </button>
                ))}
              </nav>
            </div>
          </div>
        </header>

        <div className="max-w-7xl mx-auto px-3 md:px-6 py-4 md:py-8">
          {/* Filmmaker Quote */}
          <div className="mb-6 bg-gradient-to-r from-amber-50 via-orange-50 to-red-50 border-2 border-amber-200 rounded-2xl p-6 shadow-lg">
            <div className="flex items-start gap-4">
              <span className="text-4xl">üé¨</span>
              <div className="flex-1">
                <p className="text-lg md:text-xl font-bold text-amber-900 italic mb-2">
                  "‡§∏‡§ø‡§®‡•á‡§Æ‡§æ ‡§∏‡§Æ‡§æ‡§ú ‡§ï‡§æ ‡§¶‡§∞‡•ç‡§™‡§£ ‡§®‡§π‡•Ä‡§Ç, ‡§¨‡§≤‡•ç‡§ï‡§ø ‡§µ‡§π ‡§ñ‡§ø‡§°‡§º‡§ï‡•Ä ‡§π‡•à ‡§ú‡§ø‡§∏‡§∏‡•á ‡§π‡§Æ ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§¶‡•á‡§ñ‡§§‡•á ‡§π‡•à‡§Ç‡•§"
                </p>
                <p className="text-sm font-bold text-amber-800">‚Äî ‡§∏‡§§‡•ç‡§Ø‡§ú‡•Ä‡§§ ‡§∞‡•á (Satyajit Ray)</p>
              </div>
            </div>
          </div>

          {/* OVERVIEW TAB - Original Dashboard */}
          {activeTab === 'overview' && (
            <>
            {/* Clean Light Theme Container */}
            <div className="min-h-screen bg-gray-50 rounded-2xl -mx-6 -mt-2 px-6 py-6">

            {/* Header Section */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
              <div className="flex items-center justify-between">
                <div>
                  <div className="flex items-center gap-3 mb-2">
                    <span className="px-3 py-1 bg-blue-600 text-white text-xs font-bold rounded-lg">STAGE</span>
                    <span className="text-gray-500 text-sm font-medium">Admin Dashboard</span>
                  </div>
                  <h1 className="text-2xl font-bold text-gray-800">Production Team</h1>
                  <p className="text-gray-500 text-sm">Content Management & Review Platform</p>
                </div>
              </div>
            </div>

            {/* Stats Cards */}
            <div className="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
              <button
                onClick={() => {
                  setFilterStatus('all');
                  setFilterCulture('all');
                  setFilterFormat('all');
                  setTimeout(() => document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth' }), 100);
                }}
                className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md hover:border-blue-300 transition-all text-left"
              >
                <div className="text-3xl font-bold text-gray-800">{stats.total}</div>
                <div className="text-gray-500 text-sm font-medium">Total Projects</div>
              </button>
              <button
                onClick={() => {
                  setFilterStatus('approved');
                  setFilterCulture('all');
                  setFilterFormat('all');
                  setTimeout(() => document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth' }), 100);
                }}
                className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md hover:border-green-300 transition-all text-left"
              >
                <div className="text-3xl font-bold text-green-600">{stats.approved}</div>
                <div className="text-gray-500 text-sm font-medium">Approved</div>
              </button>
              <button
                onClick={() => {
                  setFilterStatus('pending');
                  setFilterCulture('all');
                  setFilterFormat('all');
                  setTimeout(() => document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth' }), 100);
                }}
                className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md hover:border-amber-300 transition-all text-left"
              >
                <div className="text-3xl font-bold text-amber-600">{stats.pending}</div>
                <div className="text-gray-500 text-sm font-medium">Pending</div>
              </button>
              <button
                onClick={() => {
                  setFilterStatus('in-production');
                  setFilterCulture('all');
                  setFilterFormat('all');
                  setTimeout(() => document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth' }), 100);
                }}
                className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md hover:border-blue-300 transition-all text-left"
              >
                <div className="text-3xl font-bold text-blue-600">{stats.inProduction}</div>
                <div className="text-gray-500 text-sm font-medium">In Production</div>
              </button>
              <button
                onClick={() => setShowBudgetBreakdown(!showBudgetBreakdown)}
                className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md hover:border-emerald-300 transition-all text-left"
              >
                <div className="text-2xl font-bold text-emerald-600">{formatBudgetInWords(stats.totalBudget)}</div>
                <div className="text-gray-500 text-sm font-medium flex items-center gap-1">
                  Total Value <span className="text-xs">{showBudgetBreakdown ? '‚ñ≤' : '‚ñº'}</span>
                </div>
              </button>
            </div>

            {/* Invite Tracker Panel */}
            {showInviteTracker && (
              <div className="mb-6">
                <InviteTracker />
              </div>
            )}

            {/* Budget Breakdown Panel - Expandable */}
            {showBudgetBreakdown && (
              <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-5 mb-6">
                <h3 className="text-lg font-bold text-gray-800 mb-4">Budget Breakdown</h3>

                    {/* Culture-wise Breakdown */}
                    <div className="mb-5">
                      <h4 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3">By Culture</h4>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                        {['Haryanvi', 'Rajasthani', 'Bhojpuri', 'Gujarati'].map((culture) => {
                          const cultureProjects = approvedProjects.filter(p => p.culture?.toLowerCase() === culture.toLowerCase());
                          const cultureBudget = cultureProjects.reduce((sum, p) => sum + (p.totalBudget || 0), 0);
                          return (
                            <button
                              key={culture}
                              onClick={() => {
                                setFilterCulture(culture);
                                setFilterStatus('approved');
                                setFilterFormat('all');
                                setShowBudgetBreakdown(false);
                                setTimeout(() => document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth' }), 100);
                              }}
                              className="p-3 rounded-lg bg-gray-50 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all text-left"
                            >
                              <div className="text-gray-800 font-semibold">{culture}</div>
                              <div className="text-gray-500 text-sm">{cultureProjects.length} Projects</div>
                              <div className="text-blue-600 font-bold mt-1">{formatBudgetInWords(cultureBudget)}</div>
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    {/* Format-wise Breakdown */}
                    <div className="mb-5">
                      <h4 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3">By Format</h4>
                      <div className="grid grid-cols-2 md:grid-cols-5 gap-3">
                        {[
                          { name: 'Feature Film', icon: 'üé¨' },
                          { name: 'Mini Film', icon: 'üéûÔ∏è' },
                          { name: 'Long Series', icon: 'üì∫' },
                          { name: 'Limited Series', icon: 'üé≠' },
                          { name: 'Microdrama', icon: '‚ö°' },
                        ].map((format) => {
                          const formatProjects = approvedProjects.filter(p => p.format === format.name);
                          const formatBudget = formatProjects.reduce((sum, p) => sum + (p.totalBudget || 0), 0);
                          return (
                            <button
                              key={format.name}
                              onClick={() => {
                                setFilterFormat(format.name);
                                setFilterStatus('approved');
                                setFilterCulture('all');
                                setShowBudgetBreakdown(false);
                                setTimeout(() => document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth' }), 100);
                              }}
                              className="p-3 rounded-lg bg-gray-50 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all text-left"
                            >
                              <div className="text-xl mb-1">{format.icon}</div>
                              <div className="text-gray-800 font-semibold text-sm">{format.name}</div>
                              <div className="text-gray-500 text-xs">{formatProjects.length} Projects</div>
                              <div className="text-blue-600 font-bold text-sm mt-1">{formatBudgetInWords(formatBudget)}</div>
                            </button>
                          );
                        })}
                      </div>
                    </div>

                    {/* Approved Projects List */}
                    <div>
                      <h4 className="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-3">Approved Projects ({approvedProjects.length})</h4>
                      <div className="max-h-60 overflow-y-auto space-y-2">
                        {approvedProjects.map((project) => (
                          <div
                            key={project.id}
                            onClick={() => {
                              markAsViewed(project.id);
                              setSelectedSubmission(project);
                              setShowBudgetBreakdown(false);
                            }}
                            className="flex items-center justify-between p-3 rounded-lg bg-gray-50 border border-gray-200 hover:border-blue-300 cursor-pointer transition-all"
                          >
                            <div className="flex items-center gap-3">
                              <div className="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center text-lg">
                                {project.format === 'Feature Film' ? 'üé¨' :
                                 project.format === 'Mini Film' ? 'üéûÔ∏è' :
                                 project.format === 'Long Series' ? 'üì∫' :
                                 project.format === 'Limited Series' ? 'üé≠' : '‚ö°'}
                              </div>
                              <div>
                                <div className="text-gray-800 font-semibold text-sm">{project.projectName}</div>
                                <div className="text-gray-500 text-xs">{project.culture} ‚Ä¢ {project.format} ‚Ä¢ {project.creator}</div>
                              </div>
                            </div>
                            <div className="text-green-600 font-bold">{formatBudgetInWords(project.totalBudget)}</div>
                          </div>
                        ))}
                        {approvedProjects.length === 0 && (
                          <div className="text-center py-8 text-gray-500">No approved projects yet</div>
                        )}
                      </div>
                    </div>
                  </div>
                )}

            {/* Status Quick Access Bar */}
            <div className="flex items-center gap-2 mb-6 overflow-x-auto pb-2">
              {[
                { status: 'all', label: 'All', count: stats.total },
                { status: 'pending', label: 'Pending', count: stats.pending },
                { status: 'under-review', label: 'Under Review', count: stats.underReview },
                { status: 'approved', label: 'Approved', count: stats.approved },
                { status: 'agreement-signed', label: 'Agreement', count: submissions.filter(s => s.status === 'agreement-signed').length },
                { status: 'in-production', label: 'In Production', count: stats.inProduction },
                { status: 'revision-requested', label: 'Revision', count: stats.revisionRequested },
                { status: 'on-hold', label: 'On Hold', count: stats.onHold },
                { status: 'scrapped', label: 'Scrapped', count: stats.scrapped },
              ].map((item) => (
                <button
                  key={item.status}
                  onClick={() => {
                    setFilterStatus(item.status);
                    setFilterFormat('all');
                    setFilterCulture('all');
                    setTimeout(() => {
                      document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }, 100);
                  }}
                  className={`flex-shrink-0 px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                    filterStatus === item.status
                      ? 'bg-blue-600 text-white shadow-sm'
                      : 'bg-white text-gray-700 border border-gray-200 hover:border-blue-300'
                  }`}
                >
                  {item.label} <span className="ml-1 text-xs opacity-70">{item.count}</span>
                </button>
              ))}
            </div>

            {/* Search & Sort Bar */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-6">
              <div className="flex flex-col md:flex-row gap-4">
                {/* Search Input */}
                <div className="flex-1 relative">
                  <span className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">üîç</span>
                  <input
                    type="text"
                    placeholder="Search projects by name, creator, director, culture, format..."
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    className="w-full pl-12 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-800 placeholder-gray-400 focus:outline-none focus:border-blue-400 focus:ring-2 focus:ring-blue-100 transition-all"
                  />
                  {searchQuery && (
                    <button
                      onClick={() => setSearchQuery('')}
                      className="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600"
                    >
                      ‚úï
                    </button>
                  )}
                </div>

                {/* Sort Options */}
                <div className="flex items-center gap-2">
                  <span className="text-gray-500 text-sm hidden md:inline">Sort:</span>
                  <select
                    value={sortBy}
                    onChange={(e) => setSortBy(e.target.value as any)}
                    className="px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700 text-sm focus:outline-none focus:border-blue-400 cursor-pointer"
                  >
                    <option value="date">Date</option>
                    <option value="name">Name</option>
                    <option value="budget">Budget</option>
                    <option value="status">Status</option>
                  </select>
                  <button
                    onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}
                    className="px-3 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-100 transition-all"
                    title={sortOrder === 'asc' ? 'Ascending' : 'Descending'}
                  >
                    {sortOrder === 'asc' ? '‚Üë' : '‚Üì'}
                  </button>
                  <button
                    onClick={() => setShowAdvancedFilters(!showAdvancedFilters)}
                    className={`px-3 py-2.5 rounded-lg font-medium text-sm transition-all ${
                      showAdvancedFilters
                        ? 'bg-blue-600 text-white'
                        : 'bg-gray-50 border border-gray-200 text-gray-700 hover:bg-gray-100'
                    }`}
                  >
                    Filters
                  </button>
                  <button
                    onClick={() => setShowAnalytics(!showAnalytics)}
                    className={`px-3 py-2.5 rounded-lg font-medium text-sm transition-all ${
                      showAnalytics
                        ? 'bg-blue-600 text-white'
                        : 'bg-gray-50 border border-gray-200 text-gray-700 hover:bg-gray-100'
                    }`}
                  >
                  üìä Analytics
                </button>
                </div>
              </div>
            </div>

            {/* Advanced Filters Panel */}
            {showAdvancedFilters && (
              <div className="mb-6 bg-white rounded-2xl border border-gray-200 shadow-sm p-5">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2">
                    <span className="text-blue-500">üéõÔ∏è</span> Advanced Filters
                  </h3>
                  <button
                    onClick={() => {
                      setDateRangeFrom('');
                      setDateRangeTo('');
                      setBudgetMin('');
                      setBudgetMax('');
                      setFilterStatus('all');
                      setFilterFormat('all');
                      setFilterCulture('all');
                    }}
                    className="px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-600 text-sm font-medium rounded-lg transition-all"
                  >
                    Clear All
                  </button>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  {/* Date Range From */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üìÖ From Date</label>
                    <input
                      type="date"
                      value={dateRangeFrom}
                      onChange={(e) => setDateRangeFrom(e.target.value)}
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100"
                    />
                  </div>

                  {/* Date Range To */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üìÖ To Date</label>
                    <input
                      type="date"
                      value={dateRangeTo}
                      onChange={(e) => setDateRangeTo(e.target.value)}
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100"
                    />
                  </div>

                  {/* Budget Min */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üí∞ Min Budget (‚Çπ)</label>
                    <input
                      type="number"
                      value={budgetMin}
                      onChange={(e) => setBudgetMin(e.target.value)}
                      placeholder="e.g., 1000000"
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 placeholder-gray-400"
                    />
                  </div>

                  {/* Budget Max */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üí∞ Max Budget (‚Çπ)</label>
                    <input
                      type="number"
                      value={budgetMax}
                      onChange={(e) => setBudgetMax(e.target.value)}
                      placeholder="e.g., 50000000"
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 placeholder-gray-400"
                    />
                  </div>

                  {/* Culture Filter */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üåç Culture</label>
                    <select
                      value={filterCulture}
                      onChange={(e) => setFilterCulture(e.target.value)}
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 appearance-none cursor-pointer"
                    >
                      <option value="all">All Cultures</option>
                      <option value="haryanvi">Haryanvi</option>
                      <option value="rajasthani">Rajasthani</option>
                      <option value="bhojpuri">Bhojpuri</option>
                      <option value="gujarati">Gujarati</option>
                    </select>
                  </div>

                  {/* Format Filter */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üé¨ Format</label>
                    <select
                      value={filterFormat}
                      onChange={(e) => setFilterFormat(e.target.value)}
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 appearance-none cursor-pointer"
                    >
                      <option value="all">All Formats</option>
                      <option value="Feature Film">Feature Film</option>
                      <option value="Mini Film">Mini Film</option>
                      <option value="Long Series">Long Series</option>
                      <option value="Limited Series">Limited Series</option>
                      <option value="Microdrama">Microdrama</option>
                    </select>
                  </div>

                  {/* Status Filter */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">üìã Status</label>
                    <select
                      value={filterStatus}
                      onChange={(e) => setFilterStatus(e.target.value)}
                      className="w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-gray-700 text-sm focus:outline-none focus:border-blue-400 appearance-none cursor-pointer"
                    >
                      <option value="all">All Statuses</option>
                      <option value="pending">Pending</option>
                      <option value="under-review">Under Review</option>
                      <option value="approved">Approved</option>
                      <option value="agreement-signed">Agreement Signed</option>
                      <option value="in-production">In Production</option>
                      <option value="revision-requested">Revision Requested</option>
                      <option value="on-hold">On Hold</option>
                      <option value="scrapped">Scrapped</option>
                    </select>
                  </div>

                  {/* Quick Budget Presets */}
                  <div>
                    <label className="block text-sm font-medium text-gray-600 mb-2">‚ö° Quick Budget</label>
                    <div className="flex gap-2 flex-wrap">
                      <button
                        onClick={() => { setBudgetMin(''); setBudgetMax('5000000'); }}
                        className="px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-600 text-xs font-medium rounded-lg transition-all border border-blue-200"
                      >
                        Under 50L
                      </button>
                      <button
                        onClick={() => { setBudgetMin('5000000'); setBudgetMax('20000000'); }}
                        className="px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-600 text-xs font-medium rounded-lg transition-all border border-blue-200"
                      >
                        50L - 2Cr
                      </button>
                      <button
                        onClick={() => { setBudgetMin('20000000'); setBudgetMax(''); }}
                        className="px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-600 text-xs font-medium rounded-lg transition-all border border-blue-200"
                      >
                        Above 2Cr
                      </button>
                    </div>
                  </div>
                </div>

                {/* Active Filters Summary */}
                {(dateRangeFrom || dateRangeTo || budgetMin || budgetMax) && (
                  <div className="mt-4 pt-4 border-t border-gray-100">
                    <div className="flex items-center gap-2 flex-wrap">
                      <span className="text-gray-500 text-sm">Active filters:</span>
                      {dateRangeFrom && (
                        <span className="px-2 py-1 bg-blue-50 text-blue-600 text-xs font-medium rounded-lg flex items-center gap-1 border border-blue-200">
                          From: {dateRangeFrom}
                          <button onClick={() => setDateRangeFrom('')} className="hover:text-blue-800">√ó</button>
                        </span>
                      )}
                      {dateRangeTo && (
                        <span className="px-2 py-1 bg-blue-50 text-blue-600 text-xs font-medium rounded-lg flex items-center gap-1 border border-blue-200">
                          To: {dateRangeTo}
                          <button onClick={() => setDateRangeTo('')} className="hover:text-blue-800">√ó</button>
                        </span>
                      )}
                      {budgetMin && (
                        <span className="px-2 py-1 bg-green-50 text-green-600 text-xs font-medium rounded-lg flex items-center gap-1 border border-green-200">
                          Min: ‚Çπ{parseInt(budgetMin).toLocaleString('en-IN')}
                          <button onClick={() => setBudgetMin('')} className="hover:text-green-800">√ó</button>
                        </span>
                      )}
                      {budgetMax && (
                        <span className="px-2 py-1 bg-green-50 text-green-600 text-xs font-medium rounded-lg flex items-center gap-1 border border-green-200">
                          Max: ‚Çπ{parseInt(budgetMax).toLocaleString('en-IN')}
                          <button onClick={() => setBudgetMax('')} className="hover:text-green-800">√ó</button>
                        </span>
                      )}
                    </div>
                  </div>
                )}
              </div>
            )}

            {/* Quick Stats Summary */}
            {showAnalytics && (
              <div className="mb-8 bg-white rounded-2xl border border-gray-200 shadow-sm p-6">
                <div className="flex items-center justify-between mb-6">
                  <h2 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                    <span className="text-blue-500">üìä</span> Quick Stats
                  </h2>
                  <Link
                    href="/admin/analytics"
                    className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-all text-sm flex items-center gap-2"
                  >
                    <span>View Full Analytics</span>
                    <span>‚Üí</span>
                  </Link>
                </div>

                {/* Simple Stats Grid */}
                <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                  <div className="bg-blue-50 rounded-xl p-4 text-center border border-blue-100">
                    <div className="text-3xl font-bold text-blue-600">{stats.total}</div>
                    <div className="text-sm text-gray-600">Total</div>
                  </div>
                  <div className="bg-amber-50 rounded-xl p-4 text-center border border-amber-100">
                    <div className="text-3xl font-bold text-amber-600">{stats.pending + stats.underReview}</div>
                    <div className="text-sm text-gray-600">Pipeline</div>
                  </div>
                  <div className="bg-green-50 rounded-xl p-4 text-center border border-green-100">
                    <div className="text-3xl font-bold text-green-600">{stats.approved}</div>
                    <div className="text-sm text-gray-600">Approved</div>
                  </div>
                  <div className="bg-purple-50 rounded-xl p-4 text-center border border-purple-100">
                    <div className="text-3xl font-bold text-purple-600">{stats.inProduction}</div>
                    <div className="text-sm text-gray-600">Production</div>
                  </div>
                  <div className="bg-emerald-50 rounded-xl p-4 text-center border border-emerald-100">
                    <div className="text-xl font-bold text-emerald-600">{formatBudgetInWords(stats.totalBudget)}</div>
                    <div className="text-sm text-gray-600">Total Value</div>
                  </div>
                </div>
              </div>
            )}

            {/* CULTURE-WISE ROW */}
            <div className="mb-8">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-bold text-gray-800">Browse by Culture</h2>
                {filterCulture !== 'all' && (
                  <button
                    onClick={() => setFilterCulture('all')}
                    className="text-sm text-blue-600 hover:text-blue-800 transition-colors font-medium"
                  >
                    Clear Filter
                  </button>
                )}
              </div>
              <div className="flex gap-4 overflow-x-auto pb-4 hide-scrollbar">
                {[
                  { name: 'Haryanvi', color: 'from-emerald-400 to-teal-500', bg: 'bg-emerald-50', border: 'border-emerald-200' },
                  { name: 'Rajasthani', color: 'from-pink-400 to-rose-500', bg: 'bg-pink-50', border: 'border-pink-200' },
                  { name: 'Bhojpuri', color: 'from-orange-400 to-amber-500', bg: 'bg-orange-50', border: 'border-orange-200' },
                  { name: 'Gujarati', color: 'from-yellow-400 to-amber-400', bg: 'bg-yellow-50', border: 'border-yellow-200' },
                ].map((cultureItem) => {
                  const count = submissions.filter(s =>
                    s.culture?.toLowerCase() === cultureItem.name.toLowerCase()
                  ).length;
                  return (
                    <button
                      key={cultureItem.name}
                      onClick={() => {
                        setFilterCulture(filterCulture === cultureItem.name ? 'all' : cultureItem.name);
                        setFilterFormat('all');
                        setFilterStatus('all');
                        setTimeout(() => {
                          document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 100);
                      }}
                      className={`flex-shrink-0 w-48 group relative rounded-xl overflow-hidden transition-all duration-300 border-2 shadow-sm hover:shadow-md ${
                        filterCulture === cultureItem.name ? `ring-2 ring-blue-500 scale-105 ${cultureItem.border}` : `${cultureItem.border} hover:scale-105`
                      }`}
                    >
                      <div className={`h-24 bg-gradient-to-br ${cultureItem.color}`}></div>
                      <div className={`${cultureItem.bg} p-3`}>
                        <div className="text-gray-800 font-bold text-lg">{cultureItem.name}</div>
                        <div className="text-gray-500 text-xs">{count} Projects</div>
                      </div>
                      {filterCulture === cultureItem.name && (
                        <div className="absolute top-2 right-2 w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center">
                          <span className="text-white text-xs font-bold">‚úì</span>
                        </div>
                      )}
                    </button>
                  );
                })}
              </div>
            </div>

            {/* FORMAT-WISE ROW */}
            <div className="mb-8">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-bold text-gray-800">Browse by Format</h2>
                {filterFormat !== 'all' && (
                  <button
                    onClick={() => setFilterFormat('all')}
                    className="text-sm text-blue-600 hover:text-blue-800 transition-colors font-medium"
                  >
                    Clear Filter
                  </button>
                )}
              </div>
              <div className="flex gap-4 overflow-x-auto pb-4 hide-scrollbar">
                {[
                  { key: 'Feature Film', icon: 'üé¨', bg: 'bg-red-50', border: 'border-red-200', text: 'text-red-600' },
                  { key: 'Mini Film', icon: 'üéûÔ∏è', bg: 'bg-amber-50', border: 'border-amber-200', text: 'text-amber-600' },
                  { key: 'Long Series', icon: 'üì∫', bg: 'bg-green-50', border: 'border-green-200', text: 'text-green-600' },
                  { key: 'Limited Series', icon: 'üé≠', bg: 'bg-purple-50', border: 'border-purple-200', text: 'text-purple-600' },
                  { key: 'Microdrama', icon: '‚ö°', bg: 'bg-blue-50', border: 'border-blue-200', text: 'text-blue-600' },
                ].map(({ key, icon, bg, border, text }) => {
                  const count = stats.byFormat[key] || 0;
                  return (
                    <button
                      key={key}
                      onClick={() => {
                        setFilterFormat(filterFormat === key ? 'all' : key);
                        setFilterCulture('all');
                        setFilterStatus('all');
                        setTimeout(() => {
                          document.getElementById('netflix-results')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }, 100);
                      }}
                      className={`flex-shrink-0 w-40 group relative rounded-xl overflow-hidden transition-all duration-300 border-2 shadow-sm hover:shadow-md ${bg} ${
                        filterFormat === key ? `ring-2 ring-blue-500 scale-105 ${border}` : `${border} hover:scale-105`
                      }`}
                    >
                      <div className="h-20 flex items-center justify-center">
                        <span className="text-4xl">{icon}</span>
                      </div>
                      <div className="p-2 border-t border-gray-100">
                        <div className={`font-bold text-sm ${text}`}>{key}</div>
                        <div className="text-gray-500 text-xs">{count} Projects</div>
                      </div>
                      {filterFormat === key && (
                        <div className="absolute top-2 right-2 w-5 h-5 bg-blue-600 rounded-full flex items-center justify-center">
                          <span className="text-white text-xs font-bold">‚úì</span>
                        </div>
                      )}
                    </button>
                  );
                })}
              </div>
            </div>

            {/* RECENT SUBMISSIONS ROW */}
            <div className="mb-8">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-bold text-gray-800">Recent Submissions</h2>
                <span className="text-blue-600 text-sm font-medium">{newSubmissionsCount} new</span>
              </div>
              <div className="flex gap-4 overflow-x-auto pb-4 hide-scrollbar">
                {[...submissions]
                  .sort((a, b) => new Date(b.submittedDate).getTime() - new Date(a.submittedDate).getTime())
                  .slice(0, 10)
                  .map((project) => {
                    const statusConfig = getStatusConfig(project.status);
                    const isNew = isNewSubmission(project.submittedDate, project.id);
                    return (
                      <div
                        key={project.id}
                        onClick={() => {
                          markAsViewed(project.id);
                          setSelectedSubmission(project);
                        }}
                        className={`flex-shrink-0 w-56 bg-white rounded-xl overflow-hidden cursor-pointer transition-all duration-300 hover:scale-105 hover:z-10 relative group border border-gray-200 shadow-sm hover:shadow-lg ${
                          isNew ? 'ring-2 ring-blue-500' : ''
                        }`}
                      >
                        {isNew && (
                          <div className="absolute top-2 left-2 z-10 px-2 py-0.5 bg-blue-600 text-white text-xs font-bold rounded">
                            NEW
                          </div>
                        )}
                        <div className={`h-28 bg-gradient-to-br ${getCultureColor(project.culture)} flex items-center justify-center relative`}>
                          <span className="text-5xl opacity-60">{
                            project.format === 'Feature Film' ? 'üé¨' :
                            project.format === 'Mini Film' ? 'üéûÔ∏è' :
                            project.format === 'Long Series' ? 'üì∫' :
                            project.format === 'Limited Series' ? 'üé≠' : '‚ö°'
                          }</span>
                          <div className="absolute bottom-2 right-2">
                            <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusConfig.badge}`}>
                              {statusConfig.text}
                            </span>
                          </div>
                        </div>
                        <div className="p-3">
                          <div className="text-gray-800 font-bold text-sm truncate mb-1">{project.projectName}</div>
                          <div className="text-gray-500 text-xs mb-2">{project.culture} ‚Ä¢ {project.format}</div>
                          <div className="flex items-center justify-between">
                            <span className="text-green-600 text-xs font-bold">{formatBudgetInWords(project.totalBudget)}</span>
                            <span className="text-gray-400 text-xs">{getTimeElapsed(project.submittedDate)}</span>
                          </div>
                        </div>
                        {/* Hover Overlay */}
                        <div className="absolute inset-0 bg-blue-900/90 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2 p-4">
                          <button className="w-full py-2 bg-white text-blue-600 font-bold rounded-lg text-sm hover:bg-blue-50 transition-colors">
                            Review
                          </button>
                          <div className="text-blue-100 text-xs text-center">
                            <div>{project.creator}</div>
                            <div>{project.genre}</div>
                          </div>
                        </div>
                      </div>
                    );
                  })}
              </div>
            </div>

            {/* TOP BUDGET PROJECTS ROW */}
            <div className="mb-8">
              <div className="flex items-center justify-between mb-4">
                <h2 className="text-xl font-bold text-gray-800">Top Budget Projects</h2>
                <span className="text-gray-500 text-sm">By total value</span>
              </div>
              <div className="flex gap-4 overflow-x-auto pb-4 hide-scrollbar">
                {[...submissions]
                  .sort((a, b) => (b.totalBudget || 0) - (a.totalBudget || 0))
                  .slice(0, 8)
                  .map((project, index) => {
                    const statusConfig = getStatusConfig(project.status);
                    return (
                      <div
                        key={project.id}
                        onClick={() => {
                          markAsViewed(project.id);
                          setSelectedSubmission(project);
                        }}
                        className="flex-shrink-0 w-64 bg-white rounded-xl overflow-hidden cursor-pointer transition-all duration-300 hover:scale-105 hover:z-10 relative group border border-gray-200 shadow-sm hover:shadow-lg"
                      >
                        <div className="absolute top-2 left-2 z-10 w-8 h-8 bg-gradient-to-br from-amber-400 to-amber-500 rounded-full flex items-center justify-center shadow-md">
                          <span className="text-white font-bold text-sm">#{index + 1}</span>
                        </div>
                        <div className={`h-32 bg-gradient-to-br ${getCultureColor(project.culture)} flex items-center justify-center relative`}>
                          <span className="text-6xl opacity-60">üí∞</span>
                          <div className="absolute bottom-2 right-2">
                            <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusConfig.badge}`}>
                              {statusConfig.text}
                            </span>
                          </div>
                        </div>
                        <div className="p-3">
                          <div className="text-gray-800 font-bold text-sm truncate mb-1">{project.projectName}</div>
                          <div className="text-gray-500 text-xs mb-2">{project.culture} ‚Ä¢ {project.format}</div>
                          <div className="text-emerald-600 text-lg font-bold">{formatBudgetInWords(project.totalBudget)}</div>
                        </div>
                        {/* Hover Overlay */}
                        <div className="absolute inset-0 bg-blue-900/90 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2 p-4">
                          <button className="w-full py-2 bg-white text-blue-600 font-bold rounded-lg text-sm hover:bg-blue-50 transition-colors">
                            Review
                          </button>
                          <div className="text-blue-100 text-xs text-center">
                            <div>{project.creator}</div>
                            <div>Director: {project.director || 'TBD'}</div>
                          </div>
                        </div>
                      </div>
                    );
                  })}
              </div>
            </div>

            {/* ACTIVITY LOG ROW */}
            <div className="mb-8">
              <h2 className="text-xl font-bold text-gray-800 mb-4">Activity Log</h2>
              <div className="bg-white rounded-xl p-4 max-h-80 overflow-y-auto border border-gray-200 shadow-sm">
                {[...submissions]
                  .sort((a, b) => new Date(b.submittedDate).getTime() - new Date(a.submittedDate).getTime())
                  .slice(0, 15)
                  .map((project) => {
                    const statusConfig = getStatusConfig(project.status);
                    return (
                      <div
                        key={project.id}
                        className="flex items-center gap-4 py-3 border-b border-gray-100 last:border-0 hover:bg-gray-50 rounded px-2 transition-colors cursor-pointer"
                        onClick={() => {
                          markAsViewed(project.id);
                          setSelectedSubmission(project);
                        }}
                      >
                        <div className="w-2 h-2 rounded-full bg-green-500"></div>
                        <div className="flex-1">
                          <div className="flex items-center gap-2">
                            <span className="text-gray-800 font-semibold text-sm">{project.projectName}</span>
                            <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusConfig.badge}`}>
                              {statusConfig.text}
                            </span>
                          </div>
                          <div className="text-gray-500 text-xs mt-0.5">
                            Submitted by {project.creator} ‚Ä¢ {project.culture} ‚Ä¢ {project.format}
                          </div>
                        </div>
                        <div className="text-right">
                          <div className="text-gray-600 text-xs">{formatDate(project.submittedDate)}</div>
                          <div className="text-gray-400 text-xs">{getTimeElapsed(project.submittedDate)}</div>
                        </div>
                      </div>
                    );
                  })}
              </div>
            </div>

            {/* Active Filters Bar */}
            {(filterFormat !== 'all' || filterCulture !== 'all' || filterStatus !== 'all') && (
              <div className="mb-6 flex items-center gap-3 flex-wrap bg-white p-3 rounded-xl border border-gray-200 shadow-sm">
                <span className="text-gray-500 text-sm font-medium">Active Filters:</span>
                {filterCulture !== 'all' && (
                  <span className="px-3 py-1 bg-blue-50 border border-blue-200 rounded-full text-blue-600 text-sm flex items-center gap-2 font-medium">
                    Culture: {filterCulture}
                    <button onClick={() => setFilterCulture('all')} className="hover:text-blue-800">‚úï</button>
                  </span>
                )}
                {filterFormat !== 'all' && (
                  <span className="px-3 py-1 bg-purple-50 border border-purple-200 rounded-full text-purple-600 text-sm flex items-center gap-2 font-medium">
                    Format: {filterFormat}
                    <button onClick={() => setFilterFormat('all')} className="hover:text-purple-800">‚úï</button>
                  </span>
                )}
                {filterStatus !== 'all' && (
                  <span className="px-3 py-1 bg-red-50 border border-red-200 rounded-full text-red-600 text-sm flex items-center gap-2 font-medium">
                    Status: {filterStatus.replace('-', ' ')}
                    <button onClick={() => setFilterStatus('all')} className="hover:text-red-800">‚úï</button>
                  </span>
                )}
                <button
                  onClick={() => {
                    setFilterCulture('all');
                    setFilterFormat('all');
                    setFilterStatus('all');
                  }}
                  className="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-gray-600 text-sm transition-colors font-medium"
                >
                  Clear All
                </button>
              </div>
            )}

            {/* Results Header */}
            <div id="netflix-results" className="flex flex-col md:flex-row md:items-center justify-between mb-6 gap-2">
              <h2 className="text-lg md:text-xl font-bold text-gray-800">
                {searchQuery
                  ? `Search Results for "${searchQuery}" (${filteredSubmissions.length})`
                  : filterCulture !== 'all' || filterFormat !== 'all' || filterStatus !== 'all'
                  ? `Filtered Results (${filteredSubmissions.length})`
                  : `All Projects (${submissions.length})`
                }
              </h2>
              <div className="flex items-center gap-2 text-sm text-gray-500">
                <span>Sorted by: {sortBy === 'date' ? 'üìÖ Date' : sortBy === 'name' ? 'üìù Name' : sortBy === 'budget' ? 'üí∞ Budget' : 'üîÑ Status'}</span>
                <span>({sortOrder === 'desc' ? 'Newest first' : 'Oldest first'})</span>
              </div>
            </div>

            {/* Projects Grid - Card Style */}
            <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 mb-8">
              {filteredSubmissions.map((submission) => {
                const statusConfig = getStatusConfig(submission.status);
                const isNew = isNewSubmission(submission.submittedDate, submission.id);
                return (
                  <div
                    key={submission.id}
                    className={`group bg-white rounded-xl overflow-hidden cursor-pointer transition-all duration-300 hover:scale-105 hover:z-10 relative border border-gray-200 shadow-sm hover:shadow-lg ${
                      isNew ? 'ring-2 ring-blue-500' : ''
                    }`}
                    onClick={() => {
                      markAsViewed(submission.id);
                      setSelectedSubmission(submission);
                    }}
                  >
                    {/* NEW Badge */}
                    {isNew && (
                      <div className="absolute top-2 left-2 z-10 px-2 py-0.5 bg-blue-600 text-white text-xs font-bold rounded animate-pulse">
                        NEW
                      </div>
                    )}

                    {/* Card Visual */}
                    <div className={`h-36 bg-gradient-to-br ${getCultureColor(submission.culture)} flex items-center justify-center relative`}>
                      <span className="text-6xl opacity-50">{
                        submission.format === 'Feature Film' ? 'üé¨' :
                        submission.format === 'Mini Film' ? 'üéûÔ∏è' :
                        submission.format === 'Long Series' ? 'üì∫' :
                        submission.format === 'Limited Series' ? 'üé≠' : '‚ö°'
                      }</span>

                      {/* Status Badge */}
                      <div className="absolute bottom-2 right-2">
                        <span className={`px-2 py-0.5 rounded text-xs font-bold ${statusConfig.badge}`}>
                          {statusConfig.text}
                        </span>
                      </div>

                      {/* Budget Badge */}
                      <div className="absolute top-2 right-2">
                        <span className="px-2 py-0.5 bg-white/90 rounded text-xs font-bold text-emerald-600 shadow-sm">
                          {formatBudgetInWords(submission.totalBudget)}
                        </span>
                      </div>
                    </div>

                    {/* Card Info */}
                    <div className="p-3">
                      <div className="text-gray-800 font-bold text-sm truncate mb-1">{submission.projectName}</div>
                      <div className="text-gray-500 text-xs mb-2">{submission.culture} ‚Ä¢ {submission.format}</div>
                      <div className="flex items-center justify-between">
                        <span className="text-gray-600 text-xs">{submission.creator}</span>
                        <span className="text-gray-400 text-xs">{getTimeElapsed(submission.submittedDate)}</span>
                      </div>
                    </div>

                    {/* Hover Overlay */}
                    <div className="absolute inset-0 bg-blue-900/95 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col p-4">
                      <div className="flex-1">
                        <div className="text-white font-bold mb-1">{submission.projectName}</div>
                        <div className="text-blue-200 text-xs mb-2">{submission.culture} ‚Ä¢ {submission.format} ‚Ä¢ {submission.genre}</div>
                        <div className="text-blue-100 text-xs mb-1">Creator: {submission.creator}</div>
                        <div className="text-blue-100 text-xs mb-1">Director: {submission.director || 'TBD'}</div>
                        <div className="text-emerald-300 text-sm font-bold mb-2">{formatBudgetInWords(submission.totalBudget)}</div>

                        {/* Completeness Bar */}
                        <div className="mb-2">
                          <div className="flex justify-between text-xs mb-1">
                            <span className="text-blue-200">Completeness</span>
                            <span className={submission.completeness >= 90 ? 'text-green-300' : 'text-amber-300'}>{submission.completeness}%</span>
                          </div>
                          <div className="h-1 bg-blue-800 rounded-full">
                            <div
                              className={`h-full rounded-full ${submission.completeness >= 90 ? 'bg-green-400' : 'bg-amber-400'}`}
                              style={{ width: `${submission.completeness}%` }}
                            />
                          </div>
                        </div>

                        {submission.warnings > 0 && (
                          <div className="text-amber-300 text-xs">‚ö†Ô∏è {submission.warnings} Warnings</div>
                        )}
                        {submission.sopComments && submission.sopComments.length > 0 && (
                          <div className="text-blue-300 text-xs">üí¨ {submission.sopComments.length} SOP Questions</div>
                        )}
                      </div>

                      {/* Action Buttons */}
                      <div className="flex gap-2 mt-auto">
                        <button
                          className="flex-1 py-2 bg-white text-blue-600 font-bold rounded-lg text-xs hover:bg-blue-50 transition-colors"
                          onClick={(e) => {
                            e.stopPropagation();
                            markAsViewed(submission.id);
                            setSelectedSubmission(submission);
                          }}
                        >
                          Review
                        </button>
                        <button
                          onClick={(e) => {
                            e.stopPropagation();
                            setShowStatusMenu(submission.id);
                          }}
                          className="px-3 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded-lg text-xs transition-colors"
                          title="Change Status"
                        >
                          üîÑ
                        </button>
                        <button
                          onClick={(e) => {
                            e.stopPropagation();
                            setShowDeleteConfirm(submission.id);
                          }}
                          className="px-3 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-xs transition-colors"
                          title="Delete"
                        >
                          üóëÔ∏è
                        </button>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>

            {filteredSubmissions.length === 0 && (
              <div className="text-center py-16">
                <div className="text-6xl mb-4 opacity-50">üì≠</div>
                <div className="text-xl font-bold text-gray-500">No projects found</div>
                <div className="text-sm text-gray-400 mt-2">Try adjusting your filters</div>
              </div>
            )}

            </div> {/* End of Overview Container */}

            <style jsx>{`
              .hide-scrollbar::-webkit-scrollbar {
                display: none;
              }
              .hide-scrollbar {
                -ms-overflow-style: none;
                scrollbar-width: none;
              }
            `}</style>
            </>
          )}

          {/* SUBMISSIONS/PIPELINE TAB - Original */}
          {activeTab === 'submissions' && (
            <div className="space-y-6">
              <div className="bg-white rounded-xl p-5 border-2 border-gray-200 shadow-lg">
                <div className="flex items-center justify-between">
                  <div>
                    <h2 className="text-3xl font-black text-gray-900 mb-2 flex items-center gap-3">
                      <span className="text-4xl">üìã</span>
                      <span>All Projects</span>
                    </h2>
                    <p className="text-gray-700 font-semibold">
                      Manage and review all projects ({submissions.length} total)
                    </p>
                  </div>
                  <button
                    onClick={() => setShowAddProjectModal(true)}
                    className="px-6 py-3 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2"
                  >
                    <span className="text-xl">‚ûï</span>
                    <span>Add Project</span>
                  </button>
                </div>
              </div>

              {/* Submissions Grid - Same as Overview */}
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                {submissions.map((submission) => {
                  const statusConfig = getStatusConfig(submission.status);
                  const isNew = isNewSubmission(submission.submittedDate, submission.id);
                  return (
                    <div
                      key={submission.id}
                      className={`group bg-white backdrop-blur-xl border-2 rounded-2xl hover:shadow-xl transition-all duration-300 shadow-lg relative ${
                        isNew ? 'border-red-400 ring-4 ring-red-100 animate-pulse-slow' : 'border-gray-200'
                      }`}
                    >
                      {isNew && (
                        <div className="absolute top-4 right-4 z-10">
                          <div className="relative">
                            <div className="px-4 py-2 bg-gradient-to-r from-red-500 to-pink-600 rounded-full shadow-lg flex items-center gap-2 animate-bounce-slow">
                              <span className="text-white text-xs font-black uppercase tracking-wider">‚ú® NEW</span>
                            </div>
                            <div className="absolute inset-0 bg-red-500 rounded-full animate-ping opacity-30"></div>
                          </div>
                        </div>
                      )}

                      <div className="p-6">
                        <div className="flex items-center justify-between mb-3">
                          <div className="flex items-center gap-2 text-xs font-bold text-gray-500">
                            <span>‚è∞</span>
                            <span>{getTimeElapsed(submission.submittedDate)}</span>
                          </div>
                        </div>

                        <div className="flex items-start justify-between mb-4">
                          <div className="flex-1">
                            <h3 className="text-2xl font-black mb-3 text-gray-900">{submission.projectName}</h3>
                            <div className="flex items-center gap-2 flex-wrap">
                              <span className="px-3 py-1.5 bg-purple-100 border-2 border-purple-300 rounded-lg text-xs font-bold text-purple-800">
                                {submission.format}
                              </span>
                              <span className="px-3 py-1.5 bg-pink-100 border-2 border-pink-300 rounded-lg text-xs font-bold text-pink-800">
                                {submission.culture}
                              </span>
                              <span className="px-3 py-1.5 bg-blue-100 border-2 border-blue-300 rounded-lg text-xs font-bold text-blue-800">
                                {submission.genre}
                              </span>
                            </div>
                          </div>
                          <div className={`px-3 py-2 rounded-lg border-2 ${statusConfig.badge}`}>
                            <div className="text-xs font-black whitespace-nowrap">{statusConfig.icon}</div>
                          </div>
                        </div>

                        {/* Creator, Director & Budget */}
                        <div className="grid grid-cols-3 gap-3 mb-3">
                          <div className="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-3 border-2 border-blue-200">
                            <div className="text-xs font-bold text-blue-700 mb-1 uppercase tracking-wide">CREATOR</div>
                            <div className="text-sm font-bold text-gray-900">{submission.creator}</div>
                          </div>
                          <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-3 border-2 border-purple-200">
                            <div className="text-xs font-bold text-purple-700 mb-1 uppercase tracking-wide">DIRECTOR</div>
                            <div className="text-sm font-bold text-gray-900">{submission.director || 'N/A'}</div>
                          </div>
                          <div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-3 border-2 border-green-200">
                            <div className="text-xs font-bold text-green-700 mb-1 uppercase tracking-wide">BUDGET</div>
                            <div className="text-sm font-black text-gray-900">{formatBudgetInWords(submission.totalBudget)}</div>
                          </div>
                        </div>

                        {/* Production & Content POC - Editable */}
                        <div className="grid grid-cols-2 gap-3 mb-4">
                          {/* Production POC */}
                          <div className="bg-gradient-to-br from-cyan-50 to-blue-50 rounded-xl p-3 border-2 border-cyan-200">
                            <div className="text-xs font-bold text-cyan-700 mb-1 uppercase tracking-wide flex items-center gap-1">
                              üé¨ PRODUCTION POC
                            </div>
                            {editingPOC?.submissionId === submission.id && editingPOC?.field === 'productionPOC' ? (
                              <div className="flex items-center gap-1">
                                <input
                                  type="text"
                                  value={tempPOCValue}
                                  onChange={(e) => setTempPOCValue(e.target.value)}
                                  onKeyPress={(e) => e.key === 'Enter' && handleSavePOC()}
                                  className="flex-1 text-sm font-bold text-gray-900 bg-white border-2 border-cyan-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-cyan-500"
                                  placeholder="Enter name"
                                  autoFocus
                                />
                                <button
                                  onClick={handleSavePOC}
                                  className="p-1 bg-green-500 text-white rounded hover:bg-green-600 transition-colors"
                                  title="Save"
                                >
                                  ‚úì
                                </button>
                                <button
                                  onClick={handleCancelEditPOC}
                                  className="p-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors"
                                  title="Cancel"
                                >
                                  ‚úï
                                </button>
                              </div>
                            ) : (
                              <div
                                className="text-sm font-bold text-gray-900 cursor-pointer hover:text-cyan-700 transition-colors group flex items-center gap-2"
                                onClick={(e) => {
                                  e.stopPropagation();
                                  handleStartEditPOC(submission.id, 'productionPOC', submission.productionPOC || '');
                                }}
                              >
                                {submission.productionPOC || <span className="text-gray-400 italic">Click to assign</span>}
                                <span className="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚úèÔ∏è</span>
                              </div>
                            )}
                          </div>

                          {/* Content POC */}
                          <div className="bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-3 border-2 border-orange-200">
                            <div className="text-xs font-bold text-orange-700 mb-1 uppercase tracking-wide flex items-center gap-1">
                              üìù CONTENT POC
                            </div>
                            {editingPOC?.submissionId === submission.id && editingPOC?.field === 'contentPOC' ? (
                              <div className="flex items-center gap-1">
                                <input
                                  type="text"
                                  value={tempPOCValue}
                                  onChange={(e) => setTempPOCValue(e.target.value)}
                                  onKeyPress={(e) => e.key === 'Enter' && handleSavePOC()}
                                  className="flex-1 text-sm font-bold text-gray-900 bg-white border-2 border-orange-400 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-orange-500"
                                  placeholder="Enter name"
                                  autoFocus
                                />
                                <button
                                  onClick={handleSavePOC}
                                  className="p-1 bg-green-500 text-white rounded hover:bg-green-600 transition-colors"
                                  title="Save"
                                >
                                  ‚úì
                                </button>
                                <button
                                  onClick={handleCancelEditPOC}
                                  className="p-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors"
                                  title="Cancel"
                                >
                                  ‚úï
                                </button>
                              </div>
                            ) : (
                              <div
                                className="text-sm font-bold text-gray-900 cursor-pointer hover:text-orange-700 transition-colors group flex items-center gap-2"
                                onClick={(e) => {
                                  e.stopPropagation();
                                  handleStartEditPOC(submission.id, 'contentPOC', submission.contentPOC || '');
                                }}
                              >
                                {submission.contentPOC || <span className="text-gray-400 italic">Click to assign</span>}
                                <span className="text-xs opacity-0 group-hover:opacity-100 transition-opacity">‚úèÔ∏è</span>
                              </div>
                            )}
                          </div>
                        </div>

                        <div className="flex items-center gap-3">
                          <button
                            onClick={() => {
                              markAsViewed(submission.id);
                              setSelectedSubmission(submission);
                            }}
                            className="flex-1 py-3 bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white font-black rounded-xl transition-all shadow-md hover:shadow-lg"
                          >
                            View Details ‚Üí
                          </button>

                          {/* Status Change Button */}
                          <div className="relative">
                            <button
                              id={`status-button-sub-${submission.id}`}
                              onClick={() => setShowStatusMenu(showStatusMenu === submission.id ? null : submission.id)}
                              className="px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white font-black rounded-xl transition-all shadow-md"
                              title="Change Status"
                            >
                              üîÑ
                            </button>
                            {showStatusMenu === submission.id && (
                              <div
                                className="fixed bg-gray-900 border-2 border-white/20 rounded-xl shadow-2xl z-[9999] min-w-[220px] max-h-[400px] overflow-y-auto"
                                style={{
                                  top: `${(document.getElementById(`status-button-sub-${submission.id}`)?.getBoundingClientRect().bottom || 0) + 8}px`,
                                  left: `${(document.getElementById(`status-button-sub-${submission.id}`)?.getBoundingClientRect().right || 0) - 220}px`,
                                }}
                              >
                                <div className="p-3 space-y-1">
                                  <div className="text-xs font-bold text-gray-400 px-3 py-2 uppercase tracking-wide">Change Status To:</div>
                                  {[
                                    { value: 'pending', label: 'Pending', icon: '‚è≥' },
                                    { value: 'under-review', label: 'Under Review', icon: 'üëÅÔ∏è' },
                                    { value: 'approved', label: 'Approved', icon: '‚úì' },
                                    { value: 'revision-requested', label: 'Revision Needed', icon: 'üìù' },
                                    { value: 'on-hold', label: 'On Hold', icon: '‚è∏Ô∏è' },
                                    { value: 'in-production', label: 'In Production', icon: 'üé¨' },
                                    { value: 'scrapped', label: 'Scrapped', icon: 'üóëÔ∏è' },
                                  ].map((status) => (
                                    <button
                                      key={status.value}
                                      onClick={() => {
                                        handleStatusChange(submission.id, status.value);
                                        setShowStatusMenu(null);
                                      }}
                                      className={`w-full text-left px-3 py-2.5 hover:bg-white/10 rounded-lg text-sm font-bold text-white flex items-center gap-2 transition-all ${
                                        submission.status === status.value ? 'bg-white/20' : ''
                                      }`}
                                    >
                                      <span>{status.icon}</span>
                                      <span>{status.label}</span>
                                      {submission.status === status.value && (
                                        <span className="ml-auto text-green-400">‚úì</span>
                                      )}
                                    </button>
                                  ))}
                                </div>
                              </div>
                            )}
                          </div>
                          {/* Delete Project Button */}
                          <button
                            onClick={() => {
                              if (confirm(`Are you sure you want to delete "${submission.projectName}"?\n\nThis action cannot be undone.`)) {
                                const updatedSubmissions = submissions.filter(s => s.id !== submission.id);
                                setSubmissions(updatedSubmissions);
                                // Also remove from localStorage
                                const existingLocal = JSON.parse(localStorage.getItem('creator_submissions') || '[]');
                                const updatedLocal = existingLocal.filter((s: any) => s.id !== submission.id);
                                localStorage.setItem('creator_submissions', JSON.stringify(updatedLocal));
                                alert('Project deleted successfully');
                              }
                            }}
                            className="px-4 py-3 bg-red-100 hover:bg-red-200 text-red-700 font-black rounded-xl transition-all"
                            title="Delete Project"
                          >
                            üóëÔ∏è
                          </button>
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          )}

          {/* ANALYTICS TAB - Redesigned */}
          {activeTab === 'analytics' && (
            <div className="space-y-6">
              {/* Header */}
              <div className="bg-white rounded-2xl p-6 border-2 border-gray-200 shadow-lg">
                <h2 className="text-2xl font-black text-gray-900 flex items-center gap-3">
                  <span className="text-3xl">üìä</span>
                  Analytics Dashboard
                </h2>
              </div>

              {/* Quick Stats Row */}
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                {[
                  { label: 'Total Projects', value: stats.total, icon: 'üìÅ', color: 'blue' },
                  { label: 'Approved', value: stats.approved, icon: '‚úÖ', color: 'green' },
                  { label: 'In Production', value: stats.inProduction, icon: 'üé¨', color: 'purple' },
                  { label: 'Under Review', value: stats.underReview, icon: 'üëÅÔ∏è', color: 'orange' },
                ].map((stat) => (
                  <div key={stat.label} className={`bg-${stat.color}-50 border-2 border-${stat.color}-200 rounded-xl p-4 text-center`}>
                    <div className="text-2xl mb-1">{stat.icon}</div>
                    <div className="text-3xl font-black text-gray-900">{stat.value}</div>
                    <div className={`text-sm font-bold text-${stat.color}-700`}>{stat.label}</div>
                  </div>
                ))}
              </div>

              {/* Projects by Culture - Expandable */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <button
                  onClick={() => setExpandedBudgetCulture(expandedBudgetCulture === 'culture-analytics' ? null : 'culture-analytics')}
                  className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition-all"
                >
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">üåç</span>
                    <div className="text-left">
                      <h3 className="text-lg font-black text-gray-900">Projects by Culture</h3>
                      <p className="text-sm text-gray-500 font-semibold">{Object.keys(stats.budgetByCulture).length} cultures</p>
                    </div>
                  </div>
                  <div className={`w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xl font-bold transition-transform ${expandedBudgetCulture === 'culture-analytics' ? 'rotate-180' : ''}`}>
                    ‚ñº
                  </div>
                </button>

                {expandedBudgetCulture === 'culture-analytics' && (
                  <div className="border-t-2 border-gray-200 p-5 space-y-4">
                    {Object.entries(
                      submissions.reduce((acc: Record<string, number>, s) => {
                        acc[s.culture] = (acc[s.culture] || 0) + 1;
                        return acc;
                      }, {})
                    ).sort((a, b) => b[1] - a[1]).map(([culture, count]) => {
                      const percentage = ((count as number) / stats.total * 100).toFixed(0);
                      return (
                        <div key={culture} className="space-y-2">
                          <div className="flex items-center justify-between">
                            <span className="font-bold text-gray-900">{culture}</span>
                            <span className="font-black text-gray-700">{count} projects ({percentage}%)</span>
                          </div>
                          <div className="h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div
                              className="h-full bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full transition-all duration-500"
                              style={{ width: `${percentage}%` }}
                            />
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>

              {/* Projects by Format - Expandable */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <button
                  onClick={() => setExpandedBudgetCulture(expandedBudgetCulture === 'format-analytics' ? null : 'format-analytics')}
                  className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition-all"
                >
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">üé¨</span>
                    <div className="text-left">
                      <h3 className="text-lg font-black text-gray-900">Projects by Format</h3>
                      <p className="text-sm text-gray-500 font-semibold">Content type distribution</p>
                    </div>
                  </div>
                  <div className={`w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xl font-bold transition-transform ${expandedBudgetCulture === 'format-analytics' ? 'rotate-180' : ''}`}>
                    ‚ñº
                  </div>
                </button>

                {expandedBudgetCulture === 'format-analytics' && (
                  <div className="border-t-2 border-gray-200 p-5 space-y-4">
                    {Object.entries(
                      submissions.reduce((acc: Record<string, number>, s) => {
                        acc[s.format] = (acc[s.format] || 0) + 1;
                        return acc;
                      }, {})
                    ).sort((a, b) => b[1] - a[1]).map(([format, count]) => {
                      const percentage = ((count as number) / stats.total * 100).toFixed(0);
                      const formatIcons: Record<string, string> = {
                        'Feature Film': 'üé¨', 'Mini Film': 'üéûÔ∏è', 'Long Series': 'üì∫',
                        'Limited Series': 'üé≠', 'Microdrama': '‚ö°'
                      };
                      return (
                        <div key={format} className="space-y-2">
                          <div className="flex items-center justify-between">
                            <span className="font-bold text-gray-900 flex items-center gap-2">
                              <span>{formatIcons[format] || 'üìπ'}</span> {format}
                            </span>
                            <span className="font-black text-gray-700">{count} projects ({percentage}%)</span>
                          </div>
                          <div className="h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div
                              className="h-full bg-gradient-to-r from-purple-500 to-pink-600 rounded-full transition-all duration-500"
                              style={{ width: `${percentage}%` }}
                            />
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>

              {/* Projects by Status - Expandable */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <button
                  onClick={() => setExpandedBudgetCulture(expandedBudgetCulture === 'status-analytics' ? null : 'status-analytics')}
                  className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition-all"
                >
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">üìã</span>
                    <div className="text-left">
                      <h3 className="text-lg font-black text-gray-900">Projects by Status</h3>
                      <p className="text-sm text-gray-500 font-semibold">Pipeline overview</p>
                    </div>
                  </div>
                  <div className={`w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xl font-bold transition-transform ${expandedBudgetCulture === 'status-analytics' ? 'rotate-180' : ''}`}>
                    ‚ñº
                  </div>
                </button>

                {expandedBudgetCulture === 'status-analytics' && (
                  <div className="border-t-2 border-gray-200 p-5 space-y-4">
                    {[
                      { status: 'approved', label: 'Approved', color: 'green', icon: '‚úÖ' },
                      { status: 'in-production', label: 'In Production', color: 'purple', icon: 'üé¨' },
                      { status: 'under-review', label: 'Under Review', color: 'blue', icon: 'üëÅÔ∏è' },
                      { status: 'pending', label: 'Pending', color: 'yellow', icon: '‚è≥' },
                      { status: 'revision-requested', label: 'Revision Requested', color: 'orange', icon: 'üìù' },
                    ].map(({ status, label, color, icon }) => {
                      const count = submissions.filter(s => s.status === status).length;
                      const percentage = stats.total > 0 ? ((count / stats.total) * 100).toFixed(0) : '0';
                      return (
                        <div key={status} className="space-y-2">
                          <div className="flex items-center justify-between">
                            <span className="font-bold text-gray-900 flex items-center gap-2">
                              <span>{icon}</span> {label}
                            </span>
                            <span className="font-black text-gray-700">{count} projects ({percentage}%)</span>
                          </div>
                          <div className="h-4 bg-gray-200 rounded-full overflow-hidden">
                            <div
                              className={`h-full rounded-full transition-all duration-500 ${
                                color === 'green' ? 'bg-green-500' :
                                color === 'purple' ? 'bg-purple-500' :
                                color === 'blue' ? 'bg-blue-500' :
                                color === 'yellow' ? 'bg-yellow-500' :
                                'bg-orange-500'
                              }`}
                              style={{ width: `${percentage}%` }}
                            />
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* BUDGET TAB - Redesigned */}
          {activeTab === 'budget' && (
            <div className="space-y-6">
              {/* Header with Total */}
              <div className="bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl p-6 shadow-lg text-white">
                <div className="flex items-center justify-between">
                  <div>
                    <h2 className="text-lg font-bold opacity-90 mb-1">Total Budget (All Projects)</h2>
                    <div className="text-4xl font-black">{formatBudgetInWords(submissions.reduce((sum, s) => sum + (s.totalBudget || 0), 0))}</div>
                    <p className="text-sm font-semibold opacity-80 mt-2">{stats.total} total projects</p>
                  </div>
                  <div className="text-6xl">üí∞</div>
                </div>
              </div>

              {/* Budget Quick Stats */}
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                {[
                  { label: 'Approved Budget', value: submissions.filter(s => s.status === 'approved').reduce((sum, s) => sum + (s.totalBudget || 0), 0), icon: '‚úÖ', color: 'green' },
                  { label: 'In Production', value: submissions.filter(s => s.status === 'in-production').reduce((sum, s) => sum + (s.totalBudget || 0), 0), icon: 'üé¨', color: 'purple' },
                  { label: 'Under Review', value: submissions.filter(s => s.status === 'under-review').reduce((sum, s) => sum + (s.totalBudget || 0), 0), icon: 'üëÅÔ∏è', color: 'blue' },
                  { label: 'Pending', value: submissions.filter(s => s.status === 'pending').reduce((sum, s) => sum + (s.totalBudget || 0), 0), icon: '‚è≥', color: 'yellow' },
                ].map((stat) => (
                  <div key={stat.label} className="bg-white border-2 border-gray-200 rounded-xl p-4 shadow-md">
                    <div className="flex items-center gap-2 mb-2">
                      <span className="text-xl">{stat.icon}</span>
                      <span className="text-sm font-bold text-gray-600">{stat.label}</span>
                    </div>
                    <div className="text-xl font-black text-gray-900">{formatBudget(stat.value)}</div>
                  </div>
                ))}
              </div>

              {/* Budget by Culture - Expandable */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <button
                  onClick={() => setExpandedBudgetCulture(expandedBudgetCulture === 'budget-culture' ? null : 'budget-culture')}
                  className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition-all"
                >
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">üåç</span>
                    <div className="text-left">
                      <h3 className="text-lg font-black text-gray-900">Budget by Culture</h3>
                      <p className="text-sm text-gray-500 font-semibold">Click to view breakdown</p>
                    </div>
                  </div>
                  <div className={`w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xl font-bold transition-transform ${expandedBudgetCulture === 'budget-culture' ? 'rotate-180' : ''}`}>
                    ‚ñº
                  </div>
                </button>

                {expandedBudgetCulture === 'budget-culture' && (
                  <div className="border-t-2 border-gray-200 p-5 space-y-4">
                    {Object.entries(
                      submissions.reduce((acc: Record<string, { count: number; budget: number; projects: any[] }>, s) => {
                        if (!acc[s.culture]) acc[s.culture] = { count: 0, budget: 0, projects: [] };
                        acc[s.culture].count++;
                        acc[s.culture].budget += s.totalBudget || 0;
                        acc[s.culture].projects.push(s);
                        return acc;
                      }, {})
                    ).sort((a, b) => b[1].budget - a[1].budget).map(([culture, data]) => {
                      const totalBudget = submissions.reduce((sum, s) => sum + (s.totalBudget || 0), 0);
                      const percentage = totalBudget > 0 ? ((data.budget / totalBudget) * 100).toFixed(0) : '0';
                      return (
                        <div key={culture} className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                          <div className="flex items-center justify-between mb-3">
                            <div>
                              <span className="font-black text-gray-900 text-lg">{culture}</span>
                              <span className="text-sm text-gray-500 ml-2">({data.count} projects)</span>
                            </div>
                            <span className="font-black text-green-600 text-lg">{formatBudget(data.budget)}</span>
                          </div>
                          <div className="h-3 bg-gray-200 rounded-full overflow-hidden mb-3">
                            <div
                              className="h-full bg-gradient-to-r from-green-500 to-emerald-600 rounded-full"
                              style={{ width: `${percentage}%` }}
                            />
                          </div>
                          <div className="text-xs text-gray-500 font-semibold">{percentage}% of total budget</div>

                          {/* Projects in this culture */}
                          <div className="mt-3 space-y-2">
                            {data.projects.slice(0, 3).map((project: any) => (
                              <div
                                key={project.id}
                                onClick={() => { markAsViewed(project.id); setSelectedSubmission(project); }}
                                className="bg-white rounded-lg p-3 border border-gray-200 cursor-pointer hover:shadow-md transition-all flex items-center justify-between"
                              >
                                <div>
                                  <div className="font-bold text-gray-900 text-sm">{project.projectName}</div>
                                  <div className="text-xs text-gray-500">{project.format}</div>
                                </div>
                                <div className="font-bold text-green-600 text-sm">{formatBudget(project.totalBudget)}</div>
                              </div>
                            ))}
                            {data.projects.length > 3 && (
                              <div className="text-center text-xs text-gray-400 font-semibold">+ {data.projects.length - 3} more</div>
                            )}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>

              {/* Budget by Format - Expandable */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <button
                  onClick={() => setExpandedBudgetCulture(expandedBudgetCulture === 'budget-format' ? null : 'budget-format')}
                  className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition-all"
                >
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">üé¨</span>
                    <div className="text-left">
                      <h3 className="text-lg font-black text-gray-900">Budget by Format</h3>
                      <p className="text-sm text-gray-500 font-semibold">Click to view breakdown</p>
                    </div>
                  </div>
                  <div className={`w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xl font-bold transition-transform ${expandedBudgetCulture === 'budget-format' ? 'rotate-180' : ''}`}>
                    ‚ñº
                  </div>
                </button>

                {expandedBudgetCulture === 'budget-format' && (
                  <div className="border-t-2 border-gray-200 p-5 space-y-4">
                    {Object.entries(
                      submissions.reduce((acc: Record<string, { count: number; budget: number; projects: any[] }>, s) => {
                        if (!acc[s.format]) acc[s.format] = { count: 0, budget: 0, projects: [] };
                        acc[s.format].count++;
                        acc[s.format].budget += s.totalBudget || 0;
                        acc[s.format].projects.push(s);
                        return acc;
                      }, {})
                    ).sort((a, b) => b[1].budget - a[1].budget).map(([format, data]) => {
                      const totalBudget = submissions.reduce((sum, s) => sum + (s.totalBudget || 0), 0);
                      const percentage = totalBudget > 0 ? ((data.budget / totalBudget) * 100).toFixed(0) : '0';
                      const formatIcons: Record<string, string> = {
                        'Feature Film': 'üé¨', 'Mini Film': 'üéûÔ∏è', 'Long Series': 'üì∫',
                        'Limited Series': 'üé≠', 'Microdrama': '‚ö°'
                      };
                      return (
                        <div key={format} className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                          <div className="flex items-center justify-between mb-3">
                            <div className="flex items-center gap-2">
                              <span className="text-xl">{formatIcons[format] || 'üìπ'}</span>
                              <span className="font-black text-gray-900 text-lg">{format}</span>
                              <span className="text-sm text-gray-500">({data.count} projects)</span>
                            </div>
                            <span className="font-black text-purple-600 text-lg">{formatBudget(data.budget)}</span>
                          </div>
                          <div className="h-3 bg-gray-200 rounded-full overflow-hidden mb-3">
                            <div
                              className="h-full bg-gradient-to-r from-purple-500 to-pink-600 rounded-full"
                              style={{ width: `${percentage}%` }}
                            />
                          </div>
                          <div className="text-xs text-gray-500 font-semibold">{percentage}% of total budget</div>

                          {/* Projects in this format */}
                          <div className="mt-3 space-y-2">
                            {data.projects.slice(0, 3).map((project: any) => (
                              <div
                                key={project.id}
                                onClick={() => { markAsViewed(project.id); setSelectedSubmission(project); }}
                                className="bg-white rounded-lg p-3 border border-gray-200 cursor-pointer hover:shadow-md transition-all flex items-center justify-between"
                              >
                                <div>
                                  <div className="font-bold text-gray-900 text-sm">{project.projectName}</div>
                                  <div className="text-xs text-gray-500">{project.culture}</div>
                                </div>
                                <div className="font-bold text-purple-600 text-sm">{formatBudget(project.totalBudget)}</div>
                              </div>
                            ))}
                            {data.projects.length > 3 && (
                              <div className="text-center text-xs text-gray-400 font-semibold">+ {data.projects.length - 3} more</div>
                            )}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>

              {/* All Projects List - Expandable */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <button
                  onClick={() => setExpandedBudgetCulture(expandedBudgetCulture === 'all-projects' ? null : 'all-projects')}
                  className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition-all"
                >
                  <div className="flex items-center gap-3">
                    <span className="text-2xl">üìã</span>
                    <div className="text-left">
                      <h3 className="text-lg font-black text-gray-900">All Projects</h3>
                      <p className="text-sm text-gray-500 font-semibold">Sorted by budget (highest first)</p>
                    </div>
                  </div>
                  <div className={`w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-xl font-bold transition-transform ${expandedBudgetCulture === 'all-projects' ? 'rotate-180' : ''}`}>
                    ‚ñº
                  </div>
                </button>

                {expandedBudgetCulture === 'all-projects' && (
                  <div className="border-t-2 border-gray-200 p-5 space-y-3">
                    {[...submissions].sort((a, b) => (b.totalBudget || 0) - (a.totalBudget || 0)).map((project, index) => (
                      <div
                        key={project.id}
                        onClick={() => { markAsViewed(project.id); setSelectedSubmission(project); }}
                        className="bg-gray-50 rounded-xl p-4 border border-gray-200 cursor-pointer hover:shadow-md hover:bg-gray-100 transition-all"
                      >
                        <div className="flex items-center gap-4">
                          <div className="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center font-black text-gray-600 text-sm">
                            {index + 1}
                          </div>
                          <div className="flex-1">
                            <div className="font-bold text-gray-900">{project.projectName}</div>
                            <div className="text-sm text-gray-500 flex items-center gap-2 mt-1">
                              <span>{project.culture}</span>
                              <span>‚Ä¢</span>
                              <span>{project.format}</span>
                              <span>‚Ä¢</span>
                              <span className={`px-2 py-0.5 rounded text-xs font-bold ${getStatusConfig(project.status).badge}`}>
                                {getStatusConfig(project.status).text}
                              </span>
                            </div>
                          </div>
                          <div className="text-right">
                            <div className="font-black text-green-600 text-lg">{formatBudget(project.totalBudget)}</div>
                            <div className="text-xs text-gray-400">{project.creator}</div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          )}

          {/* LIBRARY TAB - Talent Database */}
          {activeTab === 'library' && (
            <div className="space-y-6">
              {/* Library Header */}
              <div className="bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 rounded-2xl p-6 shadow-lg text-white">
                <div className="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                  <div>
                    <h2 className="text-lg font-bold opacity-90 mb-1">Talent Library</h2>
                    <div className="text-3xl font-black">Crew & Cast Database</div>
                    <p className="text-sm font-semibold opacity-80 mt-2">
                      {talentLibrary.length} talents ‚Ä¢ Auto-synced from approved projects
                    </p>
                  </div>
                  <div className="flex flex-wrap items-center gap-2">
                    {/* Share Button */}
                    <div className="relative group">
                      <button className="px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm rounded-xl font-bold transition-all flex items-center gap-2">
                        <span>üì§</span> Share
                      </button>
                      <div className="absolute right-0 top-full mt-2 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 w-48 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50">
                        <button onClick={() => shareToWhatsApp(`STAGE Talent Library\n${talentLibrary.length} talents available\n${window.location.href}`)} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üí¨</span> WhatsApp
                        </button>
                        <button onClick={() => shareToTwitter(`Check out STAGE OTT Talent Library - ${talentLibrary.length} industry talents! ${window.location.href}`)} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üê¶</span> Twitter/X
                        </button>
                        <button onClick={() => shareToLinkedIn('STAGE OTT Talent Library', window.location.href)} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üíº</span> LinkedIn
                        </button>
                        <button onClick={() => shareToEmail('STAGE Talent Library', `Check out our talent database with ${talentLibrary.length} industry professionals.\n\n${window.location.href}`)} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üìß</span> Email
                        </button>
                        <button onClick={() => { navigator.clipboard.writeText(window.location.href); alert('Link copied!'); }} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üîó</span> Copy Link
                        </button>
                      </div>
                    </div>
                    {/* Download Button */}
                    <div className="relative group">
                      <button className="px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm rounded-xl font-bold transition-all flex items-center gap-2">
                        <span>‚¨áÔ∏è</span> Download
                      </button>
                      <div className="absolute right-0 top-full mt-2 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 w-56 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-50">
                        <div className="px-4 py-2 text-xs font-bold text-gray-500 uppercase">All Talents</div>
                        <button onClick={() => downloadTalentsExcel(talentLibrary, 'STAGE_All_Talents')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üìä</span> Excel (.xlsx)
                        </button>
                        <button onClick={() => downloadTalentsCSV(talentLibrary, 'STAGE_All_Talents')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üìÑ</span> CSV
                        </button>
                        <button onClick={() => downloadTalentsPDF(talentLibrary, 'All Talents')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üìë</span> PDF (Print)
                        </button>
                        <div className="border-t border-gray-200 my-2"></div>
                        <div className="px-4 py-2 text-xs font-bold text-gray-500 uppercase">By Department</div>
                        <button onClick={() => downloadTalentsExcel(talentLibrary.filter(t => t.department === 'direction'), 'STAGE_Direction_Team')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üé¨</span> Direction Team
                        </button>
                        <button onClick={() => downloadTalentsExcel(talentLibrary.filter(t => t.department === 'production'), 'STAGE_Production_Team')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üé•</span> Production Team
                        </button>
                        <button onClick={() => downloadTalentsExcel(talentLibrary.filter(t => t.department === 'camera'), 'STAGE_Camera_Team')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üì∑</span> Camera Team
                        </button>
                        <button onClick={() => downloadTalentsExcel(talentLibrary.filter(t => t.department === 'cast'), 'STAGE_Cast_Members')} className="w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center gap-2 text-sm font-semibold">
                          <span>üé≠</span> Cast Members
                        </button>
                      </div>
                    </div>
                    {/* Add Talent Button */}
                    <button
                      onClick={() => setShowAddTalentModal(true)}
                      className="px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm rounded-xl font-bold transition-all flex items-center gap-2"
                    >
                      <span>‚ûï</span> Add
                    </button>
                  </div>
                </div>
              </div>

              {/* Library Search & Filters */}
              <div className="bg-white rounded-xl border-2 border-gray-200 p-4 shadow-md">
                <div className="flex flex-col md:flex-row gap-4">
                  <div className="flex-1">
                    <input
                      type="text"
                      value={librarySearchQuery}
                      onChange={(e) => setLibrarySearchQuery(e.target.value)}
                      placeholder="üîç Search by name, role, culture..."
                      className="w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl text-gray-900 placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20"
                    />
                  </div>
                  <select
                    value={selectedDepartment}
                    onChange={(e) => setSelectedDepartment(e.target.value)}
                    className="px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl text-gray-900 focus:outline-none focus:border-purple-500"
                  >
                    <option value="all">All Departments</option>
                    <option value="direction">Direction</option>
                    <option value="production">Production</option>
                    <option value="writing">Writing</option>
                    <option value="camera">Camera</option>
                    <option value="editing">Editing</option>
                    <option value="sound">Sound</option>
                    <option value="music">Music</option>
                    <option value="art">Art & Design</option>
                    <option value="costume">Costume & Makeup</option>
                    <option value="vfx">VFX & Post</option>
                    <option value="cast">Cast</option>
                  </select>
                </div>
              </div>

              {/* Department Stats - Clickable */}
              <div className="grid grid-cols-2 md:grid-cols-6 gap-3">
                {[
                  { id: 'all', label: 'All', icon: 'üìö', color: 'bg-gray-600' },
                  { id: 'direction', label: 'Direction', icon: 'üé¨', color: 'bg-red-500' },
                  { id: 'production', label: 'Production', icon: 'üé•', color: 'bg-blue-500' },
                  { id: 'writing', label: 'Writing', icon: '‚úçÔ∏è', color: 'bg-green-500' },
                  { id: 'camera', label: 'Camera', icon: 'üì∑', color: 'bg-yellow-500' },
                  { id: 'cast', label: 'Cast', icon: 'üé≠', color: 'bg-pink-500' },
                ].map((dept) => {
                  const count = dept.id === 'all' ? talentLibrary.length : talentLibrary.filter(t => t.department === dept.id).length;
                  return (
                    <button
                      key={dept.id}
                      onClick={() => setSelectedDepartment(dept.id)}
                      className={`bg-white border-2 rounded-xl p-4 shadow-md text-center transition-all hover:scale-105 ${
                        selectedDepartment === dept.id ? 'border-purple-500 ring-2 ring-purple-500/30' : 'border-gray-200'
                      }`}
                    >
                      <div className={`w-10 h-10 ${dept.color} rounded-full flex items-center justify-center mx-auto mb-2`}>
                        <span className="text-xl">{dept.icon}</span>
                      </div>
                      <div className="text-2xl font-black text-gray-900">{count}</div>
                      <div className="text-xs font-bold text-gray-500">{dept.label}</div>
                    </button>
                  );
                })}

              </div>

              {/* Talent Grid - From Library */}
              <div className="bg-white rounded-2xl border-2 border-gray-200 shadow-lg overflow-hidden">
                <div className="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-4">
                  <h3 className="text-xl font-black">
                    {selectedDepartment === 'all' ? 'All Talents' : selectedDepartment.charAt(0).toUpperCase() + selectedDepartment.slice(1) + ' Team'}
                  </h3>
                  <p className="text-sm opacity-80 font-semibold">
                    {talentLibrary.filter(t =>
                      (selectedDepartment === 'all' || t.department === selectedDepartment) &&
                      (librarySearchQuery === '' ||
                        t.name.toLowerCase().includes(librarySearchQuery.toLowerCase()) ||
                        t.role.toLowerCase().includes(librarySearchQuery.toLowerCase()) ||
                        t.culture?.toLowerCase().includes(librarySearchQuery.toLowerCase()))
                    ).length} members
                  </p>
                </div>
                <div className="p-4">
                  {talentLibrary.length === 0 ? (
                    <div className="text-center py-12">
                      <div className="text-6xl mb-4">üìö</div>
                      <h4 className="text-xl font-black text-gray-700 mb-2">No Talents Yet</h4>
                      <p className="text-gray-500 mb-4">Talents are auto-added when projects are approved or go to production</p>
                      <button
                        onClick={() => setShowAddTalentModal(true)}
                        className="px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold rounded-xl hover:shadow-lg transition-all"
                      >
                        ‚ûï Add Talent Manually
                      </button>
                    </div>
                  ) : (
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                      {talentLibrary
                        .filter(t =>
                          (selectedDepartment === 'all' || t.department === selectedDepartment) &&
                          (librarySearchQuery === '' ||
                            t.name.toLowerCase().includes(librarySearchQuery.toLowerCase()) ||
                            t.role.toLowerCase().includes(librarySearchQuery.toLowerCase()) ||
                            t.culture?.toLowerCase().includes(librarySearchQuery.toLowerCase()))
                        )
                        .map((talent) => (
                          <div
                            key={talent.id}
                            onClick={() => setSelectedTalent(talent)}
                            className="bg-gray-50 rounded-xl p-4 border-2 border-gray-200 hover:border-purple-400 hover:shadow-lg transition-all cursor-pointer group"
                          >
                            <div className="flex items-start gap-3">
                              <div className="w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-full flex items-center justify-center text-white font-black text-xl flex-shrink-0 group-hover:scale-110 transition-transform">
                                {talent.name.charAt(0).toUpperCase()}
                              </div>
                              <div className="flex-1 min-w-0">
                                <h4 className="font-black text-gray-900 truncate text-lg">{talent.name}</h4>
                                <p className="text-sm text-purple-600 font-bold">{talent.role}</p>
                                <div className="flex flex-wrap items-center gap-2 mt-2">
                                  <span className="px-2 py-0.5 bg-purple-100 text-purple-700 text-xs font-bold rounded-full">
                                    {talent.projects?.length || 0} projects
                                  </span>
                                  <span className="px-2 py-0.5 bg-gray-200 text-gray-600 text-xs font-bold rounded-full">
                                    {talent.culture}
                                  </span>
                                </div>
                                {talent.workLink && (
                                  <div className="mt-2 text-xs text-blue-500 truncate">
                                    üîó {talent.workLink}
                                  </div>
                                )}
                                {(talent.phone || talent.email) && (
                                  <div className="mt-1 text-xs text-gray-500">
                                    {talent.phone && <span>üì± {talent.phone}</span>}
                                  </div>
                                )}
                              </div>
                            </div>
                          </div>
                        ))}
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {/* PROJECTS TAB - Database Connected */}
          {activeTab === 'projects' && (
            <div className="space-y-6">
              <ProjectsManager />
            </div>
          )}

          {/* INVOICES TAB - Invoice Management */}
          {activeTab === 'invoices' && (
            <div className="space-y-6">
              <InvoiceManager />
            </div>
          )}

          {/* REPORTS TAB - Annual Reports & Budget Analytics */}
          {activeTab === 'reports' && (
            <div className="space-y-6">
              <div className="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                <h2 className="text-2xl font-bold text-gray-800 mb-2">Annual Reports & Budget Analytics</h2>
                <p className="text-gray-500">Track budget by culture, format, and generate annual reports</p>
              </div>
              <DashboardAnalytics />
            </div>
          )}

          {/* OLD PROJECTS TAB CODE - REMOVED, NOW USING ProjectsManager */}
          {false && (() => {
            const filteredProjects: any[] = [];

            // Budget format
            const formatBudget = (amount: number) => {
              if (!amount || amount === 0) return '‚Äî';
              const lakhs = amount / 100000;
              if (lakhs >= 100) return `‚Çπ${(lakhs / 100).toFixed(2)} Cr`;
              return `‚Çπ${lakhs.toFixed(2)} L`;
            };

            const updateProject = (projectId: string | number, field: string, value: string | number) => {
              console.log('Old code - disabled');
            };

            const deleteInternalProject = (projectId: string | number) => {
              console.log('Old code - disabled');
            };

            // Drag and Drop handlers
            const handleDragStart = (e: React.DragEvent, projectId: string | number) => {
              setDraggedRowId(String(projectId));
              e.dataTransfer.effectAllowed = 'move';
              e.dataTransfer.setData('text/plain', String(projectId));
            };

            const handleDragOver = (e: React.DragEvent, targetIndex: number) => {
              e.preventDefault();
              if (!draggedRowId) return;

              const draggedIndex = filteredProjects.findIndex(p => String(p.id) === draggedRowId);
              if (draggedIndex === -1 || draggedIndex === targetIndex) return;

              // Reorder the filtered projects
              const newFilteredProjects = [...filteredProjects];
              const [draggedProject] = newFilteredProjects.splice(draggedIndex, 1);
              newFilteredProjects.splice(targetIndex, 0, draggedProject);

              // Update the full internal projects array maintaining the new order
              const otherProjects = internalProjects.filter(s => !filteredProjects.some(fp => fp.id === s.id));
              const reorderedProjects = [...newFilteredProjects, ...otherProjects];

              setInternalProjects(reorderedProjects);
              localStorage.setItem('stage_internal_projects', JSON.stringify(reorderedProjects));
            };

            const handleDragEnd = () => {
              setDraggedRowId(null);
            };

            const statusOptions = [
              { value: 'loi_sent', label: 'LOI Sent' },
              { value: 'onboarding_form_sent', label: 'Onboarding Form Sent' },
              { value: 'budget_discussion', label: 'Budget Discussion' },
              { value: 'sent_for_agreement', label: 'Sent for Agreement' },
              { value: 'agreement_done', label: 'Agreement Done' },
              { value: 'insurance_pending', label: 'Insurance Pending' },
              { value: 'insurance_done', label: 'Insurance Done' },
              { value: 'shoot_started', label: 'Shoot Started' },
              { value: 'shoot_completed', label: 'Shoot Completed' },
              { value: 'post_production', label: 'Post Production' },
              { value: 'delivered', label: 'Delivered' },
              { value: 'approved', label: 'Approved' },
              { value: 'rejected', label: 'Rejected' },
              { value: 'on_hold', label: 'On Hold' },
            ];

            const allPOCs = [...['Mayank', 'Haidar', 'Sumit'], ...customPOCs];
            const cultureOptions = [...['Haryanvi', 'Rajasthani', 'Bhojpuri', 'Gujarati'], ...customCultures];
            const formatOptions = [...['Feature Film', 'Mini Film', 'Long Series', 'Limited Series', 'Microdrama'], ...customFormats];

            // Pastel status colors
            const statusColors: Record<string, string> = {
              'loi_sent': 'bg-blue-100 text-blue-800',
              'onboarding_form_sent': 'bg-indigo-100 text-indigo-800',
              'budget_discussion': 'bg-yellow-100 text-yellow-800',
              'sent_for_agreement': 'bg-orange-100 text-orange-800',
              'agreement_done': 'bg-green-100 text-green-800',
              'insurance_pending': 'bg-red-100 text-red-800',
              'insurance_done': 'bg-teal-100 text-teal-800',
              'shoot_started': 'bg-purple-100 text-purple-800',
              'shoot_completed': 'bg-emerald-100 text-emerald-800',
              'post_production': 'bg-pink-100 text-pink-800',
              'delivered': 'bg-cyan-100 text-cyan-800',
              'approved': 'bg-green-100 text-green-800',
              'rejected': 'bg-red-100 text-red-800',
              'on_hold': 'bg-gray-100 text-gray-800',
              'custom': 'bg-violet-100 text-violet-800',
            };

            // Culture colors
            const cultureColors: Record<string, string> = {
              'Haryanvi': 'bg-amber-100 text-amber-800',
              'Rajasthani': 'bg-orange-100 text-orange-800',
              'Bhojpuri': 'bg-rose-100 text-rose-800',
              'Gujarati': 'bg-emerald-100 text-emerald-800',
            };

            // Format colors
            const formatColors: Record<string, string> = {
              'Feature Film': 'bg-blue-100 text-blue-800',
              'Mini Film': 'bg-purple-100 text-purple-800',
              'Long Series': 'bg-green-100 text-green-800',
              'Limited Series': 'bg-cyan-100 text-cyan-800',
              'Microdrama': 'bg-pink-100 text-pink-800',
            };

            // Delete POC
            const deletePOC = (pocName: string) => {
              const updatedProjects = internalProjects.map(s =>
                s.productionPOC === pocName ? { ...s, productionPOC: '' } : s
              );
              setInternalProjects(updatedProjects);
              localStorage.setItem('stage_internal_projects', JSON.stringify(updatedProjects));
              if (customPOCs.includes(pocName)) {
                setCustomPOCs(customPOCs.filter(p => p !== pocName));
              }
            };

            // Export function
            const exportData = (format: 'excel' | 'pdf', filterType?: string, filterValue?: string) => {
              let dataToExport = [...internalProjects];

              if (filterType && filterValue) {
                dataToExport = dataToExport.filter(s => s[filterType] === filterValue);
              }

              const exportRows = dataToExport.map((s, idx) => {
                const budget = parseFloat(s.totalBudget) || 0;
                const overcost = parseFloat(s.overcost) || 0;
                const insurance = parseFloat(s.insurance) || 0;
                const custom = parseFloat(s.customBudget) || 0;
                const customLabel = s.customBudgetLabel || 'Custom';
                const total = budget + overcost + insurance + custom;
                return {
                  'S.No': idx + 1,
                  'Project Name': s.projectName || '-',
                  'Creator': s.creatorName || s.creator || '-',
                  'Culture': s.culture || '-',
                  'Format': s.format || '-',
                  'Production POC': s.productionPOC || '-',
                  'Shoot Start Date': s.shootStartDate || '-',
                  'Status': statusOptions.find(o => o.value === s.status)?.label || s.customStatus || s.status || '-',
                  'Budget (L)': (budget / 100000).toFixed(2),
                  'Overcost (L)': (overcost / 100000).toFixed(2),
                  'Insurance (L)': (insurance / 100000).toFixed(2),
                  [customLabel + ' (L)']: (custom / 100000).toFixed(2),
                  'Total (L)': (total / 100000).toFixed(2),
                };
              });

              if (format === 'excel') {
                const XLSX = require('xlsx');
                const ws = XLSX.utils.json_to_sheet(exportRows);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Projects');
                const fileName = filterType && filterValue
                  ? `STAGE_${filterValue}_Projects.xlsx`
                  : 'STAGE_All_Projects.xlsx';
                XLSX.writeFile(wb, fileName);
              } else if (format === 'pdf') {
                // PDF Export - opens printable HTML in new window
                const grandTotal = dataToExport.reduce((sum, p) => sum + (parseFloat(p.totalBudget) || 0) + (parseFloat(p.overcost) || 0) + (parseFloat(p.insurance) || 0) + (parseFloat(p.customBudget) || 0), 0);
                const filterTitle = filterType && filterValue ? filterValue + ' ' : 'All ';
                const dateStr = new Date().toLocaleDateString('en-IN', { dateStyle: 'full' });
                const rowsHtml = exportRows.map(r =>
                  '<tr><td>' + r['S.No'] + '</td><td>' + r['Project Name'] + '</td><td>' + r['Creator'] + '</td><td>' + r['Culture'] + '</td><td>' + r['Format'] + '</td><td>' + r['Production POC'] + '</td><td>' + r['Status'] + '</td><td class="budget">' + r['Budget (L)'] + '</td><td class="budget">' + r['Overcost (L)'] + '</td><td class="budget">' + r['Insurance (L)'] + '</td><td class="budget total">' + r['Total (L)'] + '</td></tr>'
                ).join('');
                const html = '<!DOCTYPE html><html><head><title>STAGE ' + filterTitle + 'Projects Report</title><style>body{font-family:Arial,sans-serif;padding:20px;color:#333}h1{color:#1e40af;margin-bottom:5px}.subtitle{color:#666;margin-bottom:20px;font-size:14px}table{width:100%;border-collapse:collapse;margin:20px 0;font-size:11px}th{background:#f1f5f9;padding:8px;text-align:left;border:1px solid #e2e8f0;font-weight:600}td{padding:6px 8px;border:1px solid #e2e8f0}tr:nth-child(even){background:#f8fafc}.summary{background:#f0fdf4;padding:15px;border-radius:8px;margin-top:20px}.summary-title{font-weight:bold;color:#166534}.budget{text-align:right;font-weight:500}.total{font-weight:700;color:#166534;background:#f0fdf4}@media print{body{padding:10px}}</style></head><body><h1>STAGE ' + filterTitle + 'Projects Report</h1><p class="subtitle">Generated: ' + dateStr + ' | ' + dataToExport.length + ' Projects</p><table><thead><tr><th>#</th><th>Project</th><th>Creator</th><th>Culture</th><th>Format</th><th>POC</th><th>Status</th><th style="text-align:right">Budget</th><th style="text-align:right">Overcost</th><th style="text-align:right">Insurance</th><th style="text-align:right;background:#f0fdf4">Total</th></tr></thead><tbody>' + rowsHtml + '</tbody></table><div class="summary"><span class="summary-title">Grand Total: </span><span class="budget total">' + formatBudget(grandTotal) + '</span></div><script>window.onload=function(){window.print();}</script></body></html>';
                const printWindow = window.open('', '_blank');
                if (printWindow) {
                  printWindow.document.write(html);
                  printWindow.document.close();
                }
              }
            };

            const totalBudget = filteredProjects.reduce((sum, p) => sum + (parseFloat(p.totalBudget) || 0), 0);

            return (
            <div className="min-h-screen bg-gray-50 -m-6 p-6">
              {/* Header */}
              <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-4">
                <div className="flex flex-wrap items-center justify-between gap-4">
                  <div>
                    <h1 className="text-2xl font-bold text-gray-800">Projects Tracker <span className="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full ml-2">Internal</span></h1>
                    <p className="text-gray-500 text-sm">{filteredProjects.length} projects ‚Ä¢ Total: <span className="text-green-600 font-semibold">{formatBudget(totalBudget)}</span> <span className="text-gray-400 text-xs ml-2">(Separate from Submissions)</span></p>
                  </div>
                  <div className="flex flex-wrap gap-2">
                    <button onClick={() => exportData('excel')} className="px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg text-sm font-medium">üì• Excel</button>
                    <button onClick={() => exportData('pdf')} className="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm font-medium">üìÑ PDF</button>

                    {/* Export Dropdown */}
                    <div className="relative group">
                      <button className="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium">üìä Export Filter ‚ñº</button>
                      <div className="absolute right-0 top-full mt-1 bg-white rounded-xl shadow-xl border border-gray-200 py-2 w-64 hidden group-hover:block z-50 max-h-96 overflow-y-auto">
                        <p className="px-4 py-1 text-xs text-gray-400 uppercase font-semibold">By Culture</p>
                        {cultureOptions.map(c => (
                          <div key={c} className="flex">
                            <button onClick={() => exportData('excel', 'culture', c)} className="flex-1 px-4 py-2 text-left text-sm hover:bg-green-50 text-gray-700">üì• {c}</button>
                            <button onClick={() => exportData('pdf', 'culture', c)} className="px-3 py-2 text-sm hover:bg-red-50 text-red-600">PDF</button>
                          </div>
                        ))}
                        <hr className="my-2" />
                        <p className="px-4 py-1 text-xs text-gray-400 uppercase font-semibold">By Format</p>
                        {formatOptions.map(f => (
                          <div key={f} className="flex">
                            <button onClick={() => exportData('excel', 'format', f)} className="flex-1 px-4 py-2 text-left text-sm hover:bg-green-50 text-gray-700">üì• {f}</button>
                            <button onClick={() => exportData('pdf', 'format', f)} className="px-3 py-2 text-sm hover:bg-red-50 text-red-600">PDF</button>
                          </div>
                        ))}
                        <hr className="my-2" />
                        <p className="px-4 py-1 text-xs text-gray-400 uppercase font-semibold">By POC</p>
                        {allPOCs.map(p => (
                          <div key={p} className="flex">
                            <button onClick={() => exportData('excel', 'productionPOC', p)} className="flex-1 px-4 py-2 text-left text-sm hover:bg-green-50 text-gray-700">üì• {p}</button>
                            <button onClick={() => exportData('pdf', 'productionPOC', p)} className="px-3 py-2 text-sm hover:bg-red-50 text-red-600">PDF</button>
                          </div>
                        ))}
                        <hr className="my-2" />
                        <p className="px-4 py-1 text-xs text-gray-400 uppercase font-semibold">By Status</p>
                        {statusOptions.slice(0, 6).map(s => (
                          <div key={s.value} className="flex">
                            <button onClick={() => exportData('excel', 'status', s.value)} className="flex-1 px-4 py-2 text-left text-sm hover:bg-green-50 text-gray-700">üì• {s.label}</button>
                            <button onClick={() => exportData('pdf', 'status', s.value)} className="px-3 py-2 text-sm hover:bg-red-50 text-red-600">PDF</button>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              {/* Culture Filter Pills */}
              <div className="flex flex-wrap gap-2 mb-4">
                <button
                  onClick={() => setProjectsCultureFilter('all')}
                  className={`px-4 py-2 rounded-full text-sm font-medium transition-all ${
                    projectsCultureFilter === 'all' ? 'bg-gray-800 text-white' : 'bg-white text-gray-600 border border-gray-300 hover:bg-gray-50'
                  }`}
                >All ({submissions.length})</button>
                {cultureOptions.map(culture => {
                  const count = submissions.filter(s => s.culture === culture).length;
                  return (
                    <button
                      key={culture}
                      onClick={() => setProjectsCultureFilter(culture)}
                      className={`px-4 py-2 rounded-full text-sm font-medium transition-all ${
                        projectsCultureFilter === culture
                          ? cultureColors[culture]?.replace('100', '500').replace('800', 'white') + ' text-white'
                          : `${cultureColors[culture]} border border-gray-200 hover:shadow-sm`
                      }`}
                    >{culture} ({count})</button>
                  );
                })}
              </div>

              {/* Table */}
              <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-x-auto">
                <table className="w-full">
                  <thead>
                    <tr className="bg-gray-50 border-b border-gray-200">
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase w-12">#</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[180px]">Project</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[140px]">Creator</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[100px]">Culture</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[120px]">Format</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[140px]">POC (Prod/Content)</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[130px]">Shoot Start</th>
                      <th className="px-3 py-3 text-left text-gray-600 text-xs font-semibold uppercase min-w-[160px]">Status</th>
                      <th className="px-3 py-3 text-right text-gray-600 text-xs font-semibold uppercase min-w-[130px]">Budget</th>
                      <th className="px-3 py-3 text-center text-gray-600 text-xs font-semibold uppercase w-16">Actions</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-100">
                      {filteredProjects.map((project, index) => (
                        <tr
                          key={project.id}
                          draggable
                          onDragStart={(e) => handleDragStart(e, project.id)}
                          onDragOver={(e) => handleDragOver(e, index)}
                          onDragEnd={handleDragEnd}
                          className={`hover:bg-blue-50/50 transition-colors cursor-move ${draggedRowId === String(project.id) ? 'opacity-50 bg-blue-100' : ''}`}
                        >
                          {/* Drag Handle + # */}
                          <td className="px-3 py-3 text-gray-500 text-sm font-medium">
                            <div className="flex items-center gap-2">
                              <span className="cursor-grab active:cursor-grabbing text-gray-300 hover:text-gray-500">‚ãÆ‚ãÆ</span>
                              <span>{index + 1}</span>
                            </div>
                          </td>

                          {/* Project */}
                          <td className="px-3 py-2">
                            <input
                              type="text"
                              value={project.projectName || ''}
                              onChange={(e) => updateProject(project.id, 'projectName', e.target.value)}
                              className="w-full px-2 py-1.5 text-sm font-semibold bg-white border border-gray-200 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-blue-400"
                              placeholder="Project name..."
                            />
                          </td>

                          {/* Creator */}
                          <td className="px-3 py-2">
                            <input
                              type="text"
                              value={project.creatorName || project.creator || ''}
                              onChange={(e) => updateProject(project.id, 'creatorName', e.target.value)}
                              className="w-full px-2 py-1.5 text-sm bg-white border border-gray-200 rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-blue-400"
                              placeholder="Creator..."
                            />
                          </td>

                          {/* Culture - Colored Badge with Add */}
                          <td className="px-3 py-2">
                            <select
                              value={project.culture || ''}
                              onChange={(e) => {
                                if (e.target.value === '__add_new__') {
                                  setShowAddCultureModal(true);
                                } else {
                                  updateProject(project.id, 'culture', e.target.value);
                                }
                              }}
                              className={`w-full px-2 py-1.5 text-xs font-semibold rounded-full cursor-pointer focus:outline-none ${cultureColors[project.culture] || 'bg-gray-100 text-gray-600'}`}
                            >
                              <option value="">Select</option>
                              {cultureOptions.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                              <option value="__add_new__">‚ûï Add New</option>
                            </select>
                          </td>

                          {/* Format - Colored Badge with Add */}
                          <td className="px-3 py-2">
                            <select
                              value={project.format || ''}
                              onChange={(e) => {
                                if (e.target.value === '__add_new__') {
                                  setShowAddFormatModal(true);
                                } else {
                                  updateProject(project.id, 'format', e.target.value);
                                }
                              }}
                              className={`w-full px-2 py-1.5 text-xs font-semibold rounded-full cursor-pointer focus:outline-none ${formatColors[project.format] || 'bg-gray-100 text-gray-600'}`}
                            >
                              <option value="">Select</option>
                              {formatOptions.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                              <option value="__add_new__">‚ûï Add New</option>
                            </select>
                          </td>

                          {/* Production POC & Content POC */}
                          <td className="px-3 py-2">
                            <div className="space-y-1">
                              <select
                                value={project.productionPOC || ''}
                                onChange={(e) => {
                                  if (e.target.value === '__add_new__') {
                                    setShowAddPOCModal(true);
                                  } else {
                                    updateProject(project.id, 'productionPOC', e.target.value);
                                  }
                                }}
                                className="w-full px-2 py-1 text-xs bg-blue-50 border border-blue-200 rounded-lg text-blue-700 cursor-pointer focus:outline-none"
                              >
                                <option value="">Prod POC</option>
                                {allPOCs.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                <option value="__add_new__">‚ûï Add</option>
                              </select>
                              <select
                                value={project.contentPOC || ''}
                                onChange={(e) => {
                                  if (e.target.value === '__add_new__') {
                                    setShowAddPOCModal(true);
                                  } else {
                                    updateProject(project.id, 'contentPOC', e.target.value);
                                  }
                                }}
                                className="w-full px-2 py-1 text-xs bg-pink-50 border border-pink-200 rounded-lg text-pink-700 cursor-pointer focus:outline-none"
                              >
                                <option value="">Content POC</option>
                                {allPOCs.map(opt => <option key={opt} value={opt}>{opt}</option>)}
                                <option value="__add_new__">‚ûï Add</option>
                              </select>
                            </div>
                          </td>

                          {/* Shoot Start Date Only */}
                          <td className="px-3 py-2">
                            <input
                              type="date"
                              value={project.shootStartDate || ''}
                              onChange={(e) => updateProject(project.id, 'shootStartDate', e.target.value)}
                              className="w-full px-2 py-1.5 text-sm bg-white border border-gray-200 rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-200"
                            />
                          </td>

                          {/* Status with Custom Option */}
                          <td className="px-3 py-2">
                            {project.status === 'custom' ? (
                              <input
                                type="text"
                                value={project.customStatus || ''}
                                onChange={(e) => updateProject(project.id, 'customStatus', e.target.value)}
                                placeholder="Enter status..."
                                className="w-full px-2 py-1.5 text-xs font-semibold bg-violet-100 text-violet-800 rounded-full focus:outline-none"
                              />
                            ) : (
                              <select
                                value={project.status || ''}
                                onChange={(e) => updateProject(project.id, 'status', e.target.value)}
                                className={`w-full px-2 py-1.5 text-xs font-semibold rounded-full cursor-pointer focus:outline-none ${statusColors[project.status] || 'bg-gray-100 text-gray-600'}`}
                              >
                                <option value="">Select</option>
                                {statusOptions.map(opt => <option key={opt.value} value={opt.value}>{opt.label}</option>)}
                                <option value="custom">+ Custom Status</option>
                              </select>
                            )}
                          </td>

                          {/* Budget - Click to expand */}
                          <td className="px-3 py-2 relative">
                            {(() => {
                              const totalWithExtras = (parseFloat(project.totalBudget) || 0) +
                                (parseFloat(project.overcost) || 0) +
                                (parseFloat(project.insurance) || 0) +
                                (parseFloat(project.customBudget) || 0);
                              const hasExtras = (parseFloat(project.overcost) || 0) > 0 ||
                                (parseFloat(project.insurance) || 0) > 0 ||
                                (parseFloat(project.customBudget) || 0) > 0;
                              return (
                                <div className="group relative">
                                  <div className="flex items-center justify-end gap-1">
                                    <input
                                      type="number"
                                      value={project.totalBudget ? Math.round(parseFloat(project.totalBudget) / 100000) : ''}
                                      onChange={(e) => {
                                        const lakhs = parseFloat(e.target.value) || 0;
                                        updateProject(project.id, 'totalBudget', String(lakhs * 100000));
                                      }}
                                      className="w-16 px-2 py-1.5 text-sm font-bold text-right bg-green-50 border border-green-200 rounded-lg text-green-700 focus:outline-none focus:ring-2 focus:ring-green-200"
                                      placeholder="0"
                                    />
                                    <span className="text-gray-400 text-xs">L</span>
                                    <button className="ml-1 w-5 h-5 rounded bg-gray-100 hover:bg-blue-100 text-gray-500 hover:text-blue-600 text-xs font-bold flex items-center justify-center">+</button>
                                  </div>
                                  {hasExtras && (
                                    <div className="text-[10px] text-gray-400 text-right mt-0.5">
                                      Total: {formatBudget(totalWithExtras)}
                                    </div>
                                  )}
                                  {/* Hover Popup for extra costs */}
                                  <div className="absolute right-0 top-full mt-1 bg-white rounded-xl shadow-xl border border-gray-200 p-3 w-48 hidden group-hover:block z-50">
                                    <div className="text-xs font-semibold text-gray-500 mb-2">Extra Costs</div>
                                    <div className="space-y-2">
                                      <div className="flex items-center justify-between gap-2">
                                        <span className="text-xs text-orange-600">Overcost</span>
                                        <div className="flex items-center gap-1">
                                          <input
                                            type="number"
                                            value={project.overcost ? Math.round(parseFloat(project.overcost) / 100000) : ''}
                                            onChange={(e) => {
                                              const lakhs = parseFloat(e.target.value) || 0;
                                              updateProject(project.id, 'overcost', String(lakhs * 100000));
                                            }}
                                            className="w-14 px-2 py-1 text-xs text-right bg-orange-50 border border-orange-200 rounded text-orange-700 focus:outline-none"
                                            placeholder="0"
                                          />
                                          <span className="text-gray-400 text-[10px]">L</span>
                                        </div>
                                      </div>
                                      <div className="flex items-center justify-between gap-2">
                                        <span className="text-xs text-purple-600">Insurance</span>
                                        <div className="flex items-center gap-1">
                                          <input
                                            type="number"
                                            value={project.insurance ? Math.round(parseFloat(project.insurance) / 100000) : ''}
                                            onChange={(e) => {
                                              const lakhs = parseFloat(e.target.value) || 0;
                                              updateProject(project.id, 'insurance', String(lakhs * 100000));
                                            }}
                                            className="w-14 px-2 py-1 text-xs text-right bg-purple-50 border border-purple-200 rounded text-purple-700 focus:outline-none"
                                            placeholder="0"
                                          />
                                          <span className="text-gray-400 text-[10px]">L</span>
                                        </div>
                                      </div>
                                      {/* Custom Expense with Description */}
                                      <div className="border-t border-gray-100 pt-2 mt-1">
                                        <div className="text-xs font-semibold text-blue-600 mb-1">Custom Expense</div>
                                        <input
                                          type="text"
                                          value={project.customBudgetLabel || ''}
                                          onChange={(e) => updateProject(project.id, 'customBudgetLabel', e.target.value)}
                                          className="w-full px-2 py-1 text-xs bg-blue-50 border border-blue-200 rounded text-blue-700 focus:outline-none mb-1"
                                          placeholder="e.g. Celebrity Fee, Marketing..."
                                        />
                                        <div className="flex items-center justify-end gap-1">
                                          <span className="text-gray-400 text-[10px]">‚Çπ</span>
                                          <input
                                            type="number"
                                            value={project.customBudget ? Math.round(parseFloat(project.customBudget) / 100000) : ''}
                                            onChange={(e) => {
                                              const lakhs = parseFloat(e.target.value) || 0;
                                              updateProject(project.id, 'customBudget', String(lakhs * 100000));
                                            }}
                                            className="w-14 px-2 py-1 text-xs text-right bg-gray-50 border border-gray-200 rounded text-gray-700 focus:outline-none"
                                            placeholder="0"
                                          />
                                          <span className="text-gray-400 text-[10px]">L</span>
                                        </div>
                                      </div>
                                      <div className="pt-2 border-t border-gray-100 flex justify-between mt-2">
                                        <span className="text-xs font-semibold text-green-700">Total</span>
                                        <span className="text-xs font-bold text-green-700">{formatBudget(totalWithExtras)}</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              );
                            })()}
                          </td>

                          {/* Delete Action */}
                          <td className="px-3 py-2 text-center">
                            <button
                              onClick={() => {
                                if (confirm(`Delete "${project.projectName || 'this project'}"? This cannot be undone.`)) {
                                  deleteInternalProject(project.id);
                                }
                              }}
                              className="w-8 h-8 bg-red-100 hover:bg-red-500 rounded-lg flex items-center justify-center text-red-500 hover:text-white transition-all mx-auto"
                              title="Delete Project"
                            >
                              üóëÔ∏è
                            </button>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                  {/* Add Project Row Button */}
                  <div className="bg-green-50 border-t border-green-200">
                    <button
                      onClick={() => {
                        const newProjectId = `internal-${Date.now()}`;
                        const newProject = {
                          id: newProjectId,
                          projectName: '',
                          creator: '',
                          creatorName: '',
                          culture: '',
                          format: '',
                          productionPOC: '',
                          contentPOC: '',
                          shootStartDate: '',
                          status: 'loi_sent',
                          totalBudget: 0,
                          overcost: 0,
                          insurance: 0,
                          customBudget: 0,
                          customBudgetLabel: '',
                          createdAt: new Date().toISOString(),
                        };
                        const updatedProjects = [...internalProjects, newProject];
                        setInternalProjects(updatedProjects);
                        localStorage.setItem('stage_internal_projects', JSON.stringify(updatedProjects));
                      }}
                      className="w-full px-4 py-3 text-green-700 font-bold hover:bg-green-100 transition-all flex items-center justify-center gap-2"
                    >
                      <span className="text-xl">‚ûï</span>
                      <span>Add New Project Row</span>
                    </button>
                  </div>
                  {/* Footer */}
                  <div className="bg-gray-50 px-4 py-3 border-t border-gray-200 flex items-center justify-between">
                    <span className="text-gray-500 text-sm">{filteredProjects.length} projects ‚Ä¢ Hover on + for extras</span>
                    <span className="text-green-700 font-bold text-lg">Total: {formatBudget(
                      filteredProjects.reduce((sum, p) => sum +
                        (parseFloat(p.totalBudget) || 0) +
                        (parseFloat(p.overcost) || 0) +
                        (parseFloat(p.insurance) || 0) +
                        (parseFloat(p.customBudget) || 0), 0)
                    )}</span>
                  </div>
                </div>

              {/* POC Tracker - Light Soothing Theme */}
              <div className="bg-white rounded-2xl border border-gray-200 shadow-sm p-6 mt-6">
                <div className="flex items-center justify-between mb-6">
                  <div>
                    <h2 className="text-xl font-bold text-gray-800">Team Overview</h2>
                    <p className="text-sm text-gray-500">POC assignments with culture & format breakdown</p>
                  </div>
                  <div className="flex gap-2">
                    <button
                      onClick={() => setShowAddPOCModal(true)}
                      className="px-4 py-2 bg-blue-100 hover:bg-blue-200 rounded-xl text-sm font-bold text-blue-700 transition-all"
                    >
                      + Production POC
                    </button>
                    <button
                      onClick={() => setShowAddPOCModal(true)}
                      className="px-4 py-2 bg-pink-100 hover:bg-pink-200 rounded-xl text-sm font-bold text-pink-700 transition-all"
                    >
                      + Content POC
                    </button>
                  </div>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                  {allPOCs.map((poc, pocIndex) => {
                    const pocProjects = internalProjects.filter(s => s.productionPOC === poc);
                    const bgColors = ['bg-blue-50 border-blue-200', 'bg-purple-50 border-purple-200', 'bg-teal-50 border-teal-200', 'bg-amber-50 border-amber-200', 'bg-rose-50 border-rose-200'];
                    const textColors = ['text-blue-600', 'text-purple-600', 'text-teal-600', 'text-amber-600', 'text-rose-600'];
                    const avatarColors = ['bg-blue-100', 'bg-purple-100', 'bg-teal-100', 'bg-amber-100', 'bg-rose-100'];
                    const bgColor = bgColors[pocIndex % bgColors.length];
                    const textColor = textColors[pocIndex % textColors.length];
                    const avatarColor = avatarColors[pocIndex % avatarColors.length];
                    const pocBudget = pocProjects.reduce((sum, p) => sum + (parseFloat(p.totalBudget) || 0), 0);

                    return (
                      <div
                        key={poc}
                        onClick={() => setSelectedPOC(selectedPOC === poc ? null : poc)}
                        className={`${bgColor} border-2 rounded-xl p-4 cursor-pointer hover:shadow-lg transition-all ${selectedPOC === poc ? 'ring-2 ring-blue-400' : ''}`}
                      >
                        <div className="flex items-center justify-between mb-3">
                          <div className="flex items-center gap-3">
                            <div className={`w-10 h-10 rounded-full ${avatarColor} ${textColor} flex items-center justify-center text-lg font-bold`}>
                              {poc.charAt(0)}
                            </div>
                            <div>
                              <h3 className={`font-bold ${textColor}`}>{poc}</h3>
                              <p className="text-xs text-gray-500">Production POC</p>
                            </div>
                          </div>
                          <button
                            onClick={(e) => {
                              e.stopPropagation();
                              if (confirm(`Remove ${poc}? ${pocProjects.length} projects will be unassigned.`)) {
                                deletePOC(poc);
                              }
                            }}
                            className="w-6 h-6 bg-red-100 hover:bg-red-500 rounded flex items-center justify-center text-red-500 hover:text-white transition-all text-sm"
                          >√ó</button>
                        </div>

                        <div className="grid grid-cols-2 gap-2 text-sm">
                          <div className="bg-white/80 rounded-lg p-2 text-center border border-gray-100">
                            <div className={`text-2xl font-bold ${textColor}`}>{pocProjects.length}</div>
                            <div className="text-xs text-gray-500">Projects</div>
                          </div>
                          <div className="bg-white/80 rounded-lg p-2 text-center border border-gray-100">
                            <div className="text-lg font-bold text-emerald-600">{formatBudget(pocBudget)}</div>
                            <div className="text-xs text-gray-500">Budget</div>
                          </div>
                        </div>

                        <div className="mt-3 pt-3 border-t border-gray-200 grid grid-cols-2 gap-1 text-xs">
                          {cultureOptions.slice(0, 4).map(c => (
                            <div key={c} className="flex justify-between px-2 py-1 bg-white/80 rounded border border-gray-100">
                              <span className="text-gray-600">{c}</span>
                              <span className="font-semibold text-gray-800">{pocProjects.filter(p => p.culture === c).length}</span>
                            </div>
                          ))}
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* POC Detail Panel - Light Theme */}
              {selectedPOC && (() => {
                const pocProjects = internalProjects.filter(s => s.productionPOC === selectedPOC);
                const pocBudget = pocProjects.reduce((sum, p) => sum + (parseFloat(p.totalBudget) || 0), 0);
                return (
                  <div className="bg-white rounded-2xl border border-gray-200 shadow-sm p-6 mt-4">
                    <div className="flex items-center justify-between mb-4">
                      <div>
                        <h3 className="text-xl font-bold text-gray-800">{selectedPOC}&apos;s Projects</h3>
                        <p className="text-sm text-gray-500">{pocProjects.length} projects ‚Ä¢ {formatBudget(pocBudget)} total</p>
                      </div>
                      <button onClick={() => setSelectedPOC(null)} className="text-gray-400 hover:text-gray-700 text-2xl">√ó</button>
                    </div>

                    {/* Matrix */}
                    <div className="overflow-x-auto mb-4 bg-gray-50 rounded-xl p-4 border border-gray-200">
                      <table className="w-full text-sm">
                        <thead>
                          <tr className="border-b border-gray-200">
                            <th className="text-left py-2 px-3 text-gray-600 font-medium">Culture</th>
                            {formatOptions.map(f => <th key={f} className="text-center py-2 px-2 text-gray-600 font-medium text-xs">{f}</th>)}
                            <th className="text-right py-2 px-3 text-gray-600 font-medium">Total</th>
                          </tr>
                        </thead>
                        <tbody>
                          {cultureOptions.slice(0, 4).map(c => (
                            <tr key={c} className="border-b border-gray-100">
                              <td className="py-2 px-3 font-medium text-gray-800">{c}</td>
                              {formatOptions.map(f => {
                                const cnt = pocProjects.filter(p => p.culture === c && p.format === f).length;
                                return <td key={f} className="text-center py-2 px-2">{cnt > 0 ? <span className="bg-emerald-100 text-emerald-700 px-2 py-0.5 rounded-full text-xs font-semibold">{cnt}</span> : <span className="text-gray-300">‚Äî</span>}</td>;
                              })}
                              <td className="text-right py-2 px-3 font-bold text-gray-800">{pocProjects.filter(p => p.culture === c).length}</td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>

                    {/* List */}
                    <div className="space-y-2 max-h-60 overflow-y-auto">
                      {pocProjects.map((p, i) => (
                        <div key={p.id} className="bg-gray-50 rounded-lg p-3 flex items-center justify-between border border-gray-200">
                          <div className="flex items-center gap-3">
                            <span className="text-gray-500 font-medium">{i + 1}.</span>
                            <div>
                              <div className="font-semibold text-gray-800">{p.projectName || 'Untitled'}</div>
                              <div className="text-xs text-gray-500">{p.culture} ‚Ä¢ {p.format}</div>
                            </div>
                          </div>
                          <div className="flex items-center gap-3">
                            <div className="text-right">
                              <div className="text-emerald-600 font-semibold">{formatBudget(parseFloat(p.totalBudget) || 0)}</div>
                              <span className={`text-xs px-2 py-0.5 rounded-full ${statusColors[p.status] || 'bg-gray-200 text-gray-600'}`}>
                                {statusOptions.find(o => o.value === p.status)?.label || p.status || 'N/A'}
                              </span>
                            </div>
                            <button
                              onClick={() => {
                                if (confirm(`Delete "${p.projectName}"? This cannot be undone.`)) {
                                  deleteInternalProject(p.id);
                                }
                              }}
                              className="w-8 h-8 bg-red-100 hover:bg-red-500 rounded-lg flex items-center justify-center text-red-500 hover:text-white transition-all"
                              title="Delete Project"
                            >
                              üóëÔ∏è
                            </button>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                );
              })()}

              {/* Add POC Modal - Light Theme */}
              {showAddPOCModal && (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40" onClick={() => setShowAddPOCModal(false)}>
                  <div className="bg-white rounded-2xl shadow-xl border border-gray-200 p-6 w-full max-w-sm" onClick={e => e.stopPropagation()}>
                    <h3 className="text-xl font-bold text-gray-800 mb-4">Add Team Member</h3>
                    <input
                      type="text"
                      value={newPOCName}
                      onChange={(e) => setNewPOCName(e.target.value)}
                      placeholder="Enter name..."
                      className="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-300 text-gray-800 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 mb-4"
                      autoFocus
                    />
                    <div className="flex gap-3">
                      <button
                        onClick={() => setShowAddPOCModal(false)}
                        className="flex-1 px-4 py-2.5 rounded-xl bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium transition-colors"
                      >Cancel</button>
                      <button
                        onClick={() => {
                          if (newPOCName.trim() && !allPOCs.includes(newPOCName.trim())) {
                            setCustomPOCs([...customPOCs, newPOCName.trim()]);
                            setNewPOCName('');
                            setShowAddPOCModal(false);
                          }
                        }}
                        className="flex-1 px-4 py-2.5 rounded-xl bg-blue-600 hover:bg-blue-500 text-white font-medium transition-colors"
                      >Add POC</button>
                    </div>
                  </div>
                </div>
              )}

              {/* Add Culture Modal - Light Theme */}
              {showAddCultureModal && (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40" onClick={() => setShowAddCultureModal(false)}>
                  <div className="bg-white rounded-2xl shadow-xl border border-gray-200 p-6 w-full max-w-sm" onClick={e => e.stopPropagation()}>
                    <h3 className="text-xl font-bold text-gray-800 mb-4">Add New Culture</h3>
                    <input
                      type="text"
                      value={newCultureName}
                      onChange={(e) => setNewCultureName(e.target.value)}
                      placeholder="Enter culture name..."
                      className="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-300 text-gray-800 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500 mb-4"
                      autoFocus
                    />
                    <div className="flex gap-3">
                      <button
                        onClick={() => setShowAddCultureModal(false)}
                        className="flex-1 px-4 py-2.5 rounded-xl bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium transition-colors"
                      >Cancel</button>
                      <button
                        onClick={() => {
                          if (newCultureName.trim() && !cultureOptions.includes(newCultureName.trim())) {
                            setCustomCultures([...customCultures, newCultureName.trim()]);
                            setNewCultureName('');
                            setShowAddCultureModal(false);
                          }
                        }}
                        className="flex-1 px-4 py-2.5 rounded-xl bg-amber-500 hover:bg-amber-600 text-white font-medium transition-colors"
                      >Add Culture</button>
                    </div>
                  </div>
                </div>
              )}

              {/* Add Format Modal - Light Theme */}
              {showAddFormatModal && (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40" onClick={() => setShowAddFormatModal(false)}>
                  <div className="bg-white rounded-2xl shadow-xl border border-gray-200 p-6 w-full max-w-sm" onClick={e => e.stopPropagation()}>
                    <h3 className="text-xl font-bold text-gray-800 mb-4">Add New Format</h3>
                    <input
                      type="text"
                      value={newFormatName}
                      onChange={(e) => setNewFormatName(e.target.value)}
                      placeholder="Enter format name..."
                      className="w-full px-4 py-3 rounded-xl bg-gray-50 border border-gray-300 text-gray-800 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 mb-4"
                      autoFocus
                    />
                    <div className="flex gap-3">
                      <button
                        onClick={() => setShowAddFormatModal(false)}
                        className="flex-1 px-4 py-2.5 rounded-xl bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium transition-colors"
                      >Cancel</button>
                      <button
                        onClick={() => {
                          if (newFormatName.trim() && !formatOptions.includes(newFormatName.trim())) {
                            setCustomFormats([...customFormats, newFormatName.trim()]);
                            setNewFormatName('');
                            setShowAddFormatModal(false);
                          }
                        }}
                        className="flex-1 px-4 py-2.5 rounded-xl bg-purple-500 hover:bg-purple-600 text-white font-medium transition-colors"
                      >Add Format</button>
                    </div>
                  </div>
                </div>
              )}

            </div>
            );
          })()}

          {/* DOCUMENTS TAB - Production Templates & SOPs */}
          {activeTab === 'documents' && (
            <div className="min-h-screen bg-gray-50 -m-6 p-6">
              {/* Header */}
              <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6">
                <div className="flex items-center justify-between">
                  <div>
                    <h1 className="text-2xl font-bold text-gray-800">Production Documents</h1>
                    <p className="text-gray-500">SOPs, Formats, Templates - Share with your team</p>
                  </div>
                  <button
                    onClick={() => {
                      const input = document.createElement('input');
                      input.type = 'file';
                      input.accept = '.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.png';
                      input.onchange = (e: any) => {
                        const file = e.target.files[0];
                        if (file) {
                          // In production, upload to cloud storage
                          const newDoc = {
                            id: 'doc-' + Date.now(),
                            name: file.name,
                            category: 'Other',
                            url: URL.createObjectURL(file),
                            uploadedAt: new Date().toISOString(),
                          };
                          const updatedDocs = [...productionDocs, newDoc];
                          setProductionDocs(updatedDocs);
                          localStorage.setItem('production_docs', JSON.stringify(updatedDocs));
                        }
                      };
                      input.click();
                    }}
                    className="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2"
                  >
                    <span>üì§</span> Upload Document
                  </button>
                </div>
              </div>

              {/* Document Categories */}
              {(() => {
                // Full SOP sections from Creator Page
                const sopSections = [
                  {
                    id: 'pre-production',
                    title: 'PRE-PRODUCTION Guidelines',
                    emoji: 'üìã',
                    gradient: 'from-orange-50 via-amber-50 to-orange-100 border-orange-400',
                    items: [
                      'Creator MUST give a brief outline of the project in the format of the pitch deck requirement provided by STAGE',
                      'Creator MUST list down shot division and production requirements of every film or show before going into the process of production',
                      'Creators MUST conduct workshops with the crew members and the cast before the shoot so everyone is aware of their roles on set'
                    ]
                  },
                  {
                    id: 'pre-production-instructions',
                    title: 'Pre-Production Instructions (Mandatory)',
                    emoji: 'üìù',
                    gradient: 'from-yellow-50 via-amber-50 to-yellow-100 border-yellow-400',
                    items: [
                      'Location Permits: Secure shooting permissions or NOC for all locations and submit them to STAGE Content/Legal Team TWO WEEKS in advance',
                      'Artist Agreements and NDAs: Sign agreements with all artists and HODs and submit them to STAGE',
                      'Pre-Production Meeting: Attend a meeting with all HODs and STAGE officials ONE WEEK before shoot date. Director must present finalized cast details, look references, and location deck with all interior/exterior locations and permission letters',
                      'Shooting Schedule: Provide shooting schedule in advance and share daily shoot reports with STAGE Team',
                      'Hiring Guidelines: Hire experienced personnel for all HOD positions. Interns are NOT allowed to handle HOD roles',
                      'Clapboard and Log Sheet: Assign a skilled assistant director to manage the clapboard and log sheet'
                    ]
                  },
                  {
                    id: 'budget-breakdown',
                    title: 'Budget Breakdown Requirements',
                    emoji: 'üí∞',
                    gradient: 'from-green-50 via-emerald-50 to-green-100 border-green-400',
                    items: [
                      'Creator MUST provide a detailed budget sheet that discloses and lists down exactly how and where the budget will be used',
                      'The budget will be allocated only after discussion with and approval by the STAGE team'
                    ]
                  },
                  {
                    id: 'technical-equipment',
                    title: 'Technical Equipment Requirements',
                    emoji: 'üé•',
                    gradient: 'from-blue-50 via-cyan-50 to-blue-100 border-blue-400',
                    items: [
                      'CAMERA - Creator must list down the camera model and lenses being used for the production',
                      'SOUND EQUIPMENT - Creator must list down the sound equipment to be used in the production',
                      'LIGHT EQUIPMENT - Creator must list down the light equipment to be used in the production'
                    ]
                  },
                  {
                    id: 'look-references',
                    title: 'Look References Requirements',
                    emoji: 'üé®',
                    gradient: 'from-purple-50 via-pink-50 to-purple-100 border-purple-400',
                    items: [
                      'ART DIRECTION - Creator must share reference images of other films/shows that have similar art direction to their production ideas',
                      'MAKE-UP & COSTUME - Creator must share reference images of other films/shows that have similar make-up & costume to their production ideas'
                    ]
                  },
                  {
                    id: 'work-links',
                    title: 'Work Links for Technical Onboarding',
                    emoji: 'üîó',
                    gradient: 'from-indigo-50 via-violet-50 to-indigo-100 border-indigo-400',
                    items: [
                      'Director - Work links required (minimum 4 links)',
                      'Director of Photography - Work links required (minimum 4 links)',
                      'Editor - Work links required (minimum 4 links)',
                      'Sound Designer - Work links required (minimum 4 links)',
                      'BGM Artist - Work links required (minimum 4 links)',
                      'Colorist - Work links required (minimum 4 links)',
                      'Art Director/Production Designer - Work links required (minimum 4 links)',
                      'Make-Up and Costume - Work links required (minimum 4 links)',
                      'VFX Artist (If any) - Work links required (minimum 4 links)',
                      'NOTE: Only work links are acceptable, do not share IMDB pages or written profiles'
                    ]
                  },
                  {
                    id: 'cinematography-equipment',
                    title: 'CINEMATOGRAPHY - Equipment & Settings',
                    emoji: 'üì∑',
                    gradient: 'from-red-50 via-orange-50 to-red-100 border-red-400',
                    items: [
                      'All footage MUST be shot in landscape, i.e., 16:9, 2:1 aspect ratios',
                      'All footage MUST be shot at 25 fps frame rate',
                      'Use only full frame cameras that can shoot 4K footage at least',
                      'Use the same company and model of cameras in multi cam shoots',
                      'Acceptable cameras include SONY FX6, FX9, SONY VENICE, ARRI ALEXA MINI',
                      'All footage must be shot in RAW and Log mode as is required for Digital Intermediate (DI) and Color Grading',
                      'Prime Cine lenses and a standard kit must be used. If lenses vary according to requirements, it must be discussed with and approved by STAGE',
                      'Use stabilizers like Tripod, Gimbal and Trolley wherever required'
                    ]
                  },
                  {
                    id: 'shot-division',
                    title: 'Shot Division and Shoot Guidelines',
                    emoji: 'üé¨',
                    gradient: 'from-rose-50 via-pink-50 to-rose-100 border-rose-400',
                    items: [
                      'Enough footage must be filmed to make the post production process hassle free',
                      'Filler shots MUST be taken for every scene, specially for shows and series as they are necessary for the trailer',
                      'Make sure that all shots are well lit and lighting is done according to location and mood',
                      'Sync all camera settings with each other throughout a scene, specially during multi cam shoots',
                      'Use appropriate lenses for different kinds of shots and make sure they are well composed and shot with stable focus and no movement jerks',
                      'Shoot Behind the Scene videos for every scene if it is stated that they are required by the STAGE team',
                      'A Log Sheet MUST be maintained throughout the shoot',
                      'Creator MUST share some footage and sounds every day of production for quality assurance'
                    ]
                  },
                  {
                    id: 'sound-recording',
                    title: 'SOUND RECORDING Guidelines',
                    emoji: 'üéôÔ∏è',
                    gradient: 'from-violet-50 via-purple-50 to-violet-100 border-violet-400',
                    items: [
                      'Use good quality mics, stands and recording devices. Acceptable: Sound Device 888, 664, MixPre 10; Mics: Sennheiser 8060, MKH60, MKH50, MKH416; Wireless: Sennheiser G4 500/100 series with Sanken COS11D or Sennheiser ME',
                      'Make sure all devices are working properly and all sounds are clean before each shot',
                      'In case of sync sound, make sure there is no echo or muffle in the audio',
                      'Make sure that dialogues are recorded without disturbance',
                      'Make sure to record ambience and foley sounds in each scene',
                      'Make sure to use appropriate settings according to the location and distance of actors',
                      'Make sure to check the audio recording after every shot and re-record it if it does not match guidelines',
                      'Do not forget to back up the audio while recording sound during shoot',
                      'It must be discussed before the shoot if the sound recording would be sync sound or dubbing',
                      'NOTE: The audio quality will be checked by STAGE team and if the project requires full dubbing or any changes, it will be done by the creator\'s team without any extra budget'
                    ]
                  },
                  {
                    id: 'art-direction',
                    title: 'Art Direction Guidelines',
                    emoji: 'üé≠',
                    gradient: 'from-fuchsia-50 via-pink-50 to-fuchsia-100 border-fuchsia-400',
                    items: [
                      'Artist costumes MUST be chosen according to their place of belonging and mood of the story. All elements of the costume must be true to the fictional identity of the character',
                      'The set must be designed according to the story with research on real life references',
                      'The actors must be sharp in their senses, relaxed and well rested before the shoot for their best performance',
                      'DO NOT show any brands/brand symbols in costumes, set design or props. Brands can appear ONLY IF there is planned brand integration'
                    ]
                  },
                  {
                    id: 'filming-guidelines-mandatory',
                    title: 'Filming Guidelines (Mandatory)',
                    emoji: 'üéØ',
                    gradient: 'from-red-50 via-rose-50 to-red-100 border-red-400',
                    items: [
                      'Use only STAGE-approved clapboards and log sheets',
                      'Film the ENTIRE approved shoot script as per agreed production values. Any omitted scene must either be filmed later or will attract a PENALTY',
                      'Animal Welfare: Ensure no harm to animals during filming. If animals are involved, a veterinarian must be present with fitness certificates',
                      'Share daily shoot schedule and shooting reports with the STAGE team',
                      'Do NOT change primary artists without immediate notification to the content team',
                      'Only approved dialects can be used. For any deviations, prior permission from STAGE Content team is required',
                      'Avoid on-set script improvisation unless necessary for comedic effect',
                      'Creator is fully responsible for managing the shoot location, including any cost overruns',
                      'Confidentiality: NO sharing or posting of plot-revealing images or clips from the set. Plot discussions during media engagements are NOT allowed',
                      'Scene Leak Prevention: Script bundles from each day\'s shoot should be destroyed to avoid scene leakage',
                      'Set Security: Provide ID cards to all team members to prevent outsider intrusion',
                      'Safety & Security: Creator must ensure safety of cast/crew. No visual/audio presence of brands & institutions without approval',
                      'Language: Avoid using foul language in scripts without prior WRITTEN consent from Content Team',
                      'On-Set Conduct: Smoking, drinking alcohol, or using prohibited substances on set is STRICTLY PROHIBITED',
                      'Transportation: Ensure all drivers are licensed. Extra precautions for post-night shots, exterior shoots, or uncontrollable environments',
                      'Meals: Provide timely and healthy meals for cast & crew. ONLY VEGETARIAN food is allowed on set',
                      'Character Promos and Poster Photoshoot: Conducting on-set character promo shoots and poster photoshoots is MANDATORY',
                      'Mobile Experience: Avoid excessive use of extreme wide shots and aerial shots. Prioritize close-up shots and master shots for mobile viewing'
                    ]
                  },
                  {
                    id: 'promotional-content',
                    title: 'Promotional Content Guidelines',
                    emoji: 'üì¢',
                    gradient: 'from-cyan-50 via-teal-50 to-cyan-100 border-cyan-400',
                    items: [
                      'Photos of all important characters MUST be clicked during shoot for cover posters and thumbnails with concept photoshoots for official poster designs',
                      'CHARACTER VIDEOS: Videos of all characters appealing for downloading STAGE app must be shot in landscape and portrait. Script will be provided by STAGE team',
                      'ACTOR VIDEOS: Film/web series/show announcement videos MUST be shot of every actor in landscape and portrait. Script will be provided by STAGE team',
                      'These marketing assets must be treated as an integral part of the shoot schedule and included in the sanctioned budget'
                    ]
                  },
                  {
                    id: 'format-technicalities',
                    title: 'POST-PRODUCTION - Format Technicalities',
                    emoji: 'üìê',
                    gradient: 'from-blue-50 via-sky-50 to-blue-100 border-blue-400',
                    items: [
                      'Frame ratio MUST be 16:9 (3840x2160 / 1920x1080)',
                      'Frame rate MUST be 25 fps',
                      'Pixel aspect ratio must be Square pixel',
                      'Display format must be Progressive Scan'
                    ]
                  },
                  {
                    id: 'video-guidelines',
                    title: 'Post-Production Video Guidelines',
                    emoji: 'üéûÔ∏è',
                    gradient: 'from-red-50 via-orange-50 to-red-100 border-red-400',
                    items: [
                      'Each and every video MUST have STAGE intro and outro which will be provided by the STAGE team. These will be added ONLY after final approval',
                      'There can be NO logo on any video that is released on STAGE',
                      'The end credits must be in a certain format provided by STAGE team',
                      'Credits for the STAGE team must be added in end credits',
                      'In any credit/mention of STAGE, it must be typed out in all capital letters only',
                      'Make sure that all audio video cuts are smooth and there are no abrupt frames or jerks'
                    ]
                  },
                  {
                    id: 'sound-mixing',
                    title: 'Sound Mixing and Mastering',
                    emoji: 'üîä',
                    gradient: 'from-purple-50 via-violet-50 to-purple-100 border-purple-400',
                    items: [
                      'Make sure every dialogue is lip synced',
                      'Use foley and ambience according to the scene',
                      'Make sure there are no gaps, sharp cuts or jerks in audio',
                      'All audio levels MUST be between -12db to -6db',
                      'Make sure that audios are clean and do not have any noise or noise inconsistencies'
                    ]
                  },
                  {
                    id: 'bgm-design',
                    title: 'Background Music Design',
                    emoji: 'üéµ',
                    gradient: 'from-indigo-50 via-blue-50 to-indigo-100 border-indigo-400',
                    items: [
                      'All music that is used MUST be created originally. Do not copy music that is not original',
                      'Sync BGM according to the requirement of the content',
                      'Make sure that BGM does not overpower dialogues and they are clearly audible',
                      'All music that is used must be recorded in a music cue sheet (template will be provided by STAGE)'
                    ]
                  },
                  {
                    id: 'epidemic-music',
                    title: 'Epidemic Music Bank Guidelines',
                    emoji: 'üéß',
                    gradient: 'from-teal-50 via-emerald-50 to-teal-100 border-teal-400',
                    items: [
                      'STAGE team has licensed the Epidemic Music Bank - a large collection of music tracks apt for almost all genres and scenes',
                      'Epidemic Music Bank can be used only in STAGE projects and shall be provided where deemed necessary',
                      'Project should still use 80% of original music',
                      'Creators would have to provide a cue sheet of each and every music piece utilized in the project. Access will be provided along with confidentiality notice'
                    ]
                  },
                  {
                    id: 'color-guidelines',
                    title: 'Color Grading Guidelines',
                    emoji: 'üåà',
                    gradient: 'from-rose-50 via-pink-50 to-rose-100 border-rose-400',
                    items: [
                      'The color grading of a project must be done according to the genre, feel and theme of the project',
                      'Make sure the color is consistent throughout the scene',
                      'Make sure the color does not mismatch in any shot, especially in multi-cam footages',
                      'CC and DI must be done in dedicated softwares like DaVinci Resolve, do not use Adobe Premiere Pro or any other editing software',
                      'The look and feel should match what was promised by the creator during pitching and pre production discussions'
                    ]
                  },
                  {
                    id: 'branding-packaging',
                    title: 'STAGE Branding and Packaging',
                    emoji: '‚ú®',
                    gradient: 'from-fuchsia-50 via-purple-50 to-fuchsia-100 border-fuchsia-400',
                    items: [
                      'The film/episode should begin with STAGE Intro and disclaimer that will be provided by us',
                      'After Intro and Disclaimer, there will be no other credit plate. Film/Episode will begin directly after STAGE Intro',
                      'There must be a cold open before any Intro graphics in the web series',
                      'Web Series Intro Graphics must be under 40 seconds',
                      'Statutory Warning overlay must be used at bottom right whenever smoking/drinking is on screen (overlay will be provided by STAGE)'
                    ]
                  },
                  {
                    id: 'final-delivery-video',
                    title: 'FINAL DELIVERY - Video Requirements',
                    emoji: 'üì¶',
                    gradient: 'from-lime-50 via-green-50 to-lime-100 border-lime-400',
                    items: [
                      '4K DPX 12 Bit (Clean)',
                      '422/HQ (.Mov)',
                      '4K MP4 (H.264)',
                      'DI Project File',
                      'EDIT Project File'
                    ]
                  },
                  {
                    id: 'final-delivery-audio',
                    title: 'Final Delivery - Audio Requirements',
                    emoji: 'üîâ',
                    gradient: 'from-sky-50 via-blue-50 to-sky-100 border-sky-400',
                    items: [
                      'Final-Mix: Stereo and 5.1 Mix',
                      'Un-Mix: Stereo Dialogue',
                      'Un-Mix: Stereo Music',
                      'Un-Mix: Stereo Foley',
                      'Un-Mix: Stereo SFX',
                      'Un-Mix: 5.1 Music and Effects',
                      'Foley must be recorded separately',
                      'Final project must be delivered in LTO tape'
                    ]
                  },
                  {
                    id: 'qc-overview',
                    title: 'QUALITY CONTROL Overview',
                    emoji: '‚úÖ',
                    gradient: 'from-emerald-50 via-green-50 to-emerald-100 border-emerald-400',
                    items: [
                      'Quality Control ensures a smooth and enriching viewer experience from scripting, shooting, post production to final delivery',
                      'QC is performed primarily on frame.io software where feedback is delivered with time stamps',
                      'STAGE will share frame.io links with delivered content and feedback where creators can read and reply to discuss'
                    ]
                  },
                  {
                    id: 'qc-round1',
                    title: 'QC Round 1: Content QC',
                    emoji: '1Ô∏è‚É£',
                    gradient: 'from-blue-50 via-indigo-50 to-blue-100 border-blue-400',
                    items: [
                      'Creators are required to share a line up to the content team for review',
                      'Content team will check and finalize structure, dialect, episodic or dramatic flow to ensure shoot went according to script',
                      'After feedback, creator will share an offline edit with reference BGM',
                      'After content team approval, finalized content cut will be transferred for technical editing quality check before sound and DI'
                    ]
                  },
                  {
                    id: 'qc-round2',
                    title: 'QC Round 2: Offline Edit QC',
                    emoji: '2Ô∏è‚É£',
                    gradient: 'from-violet-50 via-purple-50 to-violet-100 border-violet-400',
                    items: [
                      'Technical QC team will check the edit and give feedback within 7-10 business days',
                      'Creator is required to make necessary changes in edit and share final edit with STAGE team',
                      'After STAGE approval, the final edit can go for Sound and DI'
                    ]
                  },
                  {
                    id: 'qc-round3',
                    title: 'QC Round 3: Sound and BGM QC',
                    emoji: '3Ô∏è‚É£',
                    gradient: 'from-amber-50 via-yellow-50 to-amber-100 border-amber-400',
                    items: [
                      'After edit approval, creator shares content with sound mixing mastering (dialogue, dubbing sync, foley) and BGM',
                      'STAGE team will check the BGM and sound design and share feedback',
                      'Creator is required to make changes and share with team within 4-5 business days',
                      'After approval for sound and BGM, move on to color'
                    ]
                  },
                  {
                    id: 'qc-round4',
                    title: 'QC Round 4: Color QC',
                    emoji: '4Ô∏è‚É£',
                    gradient: 'from-rose-50 via-red-50 to-rose-100 border-rose-400',
                    items: [
                      'After sound approval, creator shares film/show with DI and color',
                      'STAGE team will review DI and color grading and provide feedback',
                      'Creator will share final corrected content',
                      'After final approval from STAGE team, STAGE intro-outro would be added to the content'
                    ]
                  },
                  {
                    id: 'qc-notes',
                    title: 'Important QC Notes',
                    emoji: '‚ö†Ô∏è',
                    gradient: 'from-orange-50 via-amber-50 to-orange-100 border-orange-400',
                    items: [
                      'ALL FILES SHARED FOR QC MUST HAVE A "FOR STAGE PREVIEW" WATERMARK in bottom right corner. Only final delivery would be watermark free',
                      'STAGE Intro, Outro and post credits to be added after final approval of film/show',
                      'After every QC round, a deadline will be defined for delivery of next cut. This deadline must be strictly followed',
                      'If deadlines need to be revised, it can be done ONLY after discussion with STAGE team'
                    ]
                  },
                  {
                    id: 'data-storage',
                    title: 'DATA STORAGE - Required Folders',
                    emoji: 'üíæ',
                    gradient: 'from-slate-50 via-gray-50 to-slate-100 border-slate-400',
                    items: [
                      'Raw footage/clips - All raw data in day-wise folders or easily understandable format',
                      'Project files - All project files (episode prproj, Teaser/Trailer prproj, After Effects, PSD files, sound files, DaVinci DI project files)',
                      'XML files - XML files of all project files and versions',
                      'Graphics/VFX data - Any VFX or animation used along with editable files',
                      'Proxy - Proxy files of all versions pertaining to the project',
                      'Songs - All songs used in the project',
                      'IT Tracks - All BGM files (scoring, mixing, foley) with mixed and open IT tracks, 16 Track of Songs',
                      'Sync Audio - All recorded voices/sounds of camera and sound recorders with project files',
                      'BGM - All BGM tracks used in the project',
                      'Final Export - All final exports (4K/H.264, Clean mov, HD, ProRes.mov Apple ProRes 422 HQ) with dialogue track and BGM IT tracks',
                      'Unmixed Tracks Stereo - Unmix tracks (Dialogue, Music, Foley+SFX layers) for Film/Show, Trailer and Teaser',
                      'Unmix Tracks 5.1 - Unmix M&E and Separate channels unmix',
                      'Teaser and trailer final exports - Final exports with raw data, VFX data, Music data and editable files',
                      'Character Promos and photoshoots - All data, project files and exports'
                    ]
                  },
                  {
                    id: 'data-documents',
                    title: 'Documents Folder Requirements',
                    emoji: 'üìÑ',
                    gradient: 'from-zinc-50 via-stone-50 to-zinc-100 border-zinc-400',
                    items: [
                      'Documents folder should contain: Script, Screenplay, and all Contracts signed by artists for the movie or web-series'
                    ]
                  },
                  {
                    id: 'data-delivery-notes',
                    title: 'Data Delivery Instructions',
                    emoji: 'üì¨',
                    gradient: 'from-cyan-50 via-sky-50 to-cyan-100 border-cyan-400',
                    items: [
                      'All project files should work in Hard Disk by locating the media files in respective data folders',
                      'Once all data is uploaded in harddisks, arrange a video call with STAGE authority to check and confirm the data',
                      'After confirmation, courier the harddisks to: Tower A, 7th Floor, Club 125, Sector 125, Noida, U.P. Pin. 201301',
                      'Contact: Anushka - 9425360822'
                    ]
                  }
                ];

                const docCategories = [
                  {
                    name: 'SOP',
                    icon: 'üìã',
                    color: 'bg-gradient-to-br from-blue-500 to-blue-700',
                    desc: 'Standard Operating Procedures',
                    fullDesc: 'Complete production guidelines covering Pre-Production, Filming, Post-Production, Sound, Music, VFX and Delivery standards for STAGE OTT content',
                    itemCount: sopSections.length,
                    isSopFull: true,
                    sopSections: sopSections,
                    content: {
                      title: 'STAGE Production SOP',
                      sections: [
                        { heading: 'Pre-Production', items: ['Script approval from STAGE team', 'Budget approval & agreement signing', 'Casting finalization with photos', 'Location scouting & permits', 'Equipment booking', 'Insurance documentation'] },
                        { heading: 'Production', items: ['Daily call sheets 24hrs before', 'Attendance & log sheets', 'Daily rushes backup (2 copies)', 'Daily production report', 'Petty cash management', 'Safety protocols compliance'] },
                        { heading: 'Post-Production', items: ['Rough cut within 2 weeks of wrap', 'Music clearance documentation', 'Color grading approval', 'Sound mix approval', 'Final master delivery', 'All assets handover'] },
                      ]
                    }
                  },
                  {
                    name: 'Clap Board',
                    icon: 'üé¨',
                    color: 'bg-gradient-to-br from-slate-800 to-slate-900',
                    desc: 'Film Slate Templates',
                    fullDesc: 'Professional STAGE-approved clapperboard/slate formats for scene identification, take numbering, and sync reference in production',
                    itemCount: 4,
                    hasClapboardTemplate: true,
                    content: {
                      title: 'Clap Board / Film Slate',
                      sections: [
                        { heading: 'Standard Information', items: ['Production Title', 'Director Name', 'DOP/Cinematographer', 'Scene Number', 'Shot Number', 'Take Number', 'Date', 'Day/Night', 'INT/EXT'] },
                        { heading: 'Technical Details', items: ['Camera: A/B/C', 'Roll Number', 'FPS: 25', 'Aspect Ratio', 'Sound: Sync/MOS', 'Timecode'] },
                        { heading: 'STAGE Requirements', items: ['Use STAGE-approved clapboard design', 'Clearly visible in frame', 'Proper lighting on slate', 'Hold steady for 2 seconds', 'Clap clearly for audio sync'] },
                      ]
                    }
                  },
                  {
                    name: 'Invoice',
                    icon: 'üßæ',
                    color: 'bg-gradient-to-br from-green-500 to-emerald-700',
                    desc: 'Invoice Templates',
                    fullDesc: 'GST-compliant invoice templates for production payments including tranch-wise billing, vendor invoices, and tax documentation',
                    itemCount: 6,
                    hasInvoiceTemplate: true,
                    invoiceTemplate: {
                      companyName: '[YOUR PRODUCTION COMPANY NAME]',
                      companyAddress: '[Your Full Address]',
                      companyGstin: '[Your GSTIN]',
                      billTo: {
                        name: 'STAGE Technologies Private Limited',
                        address: '2nd Floor, 2-A/3 S/F, Front SIDE, Kundan Mansion, Asaf Ali Road, New Delhi - 110002',
                        gstin: '07AAICC1279L1ZC'
                      },
                      placeOfSupply: 'Delhi',
                      tranchOptions: [
                        { label: '1st Tranch (25% - Upon Agreement Signing)', percentage: 25 },
                        { label: '2nd Tranch (25% - Pre-Production Complete)', percentage: 25 },
                        { label: '3rd Tranch (25% - Shoot Complete)', percentage: 25 },
                        { label: '4th Tranch (25% - Final Delivery)', percentage: 25 },
                      ],
                      gstRate: 18,
                    },
                    content: {
                      title: 'Invoice Format Guidelines',
                      sections: [
                        { heading: 'Required Fields', items: ['Invoice Number (GST-XX/YY-ZZ format)', 'Invoice Date & Due Date', 'Vendor/Creator Details with GSTIN', 'Bill To: STAGE Technologies Pvt Ltd', 'HSN/SAC Code', 'Itemized breakdown with Rate, Qty, IGST, Amount'] },
                        { heading: 'Payment Tranches', items: ['1st Tranch: 25% upon signing of agreement', '2nd Tranch: 25% on pre-production completion', '3rd Tranch: 25% on shoot completion', '4th Tranch: 25% on final delivery & QC approval'] },
                        { heading: 'Bank Details Required', items: ['Account Holder Name', 'Account Number', 'IFSC Code', 'Branch Name', 'Bank Name', 'PAN Number', 'Aadhar Number (optional)'] },
                        { heading: 'Submission Process', items: ['Email to accounts@stageasai.com', 'CC your production POC', 'Attach signed copy as PDF', 'Include project agreement reference'] },
                      ]
                    }
                  },
                  {
                    name: 'NOC',
                    icon: 'üìú',
                    color: 'bg-gradient-to-br from-purple-500 to-indigo-700',
                    desc: 'No Objection Certificates',
                    fullDesc: 'Legal NOC templates including Work-For-Hire, Location Permission, Talent Release, Music Rights, and Copyright Act 1957 compliant documents',
                    itemCount: 12,
                    hasNocTemplate: true,
                    hasLocationNoc: true,
                    content: {
                      title: 'NOC Requirements',
                      sections: [
                        { heading: 'Location NOC', items: ['Property owner consent', 'Local authority permission', 'Police intimation (if required)', 'Residential area timing restrictions', 'Parking arrangements'] },
                        { heading: 'Music NOC', items: ['Original composition certificate', 'Third-party music clearance', 'Sync license for existing tracks', 'Royalty-free music declaration'] },
                        { heading: 'Talent NOC', items: ['Image usage rights', 'Social media usage consent', 'Behind-the-scenes footage rights', 'Promotional usage clearance'] },
                      ]
                    }
                  },
                  {
                    name: 'Budget',
                    icon: 'üí∞',
                    color: 'bg-gradient-to-br from-amber-500 to-orange-600',
                    desc: 'Budget Formats & OTT Guide',
                    fullDesc: 'Complete budget guide with department-wise allocation for ‚Çπ40L regional film, OTT platform producer margins (Netflix, Amazon, Hoichoi, Zee5), and industry-standard cost structures',
                    itemCount: 12,
                    hasBudgetTemplate: true,
                    hasOttBudgetGuide: true,
                    content: {
                      title: 'OTT Budget & Producer Margin Guide',
                      sections: [
                        { heading: '‚Çπ40 LAKH REGIONAL FILM - Budget Allocation (with 10% Creator Margin)', items: [
                          'üìä TOTAL BUDGET: ‚Çπ40,00,000 | Creator Margin: ‚Çπ4,00,000 (10%) | Working Budget: ‚Çπ36,00,000'
                        ]},
                        { heading: '1Ô∏è‚É£ ABOVE-THE-LINE (25-30%) = ‚Çπ9-10.8L', items: [
                          'Director Fee: 8-10% (‚Çπ2.88-3.6L)',
                          'Script/Story Rights: 3-5% (‚Çπ1.08-1.8L)',
                          'Lead Cast (2-3 actors): 10-12% (‚Çπ3.6-4.32L)',
                          'Music Director: 3-4% (‚Çπ1.08-1.44L)'
                        ]},
                        { heading: '2Ô∏è‚É£ PRODUCTION/BTL (40-45%) = ‚Çπ14.4-16.2L', items: [
                          'Crew Salaries (DOP, AD, Sound, Art): 12-15% (‚Çπ4.32-5.4L)',
                          'Camera & Equipment Rental: 8-10% (‚Çπ2.88-3.6L)',
                          'Location & Set: 6-8% (‚Çπ2.16-2.88L)',
                          'Art, Props & Costumes: 5-6% (‚Çπ1.8-2.16L)',
                          'Transportation & Catering: 4-5% (‚Çπ1.44-1.8L)',
                          'Makeup & Hair: 2-3% (‚Çπ0.72-1.08L)'
                        ]},
                        { heading: '3Ô∏è‚É£ POST-PRODUCTION (18-22%) = ‚Çπ6.48-7.92L', items: [
                          'Editing: 4-5% (‚Çπ1.44-1.8L)',
                          'Color Grading/DI: 3-4% (‚Çπ1.08-1.44L)',
                          'Sound Design & Mix: 4-5% (‚Çπ1.44-1.8L)',
                          'Background Music/Score: 3-4% (‚Çπ1.08-1.44L)',
                          'VFX (if needed): 2-3% (‚Çπ0.72-1.08L)'
                        ]},
                        { heading: '4Ô∏è‚É£ CONTINGENCY & MISC (8-10%) = ‚Çπ2.88-3.6L', items: [
                          'Contingency Fund: 5-7% (‚Çπ1.8-2.52L)',
                          'Insurance & Permits: 1-2% (‚Çπ0.36-0.72L)',
                          'Marketing Assets (Posters/Promos): 1-2% (‚Çπ0.36-0.72L)'
                        ]},
                        { heading: 'üé¨ OTT PLATFORM PRODUCER MARGINS', items: [
                          '‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ',
                          'üì∫ NETFLIX INDIA: 10-15% margin (Cost-Plus model, ‚Çπ4-6L on ‚Çπ40L budget)',
                          'üì∫ AMAZON PRIME VIDEO: 12-18% margin (Cost-Plus, ‚Çπ4.8-7.2L on ‚Çπ40L)',
                          'üì∫ DISNEY+ HOTSTAR: 10-15% margin (Cost-Plus, ‚Çπ4-6L on ‚Çπ40L)',
                          'üì∫ ZEE5: 10-12% margin (Cost-Plus, ‚Çπ4-4.8L on ‚Çπ40L)',
                          'üì∫ SONY LIV: 10-12% margin (Cost-Plus, ‚Çπ4-4.8L on ‚Çπ40L)',
                          'üì∫ HOICHOI (Regional): 8-12% margin (Cost-Plus, ‚Çπ3.2-4.8L on ‚Çπ40L)',
                          'üì∫ AHA (Telugu): 8-10% margin (Cost-Plus, ‚Çπ3.2-4L on ‚Çπ40L)',
                          'üì∫ SUN NXT: 8-10% margin (Regional, ‚Çπ3.2-4L on ‚Çπ40L)',
                          'üì∫ MX PLAYER: 5-8% margin (Lower budgets, ‚Çπ2-3.2L on ‚Çπ40L)',
                          'üì∫ STAGE OTT: 10% fixed margin (‚Çπ4L on ‚Çπ40L budget)'
                        ]},
                        { heading: 'üíº COST-PLUS MODEL EXPLAINED', items: [
                          'How it works: OTT pays Production Cost + Fixed Producer Margin %',
                          'Example: ‚Çπ36L Production + 10% Margin = ‚Çπ40L Total Deal',
                          'IP Rights: OTT owns all rights for agreed duration (typically 5-7 years)',
                          'Regional languages get slightly lower margins (8-12%) vs Hindi (10-18%)',
                          'First-time creators: 5-8% | Established: 10-15% | Star creators: 15-25%'
                        ]},
                        { heading: '‚ö†Ô∏è 2024-25 MARKET TRENDS', items: [
                          'Producer margins have DECLINED from 15-20% (2020) to 8-12% (2024)',
                          'OTT platforms preferring shorter exclusivity (1-2 years vs perpetual)',
                          'Regional content getting more investment but tighter margins',
                          'Backend/revenue share deals are rare for new creators',
                          'Focus on proven IP and sequels over experimental content'
                        ]},
                        { heading: '‚úÖ TIPS FOR MAXIMIZING MARGIN', items: [
                          'Build track record with lower-margin projects first',
                          'Negotiate multi-project deals for better rates',
                          'Own music rights separately when possible',
                          'Keep production costs lean to protect actual margin',
                          'Consider co-production for shared risk & better terms'
                        ]}
                      ]
                    }
                  },
                  {
                    name: 'Agreement',
                    icon: 'üìù',
                    color: 'bg-gradient-to-br from-red-500 to-rose-700',
                    desc: 'Contract Templates',
                    fullDesc: 'Legal agreement templates for Creator contracts, Talent agreements, Vendor contracts, IP assignment, and confidentiality agreements',
                    itemCount: 9,
                    hasAgreementTemplate: true,
                    content: {
                      title: 'Agreement Guidelines',
                      sections: [
                        { heading: 'Creator Agreement', items: ['Project scope & deliverables', 'Timeline & milestones', 'Payment terms & schedule', 'IP rights transfer', 'Exclusivity clause', 'Termination conditions'] },
                        { heading: 'Talent Agreement', items: ['Role description', 'Shoot dates commitment', 'Remuneration & perks', 'Promotional obligations', 'Image rights duration', 'Confidentiality clause'] },
                        { heading: 'Vendor Agreement', items: ['Service description', 'Delivery schedule', 'Payment terms', 'Quality standards', 'Liability clause', 'Insurance requirements'] },
                      ]
                    }
                  },
                  {
                    name: 'DPR',
                    icon: 'üìä',
                    color: 'bg-gradient-to-br from-amber-500 to-orange-700',
                    desc: 'Daily Production Report',
                    fullDesc: 'Create, save and share Daily Production Reports with Google Sheets export, PDF download, and WhatsApp sharing',
                    itemCount: savedDPRs.length > 0 ? savedDPRs.length : 7,
                    hasDPRTemplate: true,
                    content: {
                      title: 'Daily Production Report',
                      sections: [
                        { heading: 'Production Details', items: ['Title', 'Date', 'Day #', 'Producer', 'Director', 'Location', 'First Shoot Date', 'Scheduled Finish'] },
                        { heading: 'Timing Log', items: ['Crew Call', 'First Shot', 'Meal Break', 'Packup', 'Last Person Out'] },
                        { heading: 'Scenes & Pages', items: ['Script Total', 'Shot Today', 'Total to Date', 'Remaining'] },
                        { heading: 'Camera Setups', items: ['Previous', 'Today', 'Total', 'Remaining'] },
                        { heading: 'Comments', items: ['Delays', 'Explanations', 'Solutions'] },
                        { heading: 'Next Shoot', items: ['Date', 'Location', 'Call Time', 'Scenes'] },
                        { heading: 'Signatures', items: ['Prepared By', 'Approved By'] }
                      ]
                    }
                  },
                  {
                    name: 'Others',
                    icon: 'üìÅ',
                    color: 'bg-gradient-to-br from-slate-500 to-gray-700',
                    desc: 'My Documents',
                    fullDesc: 'Add, save and share your custom production documents - production reports, notes, checklists, and any other documents',
                    itemCount: customDocuments.length,
                    hasCustomDocs: true,
                    content: {
                      title: 'My Documents',
                      sections: []
                    }
                  },
                ];

                const selectedCat = docCategories.find(c => c.name === selectedDocCategory);

                return (
                  <>
                    {/* Premium Document Categories Grid */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5 mb-8">
                      {docCategories.map(cat => {
                        const catDocs = productionDocs.filter(d => d.category === cat.name);
                        const isSelected = selectedDocCategory === cat.name;
                        const totalItems = (cat as any).itemCount || catDocs.length || cat.content.sections.reduce((acc: number, s: any) => acc + s.items.length, 0);
                        return (
                          <div
                            key={cat.name}
                            onClick={() => setSelectedDocCategory(isSelected ? null : cat.name)}
                            className={`group relative bg-white rounded-2xl border-2 overflow-hidden hover:shadow-2xl transition-all duration-300 cursor-pointer transform hover:-translate-y-1 ${isSelected ? 'border-blue-500 shadow-2xl ring-4 ring-blue-100' : 'border-gray-200 hover:border-gray-300'}`}
                          >
                            {/* Gradient Header */}
                            <div className={`${cat.color} p-4 relative overflow-hidden`}>
                              {/* Background Pattern */}
                              <div className="absolute inset-0 opacity-10">
                                <div className="absolute top-0 right-0 w-32 h-32 bg-white rounded-full -translate-y-1/2 translate-x-1/2"></div>
                                <div className="absolute bottom-0 left-0 w-24 h-24 bg-white rounded-full translate-y-1/2 -translate-x-1/2"></div>
                              </div>

                              <div className="relative flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                  <div className="w-14 h-14 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center text-3xl shadow-lg border border-white/30">
                                    {cat.icon}
                                  </div>
                                  <div>
                                    <h3 className="font-black text-white text-lg tracking-wide">{cat.name}</h3>
                                    <p className="text-white/80 text-xs font-medium">{cat.desc}</p>
                                  </div>
                                </div>
                                <div className="flex flex-col items-end">
                                  <div className="bg-white/20 backdrop-blur-sm px-3 py-1 rounded-full border border-white/30">
                                    <span className="text-white font-bold text-lg">{totalItems}</span>
                                    <span className="text-white/80 text-xs ml-1">items</span>
                                  </div>
                                </div>
                              </div>
                            </div>

                            {/* Description Area */}
                            <div className="p-4 bg-gradient-to-b from-gray-50 to-white">
                              <p className="text-xs text-gray-600 leading-relaxed line-clamp-2 min-h-[32px]">
                                {(cat as any).fullDesc || cat.desc}
                              </p>

                              {/* Action Footer */}
                              <div className="flex items-center justify-between mt-3 pt-3 border-t border-gray-100">
                                <div className="flex items-center gap-2">
                                  {catDocs.length > 0 && (
                                    <span className="px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium">
                                      {catDocs.length} uploaded
                                    </span>
                                  )}
                                  {((cat as any).hasInvoiceTemplate || (cat as any).hasNocTemplate || (cat as any).hasClapboardTemplate || (cat as any).hasBudgetTemplate || (cat as any).hasCallSheetTemplate || (cat as any).hasLogSheetTemplate) && (
                                    <span className="px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs font-medium">
                                      Templates
                                    </span>
                                  )}
                                </div>
                                <div className={`flex items-center gap-1 text-sm font-bold transition-colors ${isSelected ? 'text-blue-600' : 'text-gray-400 group-hover:text-blue-500'}`}>
                                  {isSelected ? (
                                    <>
                                      <span>Close</span>
                                      <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" /></svg>
                                    </>
                                  ) : (
                                    <>
                                      <span>View</span>
                                      <svg className="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" /></svg>
                                    </>
                                  )}
                                </div>
                              </div>
                            </div>

                            {/* Selected Indicator */}
                            {isSelected && (
                              <div className="absolute top-0 left-0 right-0 h-1 bg-blue-500"></div>
                            )}
                          </div>
                        );
                      })}
                    </div>

                    {/* Selected Category Detail View */}
                    {selectedCat && (
                      <div className="bg-white rounded-xl border border-gray-200 mb-6 overflow-hidden">
                        <div className={`${selectedCat.color} p-4 flex items-center justify-between`}>
                          <div className="flex items-center gap-3 text-white">
                            <span className="text-3xl">{selectedCat.icon}</span>
                            <div>
                              <h2 className="text-xl font-bold">{selectedCat.content.title}</h2>
                              <p className="text-sm opacity-80">{selectedCat.desc}</p>
                            </div>
                          </div>
                          <div className="flex gap-2">
                            <button
                              onClick={() => {
                                const content = (selectedCat as any).isSopFull && (selectedCat as any).sopSections
                                  ? (selectedCat as any).sopSections.map((s: any) =>
                                      `${s.title}:\n${s.items.map((i: string) => `  ‚Ä¢ ${i}`).join('\n')}`
                                    ).join('\n\n')
                                  : selectedCat.content.sections.map(s =>
                                      `${s.heading}:\n${s.items.map(i => `  ‚Ä¢ ${i}`).join('\n')}`
                                    ).join('\n\n');
                                navigator.clipboard.writeText(`${selectedCat.content.title}\n\n${content}`);
                                alert('Content copied! Share with your team.');
                              }}
                              className="px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium"
                            >
                              üì§ Share All
                            </button>
                            <button
                              onClick={() => {
                                const content = (selectedCat as any).isSopFull && (selectedCat as any).sopSections
                                  ? (selectedCat as any).sopSections.map((s: any) =>
                                      `<div style="margin-bottom:20px;padding:15px;background:#f9fafb;border-radius:8px;border-left:4px solid #3b82f6"><h3 style="margin:0 0 10px 0;color:#1f2937">${s.emoji} ${s.title}</h3><ul style="margin:0;padding-left:20px">${s.items.map((i: string) => `<li style="margin:5px 0;color:#4b5563">${i}</li>`).join('')}</ul></div>`
                                    ).join('')
                                  : selectedCat.content.sections.map(s =>
                                      `<h3>${s.heading}</h3><ul>${s.items.map(i => `<li>${i}</li>`).join('')}</ul>`
                                    ).join('');
                                const html = `<!DOCTYPE html><html><head><title>${selectedCat.content.title}</title><style>body{font-family:Arial;padding:40px;max-width:900px;margin:0 auto}h1{color:#1e40af;border-bottom:2px solid #1e40af;padding-bottom:10px}h3{color:#374151;margin-top:20px}ul{color:#4b5563}li{margin:5px 0}@media print{body{padding:20px}}</style></head><body><h1>${selectedCat.content.title}</h1>${content}<p style="margin-top:40px;color:#9ca3af;font-size:12px">Generated by STAGE Production Portal</p></body></html>`;
                                const printWindow = window.open('', '_blank');
                                if (printWindow) {
                                  printWindow.document.write(html);
                                  printWindow.document.close();
                                  printWindow.print();
                                }
                              }}
                              className="px-4 py-2 bg-white hover:bg-gray-100 rounded-lg text-gray-800 text-sm font-medium"
                            >
                              üì• Download PDF
                            </button>
                            <button
                              onClick={() => {
                                const input = document.createElement('input');
                                input.type = 'file';
                                input.accept = '.pdf,.doc,.docx,.xls,.xlsx';
                                input.onchange = (e: any) => {
                                  const file = e.target.files[0];
                                  if (file) {
                                    const newDoc = {
                                      id: 'doc-' + Date.now(),
                                      name: file.name,
                                      category: selectedCat.name,
                                      url: URL.createObjectURL(file),
                                      uploadedAt: new Date().toISOString(),
                                    };
                                    const updatedDocs = [...productionDocs, newDoc];
                                    setProductionDocs(updatedDocs);
                                    localStorage.setItem('production_docs', JSON.stringify(updatedDocs));
                                  }
                                };
                                input.click();
                              }}
                              className="px-4 py-2 bg-white hover:bg-gray-100 rounded-lg text-gray-800 text-sm font-medium"
                            >
                              ‚ûï Upload File
                            </button>
                          </div>
                        </div>
                        <div className="p-6">
                          {/* Invoice Template Generator */}
                          {(selectedCat as any).hasInvoiceTemplate && (
                            <div className="mb-8">
                              {/* Sample Invoice Preview */}
                              <div className="bg-gradient-to-br from-slate-900 via-gray-900 to-slate-800 border-2 border-red-500/50 rounded-2xl p-6 mb-6 shadow-2xl">
                                <div className="flex items-center justify-between mb-6">
                                  <div className="flex items-center gap-4">
                                    <div className="w-14 h-14 bg-gradient-to-br from-red-500 to-red-700 rounded-xl flex items-center justify-center shadow-lg">
                                      <span className="text-3xl">üé¨</span>
                                    </div>
                                    <div>
                                      <h3 className="text-2xl font-black text-white">STAGE Tax Invoice</h3>
                                      <p className="text-red-400 text-sm font-medium">OTT Production Standard Format</p>
                                    </div>
                                  </div>
                                  <div className="flex gap-2">
                                    <button
                                      onClick={() => {
                                        const invoiceHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>Tax Invoice - STAGE OTT Production</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); min-height: 100vh; padding: 40px; }
    .invoice-container { max-width: 850px; margin: 0 auto; background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 25px 50px rgba(0,0,0,0.3); }
    .header { background: linear-gradient(135deg, #dc2626 0%, #b91c1c 50%, #991b1b 100%); padding: 30px 40px; display: flex; justify-content: space-between; align-items: center; }
    .logo-section { display: flex; align-items: center; gap: 15px; }
    .logo { width: 60px; height: 60px; background: rgba(255,255,255,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 30px; backdrop-filter: blur(10px); }
    .company-name { color: white; font-size: 28px; font-weight: 900; letter-spacing: -0.5px; }
    .company-tagline { color: rgba(255,255,255,0.8); font-size: 12px; font-weight: 500; margin-top: 2px; }
    .invoice-badge { background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 15px 25px; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.2); }
    .invoice-badge h1 { color: white; font-size: 24px; font-weight: 900; letter-spacing: 2px; }
    .invoice-badge p { color: rgba(255,255,255,0.8); font-size: 11px; margin-top: 3px; }
    .seller-buyer { display: grid; grid-template-columns: 1fr 1fr; gap: 0; }
    .seller-section { padding: 30px 40px; background: #f8fafc; border-right: 1px solid #e2e8f0; }
    .buyer-section { padding: 30px 40px; background: #fffbeb; }
    .section-label { font-size: 10px; font-weight: 700; color: #64748b; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px; }
    .company-details h3 { font-size: 18px; font-weight: 800; color: #0f172a; margin-bottom: 8px; }
    .company-details p { font-size: 12px; color: #475569; line-height: 1.6; }
    .gstin-badge { display: inline-block; background: linear-gradient(135deg, #0f172a, #1e293b); color: white; padding: 6px 12px; border-radius: 6px; font-size: 11px; font-weight: 600; margin-top: 12px; }
    .invoice-meta { padding: 20px 40px; background: #0f172a; display: flex; justify-content: space-between; align-items: center; }
    .meta-item { text-align: center; }
    .meta-label { font-size: 10px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; }
    .meta-value { font-size: 16px; font-weight: 700; color: white; margin-top: 4px; }
    .items-section { padding: 30px 40px; }
    .items-table { width: 100%; border-collapse: collapse; }
    .items-table th { background: linear-gradient(135deg, #dc2626, #b91c1c); color: white; padding: 15px 12px; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }
    .items-table th:first-child { border-radius: 10px 0 0 10px; }
    .items-table th:last-child { border-radius: 0 10px 10px 0; }
    .items-table td { padding: 20px 12px; border-bottom: 1px solid #e2e8f0; font-size: 13px; color: #334155; }
    .item-name { font-weight: 700; color: #0f172a; font-size: 14px; }
    .item-desc { font-size: 11px; color: #64748b; margin-top: 4px; line-height: 1.5; }
    .amount { font-weight: 700; color: #0f172a; }
    .totals-section { padding: 0 40px 30px; display: flex; justify-content: flex-end; }
    .totals-box { width: 300px; background: #f8fafc; border-radius: 12px; overflow: hidden; border: 2px solid #e2e8f0; }
    .total-row { display: flex; justify-content: space-between; padding: 12px 20px; border-bottom: 1px solid #e2e8f0; }
    .total-row.final { background: linear-gradient(135deg, #059669, #047857); border: none; }
    .total-label { font-size: 13px; font-weight: 600; color: #475569; }
    .total-value { font-size: 13px; font-weight: 700; color: #0f172a; }
    .total-row.final .total-label, .total-row.final .total-value { color: white; font-size: 16px; }
    .footer { padding: 30px 40px; background: #f8fafc; border-top: 2px solid #e2e8f0; display: flex; justify-content: space-between; }
    .bank-details h4 { font-size: 12px; font-weight: 800; color: #0f172a; margin-bottom: 12px; text-transform: uppercase; letter-spacing: 1px; }
    .bank-details p { font-size: 11px; color: #475569; line-height: 1.8; }
    .bank-details span { font-weight: 600; color: #0f172a; }
    .signature-section { text-align: right; }
    .signature-line { width: 180px; border-bottom: 2px solid #0f172a; margin-left: auto; margin-bottom: 8px; }
    .signature-text { font-size: 12px; font-weight: 700; color: #0f172a; }
    .watermark { text-align: center; padding: 15px; background: #0f172a; color: #64748b; font-size: 10px; }
    @media print {
      body { background: white; padding: 0; }
      .invoice-container { box-shadow: none; border-radius: 0; }
    }
  </style>
</head>
<body>
  <div class="invoice-container">
    <div class="header">
      <div class="logo-section">
        <div class="logo">üé¨</div>
        <div>
          <div class="company-name">[YOUR PRODUCTION HOUSE]</div>
          <div class="company-tagline">Film & Content Production</div>
        </div>
      </div>
      <div class="invoice-badge">
        <h1>TAX INVOICE</h1>
        <p>GST Compliant</p>
      </div>
    </div>

    <div class="seller-buyer">
      <div class="seller-section">
        <div class="section-label">From / Seller</div>
        <div class="company-details">
          <h3>[YOUR PRODUCTION COMPANY NAME]</h3>
          <p>[Your Complete Address]<br>[City, State - Pincode]<br>India</p>
          <div class="gstin-badge">GSTIN: [YOUR GSTIN]</div>
        </div>
      </div>
      <div class="buyer-section">
        <div class="section-label">Bill To / Buyer</div>
        <div class="company-details">
          <h3>STAGE Technologies Private Limited</h3>
          <p>2nd Floor, 2-A/3 S/F, Front SIDE,<br>Kundan Mansion, Asaf Ali Road,<br>New Delhi - 110002, India</p>
          <div class="gstin-badge">GSTIN: 07AAICC1279L1ZC</div>
        </div>
      </div>
    </div>

    <div class="invoice-meta">
      <div class="meta-item">
        <div class="meta-label">Invoice Number</div>
        <div class="meta-value">GST-__/25-26</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Invoice Date</div>
        <div class="meta-value">__/__/2026</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Due Date</div>
        <div class="meta-value">__/__/2026</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Place of Supply</div>
        <div class="meta-value">Delhi</div>
      </div>
    </div>

    <div class="items-section">
      <table class="items-table">
        <thead>
          <tr>
            <th style="width:40px">#</th>
            <th>Description</th>
            <th style="width:80px">HSN/SAC</th>
            <th style="width:50px">Qty</th>
            <th style="width:120px;text-align:right">Rate</th>
            <th style="width:70px;text-align:center">IGST</th>
            <th style="width:120px;text-align:right">Amount</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="font-weight:600">1</td>
            <td>
              <div class="item-name">[Regional Language] Film - "[PROJECT TITLE]"</div>
              <div class="item-desc">
                üé¨ [1st/2nd/3rd/4th] Tranch Payment<br>
                üìã [25%] upon [Agreement Signing / Pre-Production / Shoot Complete / Final Delivery]<br>
                üí∞ As per Production Agreement dated [DD/MM/YYYY]
              </div>
            </td>
            <td style="text-align:center">997212</td>
            <td style="text-align:center">1</td>
            <td style="text-align:right" class="amount">‚Çπ __,__,___.00</td>
            <td style="text-align:center">18%</td>
            <td style="text-align:right" class="amount">‚Çπ __,__,___.00</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="totals-section">
      <div class="totals-box">
        <div class="total-row">
          <span class="total-label">Subtotal</span>
          <span class="total-value">‚Çπ __,__,___.00</span>
        </div>
        <div class="total-row">
          <span class="total-label">IGST @ 18%</span>
          <span class="total-value">‚Çπ __,___.00</span>
        </div>
        <div class="total-row final">
          <span class="total-label">TOTAL</span>
          <span class="total-value">‚Çπ __,__,___.00</span>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="bank-details">
        <h4>üí≥ Bank Details</h4>
        <p>
          <span>Account Name:</span> [YOUR COMPANY NAME]<br>
          <span>Account No:</span> [ACCOUNT NUMBER]<br>
          <span>IFSC Code:</span> [IFSC CODE]<br>
          <span>Bank & Branch:</span> [BANK NAME], [BRANCH]<br>
          <span>PAN:</span> [PAN NUMBER]
        </p>
      </div>
      <div class="signature-section">
        <div class="signature-line"></div>
        <div class="signature-text">Authorized Signatory</div>
        <p style="font-size:11px;color:#64748b;margin-top:4px">[YOUR COMPANY NAME]</p>
      </div>
    </div>

    <div class="watermark">
      üé¨ STAGE OTT Platform ‚Ä¢ Regional Content Production Partner ‚Ä¢ www.stageasai.com
    </div>
  </div>
</body>
</html>`;
                                        const printWindow = window.open('', '_blank');
                                        if (printWindow) {
                                          printWindow.document.write(invoiceHtml);
                                          printWindow.document.close();
                                          printWindow.print();
                                        }
                                      }}
                                      className="px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg text-sm font-bold flex items-center gap-2 border border-white/20"
                                    >
                                      üñ®Ô∏è Print PDF
                                    </button>
                                  </div>
                                </div>

                                {/* Download Options - Editable Formats */}
                                <div className="bg-white border-2 border-blue-300 rounded-xl p-5 mb-4">
                                  <h4 className="font-bold text-blue-800 mb-4 flex items-center gap-2 text-lg">
                                    üì• Download Editable Invoice Template
                                  </h4>
                                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    {/* Google Sheets Option */}
                                    <button
                                      onClick={() => {
                                        // Create Google Sheets with pre-filled template
                                        const sheetsUrl = 'https://docs.google.com/spreadsheets/create';
                                        window.open(sheetsUrl, '_blank');
                                        // Also copy the data to clipboard for easy pasting
                                        const csvData = `TAX INVOICE - STAGE PRODUCTION

SELLER DETAILS,,,INVOICE DETAILS
Company Name:,[YOUR PRODUCTION COMPANY],,Invoice No.:,GST-__/25-26
Address:,[YOUR COMPLETE ADDRESS],,Invoice Date:,
City/State:,[CITY STATE PINCODE],,Due Date:,
GSTIN:,[YOUR GSTIN],,Place of Supply:,Delhi

BILL TO:
STAGE Technologies Private Limited
"2nd Floor, 2-A/3 S/F, Front SIDE, Kundan Mansion"
"Asaf Ali Road, New Delhi - 110002"
GSTIN: 07AAICC1279L1ZC

#,Item Description,HSN/SAC,Qty,Rate,IGST,Cess,Amount
1,"[Regional] Film ""[PROJECT NAME]"" - 1st Tranch (25% upon signing of agreement)",,1,,,0,

,,,,,SUB TOTAL,,
,,,,,IGST (18%),,
,,,,,TOTAL,,

BANK DETAILS
Account Name:,[YOUR COMPANY NAME]
Account No:,[ACCOUNT NUMBER]
IFSC Code:,[IFSC CODE]
Branch:,[BRANCH NAME]
Bank:,[BANK NAME]
PAN No:,[PAN NUMBER]
Aadhar No:,[AADHAR NUMBER]

Authorized Signatory: ____________________`;
                                        navigator.clipboard.writeText(csvData);
                                        alert('Google Sheets opened! Invoice data copied - paste it in the new sheet (Ctrl+V)');
                                      }}
                                      className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-400 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                    >
                                      <div className="w-14 h-14 bg-green-500 rounded-xl flex items-center justify-center">
                                        <span className="text-3xl">üìä</span>
                                      </div>
                                      <div className="text-center">
                                        <p className="font-bold text-green-800">Google Sheets</p>
                                        <p className="text-xs text-green-600">Open & Edit Online</p>
                                      </div>
                                    </button>

                                    {/* Excel Download Option */}
                                    <button
                                      onClick={() => {
                                        // Generate Excel-compatible CSV
                                        const csvContent = `"TAX INVOICE"

"SELLER DETAILS",,,"INVOICE DETAILS"
"Company Name:","[YOUR PRODUCTION COMPANY]",,"Invoice No.:","GST-__/25-26"
"Address:","[YOUR COMPLETE ADDRESS]",,"Invoice Date:","__/__/2026"
"City/State:","[CITY STATE PINCODE]",,"Due Date:","__/__/2026"
"GSTIN:","[YOUR GSTIN]",,"Place of Supply:","Delhi"

"BILL TO:"
"STAGE Technologies Private Limited"
"2nd Floor, 2-A/3 S/F, Front SIDE, Kundan Mansion"
"Asaf Ali Road, New Delhi - 110002"
"GSTIN: 07AAICC1279L1ZC"

"#","Item Description","HSN/SAC","Qty","Rate","IGST","Cess","Amount"
"1","[Regional] Film [PROJECT NAME] - 1st Tranch (25% upon signing of agreement)","","1","‚Çπ 0.00","","0","‚Çπ 0.00"
"","","","","","","",""
"","","","","","SUB TOTAL","","‚Çπ 0.00"
"","","","","","IGST (18%)","","‚Çπ 0.00"
"","","","","","TOTAL","","‚Çπ 0.00"

"BANK DETAILS"
"Account Name:","[YOUR COMPANY NAME]"
"Account No:","[ACCOUNT NUMBER]"
"IFSC Code:","[IFSC CODE]"
"Branch:","[BRANCH NAME]"
"Bank:","[BANK NAME]"
"PAN No:","[PAN NUMBER]"
"Aadhar No:","[AADHAR NUMBER]"

"","Authorized Signatory"`;

                                        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                                        const url = URL.createObjectURL(blob);
                                        const link = document.createElement('a');
                                        link.href = url;
                                        link.download = 'STAGE_Invoice_Template.csv';
                                        document.body.appendChild(link);
                                        link.click();
                                        document.body.removeChild(link);
                                        URL.revokeObjectURL(url);
                                        alert('Excel file downloaded! Open in MS Excel or Google Sheets to edit.');
                                      }}
                                      className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-emerald-50 to-emerald-100 border-2 border-emerald-400 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                    >
                                      <div className="w-14 h-14 bg-emerald-600 rounded-xl flex items-center justify-center">
                                        <span className="text-3xl">üìó</span>
                                      </div>
                                      <div className="text-center">
                                        <p className="font-bold text-emerald-800">Download Excel</p>
                                        <p className="text-xs text-emerald-600">Edit in MS Excel</p>
                                      </div>
                                    </button>

                                    {/* WhatsApp Share Option */}
                                    <button
                                      onClick={() => {
                                        const message = `*TAX INVOICE FORMAT - STAGE PRODUCTION*

*SELLER DETAILS:*
Company: [YOUR PRODUCTION COMPANY]
Address: [YOUR COMPLETE ADDRESS]
GSTIN: [YOUR GSTIN]

*BILL TO:*
STAGE Technologies Private Limited
2nd Floor, 2-A/3 S/F, Kundan Mansion
Asaf Ali Road, New Delhi - 110002
GSTIN: 07AAICC1279L1ZC

*INVOICE DETAILS:*
Invoice No.: GST-__/25-26
Date: __/__/2026
Place of Supply: Delhi

*ITEM:*
[Regional] Film "[PROJECT NAME]"
1st Tranch - 25% upon signing

Rate: ‚Çπ __,__,___
IGST (18%): ‚Çπ __,___
*TOTAL: ‚Çπ __,__,___*

*BANK DETAILS:*
A/C Name: [YOUR COMPANY]
A/C No: [ACCOUNT NUMBER]
IFSC: [IFSC CODE]
Bank: [BANK NAME]
PAN: [PAN NUMBER]

_Please fill your details and send back._`;
                                        const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                                        window.open(whatsappUrl, '_blank');
                                      }}
                                      className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-500 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                    >
                                      <div className="w-14 h-14 bg-green-600 rounded-xl flex items-center justify-center">
                                        <span className="text-3xl">üí¨</span>
                                      </div>
                                      <div className="text-center">
                                        <p className="font-bold text-green-800">WhatsApp</p>
                                        <p className="text-xs text-green-600">Share via WhatsApp</p>
                                      </div>
                                    </button>
                                  </div>

                                  <p className="text-xs text-gray-500 mt-4 text-center">
                                    üí° Share Excel/Google Sheets with Creator - They can edit and send back
                                  </p>
                                </div>

                                {/* Invoice Preview Card - Stylish OTT Design */}
                                <div className="rounded-2xl shadow-2xl overflow-hidden border-2 border-red-500/30">
                                  {/* Invoice Header - Premium Red Gradient */}
                                  <div className="bg-gradient-to-r from-red-600 via-red-700 to-red-800 p-6">
                                    <div className="flex justify-between items-center">
                                      <div className="flex items-center gap-4">
                                        <div className="w-16 h-16 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30">
                                          <span className="text-4xl">üé¨</span>
                                        </div>
                                        <div>
                                          <h4 className="text-2xl font-black text-white">[YOUR PRODUCTION HOUSE]</h4>
                                          <p className="text-red-200 text-sm mt-1">Film & Content Production</p>
                                        </div>
                                      </div>
                                      <div className="bg-white/15 backdrop-blur-sm px-6 py-4 rounded-xl border border-white/20 text-center">
                                        <h3 className="text-2xl font-black text-white tracking-wider">TAX INVOICE</h3>
                                        <p className="text-red-200 text-xs mt-1">GST Compliant</p>
                                      </div>
                                    </div>
                                  </div>

                                  {/* Seller & Buyer Section */}
                                  <div className="grid grid-cols-2">
                                    {/* Seller */}
                                    <div className="p-5 bg-slate-50 border-r border-gray-200">
                                      <p className="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3">From / Seller</p>
                                      <h5 className="font-bold text-lg text-slate-900">[YOUR COMPANY NAME]</h5>
                                      <p className="text-sm text-slate-600 mt-2">[Your Complete Address]<br/>[City, State - Pincode]</p>
                                      <div className="inline-block bg-slate-900 text-white px-3 py-1.5 rounded-md text-xs font-bold mt-3">
                                        GSTIN: [YOUR GSTIN]
                                      </div>
                                    </div>
                                    {/* Buyer */}
                                    <div className="p-5 bg-amber-50">
                                      <p className="text-xs font-bold text-amber-700 uppercase tracking-wider mb-3">Bill To / Buyer</p>
                                      <h5 className="font-bold text-lg text-slate-900">STAGE Technologies Pvt Ltd</h5>
                                      <p className="text-sm text-slate-600 mt-2">2nd Floor, Kundan Mansion,<br/>Asaf Ali Road, New Delhi - 110002</p>
                                      <div className="inline-block bg-slate-900 text-white px-3 py-1.5 rounded-md text-xs font-bold mt-3">
                                        GSTIN: 07AAICC1279L1ZC
                                      </div>
                                    </div>
                                  </div>

                                  {/* Invoice Meta - Dark Strip */}
                                  <div className="bg-slate-900 px-5 py-4 grid grid-cols-4 gap-4">
                                    <div className="text-center">
                                      <p className="text-slate-400 text-xs uppercase tracking-wider">Invoice No.</p>
                                      <p className="text-white font-bold mt-1">GST-__/25-26</p>
                                    </div>
                                    <div className="text-center">
                                      <p className="text-slate-400 text-xs uppercase tracking-wider">Invoice Date</p>
                                      <p className="text-white font-bold mt-1">__/__/2026</p>
                                    </div>
                                    <div className="text-center">
                                      <p className="text-slate-400 text-xs uppercase tracking-wider">Due Date</p>
                                      <p className="text-white font-bold mt-1">__/__/2026</p>
                                    </div>
                                    <div className="text-center">
                                      <p className="text-slate-400 text-xs uppercase tracking-wider">Place of Supply</p>
                                      <p className="text-white font-bold mt-1">Delhi</p>
                                    </div>
                                  </div>

                                  {/* Items Table */}
                                  <div className="p-5 bg-white">
                                    <table className="w-full text-sm">
                                      <thead>
                                        <tr className="bg-gradient-to-r from-red-600 to-red-700 text-white">
                                          <th className="p-3 text-left w-10 font-bold rounded-l-lg">#</th>
                                          <th className="p-3 text-left font-bold">Description</th>
                                          <th className="p-3 text-center w-20 font-bold">HSN/SAC</th>
                                          <th className="p-3 text-center w-12 font-bold">Qty</th>
                                          <th className="p-3 text-right w-28 font-bold">Rate</th>
                                          <th className="p-3 text-center w-16 font-bold">IGST</th>
                                          <th className="p-3 text-right w-28 font-bold rounded-r-lg">Amount</th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr className="border-b-2 border-gray-100">
                                          <td className="p-4 font-bold text-slate-900">1</td>
                                          <td className="p-4">
                                            <p className="font-bold text-slate-900">[Regional] Film - "[PROJECT TITLE]"</p>
                                            <p className="text-slate-500 text-xs mt-2 leading-relaxed">
                                              üé¨ 1st Tranch Payment<br/>
                                              üìã 25% upon Agreement Signing<br/>
                                              üí∞ As per Production Agreement
                                            </p>
                                          </td>
                                          <td className="p-4 text-center text-slate-600 font-medium">997212</td>
                                          <td className="p-4 text-center text-slate-900 font-bold">1</td>
                                          <td className="p-4 text-right text-slate-900 font-bold">‚Çπ 10,94,417</td>
                                          <td className="p-4 text-center text-slate-600 font-medium">18%</td>
                                          <td className="p-4 text-right text-slate-900 font-black">‚Çπ 10,94,417</td>
                                        </tr>
                                      </tbody>
                                    </table>

                                    {/* Totals */}
                                    <div className="flex justify-end mt-5">
                                      <div className="w-80 rounded-xl overflow-hidden border-2 border-slate-200 shadow-lg">
                                        <div className="flex justify-between py-3 px-5 bg-slate-50 border-b border-slate-200">
                                          <span className="font-bold text-slate-700">Subtotal</span>
                                          <span className="font-bold text-slate-900">‚Çπ 10,94,417.00</span>
                                        </div>
                                        <div className="flex justify-between py-3 px-5 bg-slate-50 border-b border-slate-200">
                                          <span className="font-bold text-slate-700">IGST @ 18%</span>
                                          <span className="font-bold text-slate-900">‚Çπ 1,96,996.00</span>
                                        </div>
                                        <div className="flex justify-between py-4 px-5 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white">
                                          <span className="font-black text-lg">TOTAL</span>
                                          <span className="font-black text-lg">‚Çπ 12,91,413.00</span>
                                        </div>
                                      </div>
                                    </div>
                                  </div>

                                  {/* Footer - Bank Details */}
                                  <div className="p-5 bg-slate-50 border-t-2 border-slate-200 flex justify-between items-end">
                                    <div>
                                      <p className="font-black text-sm text-slate-900 mb-3 flex items-center gap-2">üí≥ Bank Details</p>
                                      <div className="text-sm text-slate-600 leading-relaxed">
                                        <p><span className="font-bold text-slate-800">Account Name:</span> [YOUR COMPANY]</p>
                                        <p><span className="font-bold text-slate-800">Account No:</span> [ACCOUNT NUMBER]</p>
                                        <p><span className="font-bold text-slate-800">IFSC:</span> [IFSC CODE]</p>
                                        <p><span className="font-bold text-slate-800">Bank:</span> [BANK NAME], [BRANCH]</p>
                                        <p><span className="font-bold text-slate-800">PAN:</span> [PAN NUMBER]</p>
                                      </div>
                                    </div>
                                    <div className="text-center">
                                      <div className="border-b-2 border-slate-400 w-44 mb-2"></div>
                                      <p className="text-sm font-black text-slate-900">Authorized Signatory</p>
                                      <p className="text-xs text-slate-500 mt-1">[YOUR COMPANY NAME]</p>
                                    </div>
                                  </div>

                                  {/* Watermark Footer */}
                                  <div className="bg-slate-900 py-3 px-5 text-center">
                                    <p className="text-slate-400 text-xs">
                                      üé¨ STAGE OTT Platform ‚Ä¢ Regional Content Production Partner ‚Ä¢ www.stageasai.com
                                    </p>
                                  </div>
                                </div>
                              </div>

                              {/* Payment Tranch Info */}
                              <div className="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6">
                                <h4 className="font-bold text-blue-800 mb-3 flex items-center gap-2">üí∞ Payment Tranch Schedule</h4>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                  <div className="bg-white rounded-lg p-3 border border-blue-200">
                                    <div className="text-2xl font-bold text-blue-600">25%</div>
                                    <div className="text-xs text-gray-600">1st Tranch</div>
                                    <div className="text-xs text-blue-700 font-medium mt-1">Upon Agreement Signing</div>
                                  </div>
                                  <div className="bg-white rounded-lg p-3 border border-blue-200">
                                    <div className="text-2xl font-bold text-blue-600">25%</div>
                                    <div className="text-xs text-gray-600">2nd Tranch</div>
                                    <div className="text-xs text-blue-700 font-medium mt-1">Pre-Production Complete</div>
                                  </div>
                                  <div className="bg-white rounded-lg p-3 border border-blue-200">
                                    <div className="text-2xl font-bold text-blue-600">25%</div>
                                    <div className="text-xs text-gray-600">3rd Tranch</div>
                                    <div className="text-xs text-blue-700 font-medium mt-1">Shoot Complete</div>
                                  </div>
                                  <div className="bg-white rounded-lg p-3 border border-blue-200">
                                    <div className="text-2xl font-bold text-blue-600">25%</div>
                                    <div className="text-xs text-gray-600">4th Tranch</div>
                                    <div className="text-xs text-blue-700 font-medium mt-1">Final Delivery & QC</div>
                                  </div>
                                </div>
                              </div>

                              {/* Guidelines Section */}
                              <h4 className="font-bold text-gray-800 mb-4">Invoice Guidelines</h4>
                            </div>
                          )}

                          {/* Clapboard / Film Slate Template Section */}
                          {(selectedCat as any).hasClapboardTemplate && (
                            <div className="mb-8">
                              {/* Clapboard Header */}
                              <div className="bg-gradient-to-br from-slate-900 via-gray-800 to-slate-900 border-2 border-amber-500/50 rounded-2xl p-6 mb-6 shadow-2xl">
                                <div className="flex items-center justify-between mb-4">
                                  <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl flex items-center justify-center shadow-lg border-2 border-white/20">
                                      <span className="text-4xl">üé¨</span>
                                    </div>
                                    <div>
                                      <h3 className="text-2xl font-black text-white">STAGE Film Slate / Clapboard</h3>
                                      <p className="text-amber-400 text-sm font-medium">Professional Production Standard</p>
                                    </div>
                                  </div>
                                  <button
                                    onClick={() => {
                                      const clapboardHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>STAGE Film Slate / Clapboard</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Roboto+Mono:wght@700&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', sans-serif; background: #0f0f0f; min-height: 100vh; padding: 40px; display: flex; justify-content: center; align-items: center; }
    .slate-container { width: 700px; background: #1a1a1a; border-radius: 20px; overflow: hidden; box-shadow: 0 30px 60px rgba(0,0,0,0.5); }
    .clapper-top { background: repeating-linear-gradient(45deg, #fbbf24, #fbbf24 30px, #0f0f0f 30px, #0f0f0f 60px); height: 80px; position: relative; border-bottom: 4px solid #fbbf24; }
    .clapper-top::after { content: 'STAGE OTT'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 24px; font-weight: 900; color: white; text-shadow: 2px 2px 0 #000, -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000; letter-spacing: 3px; }
    .slate-body { padding: 30px; }
    .production-title { text-align: center; padding: 20px; background: linear-gradient(135deg, #fbbf24, #f59e0b); border-radius: 12px; margin-bottom: 25px; }
    .production-title h1 { font-size: 32px; font-weight: 900; color: #0f0f0f; letter-spacing: 2px; }
    .production-title p { font-size: 14px; color: #44403c; font-weight: 600; margin-top: 5px; }
    .info-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; }
    .info-box { background: #262626; border: 2px solid #fbbf24; border-radius: 10px; padding: 15px; text-align: center; }
    .info-box .label { font-size: 10px; color: #fbbf24; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 8px; }
    .info-box .value { font-family: 'Roboto Mono', monospace; font-size: 28px; color: white; font-weight: 700; min-height: 40px; border-bottom: 2px dashed #444; padding-bottom: 5px; }
    .info-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; }
    .crew-section { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .crew-box { background: #1f1f1f; border: 1px solid #333; border-radius: 8px; padding: 12px; }
    .crew-box .role { font-size: 10px; color: #fbbf24; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
    .crew-box .name { font-size: 16px; color: white; font-weight: 600; border-bottom: 1px dashed #444; padding-bottom: 5px; min-height: 24px; }
    .tech-bar { display: flex; justify-content: space-between; background: #0f0f0f; padding: 15px 20px; border-radius: 10px; margin-top: 20px; }
    .tech-item { text-align: center; }
    .tech-item .t-label { font-size: 9px; color: #666; text-transform: uppercase; letter-spacing: 1px; }
    .tech-item .t-value { font-size: 14px; color: #fbbf24; font-weight: 700; margin-top: 3px; }
    .slate-footer { background: #fbbf24; padding: 12px; text-align: center; }
    .slate-footer p { font-size: 11px; color: #0f0f0f; font-weight: 700; letter-spacing: 1px; }
    @media print { body { padding: 0; background: white; } .slate-container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="slate-container">
    <div class="clapper-top"></div>
    <div class="slate-body">
      <div class="production-title">
        <h1>[PRODUCTION TITLE]</h1>
        <p>STAGE OTT Original ‚Ä¢ [Language] ‚Ä¢ [Format]</p>
      </div>
      <div class="info-grid">
        <div class="info-box">
          <div class="label">Scene</div>
          <div class="value">___</div>
        </div>
        <div class="info-box">
          <div class="label">Shot</div>
          <div class="value">___</div>
        </div>
        <div class="info-box">
          <div class="label">Take</div>
          <div class="value">___</div>
        </div>
      </div>
      <div class="info-row">
        <div class="info-box">
          <div class="label">Roll / Card</div>
          <div class="value">___</div>
        </div>
        <div class="info-box">
          <div class="label">Date</div>
          <div class="value">__/__/2026</div>
        </div>
      </div>
      <div class="crew-section">
        <div class="crew-box">
          <div class="role">Director</div>
          <div class="name">[DIRECTOR NAME]</div>
        </div>
        <div class="crew-box">
          <div class="role">DOP / Cinematographer</div>
          <div class="name">[DOP NAME]</div>
        </div>
        <div class="crew-box">
          <div class="role">Camera</div>
          <div class="name">A / B / C</div>
        </div>
        <div class="crew-box">
          <div class="role">Sound</div>
          <div class="name">SYNC / MOS</div>
        </div>
      </div>
      <div class="tech-bar">
        <div class="tech-item">
          <div class="t-label">FPS</div>
          <div class="t-value">25</div>
        </div>
        <div class="tech-item">
          <div class="t-label">Shutter</div>
          <div class="t-value">1/50</div>
        </div>
        <div class="tech-item">
          <div class="t-label">ISO</div>
          <div class="t-value">___</div>
        </div>
        <div class="tech-item">
          <div class="t-label">Lens</div>
          <div class="t-value">___mm</div>
        </div>
        <div class="tech-item">
          <div class="t-label">Filter</div>
          <div class="t-value">___</div>
        </div>
        <div class="tech-item">
          <div class="t-label">INT/EXT</div>
          <div class="t-value">___</div>
        </div>
        <div class="tech-item">
          <div class="t-label">DAY/NIGHT</div>
          <div class="t-value">___</div>
        </div>
      </div>
    </div>
    <div class="slate-footer">
      <p>STAGE OTT PRODUCTION ‚Ä¢ OFFICIAL CLAPBOARD ‚Ä¢ USE FOR ALL SHOTS</p>
    </div>
  </div>
</body>
</html>`;
                                      const printWindow = window.open('', '_blank');
                                      if (printWindow) {
                                        printWindow.document.write(clapboardHtml);
                                        printWindow.document.close();
                                        printWindow.print();
                                      }
                                    }}
                                    className="px-4 py-2 bg-amber-500 hover:bg-amber-400 text-black rounded-lg text-sm font-bold flex items-center gap-2"
                                  >
                                    üñ®Ô∏è Print Clapboard
                                  </button>
                                </div>
                                <p className="text-gray-300 text-sm leading-relaxed">
                                  STAGE-approved film slate format with all essential fields - Scene, Shot, Take, Roll, Director, DOP, and technical settings.
                                  Required for every shot in production for proper organization and sync reference.
                                </p>
                              </div>

                              {/* Clapboard Preview */}
                              <div className="rounded-2xl shadow-2xl overflow-hidden border-2 border-amber-500/30 bg-gradient-to-b from-gray-900 to-black">
                                {/* Clapper Top Bar */}
                                <div className="h-16 bg-repeating-linear-gradient relative" style={{background: 'repeating-linear-gradient(45deg, #fbbf24, #fbbf24 20px, #000 20px, #000 40px)'}}>
                                  <div className="absolute inset-0 flex items-center justify-center">
                                    <span className="text-white font-black text-xl tracking-widest drop-shadow-lg" style={{textShadow: '2px 2px 0 #000'}}>STAGE OTT</span>
                                  </div>
                                </div>

                                {/* Slate Body */}
                                <div className="p-6">
                                  {/* Production Title */}
                                  <div className="bg-gradient-to-r from-amber-400 to-amber-500 rounded-xl p-4 mb-5 text-center">
                                    <h2 className="text-2xl font-black text-black tracking-wide">[PRODUCTION TITLE]</h2>
                                    <p className="text-amber-900 text-sm font-semibold">STAGE Original ‚Ä¢ [Language]</p>
                                  </div>

                                  {/* Scene/Shot/Take Grid */}
                                  <div className="grid grid-cols-3 gap-4 mb-5">
                                    {[
                                      { label: 'SCENE', value: '___' },
                                      { label: 'SHOT', value: '___' },
                                      { label: 'TAKE', value: '___' },
                                    ].map(item => (
                                      <div key={item.label} className="bg-gray-800 border-2 border-amber-500 rounded-xl p-4 text-center">
                                        <p className="text-amber-400 text-xs font-bold tracking-widest mb-2">{item.label}</p>
                                        <p className="text-white text-3xl font-mono font-bold border-b-2 border-dashed border-gray-600 pb-2">{item.value}</p>
                                      </div>
                                    ))}
                                  </div>

                                  {/* Roll & Date */}
                                  <div className="grid grid-cols-2 gap-4 mb-5">
                                    <div className="bg-gray-800 border border-amber-500/50 rounded-xl p-3 text-center">
                                      <p className="text-amber-400 text-xs font-bold tracking-wider mb-1">ROLL / CARD</p>
                                      <p className="text-white text-xl font-mono font-bold">___</p>
                                    </div>
                                    <div className="bg-gray-800 border border-amber-500/50 rounded-xl p-3 text-center">
                                      <p className="text-amber-400 text-xs font-bold tracking-wider mb-1">DATE</p>
                                      <p className="text-white text-xl font-mono font-bold">__/__/2026</p>
                                    </div>
                                  </div>

                                  {/* Crew Info */}
                                  <div className="grid grid-cols-2 gap-3 mb-5">
                                    {[
                                      { role: 'DIRECTOR', name: '[Director Name]' },
                                      { role: 'DOP', name: '[Cinematographer]' },
                                      { role: 'CAMERA', name: 'A / B / C' },
                                      { role: 'SOUND', name: 'SYNC / MOS' },
                                    ].map(crew => (
                                      <div key={crew.role} className="bg-gray-900 border border-gray-700 rounded-lg p-3">
                                        <p className="text-amber-500 text-xs font-bold tracking-wider">{crew.role}</p>
                                        <p className="text-white text-sm font-semibold border-b border-dashed border-gray-600 pb-1 mt-1">{crew.name}</p>
                                      </div>
                                    ))}
                                  </div>

                                  {/* Technical Bar */}
                                  <div className="bg-black rounded-xl p-4 flex justify-between">
                                    {[
                                      { label: 'FPS', value: '25' },
                                      { label: 'SHUTTER', value: '1/50' },
                                      { label: 'ISO', value: '___' },
                                      { label: 'LENS', value: '___mm' },
                                      { label: 'INT/EXT', value: '___' },
                                      { label: 'DAY/NIT', value: '___' },
                                    ].map(tech => (
                                      <div key={tech.label} className="text-center">
                                        <p className="text-gray-500 text-xs font-medium">{tech.label}</p>
                                        <p className="text-amber-400 text-sm font-bold mt-1">{tech.value}</p>
                                      </div>
                                    ))}
                                  </div>
                                </div>

                                {/* Footer */}
                                <div className="bg-amber-500 py-3 text-center">
                                  <p className="text-black text-xs font-bold tracking-wider">STAGE OTT PRODUCTION ‚Ä¢ OFFICIAL CLAPBOARD</p>
                                </div>
                              </div>

                              <h4 className="font-bold text-gray-800 mb-4 mt-6">Clapboard Guidelines</h4>
                            </div>
                          )}

                          {/* NOC Template Section - Comprehensive Department-wise */}
                          {(selectedCat as any).hasNocTemplate && (
                            <div className="mb-8">
                              {/* NOC Header */}
                              <div className="bg-gradient-to-br from-slate-900 via-purple-900 to-indigo-900 border-2 border-purple-500/50 rounded-2xl p-6 mb-6 shadow-2xl">
                                <div className="flex items-center justify-between mb-4">
                                  <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg border-2 border-white/20">
                                      <span className="text-4xl">üìú</span>
                                    </div>
                                    <div>
                                      <h3 className="text-2xl font-black text-white">STAGE Work-For-Hire NOC</h3>
                                      <p className="text-purple-300 text-sm font-medium">Copyright Act 1957 Compliant ‚Ä¢ IP Rights Assignment</p>
                                    </div>
                                  </div>
                                </div>
                                <p className="text-purple-200 text-sm leading-relaxed">
                                  Standard OTT industry NOC format for all departments - Director, Writer, Music Composer, Actors, and more.
                                  Includes Work-for-Hire declaration, IP Rights Assignment, Moral Rights Waiver as per Copyright Act 1957.
                                </p>
                              </div>

                              {/* Department Selection */}
                              <div className="bg-white border-2 border-purple-200 rounded-xl p-5 mb-6">
                                <h4 className="font-bold text-purple-800 mb-4 flex items-center gap-2">
                                  üé¨ Select Department / Role for NOC
                                </h4>
                                <div className="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                                  {[
                                    { id: 'director', label: 'Director', icon: 'üé¨', color: 'from-red-500 to-red-600' },
                                    { id: 'writer', label: 'Writer', icon: '‚úçÔ∏è', color: 'from-blue-500 to-blue-600' },
                                    { id: 'composer', label: 'Music Composer', icon: 'üéµ', color: 'from-purple-500 to-purple-600' },
                                    { id: 'lyricist', label: 'Lyricist', icon: 'üìù', color: 'from-pink-500 to-pink-600' },
                                    { id: 'dop', label: 'DOP/Cinematographer', icon: 'üì∑', color: 'from-amber-500 to-amber-600' },
                                    { id: 'editor', label: 'Editor', icon: 'üéûÔ∏è', color: 'from-green-500 to-green-600' },
                                    { id: 'sound', label: 'Sound Designer', icon: 'üîä', color: 'from-cyan-500 to-cyan-600' },
                                    { id: 'actor', label: 'Actor/Talent', icon: 'üé≠', color: 'from-rose-500 to-rose-600' },
                                    { id: 'vfx', label: 'VFX Artist', icon: '‚ú®', color: 'from-violet-500 to-violet-600' },
                                    { id: 'production', label: 'Production House', icon: 'üè¢', color: 'from-slate-600 to-slate-700' },
                                    { id: 'location', label: 'Location NOC', icon: 'üìç', color: 'from-emerald-500 to-teal-600' },
                                    { id: 'music', label: 'Music Rights', icon: 'üéº', color: 'from-indigo-500 to-blue-600' },
                                  ].map(dept => (
                                    <button
                                      key={dept.id}
                                      onClick={() => {
                                        const nocHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>NOC - ${dept.label} - STAGE OTT</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f1f5f9; padding: 30px; }
    .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%); padding: 30px; text-align: center; }
    .logo-row { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 15px; }
    .logo { width: 60px; height: 60px; background: rgba(255,255,255,0.15); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 30px; }
    .header h1 { color: white; font-size: 26px; font-weight: 900; letter-spacing: 1px; }
    .header .subtitle { color: #c4b5fd; font-size: 13px; margin-top: 5px; }
    .badge { display: inline-block; background: rgba(255,255,255,0.2); color: white; padding: 6px 16px; border-radius: 20px; font-size: 11px; font-weight: 600; margin-top: 10px; }
    .meta-strip { background: #0f172a; padding: 12px 30px; display: flex; justify-content: space-between; flex-wrap: wrap; gap: 10px; }
    .meta-item { text-align: center; flex: 1; min-width: 120px; }
    .meta-label { font-size: 9px; color: #64748b; text-transform: uppercase; letter-spacing: 1px; }
    .meta-value { font-size: 13px; font-weight: 700; color: white; margin-top: 2px; }
    .content { padding: 30px; }
    .section { margin-bottom: 25px; }
    .section-title { font-size: 12px; font-weight: 800; color: #6366f1; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e2e8f0; }
    .party-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px; }
    .party-box { background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; }
    .party-box.contributor { border-left: 4px solid #6366f1; }
    .party-box.company { border-left: 4px solid #10b981; }
    .party-label { font-size: 10px; font-weight: 700; color: #64748b; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
    .party-name { font-size: 16px; font-weight: 800; color: #0f172a; margin-bottom: 4px; }
    .party-role { font-size: 12px; color: #6366f1; font-weight: 600; margin-bottom: 8px; }
    .party-details { font-size: 12px; color: #475569; line-height: 1.6; }
    .clause { margin-bottom: 20px; }
    .clause-num { display: inline-block; background: #6366f1; color: white; width: 24px; height: 24px; border-radius: 50%; text-align: center; line-height: 24px; font-size: 12px; font-weight: 700; margin-right: 10px; }
    .clause-title { font-size: 14px; font-weight: 700; color: #0f172a; margin-bottom: 8px; }
    .clause-text { font-size: 12px; color: #334155; line-height: 1.8; text-align: justify; padding-left: 34px; }
    .highlight { background: #fef3c7; padding: 2px 6px; border-radius: 4px; font-weight: 600; }
    .amount-box { background: linear-gradient(135deg, #ecfdf5, #d1fae5); border: 2px solid #10b981; border-radius: 12px; padding: 20px; margin: 20px 0; }
    .amount-label { font-size: 11px; font-weight: 700; color: #047857; text-transform: uppercase; letter-spacing: 1px; }
    .amount-value { font-size: 28px; font-weight: 900; color: #059669; margin-top: 5px; }
    .amount-note { font-size: 11px; color: #047857; margin-top: 8px; }
    .rights-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; }
    .right-item { background: #f1f5f9; padding: 10px; border-radius: 8px; text-align: center; font-size: 11px; color: #475569; }
    .right-item strong { display: block; color: #0f172a; margin-bottom: 3px; }
    .signature-section { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 40px; padding-top: 30px; border-top: 2px solid #e2e8f0; }
    .sign-box { text-align: center; }
    .sign-line { height: 80px; border-bottom: 2px solid #1e293b; margin-bottom: 10px; }
    .sign-name { font-size: 14px; font-weight: 800; color: #0f172a; }
    .sign-role { font-size: 11px; color: #64748b; margin-top: 3px; }
    .acceptance { background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 20px; margin-top: 25px; text-align: center; }
    .acceptance p { font-size: 13px; color: #92400e; font-weight: 600; }
    .footer { background: #0f172a; padding: 15px 30px; text-align: center; }
    .footer p { color: #64748b; font-size: 10px; }
    @media print { body { background: white; padding: 10px; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo-row">
        <div class="logo">üé¨</div>
        <div class="logo">${dept.icon}</div>
      </div>
      <h1>NO OBJECTION CERTIFICATE</h1>
      <div class="subtitle">Work-For-Hire Agreement ‚Ä¢ ${dept.label}</div>
      <div class="badge">Copyright Act 1957 Compliant ‚Ä¢ IP Rights Assignment</div>
    </div>

    <div class="meta-strip">
      <div class="meta-item"><div class="meta-label">Reference No.</div><div class="meta-value">STAGE/NOC/${dept.id.toUpperCase()}/____/25-26</div></div>
      <div class="meta-item"><div class="meta-label">Department</div><div class="meta-value">${dept.label}</div></div>
      <div class="meta-item"><div class="meta-label">Date</div><div class="meta-value">__/__/2026</div></div>
      <div class="meta-item"><div class="meta-label">Project Code</div><div class="meta-value">STAGE-____</div></div>
    </div>

    <div class="content">
      <div class="party-grid">
        <div class="party-box contributor">
          <div class="party-label">Contributor / Service Provider</div>
          <div class="party-name">[CONTRIBUTOR NAME]</div>
          <div class="party-role">${dept.label}</div>
          <div class="party-details">
            Address: [Complete Address]<br>
            PAN: [PAN Number]<br>
            Contact: [Phone / Email]
          </div>
        </div>
        <div class="party-box company">
          <div class="party-label">Production Company</div>
          <div class="party-name">STAGE Technologies Private Limited</div>
          <div class="party-role">OTT Platform & Producer</div>
          <div class="party-details">
            2nd Floor, Kundan Mansion,<br>
            Asaf Ali Road, New Delhi - 110002<br>
            GSTIN: 07AAICC1279L1ZC
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üìã Project Details</div>
        <div class="party-box" style="border-left: 4px solid #f59e0b;">
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 13px;">
            <div><strong>Project Title:</strong> [PROJECT NAME]</div>
            <div><strong>Language:</strong> [REGIONAL LANGUAGE]</div>
            <div><strong>Format:</strong> [Film / Web Series / Microdrama]</div>
            <div><strong>Episodes:</strong> [Number if applicable]</div>
            <div><strong>Director:</strong> [Director Name]</div>
            <div><strong>Producer:</strong> [Production House]</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üìú Work-For-Hire Declaration</div>
        <div class="clause">
          <span class="clause-num">1</span>
          <span class="clause-title">Engagement & Services</span>
          <p class="clause-text">The Contributor hereby certifies and agrees to provide services as <span class="highlight">${dept.label}</span> for the Project titled <span class="highlight">[PROJECT NAME]</span> produced by M/s STAGE Technologies Private Limited ("Company"). The Contributor shall provide all services customarily provided in connection with the role of ${dept.label}, including creation of all materials, ideas, concepts, and works in whatever stage of completion ("Works").</p>
        </div>

        <div class="clause">
          <span class="clause-num">2</span>
          <span class="clause-title">Compensation / Fees</span>
          <div class="amount-box">
            <div class="amount-label">All-Inclusive Fees (INR)</div>
            <div class="amount-value">‚Çπ ____________/-</div>
            <div class="amount-note">Inclusive of direct taxes ‚Ä¢ Exclusive of GST ‚Ä¢ Subject to TDS as applicable</div>
          </div>
          <p class="clause-text">Subject to Contributor's compliance with this Agreement and Company's receipt of this NOC, and any tax documents required, Company shall pay the above all-inclusive fees covering all costs for rendering Services and assignment of all rights.</p>
        </div>

        <div class="clause">
          <span class="clause-num">3</span>
          <span class="clause-title">Work Made for Hire (Copyright Act, 1957)</span>
          <p class="clause-text">Contributor certifies that all results and proceeds of Contributor's Services, including without limitation the Works, will be deemed specially ordered or commissioned by Company for inclusion in audio-visual works, and as such, constitute a <span class="highlight">"work made for hire"</span> under the Copyright Act, 1957 and all copyright laws throughout the universe. Company is deemed the author and first owner thereof. The Works will be Company's sole and exclusive property, <span class="highlight">in perpetuity, throughout the universe</span>, in all media now known or hereafter devised, together with all rights including copyrights, copyright renewals, ancillary rights and neighbouring rights.</p>
        </div>

        <div class="clause">
          <span class="clause-num">4</span>
          <span class="clause-title">IP Rights Assignment</span>
          <p class="clause-text">If for any reason any of the Works are not recognized as "work made for hire," Contributor hereby irrevocably assigns and transfers to Company all intellectual property rights, including copyrights, renewed terms of copyright, ancillary rights and neighbouring rights in and to any of the Works, in all modes, media and formats now known or hereafter devised. Contributor acknowledges that Company will have the sole and exclusive right to administer the Works including publishing, communicating to public, synchronizing, reproducing, and exploiting in any manner whatsoever.</p>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üéØ Exploitation Rights</div>
        <div class="rights-grid">
          <div class="right-item"><strong>üé¨ Theatrical</strong>Cinema Release</div>
          <div class="right-item"><strong>üì∫ Television</strong>Cable, Satellite, DTH</div>
          <div class="right-item"><strong>üì± OTT/Digital</strong>Streaming Platforms</div>
          <div class="right-item"><strong>üìÄ Home Video</strong>DVD, Blu-ray</div>
          <div class="right-item"><strong>üåê Internet</strong>Web, Social Media</div>
          <div class="right-item"><strong>‚úàÔ∏è In-Flight</strong>Airlines, Hotels</div>
          <div class="right-item"><strong>üéÆ Gaming</strong>Interactive Media</div>
          <div class="right-item"><strong>üõçÔ∏è Merchandise</strong>Products, Toys</div>
          <div class="right-item"><strong>üîÑ Remakes</strong>Adaptations, Sequels</div>
        </div>
        <p class="clause-text" style="padding-left: 0;">Company and its assignees shall have perpetual rights throughout the universe to exploit the Works in all current and future media including theatrical, OTT, television, internet, mobile, VR/AR, and any new technologies hereafter devised. Company may edit, dub, subtitle, remake, revise or combine the Works with other works as deemed appropriate.</p>
      </div>

      <div class="section">
        <div class="section-title">‚öñÔ∏è Moral Rights Waiver & Data Protection</div>
        <div class="clause">
          <span class="clause-num">5</span>
          <span class="clause-title">Moral Rights Waiver</span>
          <p class="clause-text">Contributor agrees to waive any and all moral rights relating to the Works, including rights of identification of authorship, rights of approval, restriction or limitation on use, and subsequent modifications including all "New Exploitation Rights" as may be recognized in future under law or equity.</p>
        </div>
        <div class="clause">
          <span class="clause-num">6</span>
          <span class="clause-title">Confidentiality & Data Protection</span>
          <p class="clause-text">Contributor shall maintain strict confidentiality of all project information. Any security breach must be reported to Company within 1 hour of discovery. Contributor is fully liable for security breach caused by own acts or omissions.</p>
        </div>
      </div>

      <div class="signature-section">
        <div class="sign-box">
          <div class="sign-line"></div>
          <div class="sign-name">[CONTRIBUTOR NAME]</div>
          <div class="sign-role">${dept.label} / Contributor</div>
        </div>
        <div class="sign-box">
          <div class="sign-line"></div>
          <div class="sign-name">For STAGE Technologies Pvt Ltd</div>
          <div class="sign-role">Authorized Signatory</div>
        </div>
      </div>

      <div class="acceptance">
        <p>üìß The Contributor is requested to mail this back with <strong>"I ACCEPT"</strong> within 24 hours of receipt.</p>
      </div>
    </div>

    <div class="footer">
      <p>üé¨ STAGE OTT Platform ‚Ä¢ Regional Content Production ‚Ä¢ Work-For-Hire NOC ‚Ä¢ Copyright Act 1957 Compliant</p>
    </div>
  </div>
</body>
</html>`;
                                        const printWindow = window.open('', '_blank');
                                        if (printWindow) {
                                          printWindow.document.write(nocHtml);
                                          printWindow.document.close();
                                          printWindow.print();
                                        }
                                      }}
                                      className={`flex flex-col items-center gap-2 p-3 bg-gradient-to-br ${dept.color} rounded-xl text-white hover:scale-105 transition-all shadow-lg`}
                                    >
                                      <span className="text-2xl">{dept.icon}</span>
                                      <span className="text-xs font-bold text-center leading-tight">{dept.label}</span>
                                    </button>
                                  ))}
                                </div>
                                <p className="text-xs text-gray-500 mt-4 text-center">
                                  Click on any department to generate & print professional Work-For-Hire NOC
                                </p>
                              </div>

                              {/* Download Options */}
                              <div className="bg-white border-2 border-purple-300 rounded-xl p-5 mb-6">
                                <h4 className="font-bold text-purple-800 mb-4 flex items-center gap-2 text-lg">
                                  üì• Download Master NOC Template (All Departments)
                                </h4>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                  {/* Google Sheets */}
                                  <button
                                    onClick={() => {
                                      const sheetsUrl = 'https://docs.google.com/spreadsheets/create';
                                      window.open(sheetsUrl, '_blank');
                                      const csvData = `STAGE OTT - WORK-FOR-HIRE NOC TEMPLATE
Copyright Act 1957 Compliant | IP Rights Assignment

REFERENCE NUMBER:,STAGE/NOC/[DEPT]/____/25-26
DATE:,__/__/2026
PROJECT CODE:,STAGE-____

CONTRIBUTOR DETAILS:
Name:,[FULL NAME]
Role/Department:,[Director/Writer/Composer/Actor/etc.]
Address:,[Complete Address]
PAN:,[PAN Number]
Contact:,[Phone / Email]
Bank Account:,[Account Details for Payment]

PROJECT DETAILS:
Title:,[PROJECT NAME]
Language:,[REGIONAL LANGUAGE]
Format:,[Film / Web Series / Microdrama]
Episodes:,[Number if applicable]
Director:,[Director Name]
Producer:,[Production House Name]

COMPANY DETAILS:
Name:,STAGE Technologies Private Limited
Address:,"2nd Floor, Kundan Mansion, Asaf Ali Road, New Delhi - 110002"
GSTIN:,07AAICC1279L1ZC

COMPENSATION:
All-Inclusive Fees (INR):,‚Çπ ____________/-
Payment Terms:,[Advance / Milestone based]
Note:,"Inclusive of direct taxes, Exclusive of GST, Subject to TDS"

WORK-FOR-HIRE DECLARATION:
"The Contributor certifies that all Works created shall be deemed 'work made for hire' under Copyright Act 1957. Company is the author and first owner. Works are Company's exclusive property in perpetuity throughout the universe in all media."

IP RIGHTS ASSIGNED:
1.,Copyright & Copyright Renewals
2.,Ancillary Rights & Neighbouring Rights
3.,Theatrical, OTT, Television, Internet Rights
4.,Remake, Sequel, Adaptation Rights
5.,Merchandising & Licensing Rights
6.,All Future/New Exploitation Rights

MORAL RIGHTS WAIVER:
"Contributor waives all moral rights including identification of authorship and approval rights."

SIGNATURES:
Contributor:,____________________
Date:,__/__/2026
For STAGE Technologies:,____________________
Date:,__/__/2026

ACCEPTANCE:
"Mail back with 'I ACCEPT' within 24 hours of receipt"`;
                                      navigator.clipboard.writeText(csvData);
                                      alert('Google Sheets opened! NOC data copied - paste it (Ctrl+V)');
                                    }}
                                    className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-400 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                  >
                                    <div className="w-14 h-14 bg-purple-500 rounded-xl flex items-center justify-center">
                                      <span className="text-3xl">üìä</span>
                                    </div>
                                    <div className="text-center">
                                      <p className="font-bold text-purple-800">Google Sheets</p>
                                      <p className="text-xs text-purple-600">Open & Edit Online</p>
                                    </div>
                                  </button>

                                  {/* Excel Download */}
                                  <button
                                    onClick={() => {
                                      const csvContent = `"STAGE OTT - WORK-FOR-HIRE NOC"
"Copyright Act 1957 Compliant"

"Reference:","STAGE/NOC/[DEPT]/____/25-26"
"Date:","__/__/2026"

"CONTRIBUTOR:"
"Name:","[FULL NAME]"
"Role:","[Department/Role]"
"Address:","[Complete Address]"
"PAN:","[PAN]"
"Contact:","[Phone/Email]"

"PROJECT:"
"Title:","[PROJECT NAME]"
"Language:","[REGIONAL]"
"Format:","[Film/Series]"

"COMPANY:"
"STAGE Technologies Private Limited"
"New Delhi - 110002"
"GSTIN: 07AAICC1279L1ZC"

"FEES:"
"Amount:","‚Çπ ____________/-"
"Terms:","Inclusive of taxes, Subject to TDS"

"DECLARATION:"
"All Works are 'work made for hire' under Copyright Act 1957. Company owns all IP rights in perpetuity."

"SIGNATURES:"
"Contributor:","____________________"
"Company:","____________________"

"Reply with 'I ACCEPT' within 24 hours"`;
                                      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                                      const url = URL.createObjectURL(blob);
                                      const link = document.createElement('a');
                                      link.href = url;
                                      link.download = 'STAGE_WorkForHire_NOC.csv';
                                      document.body.appendChild(link);
                                      link.click();
                                      document.body.removeChild(link);
                                      URL.revokeObjectURL(url);
                                      alert('NOC Excel downloaded!');
                                    }}
                                    className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-indigo-50 to-indigo-100 border-2 border-indigo-400 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                  >
                                    <div className="w-14 h-14 bg-indigo-600 rounded-xl flex items-center justify-center">
                                      <span className="text-3xl">üìó</span>
                                    </div>
                                    <div className="text-center">
                                      <p className="font-bold text-indigo-800">Download Excel</p>
                                      <p className="text-xs text-indigo-600">Edit in MS Excel</p>
                                    </div>
                                  </button>

                                  {/* WhatsApp */}
                                  <button
                                    onClick={() => {
                                      const message = `*STAGE OTT - WORK-FOR-HIRE NOC*
üìú _Copyright Act 1957 Compliant_

*Ref:* STAGE/NOC/____/25-26
*Date:* __/__/2026

*CONTRIBUTOR:*
Name: [YOUR NAME]
Role: [Director/Writer/Composer/etc.]
PAN: [PAN NUMBER]

*PROJECT:*
üé¨ Title: [PROJECT NAME]
üó£Ô∏è Language: [REGIONAL]
üì∫ Format: [Film/Series]

*COMPANY:*
STAGE Technologies Pvt Ltd
New Delhi - 110002

*FEES:* ‚Çπ ____________/-
_(Inclusive of taxes, Subject to TDS)_

*DECLARATION:*
All Works are "work made for hire" under Copyright Act 1957. Company owns all IP rights in perpetuity throughout universe.

*RIGHTS ASSIGNED:*
‚úÖ Copyright & Renewals
‚úÖ OTT, TV, Theatrical Rights
‚úÖ Remake/Sequel Rights
‚úÖ All Future Rights

*MORAL RIGHTS:* Waived

*SIGNATURES REQUIRED:*
‚úçÔ∏è Contributor
‚úçÔ∏è Company

üìß _Reply with "I ACCEPT" within 24 hours_

üé¨ STAGE OTT Platform`;
                                      const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
                                      window.open(whatsappUrl, '_blank');
                                    }}
                                    className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-500 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                  >
                                    <div className="w-14 h-14 bg-green-600 rounded-xl flex items-center justify-center">
                                      <span className="text-3xl">üí¨</span>
                                    </div>
                                    <div className="text-center">
                                      <p className="font-bold text-green-800">WhatsApp</p>
                                      <p className="text-xs text-green-600">Share via WhatsApp</p>
                                    </div>
                                  </button>
                                </div>
                              </div>

                              {/* Location NOC - Premium Template */}
                              <div className="bg-gradient-to-br from-emerald-900 via-teal-900 to-cyan-900 border-2 border-emerald-500/50 rounded-2xl p-6 mb-6 shadow-2xl">
                                <div className="flex items-center justify-between mb-4">
                                  <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center shadow-lg border-2 border-white/20">
                                      <span className="text-4xl">üìç</span>
                                    </div>
                                    <div>
                                      <h3 className="text-2xl font-black text-white">Location Permission NOC</h3>
                                      <p className="text-emerald-400 text-sm font-medium">Property Owner / Authority Consent</p>
                                    </div>
                                  </div>
                                  <button
                                    onClick={() => {
                                      const locationNocHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>Location NOC - STAGE OTT Production</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f1f5f9; padding: 30px; }
    .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #064e3b 0%, #047857 50%, #059669 100%); padding: 30px; text-align: center; position: relative; overflow: hidden; }
    .header::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 50%); }
    .logo-row { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 15px; position: relative; }
    .logo { width: 60px; height: 60px; background: rgba(255,255,255,0.15); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 30px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2); }
    .header h1 { color: white; font-size: 26px; font-weight: 900; letter-spacing: 1px; position: relative; }
    .header .subtitle { color: #a7f3d0; font-size: 13px; margin-top: 5px; }
    .badge { display: inline-block; background: rgba(255,255,255,0.2); color: white; padding: 6px 16px; border-radius: 20px; font-size: 11px; font-weight: 600; margin-top: 10px; border: 1px solid rgba(255,255,255,0.3); }
    .meta-strip { background: #0f172a; padding: 15px 30px; display: flex; justify-content: space-between; flex-wrap: wrap; gap: 10px; }
    .meta-item { text-align: center; flex: 1; min-width: 150px; }
    .meta-label { font-size: 9px; color: #64748b; text-transform: uppercase; letter-spacing: 1.5px; }
    .meta-value { font-size: 14px; font-weight: 700; color: white; margin-top: 3px; }
    .content { padding: 35px; }
    .to-section { margin-bottom: 25px; }
    .to-label { font-size: 14px; font-weight: 700; color: #047857; text-transform: uppercase; letter-spacing: 1px; border-bottom: 2px solid #d1fae5; padding-bottom: 8px; display: inline-block; }
    .subject-box { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border-left: 4px solid #047857; padding: 20px; border-radius: 0 12px 12px 0; margin: 20px 0; }
    .subject-label { font-size: 10px; font-weight: 700; color: #047857; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 8px; }
    .subject-text { font-size: 16px; font-weight: 700; color: #064e3b; }
    .body-text { font-size: 14px; color: #334155; line-height: 1.8; margin: 25px 0; }
    .highlight { background: #fef3c7; padding: 2px 6px; border-radius: 4px; font-weight: 600; }
    .section { margin-bottom: 30px; }
    .section-title { font-size: 12px; font-weight: 800; color: #047857; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #d1fae5; display: flex; align-items: center; gap: 8px; }
    .details-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .detail-box { background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 10px; padding: 15px; }
    .detail-label { font-size: 10px; color: #059669; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
    .detail-value { font-size: 14px; color: #064e3b; font-weight: 600; border-bottom: 1px dashed #86efac; padding-bottom: 5px; min-height: 22px; }
    .terms-box { background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 12px; padding: 25px; }
    .terms-list { list-style: none; }
    .terms-list li { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px; font-size: 13px; color: #475569; line-height: 1.6; }
    .check-icon { width: 22px; height: 22px; background: linear-gradient(135deg, #10b981, #059669); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; flex-shrink: 0; margin-top: 2px; }
    .restrictions { background: #fef2f2; border: 2px solid #fecaca; border-radius: 12px; padding: 20px; margin-top: 20px; }
    .restrictions-title { color: #dc2626; font-weight: 700; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
    .restrictions-list { list-style: none; }
    .restrictions-list li { display: flex; align-items: center; gap: 10px; font-size: 13px; color: #991b1b; margin-bottom: 8px; }
    .warning-icon { color: #dc2626; font-weight: bold; }
    .signature-section { display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px; margin-top: 40px; padding-top: 30px; border-top: 2px solid #e2e8f0; }
    .sign-box { text-align: center; }
    .sign-line { height: 60px; border-bottom: 2px solid #0f172a; margin-bottom: 10px; }
    .sign-label { font-size: 13px; font-weight: 700; color: #0f172a; }
    .sign-sublabel { font-size: 11px; color: #64748b; margin-top: 3px; }
    .footer { background: linear-gradient(135deg, #064e3b, #047857); padding: 15px; text-align: center; }
    .footer p { color: #a7f3d0; font-size: 11px; font-weight: 500; letter-spacing: 0.5px; }
    @media print { body { padding: 0; background: white; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo-row">
        <div class="logo">üé¨</div>
        <div class="logo">üìç</div>
      </div>
      <h1>LOCATION PERMISSION NOC</h1>
      <p class="subtitle">No Objection Certificate for Film/Content Production</p>
      <div class="badge">STAGE OTT Platform ‚Ä¢ Regional Content Production</div>
    </div>

    <div class="meta-strip">
      <div class="meta-item">
        <div class="meta-label">Reference Number</div>
        <div class="meta-value">STAGE/LOC/____/25-26</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Issue Date</div>
        <div class="meta-value">__/__/2026</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Valid From</div>
        <div class="meta-value">__/__/2026</div>
      </div>
      <div class="meta-item">
        <div class="meta-label">Valid Until</div>
        <div class="meta-value">__/__/2026</div>
      </div>
    </div>

    <div class="content">
      <div class="to-section">
        <div class="to-label">To Whomsoever It May Concern</div>
      </div>

      <div class="subject-box">
        <div class="subject-label">Subject</div>
        <div class="subject-text">No Objection Certificate for Location Usage - "[PROJECT TITLE]" Production</div>
      </div>

      <p class="body-text">
        This is to certify that I/We, <span class="highlight">[PROPERTY OWNER NAME]</span>, being the lawful owner/authorized representative of the property located at <span class="highlight">[COMPLETE PROPERTY ADDRESS]</span>, hereby grant permission and No Objection Certificate to <span class="highlight">STAGE Technologies Private Limited</span> and its authorized production partner <span class="highlight">[PRODUCTION COMPANY NAME]</span> for the purpose of filming/shooting activities as detailed below.
      </p>

      <div class="section">
        <div class="section-title">üìç Location Details</div>
        <div class="details-grid">
          <div class="detail-box">
            <div class="detail-label">Property Name/Type</div>
            <div class="detail-value">[e.g., Residence/Office/Farm/Heritage Site]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Complete Address</div>
            <div class="detail-value">[Full Address with Pin Code]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Areas Permitted</div>
            <div class="detail-value">[e.g., All areas / Specific rooms / Exterior only]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Contact Person On-Site</div>
            <div class="detail-value">[Name & Phone Number]</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üé¨ Production Details</div>
        <div class="details-grid">
          <div class="detail-box">
            <div class="detail-label">Project Title</div>
            <div class="detail-value">[PROJECT NAME]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Language</div>
            <div class="detail-value">[REGIONAL LANGUAGE]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Production House</div>
            <div class="detail-value">[COMPANY NAME]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Director</div>
            <div class="detail-value">[DIRECTOR NAME]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Shoot Dates</div>
            <div class="detail-value">__/__/2026 to __/__/2026</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Shoot Timings</div>
            <div class="detail-value">[e.g., 6 AM to 10 PM]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Crew Size (Approx)</div>
            <div class="detail-value">[Number of people]</div>
          </div>
          <div class="detail-box">
            <div class="detail-label">Vehicles Expected</div>
            <div class="detail-value">[Number of vehicles]</div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">‚úÖ Terms & Conditions</div>
        <div class="terms-box">
          <ul class="terms-list">
            <li><span class="check-icon">‚úì</span> The production team shall maintain cleanliness and restore the property to its original condition after shoot completion</li>
            <li><span class="check-icon">‚úì</span> Any damage caused to the property during production shall be borne by the production house</li>
            <li><span class="check-icon">‚úì</span> The production team shall follow all safety protocols and not endanger any residents/visitors</li>
            <li><span class="check-icon">‚úì</span> Electrical connections and equipment usage shall be done with proper safety measures</li>
            <li><span class="check-icon">‚úì</span> The property owner's privacy and daily activities shall be respected as much as possible</li>
            <li><span class="check-icon">‚úì</span> The production team shall have adequate insurance coverage for the shoot</li>
            <li><span class="check-icon">‚úì</span> This NOC is valid only for the project, dates, and timings mentioned above</li>
            <li><span class="check-icon">‚úì</span> The property owner reserves the right to revoke this NOC if terms are violated</li>
          </ul>
        </div>

        <div class="restrictions">
          <div class="restrictions-title">‚ö†Ô∏è Restrictions (if any)</div>
          <ul class="restrictions-list">
            <li><span class="warning-icon">‚Ä¢</span> [Specify any restricted areas / No access zones]</li>
            <li><span class="warning-icon">‚Ä¢</span> [Specify any restricted timings / Quiet hours]</li>
            <li><span class="warning-icon">‚Ä¢</span> [Specify any other conditions / Special requirements]</li>
          </ul>
        </div>
      </div>

      <div class="signature-section">
        <div class="sign-box">
          <div class="sign-line"></div>
          <div class="sign-label">Property Owner/Authorized Rep</div>
          <div class="sign-sublabel">[Name, Signature & Date]</div>
        </div>
        <div class="sign-box">
          <div class="sign-line"></div>
          <div class="sign-label">Production Representative</div>
          <div class="sign-sublabel">[Name, Signature & Date]</div>
        </div>
        <div class="sign-box">
          <div class="sign-line"></div>
          <div class="sign-label">Witness</div>
          <div class="sign-sublabel">[Name, Contact & Signature]</div>
        </div>
      </div>
    </div>

    <div class="footer">
      <p>üé¨ STAGE OTT Platform ‚Ä¢ Regional Content Production ‚Ä¢ Location Permission NOC</p>
    </div>
  </div>
</body>
</html>`;
                                      const printWindow = window.open('', '_blank');
                                      if (printWindow) {
                                        printWindow.document.write(locationNocHtml);
                                        printWindow.document.close();
                                        printWindow.print();
                                      }
                                    }}
                                    className="px-4 py-2 bg-emerald-500 hover:bg-emerald-400 text-white rounded-lg text-sm font-bold flex items-center gap-2"
                                  >
                                    üñ®Ô∏è Print Location NOC
                                  </button>
                                </div>
                                <p className="text-emerald-200 text-sm leading-relaxed">
                                  Standard OTT industry Location NOC format for obtaining permission from property owners, local authorities,
                                  and government bodies for shoot locations. Includes terms, restrictions, and liability clauses.
                                </p>
                              </div>

                              {/* Work-For-Hire NOC Preview Card */}
                              <div className="rounded-2xl shadow-2xl overflow-hidden border-2 border-purple-500/30">
                                {/* Header */}
                                <div className="bg-gradient-to-r from-slate-900 via-purple-900 to-indigo-900 p-6 text-center">
                                  <div className="flex justify-center gap-4 mb-4">
                                    <div className="w-14 h-14 bg-white/15 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30">
                                      <span className="text-3xl">üé¨</span>
                                    </div>
                                    <div className="w-14 h-14 bg-white/15 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30">
                                      <span className="text-3xl">üìú</span>
                                    </div>
                                  </div>
                                  <h3 className="text-2xl font-black text-white tracking-wide">NO OBJECTION CERTIFICATE</h3>
                                  <p className="text-purple-300 text-sm mt-1">Work-For-Hire Agreement ‚Ä¢ [Department]</p>
                                  <div className="inline-block bg-white/15 backdrop-blur-sm px-4 py-1.5 rounded-full text-white text-xs font-bold mt-3 border border-white/20">
                                    Copyright Act 1957 Compliant ‚Ä¢ IP Rights Assignment
                                  </div>
                                </div>

                                {/* Meta Strip */}
                                <div className="bg-slate-900 px-5 py-3 grid grid-cols-4 gap-4">
                                  <div className="text-center">
                                    <p className="text-slate-500 text-xs uppercase tracking-wider">Reference</p>
                                    <p className="text-white font-bold text-sm mt-0.5">STAGE/NOC/___/25-26</p>
                                  </div>
                                  <div className="text-center">
                                    <p className="text-slate-500 text-xs uppercase tracking-wider">Department</p>
                                    <p className="text-white font-bold text-sm mt-0.5">[Role/Dept]</p>
                                  </div>
                                  <div className="text-center">
                                    <p className="text-slate-500 text-xs uppercase tracking-wider">Date</p>
                                    <p className="text-white font-bold text-sm mt-0.5">__/__/2026</p>
                                  </div>
                                  <div className="text-center">
                                    <p className="text-slate-500 text-xs uppercase tracking-wider">Project</p>
                                    <p className="text-white font-bold text-sm mt-0.5">STAGE-____</p>
                                  </div>
                                </div>

                                {/* Content */}
                                <div className="p-6 bg-white">
                                  {/* Parties */}
                                  <div className="grid grid-cols-2 gap-4 mb-6">
                                    <div className="bg-slate-50 p-4 rounded-xl border-l-4 border-purple-500">
                                      <p className="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Contributor</p>
                                      <p className="font-bold text-slate-900">[CONTRIBUTOR NAME]</p>
                                      <p className="text-sm text-purple-600 font-medium">[Department/Role]</p>
                                      <p className="text-xs text-slate-500 mt-2">PAN: [PAN] | Contact: [Phone]</p>
                                    </div>
                                    <div className="bg-slate-50 p-4 rounded-xl border-l-4 border-emerald-500">
                                      <p className="text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Company</p>
                                      <p className="font-bold text-slate-900">STAGE Technologies Pvt Ltd</p>
                                      <p className="text-sm text-emerald-600 font-medium">OTT Platform & Producer</p>
                                      <p className="text-xs text-slate-500 mt-2">GSTIN: 07AAICC1279L1ZC</p>
                                    </div>
                                  </div>

                                  {/* Project */}
                                  <div className="bg-amber-50 p-4 rounded-xl border-l-4 border-amber-500 mb-6">
                                    <p className="text-xs font-bold text-amber-700 uppercase tracking-wider mb-2">üìã Project Details</p>
                                    <div className="grid grid-cols-3 gap-3 text-sm">
                                      <div><span className="text-slate-500">Title:</span> <span className="font-bold">[PROJECT]</span></div>
                                      <div><span className="text-slate-500">Language:</span> <span className="font-bold">[REGIONAL]</span></div>
                                      <div><span className="text-slate-500">Format:</span> <span className="font-bold">[Film/Series]</span></div>
                                    </div>
                                  </div>

                                  {/* Compensation */}
                                  <div className="bg-gradient-to-r from-emerald-50 to-green-50 p-5 rounded-xl border-2 border-emerald-400 mb-6">
                                    <p className="text-xs font-bold text-emerald-700 uppercase tracking-wider">üí∞ Compensation / Fees</p>
                                    <p className="text-3xl font-black text-emerald-600 mt-2">‚Çπ ____________/-</p>
                                    <p className="text-xs text-emerald-600 mt-2">Inclusive of direct taxes ‚Ä¢ Exclusive of GST ‚Ä¢ Subject to TDS</p>
                                  </div>

                                  {/* Key Clauses */}
                                  <div className="space-y-4 mb-6">
                                    <div className="flex gap-3">
                                      <span className="w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0">1</span>
                                      <div>
                                        <p className="font-bold text-slate-900 text-sm">Work Made for Hire</p>
                                        <p className="text-xs text-slate-600 mt-1">All Works constitute "work made for hire" under Copyright Act 1957. Company is the author and first owner.</p>
                                      </div>
                                    </div>
                                    <div className="flex gap-3">
                                      <span className="w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0">2</span>
                                      <div>
                                        <p className="font-bold text-slate-900 text-sm">IP Rights Assignment</p>
                                        <p className="text-xs text-slate-600 mt-1">All copyrights, ancillary rights, neighbouring rights assigned to Company in perpetuity, throughout universe.</p>
                                      </div>
                                    </div>
                                    <div className="flex gap-3">
                                      <span className="w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0">3</span>
                                      <div>
                                        <p className="font-bold text-slate-900 text-sm">Moral Rights Waiver</p>
                                        <p className="text-xs text-slate-600 mt-1">Contributor waives all moral rights including identification of authorship and approval rights.</p>
                                      </div>
                                    </div>
                                  </div>

                                  {/* Exploitation Rights */}
                                  <div className="mb-6">
                                    <p className="text-xs font-bold text-slate-700 uppercase tracking-wider mb-3">üéØ Exploitation Rights Granted</p>
                                    <div className="flex flex-wrap gap-2">
                                      {['Theatrical', 'OTT/Digital', 'Television', 'Internet', 'Home Video', 'Remakes', 'Merchandise', 'All Future Media'].map(right => (
                                        <span key={right} className="px-3 py-1 bg-slate-100 text-slate-700 rounded-full text-xs font-medium">‚úì {right}</span>
                                      ))}
                                    </div>
                                  </div>

                                  {/* Signatures */}
                                  <div className="grid grid-cols-2 gap-6 pt-6 border-t-2 border-slate-200">
                                    <div className="text-center">
                                      <div className="h-16 border-b-2 border-slate-400 mb-2"></div>
                                      <p className="text-sm font-bold text-slate-900">[Contributor Name]</p>
                                      <p className="text-xs text-slate-500">Contributor / [Role]</p>
                                    </div>
                                    <div className="text-center">
                                      <div className="h-16 border-b-2 border-slate-400 mb-2"></div>
                                      <p className="text-sm font-bold text-slate-900">For STAGE Technologies</p>
                                      <p className="text-xs text-slate-500">Authorized Signatory</p>
                                    </div>
                                  </div>

                                  {/* Acceptance Note */}
                                  <div className="bg-amber-50 border-2 border-amber-400 rounded-xl p-4 mt-6 text-center">
                                    <p className="text-sm text-amber-800 font-bold">üìß Mail back with "I ACCEPT" within 24 hours of receipt</p>
                                  </div>
                                </div>

                                {/* Footer */}
                                <div className="bg-slate-900 py-3 px-5 text-center">
                                  <p className="text-slate-400 text-xs">üé¨ STAGE OTT Platform ‚Ä¢ Work-For-Hire NOC ‚Ä¢ Copyright Act 1957 Compliant</p>
                                </div>
                              </div>

                              <h4 className="font-bold text-gray-800 mb-4 mt-6">NOC Guidelines</h4>
                            </div>
                          )}

                          {/* Content Creation Agreement Template */}
                          {(selectedCat as any).hasAgreementTemplate && (
                            <div className="mb-8">
                              {/* Agreement Header */}
                              <div className="bg-gradient-to-br from-slate-900 via-red-900 to-rose-900 border-2 border-red-500/50 rounded-2xl p-6 mb-6 shadow-2xl">
                                <div className="flex items-center justify-between mb-4">
                                  <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-gradient-to-br from-red-500 to-rose-600 rounded-xl flex items-center justify-center shadow-lg border-2 border-white/20">
                                      <span className="text-4xl">üìù</span>
                                    </div>
                                    <div>
                                      <h3 className="text-2xl font-black text-white">Content Creation Agreement</h3>
                                      <p className="text-red-300 text-sm font-medium">OTT Production Contract ‚Ä¢ 17 Clauses ‚Ä¢ 9 Annexures</p>
                                    </div>
                                  </div>
                                  <button
                                    onClick={() => {
                                      const agreementHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>Content Creation Agreement - STAGE OTT</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Times+New+Roman:wght@400;700&family=Inter:wght@400;500;600;700;800&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Times New Roman', Georgia, serif; background: white; padding: 20px; line-height: 1.6; font-size: 12pt; }
    .page { max-width: 210mm; margin: 0 auto; background: white; padding: 25mm 20mm; }
    h1 { text-align: center; font-size: 16pt; font-weight: bold; text-decoration: underline; margin-bottom: 20px; }
    h2 { font-size: 12pt; font-weight: bold; margin: 20px 0 10px 0; }
    h3 { font-size: 12pt; font-weight: bold; text-decoration: underline; margin: 15px 0 10px 0; }
    p { text-align: justify; margin-bottom: 10px; }
    .center { text-align: center; }
    .bold { font-weight: bold; }
    .underline { text-decoration: underline; }
    .indent { margin-left: 30px; }
    .clause { margin-bottom: 15px; }
    .clause-title { font-weight: bold; text-decoration: underline; }
    .sub-clause { margin-left: 20px; margin-bottom: 8px; }
    .sub-sub-clause { margin-left: 40px; margin-bottom: 6px; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 11pt; }
    table, th, td { border: 1px solid black; }
    th, td { padding: 8px; text-align: left; }
    th { background: #f0f0f0; font-weight: bold; }
    .signature-section { margin-top: 40px; }
    .signature-grid { display: flex; justify-content: space-between; margin-top: 30px; }
    .signature-box { width: 45%; text-align: center; }
    .signature-line { border-bottom: 1px solid black; height: 60px; margin-bottom: 5px; }
    .annexure { page-break-before: always; margin-top: 30px; }
    .annexure-title { text-align: center; font-weight: bold; text-decoration: underline; margin-bottom: 20px; }
    @media print { body { padding: 0; } .page { padding: 15mm; } }
  </style>
</head>
<body>
  <div class="page">
    <h1>CONTENT CREATION AGREEMENT</h1>

    <p>This Content Creation Agreement ("<b>Agreement</b>") is executed at Delhi on the <span class="highlight">[DATE]</span> [hereinafter referred to as Effective Date].</p>

    <p class="center bold">BY AND BETWEEN:</p>

    <p><b>STAGE Technologies Private Limited</b>, a Company incorporated under the Indian Companies Act and having its office at Room No. 203, Second Floor, 2-A/3, Kundan Mansion, Asaf Ali Road, Delhi - 110002, represented by its Director, Mr. Parveen Singhal (hereinafter referred to as the "<b>Company</b>") (which expression shall, unless contrary to the context or meaning thereof, be deemed to mean and include its successors in interest and permitted assigns) of the <b>ONE PART</b>;</p>

    <p class="center bold">AND</p>

    <p><b>[CREATOR/PRODUCTION HOUSE NAME]</b>, a [Proprietorship/Partnership/Company], having its office at [COMPLETE ADDRESS], represented by its [Proprietor/Partner/Director] [REPRESENTATIVE NAME], PAN - [PAN NUMBER] (GST - [GST NUMBER]) (hereinafter referred to as "<b>Creator</b>", which expression shall unless repugnant to the context or meaning thereof, be deemed to mean and include its successors and assigns) on the <b>SECOND PART</b>.</p>

    <p>Company and Creator shall hereinafter jointly be referred to as the "<b>Parties</b>" and severally as the "<b>Party</b>."</p>

    <h2>WHEREAS:</h2>
    <p class="indent">1. Company and Creator both are engaged in the business of production and distribution of films.</p>
    <p class="indent">2. Company has engaged Creator to create content in the form of a Film solely for Company's exploitation.</p>
    <p class="indent">3. Based on the representations made by the Creator, Company hereby commissions the Creator for providing service for making the Film at the instance of Company and the Creator has agreed to create, compose, film, produce, edit, post-produce and deliver the Audio Visual Content or scenes forming a part of the Film for Company on the terms and conditions appearing hereinafter. It is clarified that Company shall be the author and the first and exclusive owner of the copyright in the Film, for the entire Territory and in perpetuity. Company, as first and exclusive owner, shall have the sole and exclusive right to exercise all rights of Company over the Film in accordance with Section 14 (d) of the Copyright Act, 1957 ("<b>Act</b>") or any other equivalent provision thereof (as amended from time to time).</p>

    <p class="center bold">NOW THIS AGREEMENT WITNESSETH FOLLOWS:</p>

    <h2>1. DEFINITIONS:</h2>
    <p class="sub-clause"><b>1.1. "Cash Flow Schedule"</b> means the cash flow schedule for payment of amounts towards the Content Creation Budget which shall be paid by Company to Creator in accordance with the Annexure 1 herein.</p>
    <p class="sub-clause"><b>1.2. "Creative Elements"</b> shall refer to the exclusive right to decide on all aspects relating to the Film including but not limited to, all the decisions regarding the genre, theme, concept, story, script, Contributors, role and the nature of the performance of Contributors, characters, shoot venue, background settings, light effects, lay-out etc.</p>
    <p class="sub-clause"><b>1.3. "Contributors"</b> means any third party who is providing goods or access or rights or creative contributions or services in connection with the Film, and includes the lead artists of the Film, heads of department, writer(s), music director/composer(s), lyricist(s), singers, all other authors of Underlying Works, director of photography, art director, production designer, director of action, choreographers, other technicians et al, all as approved by Company.</p>
    <p class="sub-clause"><b>1.4. "Delivery Date"</b> means the date on which Creator shall furnish first positive print of the Film along with the censor certificate (if applicable), and other Delivery Materials hereto shall be complete and ready for delivery on or before <span class="highlight">[DELIVERY DATE]</span> with a grace period of a week immediately before the first release date of the Film whichever date is earlier to Company as required by Company.</p>
    <p class="sub-clause"><b>1.5. "Delivery Materials"</b> shall mean and include without limitation to the items, materials, more particularly specified in Annexure 2 of the Agreement which shall be developed by Creator and furnished to Company.</p>
    <p class="sub-clause"><b>1.6. "Delivery Schedule"</b> shall mean the dates of delivery of the Film as mentioned in detail in Annexure 6 attached hereto.</p>
    <p class="sub-clause"><b>1.7. "Film Materials"</b> shall mean and include the Film, contributors agreements (with authors of all the underlying works including the works of authors of Literary, Dramatic, Artistic or Musical Works of the Audio Visual Content forming a part of the Film, performances of the Performers, all consents, waivers or releases from all talent and all persons or entities who have rendered services to Creator in connection with the Audio Visual Content to the extent permissible by law), Publicity Materials, any tape, Telecast Masters, any portion, negative, rushes or format thereof packaging sets, costumes, jewelry and all other elements/properties (tangible, intangible, movable and immovable, as the case may be) in relation to the Film including without limitation the image, face, name, signature, voice and photographs of each performer or artist whether used in conjunction with the Film or for any merchandising opportunities in relation to the Film.</p>
    <p class="sub-clause"><b>1.8. "First Copy"</b> shall mean the Film in a form ready for final exploitation in all aspects on all modes, medias, platforms known now or hereinafter known along with a certification from the Central Board of Film Certification ("<b>CBFC</b>"), if applicable, as per the terms of this Agreement.</p>
    <p class="sub-clause"><b>1.9. "Intellectual Property"</b> includes patents, trademarks, service marks, trade names, registered designs, copyrights, rights of privacy and publicity; and other forms of intellectual or industrial property, know how, confidential or secret processes, trade secrets, any other protected rights or assets, and any licenses and permission in connection therewith, in each and any part of the world and whether or not registered or registerable and for the full period thereof, and all extensions and renewals thereof, and all applications for registration in connection with the foregoing any and all rights in the Film, content, concept, story, screenplay, script, music, lyrics, negatives, positives and all other materials in respect of the Film, or in the prints of the Film, or Publicity Materials or other paraphernalia of the Film, or any other Intellectual Property arising out of or associated with the Film.</p>
    <p class="sub-clause"><b>1.10. "Content Creation Budget"</b> shall mean all expenses incurred on the Film commencing from development till completion of the censored first copy, including without limitation to the cost of Film production, Creator fees, fees paid to the lead actor, director, cast and crew, rights acquisition expenses, development expenses, post production costs, finance costs, legal expenses, writers fees, line producer, cost of equipment, insurance, stamp duties, contingency fees, any and all taxes, administrative costs in relation to managing the production of the Film, cost of positive raw stock, laboratory, insurance, goods and service tax (GST) (to the extent set-off not available) or any other applicable taxes, duties or dues as applicable in accordance with the applicable laws, payable in relation to any agreements executed for the purpose of production of the Film, and shall be subject to applicable withholding taxes and such production budget shall mutually agree between the Parties which shall be funded by Company more particularly specified in Annexure 3.</p>
    <p class="sub-clause"><b>1.11. "Content Creation Schedule"</b> shall mean and include the schedule during which there shall be pre-production, production and postproduction activities conducted by Creator as mentioned in Annexure 4.</p>
    <p class="sub-clause"><b>1.12. "Publicity Materials"</b> shall mean any biographical notes, press releases, audio and/or audio visual material or photographs relating to the Film and/or any or all artwork and packaging materials relating to the Film inclusive of transparencies, still photos, posters, synopsis etc.</p>
    <p class="sub-clause"><b>1.13. "Content Creation Services"</b> shall mean the production services as set out in this Agreement undertaken by the Creator under commission and/or under the directions of the Company, to produce and deliver the Audio Visual Content of the Film in conformity with the terms and conditions of this Agreement.</p>
    <p class="sub-clause"><b>1.14. "Revenues"</b> shall mean and include all the gross revenues, incomes, monies realized by the Creator from the exploitation and/or sale of any rights including without limitation to theatrical, satellite/television broadcasting rights, digital rights, music rights, etc of the Film on all platforms, medias and modes known now or hereinafter known in universal perpetuity, also includes monies realized by Creator in the form of production and/or location incentive, tax set offs or rebates etc.</p>
    <p class="sub-clause"><b>1.15. "Technical Specifications"</b> shall mean such technical specifications in respect of the Film/Film Materials as may be required or specified by Company in Annexure 7 of this Agreement.</p>
    <p class="sub-clause"><b>1.16. "Term"</b> shall commence from the execution of this Agreement and continue till perpetuity.</p>
    <p class="sub-clause"><b>1.17. "Territory"</b> shall mean the entire world.</p>

    <h2>2. Engagement:</h2>
    <p class="sub-clause"><b>2.1.</b> Company hereby appoints Creator who shall be conducting all the production activities of the Film till the delivery of the First Copy of the Film and such appointment is duly accepted by Creator wherein Creator shall render all services customarily rendered by a production house in the film industry on an exclusive basis and as required by Company on the terms and conditions mentioned in this Agreement and instructions provided by Company from time to time, in connection with the Film.</p>
    <p class="sub-clause"><b>2.2.</b> Creator agrees to work to the satisfaction of the Company with regard to every element of Content Creation Services including but not limited to Publicity Materials, Music Cue Sheets.</p>
    <p class="sub-clause"><b>2.3.</b> The Company retains the right to review progress of the Film at any stage and necessitate any change with all financial and other consequences of such change being subject to the decision of the Company.</p>
    <p class="sub-clause"><b>2.4.</b> Company shall have the right to ask for cancellation or reduction of the parts or entirety of the Film undelivered/completed according to the satisfaction of the Company and payment to Creator shall stand proportionately reduced.</p>

    <h2>3. Content Creation Services:</h2>
    <p class="sub-clause"><b>3.1.</b> Creator shall, on an independent basis, provide production services in connection with production of the Film in accordance with the Content Creation Budget, Delivery Schedule and Content Creation Schedule so as to produce, complete and deliver to Company the Film in including, without limitation, all of the services listed on Annexure 5 attached hereto and incorporated herein by reference, in accordance with the provisions of this Agreement, subject to sole discretion and approval of Company (all such services required of Creator hereunder collectively referred to herein as the "Services"). Company shall fund the expenses incurred by Creator in accordance with the Cash Flow Annexure 1.</p>
    <p class="sub-clause"><b>3.2.</b> The Parties agree that the Content Creation Budget for the Film shall be mutually decided between the Parties. However, the Company will have the final approval on the Content Creation Budget of the Film and shall be annexed as Annexure 3.</p>
    <p class="sub-clause"><b>3.3.</b> Parties agree and confirm that the Film shall be directed by <span class="highlight">[DIRECTOR NAME]</span> and written by <span class="highlight">[WRITER NAME]</span> wherein the writer shall have the sole creative control over script, screenplay, and dialogues of the Film. The creative control over the final cut including edit, post production activities, etc. in the Film shall stand vested with Company. Creator hereby agrees to render all assistance as may be required by Company to comply with such formalities and requirements for producing the Film. Further the Parties agree such script shall be registered with any/all relevant authorized/governing bodies in the name of Creator in India.</p>
    <p class="sub-clause"><b>3.4.</b> The Parties hereto agree that Creator is authorised to engage and enter into production related agreements with the director, Writer, lead star cast, head of the departments, music composers ("<b>Above-the-Line Talents</b>") wherein Company shall be a confirming party to such Above-the-Line Talents Agreements. Creator shall enter into all below-the-line production related agreements and arrangements for secondary cast, supporting cast, technicians, service providers ("<b>Content Creation Agreements</b>"). Creator shall ensure that no party(ies) to the Content Creation Agreements or any of their associates or nominees shall acquire any right or interest in respect of revenues and all royalty(ies) to third parties under the Content Creation Agreements, if any applicable royalties are payable by the copyright board or societies then such talent shall directly collect the same from the respective copyright societies/bodies without any recourse to Company and/or Creator.</p>
    <p class="sub-clause"><b>3.5.</b> Creator shall ensure that under Content Creation Agreements Creator shall have the right to use the names, sobriquet, autograph, likeness, photographs, portrait, caricatures, voice silhouette of all persons appearing in and contributing to the Film, including that of and all other products in the Film with any merchandising, or music publishing endeavours in connection with the Film including the script and music thereof, and all revenues generated there from shall be to the account of the Film.</p>
    <p class="sub-clause"><b>3.6.</b> Creator shall seek all approvals under the applicable laws, laws of various states, animal welfare board and/or any other trade body, seek all applicable licenses, permits and approvals (if any) from the relevant governmental authorities or bodies in relation to export and/or import of any materials related to the Film, and shall pay the applicable import and/or export duties, if any, to the relevant authorities, for the purpose of delivery of any of the Delivery Material(s). In the event any portion of the pre-production, production or post-production of the Film is carried out in any other jurisdiction other than India, Creator shall ensure that all appropriate statutory and regulatory approvals have been obtained in connection with the Film.</p>
    <p class="sub-clause"><b>3.7.</b> Creator shall create "making of" documentary of a minimum duration of 30 minutes, containing full length interviews with all the lead cast and crew about their contribution to the Film, "behind the scenes" motion film documentaries, all additional music recorded, all picture outtakes of humorous or interesting nature - including stunts/visual effects and 'bloopers', all advertising/publicity materials including trailers, and any other unique materials reasonably available that could assist in the marketing of the Film.</p>
    <p class="sub-clause"><b>3.8.</b> It is specifically agreed between the Parties that the Creator shall not change the essential elements of the Film without the prior written approval of the Company.</p>
    <p class="sub-clause"><b>3.9.</b> Creator shall keep Company informed at all times regarding the status of the Services and the production of the Film and shall furnish the copies of the Content Creation Agreement within a period of 15 days from the execution of the same and also provide all such additional information to Creator in a timely manner. Creator shall further provide daily call sheets to Company during the shooting days and Creator shall prepare and furnish detailed cost statements during the shooting and non-shooting days with respect to the monies expended by it in relation to the Film and the status report on the progress of the Film on a regular basis. Company is entitled to review all the reports and status reports before the money to be paid as per the agreed Cash Flow Schedule. Creator will also furnish a complete statement of production account for the Film, within 15 days of the First theatrical release of the Film. Creator shall, after completing the Film as set out hereinabove, obtain the necessary Indian Censor Board certificates in Company's name (If applicable). Creator shall assist and cooperate with Company as required to obtain such censor certificates and Parties hereto agree that the Film shall be U/A or U (if applicable).</p>
    <p class="sub-clause"><b>3.10.</b> In accordance with the Content Creation Schedule and monies received by Creator from Company in accordance with the Content Creation Budget, Creator agrees to deliver the Deliverables to Company free of all liens, claims, charges, limitations, restrictions and encumbrances of any kind, fully cut, edited, scored and ready for exploitation in all respects, and in compliance with the terms and conditions hereof. Creator acknowledges that time is of the essence.</p>
    <p class="sub-clause"><b>3.11.</b> Creator in mutual consultation with the Company shall prepare the Content Creation Budget for the Film a month before the commencement of the principal photography of the Film. Creator shall not deviate materially from the Content Creation Budget whilst rendering their Services; it being understood that Creator shall be solely responsible for any costs or overages associated with the Budget unless the overages is specially approved in writing by Company.</p>
    <p class="sub-clause"><b>3.12.</b> Company at any time may inspect and/or cause to be inspected the production of the Film and the performance of the Services, and Company may make objections thereto, which Creator agrees to promptly correct.</p>

    <h2>4. Contributors and their Agreements:</h2>
    <p class="sub-clause"><b>4.1.</b> Unless the Parties agree otherwise in writing, Creator shall enter into agreements/written arrangements with the Contributors of the Film and ensure complete assignment of all Intellectual Property Rights in and to the results and proceeds of the Works in favour of Company to effectuate Clause 8.</p>
    <p class="sub-clause"><b>4.2.</b> Creator takes responsibility for engaging Contributors and associated necessities while Company retains the right to engage Contributors in any Company events without restriction. All agreements entered into by Creator with respect to the Film shall conform to Company's customary policies and requirements notified to the Creator and agreements executed with Contributors must be provided to Company prior to the commencement of principal photography shooting.</p>
    <p class="sub-clause"><b>4.3.</b> The Creator further confirms that all such Contributor's agreements shall specifically provide that:</p>
    <p class="sub-sub-clause"><b>4.3.1.</b> the Film has been commissioned by Company and is being produced by the Creator at instance of Company (generally referred as "work-for-hire") as per the Copyright Act 1957 (including its amendments thereto) and that all intellectual property rights and other ownership rights of the Film shall belongs to Company;</p>
    <p class="sub-sub-clause"><b>4.3.2.</b> The Creator shall obtain/has obtained from all Contributors engaged by the Creator a waiver to the effect that all their rights present and future in the Film under Section 57 of the Copyright Act, 1957 (including its amendments thereto) exclusively in favour of Company.</p>

    <h2>5. Review Process:</h2>
    <p>Company shall be entitled to observe the taping of the Film. Creator shall prepare and deliver to Company, or to the persons so designated by Company, detailed production reports on monthly basis which reflect the progress of the production of the Film. Creator shall promptly notify Company of any occurrence that materially delays or interferes with the production of the Film. Company shall keep the Creator advised as to all phases of the production of the Film and to whom Creator shall make available, all books, records and other information and data relating to the Film and the production thereof including without limitation shoot schedules, shoot status, story/screenplay/dialogue deliverable timelines, periodic budget v/s actual reports, bank statements, et al. Whilst Company will often not ask for delivery of any Contributors agreements, Company reserves the right (not to be exercised unreasonably) to request delivery of any Contributor agreements for its review and/or approval at any time, and the Creator agrees to produce such agreement for this purpose in a timely fashion prior to execution of such agreement.</p>

    <h2>6. Content Creation Services Fee (if applicable):</h2>
    <p class="sub-clause"><b>6.1.</b> In full consideration for the Services rendered by the Company for the Film. Company shall pay Creator the "Content Creation Services Fee" of <b>INR <span class="highlight">[AMOUNT]</span>/-</b> plus applicable taxes/GST subject to withholding under Income Tax Act 1961 ("<b>Fees</b>").</p>
    <p class="sub-clause"><b>6.2.</b> All the payments should be made within 45 days of receipt of invoice or as mutually agreed.</p>
    <p class="sub-clause"><b>6.3.</b> Notwithstanding anything contained hereinabove, any stamp duty payable on this Agreement shall be borne and paid by Creator and Company equally. If the entire stamp duty is paid by Company, then Company shall have the right to deduct 50% of the amount of stamp duty from the Fee payable by Company to Creator under this Agreement.</p>
    <p class="sub-clause"><b>6.4.</b> In the event that Company is prevented from or unable to exploit the Film as a result of any act or other failure of Creator then, in addition to any other rights and remedies available to Company, Company may withhold all or part of the Fee specified in this agreement or adjust the same against any other payment payable by Company to the Creator in respect of another agreement executed or to be executed between the Creator and Company. If Company has already paid Creator all or part of the Fee, Creator will refund such Fee (or portions already paid) to Company or to a party of Company's direction within thirty (30) days of Company's request for such refund.</p>
    <p class="sub-clause"><b>6.5.</b> In the event Company determines that the Film (or any part thereof) is of an unacceptable standard or quality, or not in conformity with the Delivery Specifications/Technical Specifications, or that the Creator has breached any of its obligations placed under this Agreement (including any material breach, in the sole view of Company, involving breach of this agreement and Delivery Schedule (as per Delivery Specifications) or any other obligation placed on the Creator), Company may rescind this Agreement after serving a notice in writing (including by way of email notice) upon Creator; provided that the Creator had failed to rectify the said breach within a period not exceeding seven (7) days from the date of receipt of such notice of breach. Notwithstanding anything contained anywhere under this Agreement, Company reserves the right to terminate this Agreement at any time without assigning any reasons by serving a prior written notice (emails permitted) of thirty days to the Creator. The Creator acknowledges that upon this Agreement being terminated by Company in accordance with the foregoing, Company shall have the unfettered right to appoint any other Creator to produce the Film.</p>
    <p class="sub-clause"><b>6.6.</b> Creator warrants delivering the Film as per this agreement. However, in case the Creator fails to deliver the Film within the timelines as stated in Annexure 6, then Company shall be entitled to levy a penalty of <b>18 percent (18%) per annum</b> calculated for each day of delay.</p>
    <p class="sub-clause"><b>6.7.</b> Company shall not reimburse any purchase made by the Creator without the prior consent and approval of Company (whether or not included in the budget).</p>
    <p class="sub-clause"><b>6.8.</b> Company shall not take responsibility for Creator's liabilities and collision insurance or any deductibles on any vehicle used in conjunction with Creator's services performed for the Film.</p>

    <h2>7. Intellectual Property Rights:</h2>
    <p class="sub-clause"><b>7.1.</b> Parties agree and confirm that Intellectual Property Rights and all elements and components thereof and relating thereto, and the results and proceeds of all services rendered in connection therewith in whatever stage of creation or completion; it being understood that all such elements, components, services and results and proceeds thereof are "<b>work(s)-made-for-hire</b>" for Company unless specifically agreed otherwise.</p>
    <p class="sub-clause"><b>7.2.</b> Creator shall ensure that any person or entity providing services hereunder in connection with the Content Creation Agreements and who may claim any copyright, moral rights or other rights related to the Film shall execute such assignments or waivers as may be required to fully and irrevocably vest all such rights in Company and/or Creator.</p>
    <p class="sub-clause"><b>7.3.</b> Without limiting the generality of the foregoing, Company shall have the sole and exclusive right in perpetuity throughout the Territory to distribute, exhibit, sell, use, license, advertise, exploit and otherwise turn to account the Film and all rights therein in any and all media, whether now known or hereafter devised, <b>including but not limited to NFT, Crypto, Blockchain, Metaverse, web3</b> or other such forms (existent or new) and in such manner and to the extent, if at all, as Company may determine in its sole and absolute discretion whether this Agreement expires in its normal course or is terminated in whole or in part for any reason whatsoever.</p>
    <p class="sub-clause"><b>7.4.</b> Without prejudice to the aforesaid, Creator hereby unconditionally and irrevocably assigns in favour of Company, for the entire Territory and in perpetuity the copyright in the Film, Film Materials and all its Underlying Works and Company shall be considered as Company of such Underlying Works and shall have the sole and exclusive rights to exercise all rights in such Underlying Works in accordance with Section 14 and 38A (as the case maybe) of the Copyright Act 1957 or any other equivalent provisions thereof (as amended from time to time) that Creator agrees and acknowledges and makes all necessary declarations confirming the aforesaid. Such assignment shall operate for all the modes, medium and formats of exploitation in respect of the Film including the Modes, Medium and Formats as detailed in Annexure 8 and Creator hereby expressly acknowledges the sufficiency of the Fee towards the assignment of the rights of the Film on all such Modes, Mediums and Formats.</p>
    <p class="sub-clause"><b>7.5.</b> Creator hereby agrees and acknowledges that in accordance with proviso 3 to <b>Section 18(1)</b> of the Copyright Act, 1957 (including amendments thereto), Company shall be deemed to be the assignee for the Underlying Works with respect to the right to share royalties on an equal basis with the author of the respective Underlying Works.</p>
    <p class="sub-clause"><b>7.6.</b> In the event the aforesaid assignment is by operation of law deemed not to be applicable to any medium or mode of exploitation of the Film due to the reason that, such medium or mode of exploitation did not exist or was not in commercial use at the time when the assignment was made, Creator hereby exclusively licenses the right to exploit the copyright in the Underlying Works through all such Modes, Medium and Formats to Company in perpetuity throughout the world. Further, Company shall solely have the exclusive first and last option to procure assignment of the rights to exploit the Underlying Works through all such modes, mediums and formats on such Modes, Medium and/or Formats coming into existence of commercial use (as the case maybe).</p>
    <p class="sub-clause"><b>7.7.</b> Company shall be the owner of the Concept and the title of the Film, in perpetuity, throughout the world. Creator hereby undertakes that all such changes/tweaking carried out in the script including the final full script shall solely belong to Company and Company shall be the first and exclusive owner of the copyright in such script of the Film, in perpetuity, throughout the world. Creator hereby agrees to indemnify and keep indemnified Company from any and all claims in respect of any aspect of the Film including but not limited to title, Concept, script, third party copyright, trade mark, trade name, right of privacy or publicity, property rights or of any other claims, as well as claims from any person(s) engaged and/or associated in any manner for the Film.</p>
    <p class="sub-clause"><b>7.8.</b> Company may, at its discretion and in its favour, register the Film' Concept, script, title and/or any underlying works, before any appropriate authorities/society and/or cancel/amend/renew/alter the aforesaid as it deems fit. Creator hereby agrees and undertakes that it shall neither before nor after the execution of this Agreement do or cause/attempt to do any act which shall affect the rights of Company in the Film, in any manner whatsoever. This Clause 7.8 shall survive the termination/expiry of this Agreement and shall bind both Parties, unless agreed in writing to the contrary and signed by the authorized signatories of both Parties. No act or omission on part of Company shall constitute or be construed as a waiver.</p>
    <p class="sub-clause"><b>7.9.</b> Creator shall ensure complete assignment of all copyright in all artists and dramatic works and performances and photographs created under the Contributors agreement in favour of Company. Creator shall provide a copy of such agreements with Contributors as and when called upon by Company. Any breach of the foregoing shall be considered as material breach by Creator and Company shall be entitled to all remedies/rights available under law and/or as per this Agreement. Further, Creator agrees to indemnify and keep Company indemnified from any claims, losses and costs arising from or resulting from such breach.</p>
    <p class="sub-clause"><b>7.10.</b> Creator hereby undertakes to do any and all acts and execute any and all documents, in such manner and at such locations as may be required by Company in its sole discretion in order to secure, protect, perfect or enforce any of the rights of Company pursuant to this Agreement. In the event, Creator fails to do so within thirty (30) days of receipt of a request from Company to do or perform an act or execute a document, Company shall be entitled to exercise the same in place of Creator as the lawful appointed attorney and Creator undertakes to affirm, ratify and be bound by such exercise of the right by Company under the provisions of this Clause 7.10.</p>
    <p class="sub-clause"><b>7.11.</b> Creator agrees and acknowledges that all the Creative Decision Rights in relation to the Film shall, at all times vest exclusively with the Company.</p>
    <p class="sub-clause"><b>7.12.</b> It is agreed by the Parties that the provisions of <b>Section 19(4) and 19A</b> of the Copyright Act, 1957 (including amendments thereto) shall have no application or effect on the terms of this Agreement. Creator hereby acknowledges and undertakes that the assignment of copyright in the Film as granted herein is not and will not be contrary to the terms and conditions of the rights already assigned to a copyright society in which Creator is a member.</p>

    <h2>8. Termination/Suspension of Services:</h2>
    <p>Company shall be entitled to terminate this Agreement upon the occurrence of any of the following events:</p>
    <p class="sub-clause"><b>8.1.</b> If Creator breaches any of his obligations, representations, warranties under this Agreement and does not remedy that breach within 15 days after receiving notice of such breach from Company.</p>
    <p class="sub-clause"><b>8.2.</b> The continuation of an event or a combination of events of force majeure for more than 7 consecutive days.</p>
    <p class="sub-clause"><b>8.3.</b> The production of the Film being cancelled, abandoned or indefinitely postponed for any reason whatsoever.</p>
    <p class="sub-clause"><b>8.4.</b> However, the termination in clauses shall be without prejudice to the other remedies available to Company in law.</p>

    <h2>9. Post Termination:</h2>
    <p class="sub-clause"><b>9.1.</b> The Parties shall be released from all further obligations under this Agreement;</p>
    <p class="sub-clause"><b>9.2.</b> Upon such termination of this Agreement, Company shall take over the Film from Creator and acquire all rights in the Film and complete the same in the manner deem fit.</p>
    <p class="sub-clause"><b>9.3.</b> Notwithstanding the termination of this Agreement, the provisions of this Agreement, the nature of which should reasonably require the survival thereof, shall survive the termination of this Agreement.</p>
    <p class="sub-clause"><b>9.4.</b> In the event of this Agreement being terminated before its stipulated time period, due to reasons mentioned in Clause 9 above, then Creator will be liable to forthwith refund the Fee (but not later than 30 days from the date of termination) already paid by Company and any unpaid Fee shall stand forfeited by Company. In case of any delay in refunding the Fee the Creator will also be liable to pay interest @ <b>18% per annum</b> from the end of aforesaid period of thirty (30) days of termination of the Agreement till the date of refund by the Creator. Notwithstanding, other rights/remedies available to Company under law and/or as per this Agreement, Company shall also have the right to claim damages from the Creator.</p>
    <p class="sub-clause"><b>9.5.</b> Furthermore, during the notice period, if instructed by Company, Creator undertakes to deliver the Audio-Visual Content to Company's satisfaction and complete the Film. However, if Creator fails to deliver the Film to the satisfaction of Company within the notice period, Company has the right to withhold the payment of the Film already delivered by Creator to Company.</p>
    <p class="sub-clause"><b>9.6.</b> In the event of termination of this Agreement, notwithstanding anything else contained in the Agreement, Creator shall immediately notate in favour of Company such agreements with Contributors and Company shall be deemed to have all the rights of the Creator as agreed under such agreements with Contributors including but not limited right to specific performance by such Contributors. Further, if the Creator has failed to perform its obligations under such agreements with Contributors/participants/artists including failure to make payments of consideration and Company is required to make good such obligation, Company shall have right to withhold any payments due and payable to the Creator as per this Agreement till the date of termination and if so deemed fit by Company utilize such outstanding payments in clearing any outstanding due to the Creator towards the Contributors. The Creator agrees to indemnify and keep Company indemnified from any claims, losses and costs arising from or resulting from such breach.</p>

    <h2>10. Creator's Representations and Warranties:</h2>
    <p class="sub-clause"><b>10.1.</b> Creator is free to enter into this Agreement and grant the rights herein granted.</p>
    <p class="sub-clause"><b>10.2.</b> Creator has neither made nor will make any commitment nor has done or will do any act in conflict with this Agreement or Company's rights hereunder.</p>
    <p class="sub-clause"><b>10.3.</b> Creator has and will maintain all the necessary personnel, facilities, equipment and resources necessary to meet the performance standards set forth in this Agreement and is not subject to any obligation or disability which will or might hinder Creator's performance hereunder.</p>
    <p class="sub-clause"><b>10.4.</b> Film shall be produced in accordance with all applicable laws (including, without limitation, all applicable statutes, ordinances, rules, regulations and requirements of all governmental agencies and regulatory bodies).</p>
    <p class="sub-clause"><b>10.5.</b> All material furnished by Creator hereunder is and shall be wholly original with Creator and will not violate or infringe upon any rights of any kind or nature whatsoever of any person or other entity.</p>
    <p class="sub-clause"><b>10.6.</b> Creator shall not incur any liability on behalf of Company and not pledge Company's credit.</p>
    <p class="sub-clause"><b>10.7.</b> Parties shall not divulge or disclose any information of any nature or kind relating to the development or production of the Film, or to the general affairs of other Party coming within their knowledge by reason of the rendering of the services hereunder, or otherwise howsoever.</p>
    <p class="sub-clause"><b>10.8.</b> Parties agree to keep confidential any information about the Film and Film related materials (including, but not limited to, scripts). At Company's request, Creator shall return to Company all materials received from or on behalf of Company related to the Film and copies thereof (including electronic copies).</p>
    <p class="sub-clause"><b>10.9.</b> Neither the Creator nor Creator's crew, or his agent(s) or any other person acting of on behalf of the foregoing has offered, paid, promised to pay or authorized the payment of any money or anything of value to any government authority or any political party for the purpose of influencing any act or decision of such government authority or political party in relation to the writing and rendering services hereunder to any person, in each case where such payment, offer or promise is prohibited under any applicable law to which such entity is subject or engaged in any activity that would in any manner result in violation of any applicable <b>anti-bribery or anti-corruption laws</b>.</p>
    <p class="sub-clause"><b>10.10.</b> Both the Parties shall not authorize or permit screenings or previews of the Film or any cut of the Film without prior written approval of other Party.</p>
    <p class="sub-clause"><b>10.11.</b> Creator and each Contributor involved shall provide an executed Certificate of Authorship in the format provided in Annexure 9 to the Company.</p>
    <p class="sub-clause"><b>10.12.</b> Creator shall secure and maintain, at its sole cost and expense as part of the Content Creation Budget, in connection with the Services and production of the Film, all customary and necessary insurance policies, including, without limitation, comprehensive general liability insurance and such policies shall list Company as additional insured (the "<b>Insurance</b>").</p>
    <p class="sub-clause"><b>10.13.</b> Both the Parties shall keep confidential all matters relating to the Film (including, without limitation, the script, the plot, or any elements thereof, any set design, props or effects, or activities of the cast and crew) and business or production activities, and shall not furnish or authorize the dissemination of any information or publicity of any form relating to the Film, (or its operations or personnel); provided that incidental non-derogatory references to either Party's engagement hereunder shall not be deemed a breach of this provision.</p>
    <p class="sub-clause"><b>10.14.</b> The terms of this Clause shall survive the expiration or termination of this Agreement.</p>
    <p class="sub-clause"><b>10.15.</b> There is no litigation or any other restraining development, legal or otherwise in and against the production of the Film, its constituents and the Creator, pending or threatened against, which may, in any manner, encumber or create impediments in carrying out the provisions of this Agreement and in smooth and uninterrupted enjoyment of the rights by Company and/or its legal assignees.</p>
    <p class="sub-clause"><b>10.16.</b> No Violation of Third-Party Rights:</p>
    <p class="sub-sub-clause"><b>10.16.1.</b> Neither the Film and/or the Film Materials nor any part thereof will infringe upon the statutory rights, common law rights, intellectual property rights including copyrights in literary, dramatic, musical or motion picture rights, patent rights or the trademark or trade names of any person, firm, corporation, association or entity whatsoever.</p>
    <p class="sub-sub-clause"><b>10.16.2.</b> Neither the Film nor any part thereof nor any of said dramatic, literary, musical and other material, whether contained therein or synchronized therewith, will violate the statutory rights of, or the right of privacy, or constitute a libel or slander against any person, firm, corporation, association or entity whatsoever, or violate any other rights not herein specifically enumerated.</p>
    <p class="sub-sub-clause"><b>10.16.3.</b> No part of the Film shall be defamatory or amount to contempt of court or breach of contract, or breach of any provision of statute, nor hurt the sentiments of religious groups.</p>
    <p class="sub-clause"><b>10.17.</b> By virtue of this Agreement no right, title or interest in or to the Film or any other rights will vest in the Creator. Consequently, the Creator does not have right to grant or assign (and should not grant or assign to) or create in favour of any person, corporation, association or other entity, any right, title or interest in or to the Film or any other rights of Company. The Creator cannot and will not create any liens, claims, charges, encumbrances, restrictions in favour of any third party, including financiers in respect of the Film or any part thereof. Nor will the Creator enter into agreements, commitments or arrangements obligations whatsoever with any person, firm, corporation that may in any way interfere with, impair, abrogate or adversely or otherwise affect any of the rights of Company.</p>
    <p class="sub-clause"><b>10.18.</b> Except Consideration to Creator, there are not now and will not be any payments of any kind required to be made by Company with respect to, or as a result of, exploiting the Film.</p>
    <p class="sub-clause"><b>10.19.</b> Each of the representations and warranties hereunder shall continue in full force and effect throughout the term of Company's rights hereunder, notwithstanding any delivery by Creator or acceptance or approval by Company of the Film or any items and documents of any kind and notwithstanding any expiration or termination of this Agreement.</p>
    <p class="sub-clause"><b>10.20.</b> Company shall not be liable for any unfulfilled obligations and liabilities of Creator towards any person whatsoever, or the appropriate Government in relation to the said Film and its constituents and Creator declares that it shall alone be liable for the statutory and otherwise compliances with regard to the overall production of the said Film. Further the Creator shall ensure and shall be liable for the compliance of all laws including but not limited to labour laws, codes, guidelines statutes, orders/judgments of courts and other statutory authorities and hold Company indemnified against any claims, costs, penalties, losses arising from a violation by the Creator with respect to the production of the Film.</p>
    <p class="sub-clause"><b>10.21.</b> Creator shall, at its own cost, obtain all of the rights, permissions and licenses from relevant copyright collection societies, performing rights society and/or any other societies as required from time to time for the use of any on-ground music included in any on-ground event in relation to the Film, to enable Company to exploit the Film, worldwide and in perpetuity.</p>

    <h2>11. Insurance:</h2>
    <p>Creator shall take out a comprehensive insurance, including without any limitation, with respect to the equipment used in the production of the Film, artists of the Film, sets/studio and wardrobe to be used in the Film, and accident and personal liability compensation insurance or such other applicable insurance which provides coverage within applicable legal limits for the benefit of all individuals hired by Creator including the employees of the Creator. Creator shall be responsible for providing reasonable health and safety measures for all the persons working in connection with the Film in order to ensure that the safety and security of all the persons in the sets is not prejudiced in any manner. Creator shall indemnify Company against all claims, actions and liability which may be asserted by or on behalf of any such person or on behalf of any party by reason of accident, injury, death or property damage resulting from any negligence or fault on the part of Creator or its employees. Unless otherwise agreed by Company, the policy of insurance shall have <b>Company as the "co-payee"</b> and the amount of such insurance cover shall be agreed with Company before Creator takes out such a policy.</p>

    <h2>12. Indemnification:</h2>
    <p>The Party in breach/default (Defaulting Party) shall, at its own expense, indemnify, save, and hold harmless the non-defaulting party and its successors, licensees, assigns, agents, representatives, and affiliates from and against any and all claims, demands, causes of action, obligations, liability, loss, damage, costs, and expenses (including reasonable attorneys' fees), incurred or sustained by reason of or arising out of any breach of any of the warranties, representations, obligations, or agreements herein made by such Defaulting Party.</p>

    <h2>13. Name and Likeness:</h2>
    <p>Company shall have the right to use Creator's name, likeness and/or biography in connection with the production, distribution, exhibition, advertising, promotion and other exploitation of the Picture and promotional "Making of" film, if any, and all subsidiary and ancillary rights therein, including without limitation, publications, marketing and advertising of the Picture and/or the promotional "Making Of" film, provided, however, any merchandising and commercial tie-ups shall require the express written permission of the Creator.</p>

    <h2>14. Credit:</h2>
    <p>Provided Creator fully performs all of its obligations hereunder and is not in breach or default hereof, Company shall accord credit to Creator on screen. Company inadvertent failure, or any failure by any third party, to accord credit as set forth herein shall not be deemed a breach of this Agreement by Company. The size, type and placement of such credit shall be at Company's sole discretion.</p>

    <h2>15. Confidentiality:</h2>
    <p>Neither Parties shall disclose to any third party any confidential business of future plans of Company related to the film at any time acquired and no reference is to be made regarding the terms of this entire agreement in any advertising publicity or promotional material without prior written consent of the parties.</p>

    <h2>16. Making of Films:</h2>
    <p>Subject to Creator's availability and reasonable approval rights, Creator agrees to cooperate with Company in the creation of promotional "Making of" film subject to Creator's services in connection with the principal photography of the Picture. Additionally, Creator agrees that Company may use portions of the Picture and "behind the scenes" shots in said promotional "making of" films and may exploit said promotional "Making Of" films in any and all media whatsoever (whether now known or hereafter devised) without the payment of any compensation whatsoever to any crew member.</p>

    <h2>17. MISCELLANEOUS:</h2>
    <p class="sub-clause"><b>17.1. Governing Law:</b> The parties agree that this Agreement shall be construed and enforced in accordance with, and the rights of parties shall be governed by the laws of India, without giving effect to the conflict of law provisions thereof. The courts at Delhi shall have exclusive jurisdiction to entertain any suit, dispute, litigation or legal proceedings in respect of or under this Agreement.</p>
    <p class="sub-clause"><b>17.2. Arbitration:</b> Any and all claims and disputes arising under this Agreement shall be settled through Arbitration. The Arbitration proceedings shall be conducted in accordance with the rules of the <b>Indian Arbitration and Conciliation Act, 1996</b> by a single arbitrator. Unless otherwise agreed, the seat of the arbitration shall be Delhi and the arbitration proceedings shall be conducted in the English language.</p>
    <p class="sub-clause"><b>17.3. Assignment:</b> This Agreement is non-assignable by the Creator subject to prior approval of the Company. This Agreement may be freely assigned and licensed by Company in whole or in part to any party and in such event; this Agreement shall remain binding upon Creator and insure to the benefit of any such assignee or licensee.</p>
    <p class="sub-clause"><b>17.4. Amendment and Waiver:</b> No supplement, modification, amendment, or cancellation of this Agreement shall be binding unless executed in writing by the parties hereto. No waiver of any of the provisions of this Agreement shall be deemed or shall constitute a waiver of any other provision hereof (whether or not similar) nor shall such waiver constitute a continuing waiver.</p>
    <p class="sub-clause"><b>17.5. Relationship:</b> Creator agrees that Company has retained Creator solely for the purposes and to the extent set forth in this Agreement, and Creator shall not be entitled to share in any of the benefits to which Company may derive from the commercial exploitation of the Creator's services rendered in connection with the Film and hereunder (including all original ideas in connection therewith). The Creator shall not be construed to be a Creator or agent of Company.</p>
    <p class="sub-clause"><b>17.6. Force Majeure:</b> If by any reason of an event of force majeure, as that term is commonly understood in the Film industry (including, without limitation, fire, flood, labor strike, acts of god, or disfigurement, death or disability of principal cast or crew of the Picture), the production or completion of the Film is materially hampered, interrupted or interfered with, then Company shall have the option to suspend this Agreement for a period of a month. Should the event of force majeure extend beyond said period of a month then Creator shall have the option to terminate this Agreement with the consent of Company.</p>
    <p class="sub-clause"><b>17.7. Further Assurance:</b> The Creator hereby undertakes to do any and all acts and execute any and all documents in such manner and at such locations as may be required by Company in its sole discretion in order to secure, protect, perfect or enforce any of the rights of Company pursuant to this Agreement. In the event the Creator fails to do so within 15 days of receipt of a request from Company to do or perform an act or execute a document, Company shall be entitled to exercise the same in place of the Creator as the lawful appointed attorney and the Creator undertakes to affirm, ratify and be bound by such exercise of the right by Company under the provisions of this clause.</p>
    <p class="sub-clause"><b>17.8. Severability:</b> In the event any provision or part of this Agreement is found to be invalid or unenforceable, only that particular provision or part so found, and not the entire Agreement, will be inoperative.</p>
    <p class="sub-clause"><b>17.9. Limited Resource:</b> As an overriding provision of this Agreement (to the extent permitted by law), Creator irrevocably acknowledge and accept that, notwithstanding anything to the contrary in this Agreement, the full extent of Company's liability in respect of any breach of this Agreement shall be limited to the extent of the Content Creation Services Fee payable to Company under this Agreement.</p>
    <p class="sub-clause"><b>17.10. Entire Agreement:</b> This Agreement (including the documents referred to herein) constitutes the entire agreement among the parties and supersedes any prior understandings, agreements, or representations by or among the parties, written or oral, to the extent they related in any way to the subject matter hereof.</p>

    <p style="margin-top: 30px;">By signing in the spaces provided below, Company and Creator accept and agree to all of the terms and conditions hereof.</p>

    <p class="center bold" style="margin-top: 20px;">IN WITNESS WHEREOF, the parties to this Agreement execute this Agreement as of the day and year first set forth above</p>

    <div class="signature-section">
      <div class="signature-grid">
        <div class="signature-box">
          <p><b>Agreed and Accepted By within named "Creator"</b></p>
          <div class="signature-line"></div>
          <p><b>[CREATOR REPRESENTATIVE NAME]</b></p>
          <p>Authorized Signatory</p>
        </div>
        <div class="signature-box">
          <p><b>Agreed and Accepted by within named "Company"</b></p>
          <div class="signature-line"></div>
          <p><b>Parveen Singhal</b></p>
          <p>Authorized Signatory</p>
        </div>
      </div>
    </div>

    <!-- ANNEXURES -->
    <div class="annexure">
      <h3 class="annexure-title">Annexure 1 - Cash Flow Schedule</h3>
      <ul>
        <li><b>25%:</b> Upon signing of the agreement.</li>
        <li><b>25%:</b> Following the successful completion and approval of the offline edit.</li>
        <li><b>40%:</b> After final Technical Check (TC), Quality Check (QC), and approval of all project deliverables.</li>
      </ul>
      <p>The final <b>10%</b> is due 60 days after the project's final delivery, subject to the receipt of a duly approved invoice. This payment is contingent on STAGE receiving the raw assets and project delivery on hard drives.</p>
      <p>Payment will be processed within 15-20 days of receiving the approved invoice. The invoice can be raised after the agreement is finalized and payment is strictly contingent upon the successful completion and approval of the corresponding milestone.</p>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 2 - Delivery Materials</h3>
      <ol>
        <li>All Episodes in the total duration - <span class="highlight">[DURATION]</span> minutes</li>
        <li>Teaser and Trailer</li>
        <li>Posters 3 designs with single artist individual poster</li>
        <li>Coming soon, Streaming now poster</li>
        <li>NOC of cast and crew</li>
        <li>All Raw Data of the Project (You have to purchase the hard disk in your sanctioned budget and upload raw data in it after the final delivery and send it to us)</li>
        <li>Promotion appeal videos by Artists</li>
      </ol>
      <h4>MARKETING ASSETS DELIVERY</h4>
      <ol>
        <li>One Teaser around 1 Minute</li>
        <li>One Trailer around 2:30 minutes</li>
        <li>One Main Poster</li>
        <li>Behind the shoot Footage and Edit</li>
        <li>Lead and primary Character Promo Shoot (All Lead & Primary Character) 30+ sec</li>
      </ol>
      <h4>TALENT NOC AND OTHER TERMS CONDITION</h4>
      <ol>
        <li>Creator, Lead/Primary cast, Departmental HOD has to sign NOC form and Creator has to submit us Scan + Hard Copy</li>
        <li>Everyone in the team, especially Lead Cast & Creator/Director has to take part in offline and online Promotion + marketing and have to post/promote teaser, trailer, poster over his social media.</li>
        <li>If Applicable, The Creator/Writer/Director and lead +primary+secondary cast is committed for season 2 also with 10-20% increase in remuneration within 3-5 months post release.</li>
        <li>All the Data is required in hard-disk (Purchased by Creator). Once all the data is uploaded in the harddisks, please arrange a video call with stage authority to check and confirm the data.</li>
      </ol>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 3 - Detailed Content Creation Budget</h3>
      <table>
        <tr><th colspan="2">PROJECT DETAILS</th></tr>
        <tr><td>Content Name/Title</td><td><span class="highlight">[PROJECT TITLE]</span></td></tr>
        <tr><td>Format</td><td><span class="highlight">[FEATURE FILM / WEB SERIES / MICRODRAMA]</span></td></tr>
        <tr><td>Creator Name</td><td><span class="highlight">[CREATOR NAME]</span></td></tr>
        <tr><td>Duration</td><td><span class="highlight">[DURATION]</span></td></tr>
        <tr><td>Shooting Days</td><td><span class="highlight">[NUMBER OF DAYS]</span></td></tr>
        <tr><td>Production Company</td><td><span class="highlight">[PRODUCTION COMPANY]</span></td></tr>
      </table>
      <table>
        <tr><th>S.NO</th><th>PARTICULARS</th><th>PACKAGE/TOTAL</th></tr>
        <tr><td colspan="3"><b>PRE PRODUCTION & SCRIPT DEVELOPMENT</b></td></tr>
        <tr><td>1</td><td>Concept and Idea</td><td></td></tr>
        <tr><td>2</td><td>Story</td><td></td></tr>
        <tr><td>3</td><td>Screenplay</td><td></td></tr>
        <tr><td>4</td><td>Dialogues</td><td></td></tr>
        <tr><td>5</td><td>Lyricist</td><td></td></tr>
        <tr><td>6</td><td>Singers</td><td></td></tr>
        <tr><td>7</td><td>Title Track Composition</td><td></td></tr>
        <tr><td>8</td><td>Music Director/Composer (Songs)</td><td></td></tr>
        <tr><td>9</td><td>Artist Workshop & Look Test</td><td></td></tr>
        <tr><td>10</td><td>Location Recce/Scouting</td><td></td></tr>
        <tr><td colspan="3"><b>PRODUCTION</b></td></tr>
        <tr><td>1</td><td>Cast/Artists (15% of Production Cost) + Juniors</td><td></td></tr>
        <tr><td>2</td><td>Crew (Proper Bifurcation)</td><td></td></tr>
        <tr><td>3</td><td>Locations/Studio</td><td></td></tr>
        <tr><td>4</td><td>Shooting Equipments (Proper Bifurcations)</td><td></td></tr>
        <tr><td colspan="3"><b>PRODUCTION MATERIAL</b></td></tr>
        <tr><td>1</td><td>Set Design & Set Construction</td><td></td></tr>
        <tr><td>2</td><td>Properties on Rent/Purchase</td><td></td></tr>
        <tr><td>3</td><td>Art Requirements</td><td></td></tr>
        <tr><td>4</td><td>Costume on Rent/Purchase (including inners)</td><td></td></tr>
        <tr><td>5</td><td>Jewellary & Accessories</td><td></td></tr>
        <tr><td>6</td><td>Makeup and Hair Material</td><td></td></tr>
        <tr><td>7</td><td>Boarding Travel Lodging/Travel and Stay</td><td></td></tr>
        <tr><td>8</td><td>Transportation (Equipments)</td><td></td></tr>
        <tr><td>9</td><td>Production Vehicles (Artist/Crew)</td><td></td></tr>
        <tr><td>10</td><td>Food</td><td></td></tr>
        <tr><td>11</td><td>Vanity Vans</td><td></td></tr>
        <tr><td>12</td><td>Others</td><td></td></tr>
        <tr><td colspan="3"><b>POST PRODUCTION</b></td></tr>
        <tr><td>1</td><td>Editor</td><td></td></tr>
        <tr><td>2</td><td>Edit Studio</td><td></td></tr>
        <tr><td>3</td><td>Dubbing Studio</td><td></td></tr>
        <tr><td>4</td><td>DI & Color Grading</td><td></td></tr>
        <tr><td>5</td><td>VFX & CGI</td><td></td></tr>
        <tr><td>6</td><td>Sound Mixing/Designing</td><td></td></tr>
        <tr><td>7</td><td>Background Music</td><td></td></tr>
        <tr><td>8</td><td>Foley Sound</td><td></td></tr>
        <tr><td colspan="3"><b>OTHER</b></td></tr>
        <tr><td>1</td><td>Total Production Cost</td><td></td></tr>
        <tr><td>2</td><td>Creator's Margin (10% of Total Production Cost)</td><td></td></tr>
        <tr><td colspan="2"><b>TOTAL PROJECT COST</b></td><td><b>‚Çπ [AMOUNT]/-</b></td></tr>
      </table>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 4 - Content Creation Schedule</h3>
      <ol>
        <li>Script: (Submission Date) <span class="highlight">[DATE]</span></li>
        <li>Detailed Screenplay with Dialogues: (Submission Date) <span class="highlight">[DATE]</span></li>
        <li>Pre-production: <span class="highlight">[START DATE]</span> TO <span class="highlight">[END DATE]</span></li>
        <li>Shoot: (Number of Days) <span class="highlight">[X]</span> DAYS (<span class="highlight">[START DATE]</span> TO <span class="highlight">[END DATE]</span>)</li>
        <li>First Cut for STAGE QC: (Estimated Date) <span class="highlight">[DATE]</span></li>
        <li>DI AND MUSIC: <span class="highlight">[DATE]</span></li>
        <li>Post-production: (Start Date - End Date) <span class="highlight">[START DATE]</span> TO <span class="highlight">[END DATE]</span></li>
        <li>Final Cut for QC: (Date) AFTER FEEDBACK MAXIMUM 6 DAYS - <span class="highlight">[DATE]</span></li>
        <li>Final Project Delivery: (Date) <span class="highlight">[DATE]</span></li>
      </ol>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 5 - Detailed List of Service</h3>
      <ol>
        <li>Engagement of Contributors to the Film</li>
        <li>Filming</li>
        <li>Music Composition and Background Score</li>
        <li>Editing</li>
        <li>Pre-Production work</li>
        <li>Post-Production work
          <ul>
            <li>Post Production</li>
            <li>Creation of Production and promotion plan</li>
            <li>Planning of editing and sound</li>
            <li>Selection of music and final mix</li>
            <li>Contact to Digital Print Company and approval of the final print</li>
            <li>Post release editing</li>
          </ul>
        </li>
        <li>Promotion
          <ul>
            <li>Creation of promotional concept</li>
            <li>Creation of final title</li>
            <li>Planning of stills, poster and trailer</li>
          </ul>
        </li>
      </ol>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 6 - Delivery Schedule</h3>
      <ol>
        <li>First Cut for STAGE QC: (Estimated Date) <span class="highlight">[DATE]</span></li>
        <li>DI AND MUSIC: <span class="highlight">[DATE]</span></li>
        <li>Post-production: (Start Date - End Date) <span class="highlight">[START DATE]</span> TO <span class="highlight">[END DATE]</span></li>
        <li>Final Cut for QC: (Date) AFTER FEEDBACK MAXIMUM 6 DAYS - <span class="highlight">[DATE]</span></li>
        <li>Final Project Delivery: (Date) <span class="highlight">[DATE]</span></li>
      </ol>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 7 - Technical Specifications</h3>
      <ol>
        <li>Cinema Camera Model Name: <span class="highlight">[CAMERA MODEL]</span></li>
        <li>Camera Setup type (One Cam Or MultiCam): <span class="highlight">[SETUP TYPE]</span></li>
        <li>Lens types: <span class="highlight">[LENS TYPES]</span></li>
        <li>Lights details: <span class="highlight">[LIGHTS DETAILS]</span></li>
        <li>Cinematic Tools and Equipment: <span class="highlight">[TOOLS LIST]</span></li>
        <li>Drone (Model Name): <span class="highlight">[DRONE MODEL]</span></li>
        <li>Sound Equipment: <span class="highlight">[SOUND EQUIPMENT]</span></li>
      </ol>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 8 - Modes, Medium and Formats</h3>
      <p>"Modes, Media and Formats" of exploitation of the Film and Works shall include but shall not be limited to the following in the Territory and in perpetuity:</p>
      <ul>
        <li>To use and incorporate the Works in all or any format(s).</li>
        <li>Distributing/exploiting/exhibition of the Works (whether digital or analog) via any and all format or medium.</li>
        <li>To produce, distribute and exploit prequels, sequels, versions, time-quels, remakes, games, characters, cartoons, adaptations, mobisodes, webisodes, audio summaries, dialogue bites, plays, dramatic works, books & novels, television series, spin off series, films, repurpose and other adaptations including but not limited to events etc.</li>
        <li>Using any digital television broadcast standards.</li>
        <li>All modes, media and formats of exploitation: (i) in existence now in Territory, (ii) in existence now in Territory but not in commercial use on the date of execution hereof, and (iii) as may be invented, developed, or discovered in future.</li>
        <li>To the extent any form of medium and/or mode of exploitation of the assigned rights, not in existence on the date of this Agreement or not in commercial use and not specifically mentioned in this Agreement ('Future Mediums'), is not held valid by operation of law, the Creator hereby grants an exclusive license, including the right to grant sub-licenses, in relation to such Future Mediums of exploitation of the Materials to the Producer according to the terms of this Agreement.</li>
      </ul>
    </div>

    <div class="annexure">
      <h3 class="annexure-title">Annexure 9 - CERTIFICATE OF AUTHORSHIP</h3>
      <p>For <b>INR <span class="highlight">[AMOUNT]</span>/-</b> and other good and valuable consideration, the receipt and sufficiency of which is hereby acknowledged, the undersigned hereby certifies that the undersigned will render the Producer or has rendered service forming part of the motion picture currently entitled "<span class="highlight">[PROJECT TITLE]</span>" (the "Picture"), at the request of <span class="highlight">[CREATOR/PRODUCTION HOUSE]</span> ("VENDOR") pursuant to a contract of service between Vendor and the undersigned dated as of <span class="highlight">[DATE]</span> (the "Agreement") (All other results and proceeds of the undersigned's services hereunder and under the Agreement are hereinafter referred to as the "Work").</p>
      <p>The undersigned hereby acknowledges that the Work has been specially ordered or commissioned by VENDOR for use as part of a contribution to a collective work or as part of the Picture or other audio-visual work, that the Work constitutes and shall constitute a <b>work-made-for-hire</b> as defined in the Indian Copyright Act of 1957, as amended, that Stage Technologies Private Limited ("Company") to whom the VENDOR has assigned the work on a First Copy Basis is and shall be the author of said work-made-for-hire and the owner of all rights in and to the Work, including, without limitation, the copyright therein and thereto throughout the universe for the initial term and any and all extensions and renewals thereof, and that Company has and shall have the right to make such changes therein and such uses thereof as it may deem necessary or desirable including but not limited, to the right to include the Work in the Picture in all media now and hereafter devised and on phonorecords and trailers, advertisements, promotions and co-promotions with respect thereto.</p>
      <p>To the extent that the Work is not deemed a work-made-for-hire, and to the extent that Company is not deemed to be the author thereof in any territory of the universe, the undersigned hereby irrevocably assigns the Work to Company (including the entire copyright therein and any extensions and/or renewals thereof), and grants to Company all rights therein, throughout the universe in perpetuity.</p>
      <p>The undersigned hereby acknowledges that the compensation paid hereunder and under the Agreement includes adequate and equitable remuneration for the assigned rights and constitutes a complete buy-out of all assigned Rights. Company's rights with respect to the Work may be freely assigned and licensed.</p>
      <p>The undersigned agrees to execute any documents consistent herewith and do any other acts consistent with this Certificate which may reasonably be required by Company or its assignees or licensees to further evidence or effectuate Company's rights. Upon the undersigned's failure to do so after ten (10) days of Company's written request, the undersigned hereby appoints Company as the undersigned's attorney-in-fact for such purposes, with full power of substitution and delegation.</p>
      <p>The undersigned affirms and acknowledges that the undersigned has been advised and counselled with respect to the negotiation and execution of this document by an attorney of the undersigned's own choice or acknowledges waiver of such advice and counsel. This Certificate shall be governed by the laws of India and courts in Delhi shall have exclusive jurisdiction.</p>
      <p class="center" style="margin-top: 30px;"><b>IN WITNESS WHEREOF</b>, the undersigned has signed this Certificate as of <span class="highlight">[DATE]</span></p>
      <div class="signature-grid" style="margin-top: 40px;">
        <div class="signature-box">
          <p>Signature:</p>
          <div class="signature-line"></div>
          <p>Name: <span class="highlight">[CONTRIBUTOR NAME]</span></p>
        </div>
        <div class="signature-box">
          <p>AGREED AND ACCEPTED:</p>
          <p><b>STAGE Technologies Private Limited</b></p>
          <div class="signature-line"></div>
          <p>By: Mr. Parveen Singhal</p>
        </div>
      </div>
    </div>

    <div style="margin-top: 50px; text-align: center; color: #666; font-size: 10pt; border-top: 1px solid #ccc; padding-top: 20px;">
      <p>üé¨ STAGE Technologies Private Limited ‚Ä¢ Content Creation Agreement Template</p>
      <p>This is a template document. Fill in all highlighted [PLACEHOLDER] fields before use.</p>
      <p>Confidential & Legally Binding when executed.</p>
    </div>
  </div>
</body>
</html>`;
                                      const printWindow = window.open('', '_blank');
                                      if (printWindow) {
                                        printWindow.document.write(agreementHtml);
                                        printWindow.document.close();
                                        printWindow.print();
                                      }
                                    }}
                                    className="px-6 py-3 bg-white hover:bg-red-50 text-red-700 font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2"
                                  >
                                    <span className="text-xl">üìÑ</span>
                                    <span>View Full Agreement (27 Pages)</span>
                                  </button>
                                </div>
                                <p className="text-red-200 text-sm leading-relaxed">
                                  Complete STAGE Content Creation Agreement - Exact replica of official contract with all 17 clauses (Definitions 1.1-1.17, Engagement, Content Creation Services 3.1-3.12, Contributors 4.1-4.3, Review Process, Fees 6.1-6.8, IP Rights 7.1-7.12, Termination 8.1-8.4, Post Termination 9.1-9.6, Warranties 10.1-10.21, Insurance, Indemnification, Name & Likeness, Credit, Confidentiality, Making of Films, Miscellaneous 17.1-17.10) + 9 Annexures (Cash Flow, Delivery Materials, Budget, Schedule, Services, Delivery Schedule, Technical Specs, Modes/Formats, Certificate of Authorship). Send to creators for review before signing.
                                </p>
                              </div>

                              {/* Download Options */}
                              <div className="bg-white border-2 border-red-300 rounded-xl p-5 mb-6">
                                <h4 className="font-bold text-red-800 mb-4 flex items-center gap-2 text-lg">
                                  üì• Download Agreement Template
                                </h4>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                  {/* Google Docs */}
                                  <button
                                    onClick={() => {
                                      const docsUrl = 'https://docs.google.com/document/create';
                                      window.open(docsUrl, '_blank');
                                      const textData = `CONTENT CREATION AGREEMENT

This Content Creation Agreement ("Agreement") is executed at Delhi on [DATE].

BY AND BETWEEN:

STAGE Technologies Private Limited, a Company incorporated under the Indian Companies Act and having its office at Room No. 203, Second Floor, 2-A/3, Kundan Mansion, Asaf Ali Road, Delhi - 110002, represented by its Director, Mr. Parveen Singhal (hereinafter referred to as the "Company")

AND

[CREATOR/PRODUCTION HOUSE NAME], a [Proprietorship/Partnership/Company], having its office at [COMPLETE ADDRESS], represented by [REPRESENTATIVE NAME], PAN - [PAN NUMBER] (GST - [GST NUMBER]) (hereinafter referred to as "Creator")

WHEREAS:
1. Company and Creator both are engaged in the business of production and distribution of films.
2. Company has engaged Creator to create content in the form of a Film solely for Company's exploitation.
3. Company shall be the author and the first and exclusive owner of the copyright in the Film, for the entire Territory and in perpetuity.

NOW THIS AGREEMENT WITNESSETH FOLLOWS:

1. DEFINITIONS (1.1-1.17):
   - Cash Flow Schedule, Creative Elements, Contributors, Delivery Date, Delivery Materials, Delivery Schedule, Film Materials, First Copy, Intellectual Property, Content Creation Budget, Content Creation Schedule, Publicity Materials, Content Creation Services, Revenues, Technical Specifications, Term, Territory

2. ENGAGEMENT (2.1-2.4)

3. CONTENT CREATION SERVICES (3.1-3.12)

4. CONTRIBUTORS AND THEIR AGREEMENTS (4.1-4.3)

5. REVIEW PROCESS

6. CONTENT CREATION SERVICES FEE (6.1-6.8)
   Fee: INR [AMOUNT]/- plus applicable taxes/GST
   Penalty: 18% per annum for delays

7. INTELLECTUAL PROPERTY RIGHTS (7.1-7.12)
   - Work-made-for-hire
   - NFT, Crypto, Blockchain, Metaverse, web3 rights included
   - Section 14, 38A, 18(1), 19(4), 19A Copyright Act 1957

8. TERMINATION/SUSPENSION OF SERVICES (8.1-8.4)

9. POST TERMINATION (9.1-9.6)
   - Interest @ 18% per annum on delayed refunds

10. CREATOR'S REPRESENTATIONS AND WARRANTIES (10.1-10.21)
    - Anti-bribery/Anti-corruption clause (10.9)

11. INSURANCE
    - Company as co-payee

12. INDEMNIFICATION

13. NAME AND LIKENESS

14. CREDIT

15. CONFIDENTIALITY

16. MAKING OF FILMS

17. MISCELLANEOUS (17.1-17.10)
    - Governing Law: India, Delhi courts
    - Arbitration: Indian Arbitration and Conciliation Act, 1996
    - Assignment, Amendment, Relationship, Force Majeure, Further Assurance, Severability, Limited Resource, Entire Agreement

ANNEXURES:
1. Cash Flow Schedule (25%-25%-40%-10%)
2. Delivery Materials
3. Detailed Content Creation Budget
4. Content Creation Schedule
5. Detailed List of Services
6. Delivery Schedule
7. Technical Specifications
8. Modes, Medium and Formats
9. Certificate of Authorship

SIGNATURES:
Creator: ______________________
Company: ______________________

STAGE Technologies Private Limited`;
                                      navigator.clipboard.writeText(textData);
                                      alert('Google Docs opened! Agreement summary copied - paste it (Ctrl+V)');
                                    }}
                                    className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-red-50 to-rose-100 border-2 border-red-400 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                  >
                                    <div className="w-14 h-14 bg-red-500 rounded-xl flex items-center justify-center">
                                      <span className="text-3xl">üìÑ</span>
                                    </div>
                                    <div className="text-center">
                                      <p className="font-bold text-red-800">Google Docs</p>
                                      <p className="text-xs text-red-600">Open & Edit Online</p>
                                    </div>
                                  </button>

                                  {/* Word Download */}
                                  <button
                                    onClick={() => {
                                      alert('Use "View Full Agreement" button to print/save as PDF for complete document with all 27 pages');
                                    }}
                                    className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-blue-50 to-indigo-100 border-2 border-blue-400 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                  >
                                    <div className="w-14 h-14 bg-blue-600 rounded-xl flex items-center justify-center">
                                      <span className="text-3xl">üìò</span>
                                    </div>
                                    <div className="text-center">
                                      <p className="font-bold text-blue-800">Save as PDF</p>
                                      <p className="text-xs text-blue-600">Print to PDF</p>
                                    </div>
                                  </button>

                                  {/* WhatsApp */}
                                  <button
                                    onClick={() => {
                                      const message = "*üé¨ STAGE CONTENT CREATION AGREEMENT*\nüìù _OTT Production Contract - 27 Pages_\n\n*Agreement:* STAGE/CCA/____/25-26\n*Date:* [DATE]\n\n*COMPANY:*\nSTAGE Technologies Pvt Ltd\nNew Delhi - 110002\nGSTIN: 07AAICC1279L1ZC\n\n*CREATOR:*\n[CREATOR NAME]\n\n*PROJECT:*\nüé¨ Title: [PROJECT NAME]\nüó£Ô∏è Language: [REGIONAL]\nüì∫ Format: [Film/Series]\n\n*BUDGET:* ‚Çπ [AMOUNT]/-\n\n*PAYMENT SCHEDULE:*\n‚úÖ 25% - Upon signing\n‚úÖ 25% - Offline edit approval\n‚úÖ 40% - TC/QC approval\n‚úÖ 10% - 60 days after delivery\n\n*17 CLAUSES:*\n1. Definitions (1.1-1.17)\n2. Engagement (2.1-2.4)\n3. Content Creation Services (3.1-3.12)\n4. Contributors (4.1-4.3)\n5. Review Process\n6. Fees (6.1-6.8)\n7. IP Rights (7.1-7.12)\n8. Termination (8.1-8.4)\n9. Post Termination (9.1-9.6)\n10. Warranties (10.1-10.21)\n11. Insurance\n12. Indemnification\n13. Name & Likeness\n14. Credit\n15. Confidentiality\n16. Making of Films\n17. Miscellaneous (17.1-17.10)\n\n*9 ANNEXURES:*\nüìã A1: Cash Flow Schedule\nüìã A2: Delivery Materials\nüìã A3: Detailed Budget\nüìã A4: Content Creation Schedule\nüìã A5: Services List\nüìã A6: Delivery Schedule\nüìã A7: Technical Specifications\nüìã A8: Modes/Mediums/Formats\nüìã A9: Certificate of Authorship\n\n*KEY PROVISIONS:*\n‚Ä¢ Work-for-Hire under Copyright Act 1957\n‚Ä¢ NFT/Crypto/Blockchain/Metaverse rights\n‚Ä¢ 18% penalty for delays\n‚Ä¢ Arbitration: Delhi\n‚Ä¢ Anti-bribery clause\n\nüìß _Please review complete document and revert_\n\nüé¨ STAGE OTT Platform";
                                      const whatsappUrl = "https://wa.me/?text=" + encodeURIComponent(message);
                                      window.open(whatsappUrl, '_blank');
                                    }}
                                    className="flex flex-col items-center gap-3 p-4 bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-500 rounded-xl hover:shadow-lg hover:scale-105 transition-all"
                                  >
                                    <div className="w-14 h-14 bg-green-600 rounded-xl flex items-center justify-center">
                                      <span className="text-3xl">üí¨</span>
                                    </div>
                                    <div className="text-center">
                                      <p className="font-bold text-green-800">WhatsApp</p>
                                      <p className="text-xs text-green-600">Share Summary</p>
                                    </div>
                                  </button>
                                </div>
                              </div>

                              {/* Agreement Preview Card */}
                              <div className="rounded-2xl shadow-2xl overflow-hidden border-2 border-red-500/30">
                                {/* Header */}
                                <div className="bg-gradient-to-r from-slate-900 via-red-900 to-rose-900 p-6 text-center">
                                  <div className="flex justify-center gap-4 mb-4">
                                    <div className="w-14 h-14 bg-white/15 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30">
                                      <span className="text-3xl">üé¨</span>
                                    </div>
                                    <div className="w-14 h-14 bg-white/15 backdrop-blur-sm rounded-xl flex items-center justify-center border border-white/30">
                                      <span className="text-3xl">üìù</span>
                                    </div>
                                  </div>
                                  <h3 className="text-2xl font-black text-white tracking-wide">CONTENT CREATION AGREEMENT</h3>
                                  <p className="text-red-300 text-sm mt-1">STAGE OTT Production Contract - Complete 27 Page Template</p>
                                  <div className="inline-block bg-white/15 backdrop-blur-sm px-4 py-1.5 rounded-full text-white text-xs font-bold mt-3 border border-white/20">
                                    17 Clauses ‚Ä¢ 9 Annexures ‚Ä¢ Copyright Act 1957 Compliant
                                  </div>
                                </div>

                                {/* Content */}
                                <div className="p-6 bg-white">
                                  <div className="grid grid-cols-2 gap-6 mb-6">
                                    <div>
                                      <h4 className="font-bold text-sm text-red-700 mb-2">üìã ALL 17 CLAUSES:</h4>
                                      <div className="text-xs text-gray-600 space-y-1">
                                        <p>1. Definitions (1.1-1.17)</p>
                                        <p>2. Engagement (2.1-2.4)</p>
                                        <p>3. Content Creation Services (3.1-3.12)</p>
                                        <p>4. Contributors (4.1-4.3)</p>
                                        <p>5. Review Process</p>
                                        <p>6. Fees (6.1-6.8) - 18% penalty</p>
                                        <p>7. IP Rights (7.1-7.12) - NFT/Crypto</p>
                                        <p>8. Termination (8.1-8.4)</p>
                                        <p>9. Post Termination (9.1-9.6)</p>
                                        <p>10. Warranties (10.1-10.21)</p>
                                        <p>11. Insurance (Co-payee)</p>
                                        <p>12. Indemnification</p>
                                        <p>13. Name & Likeness</p>
                                        <p>14. Credit</p>
                                        <p>15. Confidentiality</p>
                                        <p>16. Making of Films</p>
                                        <p>17. Miscellaneous (17.1-17.10)</p>
                                      </div>
                                    </div>
                                    <div>
                                      <h4 className="font-bold text-sm text-red-700 mb-2">üìé ALL 9 ANNEXURES:</h4>
                                      <div className="text-xs text-gray-600 space-y-1">
                                        <p>A1: Cash Flow (25-25-40-10)</p>
                                        <p>A2: Delivery Materials</p>
                                        <p>A3: Detailed Budget Table</p>
                                        <p>A4: Content Creation Schedule</p>
                                        <p>A5: Services List</p>
                                        <p>A6: Delivery Schedule</p>
                                        <p>A7: Technical Specifications</p>
                                        <p>A8: Modes/Mediums/Formats</p>
                                        <p>A9: Certificate of Authorship</p>
                                      </div>
                                      <h4 className="font-bold text-sm text-red-700 mt-4 mb-2">‚öñÔ∏è LEGAL PROVISIONS:</h4>
                                      <div className="text-xs text-gray-600 space-y-1">
                                        <p>‚Ä¢ Copyright Act 1957</p>
                                        <p>‚Ä¢ Section 14, 38A, 18(1), 19(4), 19A</p>
                                        <p>‚Ä¢ Arbitration Act 1996</p>
                                        <p>‚Ä¢ Anti-bribery compliance</p>
                                        <p>‚Ä¢ Delhi jurisdiction</p>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                                {/* Footer */}
                                <div className="bg-slate-900 py-3 px-5 text-center">
                                  <p className="text-slate-400 text-xs">üé¨ STAGE OTT Platform ‚Ä¢ Complete Content Creation Agreement ‚Ä¢ Legally Binding</p>
                                </div>
                              </div>

                              <h4 className="font-bold text-gray-800 mb-4 mt-6">Agreement Guidelines</h4>
                            </div>
                          )}

                          {/* OTT BUDGET GUIDE - Interactive Section */}
                          {(selectedCat as any).hasOttBudgetGuide && (
                            <div className="mb-8">
                              {/* Main Header */}
                              <div className="bg-gradient-to-br from-amber-900 via-orange-900 to-red-900 border-2 border-amber-500/50 rounded-2xl p-6 mb-6 shadow-2xl">
                                <div className="flex items-center justify-between mb-4">
                                  <div className="flex items-center gap-4">
                                    <div className="w-16 h-16 bg-gradient-to-br from-amber-400 to-orange-500 rounded-xl flex items-center justify-center shadow-lg border-2 border-white/20">
                                      <span className="text-4xl">üí∞</span>
                                    </div>
                                    <div>
                                      <h3 className="text-2xl font-black text-white">OTT Budget & Producer Margin Guide</h3>
                                      <p className="text-amber-300 text-sm font-medium">‚Çπ40 Lakh Regional Film ‚Ä¢ Industry Research 2024-25</p>
                                    </div>
                                  </div>
                                  <button
                                    onClick={() => {
                                      const budgetGuideHtml = `
<!DOCTYPE html>
<html>
<head>
  <title>OTT Budget & Producer Margin Guide - STAGE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: linear-gradient(135deg, #1e1b4b 0%, #0f172a 100%); min-height: 100vh; padding: 40px; }
    .container { max-width: 900px; margin: 0 auto; }
    .header { background: linear-gradient(135deg, #f59e0b 0%, #d97706 50%, #b45309 100%); border-radius: 20px 20px 0 0; padding: 30px; text-align: center; }
    .header h1 { color: white; font-size: 28px; font-weight: 900; }
    .header p { color: rgba(255,255,255,0.9); font-size: 14px; margin-top: 8px; }
    .main-content { background: white; border-radius: 0 0 20px 20px; padding: 40px; }
    .section { margin-bottom: 35px; page-break-inside: avoid; }
    .section-title { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 12px 20px; border-radius: 10px; font-size: 16px; font-weight: 800; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
    .budget-box { background: #fffbeb; border: 2px solid #fbbf24; border-radius: 12px; padding: 20px; margin-bottom: 15px; }
    .budget-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 15px; border-bottom: 2px dashed #fbbf24; }
    .total-budget { font-size: 24px; font-weight: 900; color: #92400e; }
    .margin-badge { background: #059669; color: white; padding: 8px 16px; border-radius: 20px; font-weight: 700; }
    .breakdown-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .breakdown-item { background: white; border: 1px solid #e5e7eb; border-radius: 10px; padding: 15px; }
    .breakdown-item.highlight { border-color: #f59e0b; background: #fffbeb; }
    .item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .item-title { font-weight: 700; color: #1f2937; font-size: 14px; }
    .item-percent { background: #f59e0b; color: white; padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 700; }
    .item-amount { font-size: 18px; font-weight: 800; color: #059669; margin-bottom: 8px; }
    .item-details { font-size: 11px; color: #6b7280; line-height: 1.6; }
    .platform-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    .platform-table th { background: linear-gradient(135deg, #1e40af, #1d4ed8); color: white; padding: 12px; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; }
    .platform-table td { padding: 12px; border-bottom: 1px solid #e5e7eb; font-size: 13px; }
    .platform-table tr:nth-child(even) { background: #f8fafc; }
    .platform-name { font-weight: 700; color: #1f2937; display: flex; align-items: center; gap: 8px; }
    .margin-cell { font-weight: 700; color: #059669; }
    .amount-cell { color: #1f2937; }
    .model-box { background: linear-gradient(135deg, #ede9fe, #ddd6fe); border: 2px solid #8b5cf6; border-radius: 12px; padding: 20px; }
    .model-title { font-weight: 800; color: #5b21b6; font-size: 16px; margin-bottom: 15px; }
    .model-formula { background: white; border-radius: 8px; padding: 15px; text-align: center; margin-bottom: 15px; }
    .formula-text { font-size: 18px; font-weight: 700; color: #1f2937; }
    .model-details { font-size: 13px; color: #4c1d95; line-height: 1.8; }
    .trends-list { list-style: none; }
    .trends-list li { display: flex; align-items: flex-start; gap: 12px; padding: 12px; background: #fef2f2; border-radius: 8px; margin-bottom: 10px; font-size: 13px; color: #991b1b; }
    .trends-icon { font-size: 18px; }
    .tips-list { list-style: none; }
    .tips-list li { display: flex; align-items: flex-start; gap: 12px; padding: 12px; background: #ecfdf5; border-radius: 8px; margin-bottom: 10px; font-size: 13px; color: #065f46; }
    .footer { text-align: center; margin-top: 30px; padding-top: 20px; border-top: 2px solid #e5e7eb; color: #9ca3af; font-size: 11px; }
    @media print { body { background: white; padding: 20px; } .container { max-width: 100%; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üí∞ OTT Budget & Producer Margin Guide</h1>
      <p>‚Çπ40 Lakh Regional Film Budget Allocation ‚Ä¢ Industry Research 2024-25 ‚Ä¢ STAGE OTT Platform</p>
    </div>

    <div class="main-content">
      <div class="section">
        <div class="section-title">üìä ‚Çπ40 LAKH REGIONAL FILM - Budget Breakdown</div>
        <div class="budget-box">
          <div class="budget-header">
            <div>
              <p style="font-size:12px;color:#92400e;font-weight:600;">TOTAL BUDGET</p>
              <p class="total-budget">‚Çπ40,00,000</p>
            </div>
            <div style="text-align:right;">
              <div class="margin-badge">10% Creator Margin = ‚Çπ4,00,000</div>
              <p style="font-size:12px;color:#6b7280;margin-top:8px;">Working Budget: ‚Çπ36,00,000</p>
            </div>
          </div>

          <div class="breakdown-grid">
            <div class="breakdown-item highlight">
              <div class="item-header">
                <span class="item-title">1Ô∏è‚É£ ABOVE-THE-LINE</span>
                <span class="item-percent">25-30%</span>
              </div>
              <div class="item-amount">‚Çπ9,00,000 - ‚Çπ10,80,000</div>
              <div class="item-details">
                ‚Ä¢ Director Fee: 8-10% (‚Çπ2.88-3.6L)<br>
                ‚Ä¢ Script/Story: 3-5% (‚Çπ1.08-1.8L)<br>
                ‚Ä¢ Lead Cast (2-3): 10-12% (‚Çπ3.6-4.32L)<br>
                ‚Ä¢ Music Director: 3-4% (‚Çπ1.08-1.44L)
              </div>
            </div>

            <div class="breakdown-item highlight">
              <div class="item-header">
                <span class="item-title">2Ô∏è‚É£ PRODUCTION/BTL</span>
                <span class="item-percent">40-45%</span>
              </div>
              <div class="item-amount">‚Çπ14,40,000 - ‚Çπ16,20,000</div>
              <div class="item-details">
                ‚Ä¢ Crew Salaries: 12-15% (‚Çπ4.32-5.4L)<br>
                ‚Ä¢ Camera & Equipment: 8-10% (‚Çπ2.88-3.6L)<br>
                ‚Ä¢ Location & Set: 6-8% (‚Çπ2.16-2.88L)<br>
                ‚Ä¢ Art/Props/Costumes: 5-6% (‚Çπ1.8-2.16L)<br>
                ‚Ä¢ Transport & Catering: 4-5% (‚Çπ1.44-1.8L)
              </div>
            </div>

            <div class="breakdown-item highlight">
              <div class="item-header">
                <span class="item-title">3Ô∏è‚É£ POST-PRODUCTION</span>
                <span class="item-percent">18-22%</span>
              </div>
              <div class="item-amount">‚Çπ6,48,000 - ‚Çπ7,92,000</div>
              <div class="item-details">
                ‚Ä¢ Editing: 4-5% (‚Çπ1.44-1.8L)<br>
                ‚Ä¢ Color Grading/DI: 3-4% (‚Çπ1.08-1.44L)<br>
                ‚Ä¢ Sound Design: 4-5% (‚Çπ1.44-1.8L)<br>
                ‚Ä¢ BGM/Score: 3-4% (‚Çπ1.08-1.44L)<br>
                ‚Ä¢ VFX (if needed): 2-3% (‚Çπ0.72-1.08L)
              </div>
            </div>

            <div class="breakdown-item highlight">
              <div class="item-header">
                <span class="item-title">4Ô∏è‚É£ CONTINGENCY & MISC</span>
                <span class="item-percent">8-10%</span>
              </div>
              <div class="item-amount">‚Çπ2,88,000 - ‚Çπ3,60,000</div>
              <div class="item-details">
                ‚Ä¢ Contingency Fund: 5-7% (‚Çπ1.8-2.52L)<br>
                ‚Ä¢ Insurance & Permits: 1-2% (‚Çπ0.36-0.72L)<br>
                ‚Ä¢ Marketing Assets: 1-2% (‚Çπ0.36-0.72L)
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üé¨ OTT Platform Producer Margins (2024-25)</div>
        <table class="platform-table">
          <thead>
            <tr>
              <th>Platform</th>
              <th>Margin %</th>
              <th>Amount (‚Çπ40L Budget)</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="platform-name">üì∫ Netflix India</td>
              <td class="margin-cell">10-15%</td>
              <td class="amount-cell">‚Çπ4,00,000 - ‚Çπ6,00,000</td>
              <td>Premium content, strict QC</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Amazon Prime Video</td>
              <td class="margin-cell">12-18%</td>
              <td class="amount-cell">‚Çπ4,80,000 - ‚Çπ7,20,000</td>
              <td>Best margins, long-term deals</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Disney+ Hotstar</td>
              <td class="margin-cell">10-15%</td>
              <td class="amount-cell">‚Çπ4,00,000 - ‚Çπ6,00,000</td>
              <td>Regional focus increasing</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Zee5</td>
              <td class="margin-cell">10-12%</td>
              <td class="amount-cell">‚Çπ4,00,000 - ‚Çπ4,80,000</td>
              <td>Strong regional library</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Sony LIV</td>
              <td class="margin-cell">10-12%</td>
              <td class="amount-cell">‚Çπ4,00,000 - ‚Çπ4,80,000</td>
              <td>Growing regional slate</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Hoichoi (Bengali)</td>
              <td class="margin-cell">8-12%</td>
              <td class="amount-cell">‚Çπ3,20,000 - ‚Çπ4,80,000</td>
              <td>Regional leader, volume deals</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Aha (Telugu)</td>
              <td class="margin-cell">8-10%</td>
              <td class="amount-cell">‚Çπ3,20,000 - ‚Çπ4,00,000</td>
              <td>Telugu exclusive content</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ Sun NXT</td>
              <td class="margin-cell">8-10%</td>
              <td class="amount-cell">‚Çπ3,20,000 - ‚Çπ4,00,000</td>
              <td>South Indian regional</td>
            </tr>
            <tr>
              <td class="platform-name">üì∫ MX Player</td>
              <td class="margin-cell">5-8%</td>
              <td class="amount-cell">‚Çπ2,00,000 - ‚Çπ3,20,000</td>
              <td>Lower budgets, AVOD model</td>
            </tr>
            <tr style="background:#ecfdf5;">
              <td class="platform-name" style="color:#059669;"><strong>üì∫ STAGE OTT</strong></td>
              <td class="margin-cell"><strong>10% Fixed</strong></td>
              <td class="amount-cell"><strong>‚Çπ4,00,000</strong></td>
              <td style="color:#059669;"><strong>Regional focus, creator-friendly</strong></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="section">
        <div class="section-title">üíº Cost-Plus Model Explained</div>
        <div class="model-box">
          <div class="model-title">How OTT Platforms Calculate Producer Fees</div>
          <div class="model-formula">
            <p class="formula-text">Production Cost + Fixed % Margin = Total Deal Value</p>
            <p style="font-size:13px;color:#6b7280;margin-top:8px;">Example: ‚Çπ36L Production + 10% (‚Çπ4L) Margin = ‚Çπ40L Total</p>
          </div>
          <div class="model-details">
            <strong>Key Points:</strong><br>
            ‚Ä¢ OTT owns ALL rights for agreed duration (typically 5-7 years, some perpetual)<br>
            ‚Ä¢ Regional languages get slightly lower margins (8-12%) vs Hindi (10-18%)<br>
            ‚Ä¢ First-time creators: 5-8% | Established: 10-15% | Star creators: 15-25%<br>
            ‚Ä¢ Backend/revenue share deals are RARE for new creators<br>
            ‚Ä¢ IP Rights fully transfer to OTT platform
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">‚ö†Ô∏è 2024-25 Market Trends</div>
        <ul class="trends-list">
          <li><span class="trends-icon">üìâ</span> Producer margins have DECLINED from 15-20% (2020) to 8-12% (2024)</li>
          <li><span class="trends-icon">üìÖ</span> OTT platforms preferring shorter exclusivity (1-2 years vs perpetual)</li>
          <li><span class="trends-icon">üó£Ô∏è</span> Regional content getting more investment but tighter margins</li>
          <li><span class="trends-icon">üö´</span> Backend/revenue share deals are rare for new creators</li>
          <li><span class="trends-icon">üéØ</span> Focus on proven IP and sequels over experimental content</li>
        </ul>
      </div>

      <div class="section">
        <div class="section-title">‚úÖ Tips for Maximizing Your Margin</div>
        <ul class="tips-list">
          <li><span class="trends-icon">üìà</span> Build track record with lower-margin projects first</li>
          <li><span class="trends-icon">ü§ù</span> Negotiate multi-project deals for better rates</li>
          <li><span class="trends-icon">üéµ</span> Own music rights separately when possible</li>
          <li><span class="trends-icon">üí™</span> Keep production costs lean to protect actual margin</li>
          <li><span class="trends-icon">ü§ù</span> Consider co-production for shared risk & better terms</li>
        </ul>
      </div>

      <div class="footer">
        <p>üé¨ STAGE OTT Platform ‚Ä¢ Regional Content Production ‚Ä¢ Budget & Margin Guide ‚Ä¢ Research: 2024-25</p>
        <p style="margin-top:8px;">Generated from STAGE Creator Portal ‚Ä¢ www.stageasai.com</p>
      </div>
    </div>
  </div>
</body>
</html>`;
                                      const printWindow = window.open('', '_blank');
                                      if (printWindow) {
                                        printWindow.document.write(budgetGuideHtml);
                                        printWindow.document.close();
                                        printWindow.print();
                                      }
                                    }}
                                    className="px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg text-sm font-bold flex items-center gap-2 border border-white/20"
                                  >
                                    üì• Download Complete PDF
                                  </button>
                                </div>
                                <p className="text-amber-200 text-sm leading-relaxed">
                                  Comprehensive guide covering department-wise budget allocation, OTT platform producer margins (Netflix, Amazon, Hoichoi, Zee5, etc.),
                                  Cost-Plus model explanation, and current market trends for regional content creators.
                                </p>
                              </div>

                              {/* Clickable Section Tabs */}
                              <div className="bg-white border-2 border-amber-300 rounded-xl p-5 mb-6">
                                <h4 className="font-bold text-amber-800 mb-4 flex items-center gap-2 text-lg">
                                  üìÇ Select Section to View Details
                                </h4>
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
                                  {[
                                    { id: 'allocation', label: '‚Çπ40L Budget Allocation', icon: 'üìä', color: 'from-amber-500 to-orange-600' },
                                    { id: 'platforms', label: 'OTT Platform Margins', icon: 'üì∫', color: 'from-blue-500 to-indigo-600' },
                                    { id: 'costplus', label: 'Cost-Plus Model', icon: 'üíº', color: 'from-purple-500 to-violet-600' },
                                    { id: 'trends', label: '2024-25 Trends', icon: 'üìà', color: 'from-red-500 to-rose-600' },
                                    { id: 'tips', label: 'Creator Tips', icon: 'üí°', color: 'from-green-500 to-emerald-600' },
                                  ].map(section => (
                                    <button
                                      key={section.id}
                                      onClick={() => {
                                        const sectionContent: { [key: string]: string } = {
                                          allocation: `
<!DOCTYPE html>
<html>
<head>
  <title>‚Çπ40 Lakh Film Budget Allocation - STAGE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f8fafc; padding: 40px; }
    .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); padding: 30px; text-align: center; }
    .header h1 { color: white; font-size: 26px; font-weight: 900; }
    .header p { color: rgba(255,255,255,0.9); margin-top: 8px; }
    .summary { background: #fffbeb; padding: 25px; display: flex; justify-content: space-around; border-bottom: 2px solid #fbbf24; }
    .summary-item { text-align: center; }
    .summary-label { font-size: 11px; color: #92400e; text-transform: uppercase; letter-spacing: 1px; }
    .summary-value { font-size: 24px; font-weight: 900; color: #b45309; margin-top: 5px; }
    .content { padding: 30px; }
    .dept-card { background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #fbbf24; border-radius: 16px; padding: 25px; margin-bottom: 20px; }
    .dept-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px dashed #d97706; }
    .dept-title { font-size: 18px; font-weight: 800; color: #92400e; }
    .dept-percent { background: #d97706; color: white; padding: 8px 20px; border-radius: 25px; font-weight: 800; }
    .dept-amount { font-size: 28px; font-weight: 900; color: #059669; margin-bottom: 20px; }
    .breakdown-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
    .breakdown-item { background: white; border-radius: 10px; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
    .item-name { font-weight: 600; color: #374151; font-size: 13px; }
    .item-details { text-align: right; }
    .item-percent { font-size: 11px; color: #6b7280; }
    .item-amount { font-weight: 700; color: #059669; font-size: 14px; }
    .footer { background: #0f172a; padding: 20px; text-align: center; color: #94a3b8; font-size: 11px; }
    @media print { body { background: white; padding: 10px; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìä ‚Çπ40 Lakh Regional Film - Budget Allocation</h1>
      <p>With 10% Creator Margin ‚Ä¢ STAGE OTT Standard</p>
    </div>

    <div class="summary">
      <div class="summary-item">
        <p class="summary-label">Total Budget</p>
        <p class="summary-value">‚Çπ40,00,000</p>
      </div>
      <div class="summary-item">
        <p class="summary-label">Creator Margin (10%)</p>
        <p class="summary-value">‚Çπ4,00,000</p>
      </div>
      <div class="summary-item">
        <p class="summary-label">Working Budget</p>
        <p class="summary-value">‚Çπ36,00,000</p>
      </div>
    </div>

    <div class="content">
      <div class="dept-card">
        <div class="dept-header">
          <span class="dept-title">1Ô∏è‚É£ ABOVE-THE-LINE (ATL)</span>
          <span class="dept-percent">25-30%</span>
        </div>
        <p class="dept-amount">‚Çπ9,00,000 - ‚Çπ10,80,000</p>
        <div class="breakdown-grid">
          <div class="breakdown-item">
            <span class="item-name">Director Fee</span>
            <div class="item-details">
              <p class="item-percent">8-10%</p>
              <p class="item-amount">‚Çπ2,88,000 - ‚Çπ3,60,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Script/Story Rights</span>
            <div class="item-details">
              <p class="item-percent">3-5%</p>
              <p class="item-amount">‚Çπ1,08,000 - ‚Çπ1,80,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Lead Cast (2-3 actors)</span>
            <div class="item-details">
              <p class="item-percent">10-12%</p>
              <p class="item-amount">‚Çπ3,60,000 - ‚Çπ4,32,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Music Director</span>
            <div class="item-details">
              <p class="item-percent">3-4%</p>
              <p class="item-amount">‚Çπ1,08,000 - ‚Çπ1,44,000</p>
            </div>
          </div>
        </div>
      </div>

      <div class="dept-card">
        <div class="dept-header">
          <span class="dept-title">2Ô∏è‚É£ PRODUCTION / BELOW-THE-LINE (BTL)</span>
          <span class="dept-percent">40-45%</span>
        </div>
        <p class="dept-amount">‚Çπ14,40,000 - ‚Çπ16,20,000</p>
        <div class="breakdown-grid">
          <div class="breakdown-item">
            <span class="item-name">Crew Salaries (DOP, AD, Sound, Art)</span>
            <div class="item-details">
              <p class="item-percent">12-15%</p>
              <p class="item-amount">‚Çπ4,32,000 - ‚Çπ5,40,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Camera & Equipment Rental</span>
            <div class="item-details">
              <p class="item-percent">8-10%</p>
              <p class="item-amount">‚Çπ2,88,000 - ‚Çπ3,60,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Location & Set</span>
            <div class="item-details">
              <p class="item-percent">6-8%</p>
              <p class="item-amount">‚Çπ2,16,000 - ‚Çπ2,88,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Art, Props & Costumes</span>
            <div class="item-details">
              <p class="item-percent">5-6%</p>
              <p class="item-amount">‚Çπ1,80,000 - ‚Çπ2,16,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Transportation & Catering</span>
            <div class="item-details">
              <p class="item-percent">4-5%</p>
              <p class="item-amount">‚Çπ1,44,000 - ‚Çπ1,80,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Makeup & Hair</span>
            <div class="item-details">
              <p class="item-percent">2-3%</p>
              <p class="item-amount">‚Çπ72,000 - ‚Çπ1,08,000</p>
            </div>
          </div>
        </div>
      </div>

      <div class="dept-card">
        <div class="dept-header">
          <span class="dept-title">3Ô∏è‚É£ POST-PRODUCTION</span>
          <span class="dept-percent">18-22%</span>
        </div>
        <p class="dept-amount">‚Çπ6,48,000 - ‚Çπ7,92,000</p>
        <div class="breakdown-grid">
          <div class="breakdown-item">
            <span class="item-name">Editing</span>
            <div class="item-details">
              <p class="item-percent">4-5%</p>
              <p class="item-amount">‚Çπ1,44,000 - ‚Çπ1,80,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Color Grading / DI</span>
            <div class="item-details">
              <p class="item-percent">3-4%</p>
              <p class="item-amount">‚Çπ1,08,000 - ‚Çπ1,44,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Sound Design & Mix</span>
            <div class="item-details">
              <p class="item-percent">4-5%</p>
              <p class="item-amount">‚Çπ1,44,000 - ‚Çπ1,80,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Background Music / Score</span>
            <div class="item-details">
              <p class="item-percent">3-4%</p>
              <p class="item-amount">‚Çπ1,08,000 - ‚Çπ1,44,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">VFX (if needed)</span>
            <div class="item-details">
              <p class="item-percent">2-3%</p>
              <p class="item-amount">‚Çπ72,000 - ‚Çπ1,08,000</p>
            </div>
          </div>
        </div>
      </div>

      <div class="dept-card">
        <div class="dept-header">
          <span class="dept-title">4Ô∏è‚É£ CONTINGENCY & MISCELLANEOUS</span>
          <span class="dept-percent">8-10%</span>
        </div>
        <p class="dept-amount">‚Çπ2,88,000 - ‚Çπ3,60,000</p>
        <div class="breakdown-grid">
          <div class="breakdown-item">
            <span class="item-name">Contingency Fund</span>
            <div class="item-details">
              <p class="item-percent">5-7%</p>
              <p class="item-amount">‚Çπ1,80,000 - ‚Çπ2,52,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Insurance & Permits</span>
            <div class="item-details">
              <p class="item-percent">1-2%</p>
              <p class="item-amount">‚Çπ36,000 - ‚Çπ72,000</p>
            </div>
          </div>
          <div class="breakdown-item">
            <span class="item-name">Marketing Assets (Posters/Promos)</span>
            <div class="item-details">
              <p class="item-percent">1-2%</p>
              <p class="item-amount">‚Çπ36,000 - ‚Çπ72,000</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      üé¨ STAGE OTT Platform ‚Ä¢ Regional Content Production ‚Ä¢ Budget Allocation Guide
    </div>
  </div>
</body>
</html>`,
                                          platforms: `
<!DOCTYPE html>
<html>
<head>
  <title>OTT Platform Producer Margins - STAGE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f8fafc; padding: 40px; }
    .container { max-width: 950px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); padding: 30px; text-align: center; }
    .header h1 { color: white; font-size: 26px; font-weight: 900; }
    .header p { color: rgba(255,255,255,0.9); margin-top: 8px; }
    .content { padding: 30px; }
    .platform-card { display: flex; align-items: center; justify-content: space-between; background: #f8fafc; border: 2px solid #e2e8f0; border-radius: 16px; padding: 20px 25px; margin-bottom: 15px; transition: all 0.3s; }
    .platform-card:hover { border-color: #3b82f6; transform: translateX(5px); }
    .platform-card.stage { background: linear-gradient(135deg, #ecfdf5, #d1fae5); border-color: #10b981; }
    .platform-info { display: flex; align-items: center; gap: 15px; }
    .platform-icon { width: 50px; height: 50px; background: linear-gradient(135deg, #3b82f6, #1d4ed8); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
    .platform-card.stage .platform-icon { background: linear-gradient(135deg, #10b981, #059669); }
    .platform-name { font-size: 18px; font-weight: 800; color: #1f2937; }
    .platform-type { font-size: 12px; color: #6b7280; margin-top: 2px; }
    .margin-section { display: flex; align-items: center; gap: 30px; }
    .margin-percent { text-align: center; }
    .margin-label { font-size: 10px; color: #6b7280; text-transform: uppercase; }
    .margin-value { font-size: 24px; font-weight: 900; color: #059669; }
    .amount-section { text-align: right; min-width: 180px; }
    .amount-label { font-size: 10px; color: #6b7280; text-transform: uppercase; }
    .amount-value { font-size: 18px; font-weight: 800; color: #1f2937; }
    .notes { font-size: 11px; color: #6b7280; margin-top: 5px; font-style: italic; }
    .summary-box { background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #f59e0b; border-radius: 16px; padding: 25px; margin-top: 20px; }
    .summary-title { font-weight: 800; color: #92400e; margin-bottom: 15px; font-size: 16px; }
    .summary-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
    .summary-item { text-align: center; }
    .summary-label { font-size: 11px; color: #92400e; }
    .summary-value { font-size: 20px; font-weight: 900; color: #b45309; }
    .footer { background: #0f172a; padding: 20px; text-align: center; color: #94a3b8; font-size: 11px; }
    @media print { body { background: white; padding: 10px; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üì∫ OTT Platform Producer Margins (2024-25)</h1>
      <p>Based on ‚Çπ40 Lakh Regional Film Budget ‚Ä¢ Cost-Plus Model</p>
    </div>

    <div class="content">
      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">Netflix India</p>
            <p class="platform-type">Global Premium OTT</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">10-15%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ4,00,000 - ‚Çπ6,00,000</p>
            <p class="notes">Premium content, strict QC</p>
          </div>
        </div>
      </div>

      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">Amazon Prime Video</p>
            <p class="platform-type">Global Premium OTT</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">12-18%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ4,80,000 - ‚Çπ7,20,000</p>
            <p class="notes">Best margins, long-term deals</p>
          </div>
        </div>
      </div>

      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">Disney+ Hotstar</p>
            <p class="platform-type">Global + Regional OTT</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">10-15%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ4,00,000 - ‚Çπ6,00,000</p>
            <p class="notes">Regional focus increasing</p>
          </div>
        </div>
      </div>

      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">Zee5</p>
            <p class="platform-type">Indian Multi-language OTT</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">10-12%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ4,00,000 - ‚Çπ4,80,000</p>
            <p class="notes">Strong regional library</p>
          </div>
        </div>
      </div>

      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">Hoichoi</p>
            <p class="platform-type">Bengali Regional OTT</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">8-12%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ3,20,000 - ‚Çπ4,80,000</p>
            <p class="notes">Regional leader, volume deals</p>
          </div>
        </div>
      </div>

      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">Aha (Telugu)</p>
            <p class="platform-type">Telugu Regional OTT</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">8-10%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ3,20,000 - ‚Çπ4,00,000</p>
            <p class="notes">Telugu exclusive content</p>
          </div>
        </div>
      </div>

      <div class="platform-card">
        <div class="platform-info">
          <div class="platform-icon">üì∫</div>
          <div>
            <p class="platform-name">MX Player</p>
            <p class="platform-type">AVOD Platform</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value">5-8%</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value">‚Çπ2,00,000 - ‚Çπ3,20,000</p>
            <p class="notes">Lower budgets, AVOD model</p>
          </div>
        </div>
      </div>

      <div class="platform-card stage">
        <div class="platform-info">
          <div class="platform-icon">üé¨</div>
          <div>
            <p class="platform-name">STAGE OTT</p>
            <p class="platform-type">Regional Content Platform</p>
          </div>
        </div>
        <div class="margin-section">
          <div class="margin-percent">
            <p class="margin-label">Margin</p>
            <p class="margin-value" style="color:#059669;">10% Fixed</p>
          </div>
          <div class="amount-section">
            <p class="amount-label">On ‚Çπ40L Budget</p>
            <p class="amount-value" style="color:#059669;">‚Çπ4,00,000</p>
            <p class="notes" style="color:#059669;">Creator-friendly, transparent</p>
          </div>
        </div>
      </div>

      <div class="summary-box">
        <p class="summary-title">üìä Quick Summary</p>
        <div class="summary-grid">
          <div class="summary-item">
            <p class="summary-label">Highest Margin</p>
            <p class="summary-value">Amazon 12-18%</p>
          </div>
          <div class="summary-item">
            <p class="summary-label">Industry Average</p>
            <p class="summary-value">10-12%</p>
          </div>
          <div class="summary-item">
            <p class="summary-label">Regional Average</p>
            <p class="summary-value">8-12%</p>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      üé¨ STAGE OTT Platform ‚Ä¢ OTT Platform Producer Margins Guide ‚Ä¢ Research: 2024-25
    </div>
  </div>
</body>
</html>`,
                                          costplus: `
<!DOCTYPE html>
<html>
<head>
  <title>Cost-Plus Model Explained - STAGE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f8fafc; padding: 40px; }
    .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%); padding: 30px; text-align: center; }
    .header h1 { color: white; font-size: 26px; font-weight: 900; }
    .content { padding: 30px; }
    .formula-box { background: linear-gradient(135deg, #ede9fe, #ddd6fe); border: 3px solid #8b5cf6; border-radius: 16px; padding: 30px; text-align: center; margin-bottom: 25px; }
    .formula { font-size: 22px; font-weight: 900; color: #5b21b6; margin-bottom: 15px; }
    .formula-example { background: white; border-radius: 12px; padding: 20px; }
    .example-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px dashed #c4b5fd; }
    .example-row:last-child { border: none; font-weight: 800; color: #059669; font-size: 18px; }
    .section { margin-bottom: 25px; }
    .section-title { background: #8b5cf6; color: white; padding: 12px 20px; border-radius: 10px; font-weight: 800; margin-bottom: 15px; }
    .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .info-card { background: #faf5ff; border: 1px solid #e9d5ff; border-radius: 12px; padding: 20px; }
    .info-title { font-weight: 700; color: #7c3aed; margin-bottom: 8px; }
    .info-text { font-size: 13px; color: #4c1d95; line-height: 1.6; }
    .tier-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    .tier-table th { background: #7c3aed; color: white; padding: 12px; font-size: 12px; }
    .tier-table td { padding: 12px; border-bottom: 1px solid #e5e7eb; }
    .tier-table tr:nth-child(even) { background: #faf5ff; }
    .footer { background: #0f172a; padding: 20px; text-align: center; color: #94a3b8; font-size: 11px; }
    @media print { body { background: white; padding: 10px; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üíº Cost-Plus Model Explained</h1>
    </div>

    <div class="content">
      <div class="formula-box">
        <p class="formula">Production Cost + Fixed % Margin = Total Deal Value</p>
        <div class="formula-example">
          <div class="example-row">
            <span>Production Cost</span>
            <span>‚Çπ36,00,000</span>
          </div>
          <div class="example-row">
            <span>Producer Margin (10%)</span>
            <span>+ ‚Çπ4,00,000</span>
          </div>
          <div class="example-row">
            <span>Total Deal Value</span>
            <span>= ‚Çπ40,00,000</span>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üìã How It Works</div>
        <div class="info-grid">
          <div class="info-card">
            <p class="info-title">1. Budget Submission</p>
            <p class="info-text">Creator submits detailed production budget with all department-wise costs to OTT platform.</p>
          </div>
          <div class="info-card">
            <p class="info-title">2. Budget Approval</p>
            <p class="info-text">OTT reviews, negotiates, and approves final production cost after due diligence.</p>
          </div>
          <div class="info-card">
            <p class="info-title">3. Margin Addition</p>
            <p class="info-text">Fixed percentage (8-18%) added on top of approved production cost as producer fee.</p>
          </div>
          <div class="info-card">
            <p class="info-title">4. Rights Transfer</p>
            <p class="info-text">In exchange, OTT acquires ALL exploitation rights for agreed duration (5-7 years or perpetual).</p>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">üìä Margin Tiers by Creator Experience</div>
        <table class="tier-table">
          <thead>
            <tr>
              <th>Creator Tier</th>
              <th>Typical Margin</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>First-time Creator</strong></td>
              <td>5-8%</td>
              <td>Building portfolio, lower negotiating power</td>
            </tr>
            <tr>
              <td><strong>Established Creator</strong></td>
              <td>10-15%</td>
              <td>Proven track record, multiple projects</td>
            </tr>
            <tr>
              <td><strong>Star Creator/Director</strong></td>
              <td>15-25%</td>
              <td>Known name, guaranteed viewership</td>
            </tr>
            <tr>
              <td><strong>Regional vs Hindi</strong></td>
              <td>8-12% vs 10-18%</td>
              <td>Hindi content commands higher margins</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="section">
        <div class="section-title">‚ö†Ô∏è Important Notes</div>
        <div class="info-grid">
          <div class="info-card">
            <p class="info-title">IP Rights</p>
            <p class="info-text">OTT owns ALL intellectual property rights. Creator cannot monetize content elsewhere.</p>
          </div>
          <div class="info-card">
            <p class="info-title">No Backend</p>
            <p class="info-text">Cost-Plus model = No revenue share. Your profit is ONLY the fixed margin.</p>
          </div>
          <div class="info-card">
            <p class="info-title">Budget Scrutiny</p>
            <p class="info-text">OTT will verify all costs. Inflated budgets will be rejected or reduced.</p>
          </div>
          <div class="info-card">
            <p class="info-title">Quality Standards</p>
            <p class="info-text">Must meet OTT quality benchmarks. Rework at creator's cost.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      üé¨ STAGE OTT Platform ‚Ä¢ Cost-Plus Model Guide
    </div>
  </div>
</body>
</html>`,
                                          trends: `
<!DOCTYPE html>
<html>
<head>
  <title>OTT Market Trends 2024-25 - STAGE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f8fafc; padding: 40px; }
    .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #dc2626 0%, #ef4444 100%); padding: 30px; text-align: center; }
    .header h1 { color: white; font-size: 26px; font-weight: 900; }
    .content { padding: 30px; }
    .trend-card { background: #fef2f2; border-left: 4px solid #dc2626; border-radius: 0 12px 12px 0; padding: 20px; margin-bottom: 15px; }
    .trend-icon { font-size: 24px; margin-bottom: 10px; }
    .trend-title { font-weight: 800; color: #991b1b; font-size: 16px; margin-bottom: 8px; }
    .trend-desc { font-size: 14px; color: #7f1d1d; line-height: 1.6; }
    .comparison-box { background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #f59e0b; border-radius: 12px; padding: 25px; margin: 25px 0; }
    .comparison-title { font-weight: 800; color: #92400e; margin-bottom: 15px; }
    .comparison-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px dashed #f59e0b; }
    .comparison-row:last-child { border: none; }
    .year { font-weight: 700; color: #92400e; }
    .margin-range { font-size: 20px; font-weight: 900; color: #b45309; }
    .footer { background: #0f172a; padding: 20px; text-align: center; color: #94a3b8; font-size: 11px; }
    @media print { body { background: white; padding: 10px; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìà OTT Market Trends 2024-25</h1>
    </div>

    <div class="content">
      <div class="comparison-box">
        <p class="comparison-title">üìâ Producer Margin Decline Over Years</p>
        <div class="comparison-row">
          <span class="year">2019-20</span>
          <span class="margin-range">18-25%</span>
        </div>
        <div class="comparison-row">
          <span class="year">2021-22</span>
          <span class="margin-range">15-20%</span>
        </div>
        <div class="comparison-row">
          <span class="year">2023-24</span>
          <span class="margin-range">10-15%</span>
        </div>
        <div class="comparison-row">
          <span class="year">2024-25</span>
          <span class="margin-range">8-12%</span>
        </div>
      </div>

      <div class="trend-card">
        <div class="trend-icon">üìâ</div>
        <p class="trend-title">Declining Producer Margins</p>
        <p class="trend-desc">Margins have dropped from 15-20% (2020) to 8-12% (2024). OTT platforms are becoming more cost-conscious and have stronger negotiating positions due to content surplus.</p>
      </div>

      <div class="trend-card">
        <div class="trend-icon">üìÖ</div>
        <p class="trend-title">Shorter Exclusivity Periods</p>
        <p class="trend-desc">Platforms preferring 1-2 year exclusive windows instead of perpetual rights. This benefits creators who can monetize content later, but initial payments are lower.</p>
      </div>

      <div class="trend-card">
        <div class="trend-icon">üó£Ô∏è</div>
        <p class="trend-title">Regional Content Boom (But Tighter Margins)</p>
        <p class="trend-desc">More investment in regional languages (Bengali, Telugu, Tamil, Marathi, etc.) but with stricter budget controls. Volume is up, per-project margins are down.</p>
      </div>

      <div class="trend-card">
        <div class="trend-icon">üö´</div>
        <p class="trend-title">Backend Deals Are Rare</p>
        <p class="trend-desc">Revenue share/backend deals are almost non-existent for new creators. Only star directors with proven hits can negotiate any backend participation.</p>
      </div>

      <div class="trend-card">
        <div class="trend-icon">üéØ</div>
        <p class="trend-title">Focus on Proven IP</p>
        <p class="trend-desc">Platforms favoring sequels, adaptations, and remakes over original experimental content. Reduces risk but limits opportunities for fresh creators.</p>
      </div>

      <div class="trend-card">
        <div class="trend-icon">üì±</div>
        <p class="trend-title">Microdrama/Short Format Rise</p>
        <p class="trend-desc">Short-form content (5-15 min episodes) gaining traction. Lower budgets, faster production, but also lower creator fees per project.</p>
      </div>
    </div>

    <div class="footer">
      üé¨ STAGE OTT Platform ‚Ä¢ Market Trends Research 2024-25
    </div>
  </div>
</body>
</html>`,
                                          tips: `
<!DOCTYPE html>
<html>
<head>
  <title>Creator Tips for Better Margins - STAGE</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Inter', Arial, sans-serif; background: #f8fafc; padding: 40px; }
    .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); overflow: hidden; }
    .header { background: linear-gradient(135deg, #059669 0%, #10b981 100%); padding: 30px; text-align: center; }
    .header h1 { color: white; font-size: 26px; font-weight: 900; }
    .content { padding: 30px; }
    .tip-card { background: #ecfdf5; border-left: 4px solid #10b981; border-radius: 0 12px 12px 0; padding: 20px; margin-bottom: 15px; display: flex; gap: 15px; align-items: flex-start; }
    .tip-number { width: 40px; height: 40px; background: linear-gradient(135deg, #10b981, #059669); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 18px; flex-shrink: 0; }
    .tip-content { flex: 1; }
    .tip-title { font-weight: 800; color: #065f46; font-size: 16px; margin-bottom: 8px; }
    .tip-desc { font-size: 14px; color: #047857; line-height: 1.6; }
    .pro-tip { background: linear-gradient(135deg, #fef3c7, #fde68a); border: 2px solid #f59e0b; border-radius: 12px; padding: 20px; margin: 25px 0; }
    .pro-tip-title { font-weight: 800; color: #92400e; margin-bottom: 10px; }
    .pro-tip-text { font-size: 14px; color: #78350f; line-height: 1.6; }
    .footer { background: #0f172a; padding: 20px; text-align: center; color: #94a3b8; font-size: 11px; }
    @media print { body { background: white; padding: 10px; } .container { box-shadow: none; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üí° Tips for Maximizing Your Margin</h1>
    </div>

    <div class="content">
      <div class="tip-card">
        <div class="tip-number">1</div>
        <div class="tip-content">
          <p class="tip-title">Build Track Record First</p>
          <p class="tip-desc">Accept lower margins (8-10%) on initial projects to build your portfolio. Once you have 2-3 successful releases, you can negotiate better rates (12-15%).</p>
        </div>
      </div>

      <div class="tip-card">
        <div class="tip-number">2</div>
        <div class="tip-content">
          <p class="tip-title">Negotiate Multi-Project Deals</p>
          <p class="tip-desc">Commit to 2-3 projects with the same platform for better per-project margins. Platforms value reliable creators and offer better terms for volume commitments.</p>
        </div>
      </div>

      <div class="tip-card">
        <div class="tip-number">3</div>
        <div class="tip-content">
          <p class="tip-title">Own Music Rights Separately</p>
          <p class="tip-desc">If possible, negotiate to retain music rights separately. Music streaming revenue can provide ongoing income beyond the one-time production fee.</p>
        </div>
      </div>

      <div class="tip-card">
        <div class="tip-number">4</div>
        <div class="tip-content">
          <p class="tip-title">Keep Production Costs Lean</p>
          <p class="tip-desc">Your actual take-home is Margin minus any cost overruns. Efficient production = higher actual profit. Budget for contingencies but don't overspend.</p>
        </div>
      </div>

      <div class="tip-card">
        <div class="tip-number">5</div>
        <div class="tip-content">
          <p class="tip-title">Consider Co-Production</p>
          <p class="tip-desc">Partner with established production houses for larger projects. Shared risk, combined resources, and better negotiating power with platforms.</p>
        </div>
      </div>

      <div class="tip-card">
        <div class="tip-number">6</div>
        <div class="tip-content">
          <p class="tip-title">Pitch to Multiple Platforms</p>
          <p class="tip-desc">Don't approach just one platform. Having competing offers gives you leverage. Even if you prefer one platform, alternatives strengthen your negotiation.</p>
        </div>
      </div>

      <div class="tip-card">
        <div class="tip-number">7</div>
        <div class="tip-content">
          <p class="tip-title">Focus on Niche Regional Content</p>
          <p class="tip-desc">Hyper-local stories that resonate with specific audiences are in demand. Less competition means better negotiating position for unique regional content.</p>
        </div>
      </div>

      <div class="pro-tip">
        <p class="pro-tip-title">üíé PRO TIP</p>
        <p class="pro-tip-text">Always get everything in writing. Verbal commitments mean nothing. Ensure your agreement clearly states: total fee, payment schedule, rights duration, territory, and any backend participation. Consult an entertainment lawyer before signing.</p>
      </div>
    </div>

    <div class="footer">
      üé¨ STAGE OTT Platform ‚Ä¢ Creator Success Tips
    </div>
  </div>
</body>
</html>`
                                        };
                                        const html = sectionContent[section.id];
                                        const printWindow = window.open('', '_blank');
                                        if (printWindow) {
                                          printWindow.document.write(html);
                                          printWindow.document.close();
                                          printWindow.print();
                                        }
                                      }}
                                      className={`flex flex-col items-center gap-2 p-4 bg-gradient-to-br ${section.color} rounded-xl text-white hover:scale-105 transition-all shadow-lg`}
                                    >
                                      <span className="text-3xl">{section.icon}</span>
                                      <span className="text-xs font-bold text-center leading-tight">{section.label}</span>
                                    </button>
                                  ))}
                                </div>
                                <p className="text-xs text-gray-500 mt-4 text-center">
                                  Click any section to view detailed breakdown & download PDF
                                </p>
                              </div>

                              {/* Quick Summary Cards */}
                              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                                <div className="bg-gradient-to-br from-amber-50 to-orange-100 border-2 border-amber-400 rounded-xl p-4">
                                  <p className="text-xs text-amber-700 font-semibold">TOTAL BUDGET</p>
                                  <p className="text-2xl font-black text-amber-900">‚Çπ40,00,000</p>
                                  <p className="text-xs text-amber-600 mt-1">Regional Film Standard</p>
                                </div>
                                <div className="bg-gradient-to-br from-green-50 to-emerald-100 border-2 border-green-400 rounded-xl p-4">
                                  <p className="text-xs text-green-700 font-semibold">CREATOR MARGIN</p>
                                  <p className="text-2xl font-black text-green-800">‚Çπ4,00,000</p>
                                  <p className="text-xs text-green-600 mt-1">10% of Total Budget</p>
                                </div>
                                <div className="bg-gradient-to-br from-blue-50 to-indigo-100 border-2 border-blue-400 rounded-xl p-4">
                                  <p className="text-xs text-blue-700 font-semibold">WORKING BUDGET</p>
                                  <p className="text-2xl font-black text-blue-800">‚Çπ36,00,000</p>
                                  <p className="text-xs text-blue-600 mt-1">For Production Use</p>
                                </div>
                                <div className="bg-gradient-to-br from-purple-50 to-violet-100 border-2 border-purple-400 rounded-xl p-4">
                                  <p className="text-xs text-purple-700 font-semibold">INDUSTRY AVG MARGIN</p>
                                  <p className="text-2xl font-black text-purple-800">8-12%</p>
                                  <p className="text-xs text-purple-600 mt-1">Regional OTT 2024-25</p>
                                </div>
                              </div>

                              {/* Department-wise Allocation Visual */}
                              <div className="bg-white border-2 border-gray-200 rounded-xl p-6 mb-6">
                                <h4 className="font-bold text-gray-800 mb-4 flex items-center gap-2">
                                  üìä Department-wise Budget Allocation (‚Çπ36L Working Budget)
                                </h4>
                                <div className="space-y-4">
                                  {[
                                    { name: 'Above-the-Line (Director, Cast, Script, Music)', percent: '25-30%', amount: '‚Çπ9-10.8L', color: 'bg-amber-500', width: '27.5%' },
                                    { name: 'Production/BTL (Crew, Equipment, Location, Art)', percent: '40-45%', amount: '‚Çπ14.4-16.2L', color: 'bg-blue-500', width: '42.5%' },
                                    { name: 'Post-Production (Edit, DI, Sound, BGM, VFX)', percent: '18-22%', amount: '‚Çπ6.48-7.92L', color: 'bg-purple-500', width: '20%' },
                                    { name: 'Contingency & Misc (Buffer, Insurance, Permits)', percent: '8-10%', amount: '‚Çπ2.88-3.6L', color: 'bg-gray-500', width: '9%' },
                                  ].map(dept => (
                                    <div key={dept.name} className="group">
                                      <div className="flex justify-between items-center mb-2">
                                        <span className="text-sm font-medium text-gray-700">{dept.name}</span>
                                        <div className="flex items-center gap-3">
                                          <span className="text-sm font-bold text-gray-800">{dept.percent}</span>
                                          <span className="text-sm font-bold text-green-600">{dept.amount}</span>
                                        </div>
                                      </div>
                                      <div className="h-8 bg-gray-100 rounded-full overflow-hidden">
                                        <div
                                          className={`h-full ${dept.color} rounded-full transition-all duration-500 group-hover:brightness-110 flex items-center justify-end pr-3`}
                                          style={{ width: dept.width }}
                                        >
                                          <span className="text-white text-xs font-bold">{dept.percent}</span>
                                        </div>
                                      </div>
                                    </div>
                                  ))}
                                </div>
                              </div>

                              {/* OTT Platform Margins Table */}
                              <div className="bg-white border-2 border-gray-200 rounded-xl overflow-hidden mb-6">
                                <div className="bg-gradient-to-r from-blue-600 to-indigo-700 p-4">
                                  <h4 className="font-bold text-white flex items-center gap-2">
                                    üì∫ OTT Platform Producer Margins (2024-25)
                                  </h4>
                                </div>
                                <div className="overflow-x-auto">
                                  <table className="w-full">
                                    <thead className="bg-gray-50">
                                      <tr>
                                        <th className="px-4 py-3 text-left text-xs font-bold text-gray-600 uppercase">Platform</th>
                                        <th className="px-4 py-3 text-center text-xs font-bold text-gray-600 uppercase">Margin %</th>
                                        <th className="px-4 py-3 text-right text-xs font-bold text-gray-600 uppercase">On ‚Çπ40L Budget</th>
                                        <th className="px-4 py-3 text-left text-xs font-bold text-gray-600 uppercase">Notes</th>
                                      </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-100">
                                      {[
                                        { name: 'Netflix India', margin: '10-15%', amount: '‚Çπ4-6L', notes: 'Premium content, strict QC', icon: 'üî¥' },
                                        { name: 'Amazon Prime Video', margin: '12-18%', amount: '‚Çπ4.8-7.2L', notes: 'Best margins, long-term deals', icon: 'üîµ' },
                                        { name: 'Disney+ Hotstar', margin: '10-15%', amount: '‚Çπ4-6L', notes: 'Regional focus increasing', icon: 'üü¢' },
                                        { name: 'Zee5', margin: '10-12%', amount: '‚Çπ4-4.8L', notes: 'Strong regional library', icon: 'üü£' },
                                        { name: 'Sony LIV', margin: '10-12%', amount: '‚Çπ4-4.8L', notes: 'Growing regional slate', icon: '‚ö´' },
                                        { name: 'Hoichoi (Bengali)', margin: '8-12%', amount: '‚Çπ3.2-4.8L', notes: 'Regional leader, volume deals', icon: 'üü°' },
                                        { name: 'Aha (Telugu)', margin: '8-10%', amount: '‚Çπ3.2-4L', notes: 'Telugu exclusive content', icon: 'üü†' },
                                        { name: 'MX Player', margin: '5-8%', amount: '‚Çπ2-3.2L', notes: 'Lower budgets, AVOD model', icon: '‚ö™' },
                                      ].map((platform, idx) => (
                                        <tr key={platform.name} className={idx % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                          <td className="px-4 py-3 font-medium text-gray-800">
                                            <span className="mr-2">{platform.icon}</span>{platform.name}
                                          </td>
                                          <td className="px-4 py-3 text-center font-bold text-green-600">{platform.margin}</td>
                                          <td className="px-4 py-3 text-right font-semibold text-gray-800">{platform.amount}</td>
                                          <td className="px-4 py-3 text-sm text-gray-500">{platform.notes}</td>
                                        </tr>
                                      ))}
                                      <tr className="bg-green-50 border-t-2 border-green-500">
                                        <td className="px-4 py-3 font-bold text-green-800">
                                          <span className="mr-2">üé¨</span>STAGE OTT
                                        </td>
                                        <td className="px-4 py-3 text-center font-black text-green-700">10% Fixed</td>
                                        <td className="px-4 py-3 text-right font-bold text-green-700">‚Çπ4,00,000</td>
                                        <td className="px-4 py-3 text-sm font-medium text-green-600">Creator-friendly, transparent</td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>

                              <h4 className="font-bold text-gray-800 mb-4 mt-6">Budget Template Guidelines</h4>
                            </div>
                          )}

                          {/* DPR Section */}
                          {(selectedCat as any).hasDPRTemplate && (
                            <div className="mb-8">
                              {/* OTT Standard Banner */}
                              <div className="bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-xl p-5 mb-6">
                                <div className="flex items-start gap-4">
                                  <div className="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                    <span className="text-2xl">‚úÖ</span>
                                  </div>
                                  <div className="flex-1">
                                    <h3 className="font-bold text-blue-900 text-lg mb-2">Standard OTT DPR Format</h3>
                                    <p className="text-blue-700 text-sm mb-3">Industry-standard format used by Netflix, Amazon Prime, Disney+ Hotstar</p>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                                      <div className="bg-green-100 text-green-700 px-3 py-1.5 rounded-full font-medium">‚úì Production Details</div>
                                      <div className="bg-green-100 text-green-700 px-3 py-1.5 rounded-full font-medium">‚úì Timing Log</div>
                                      <div className="bg-green-100 text-green-700 px-3 py-1.5 rounded-full font-medium">‚úì Scenes & Pages</div>
                                      <div className="bg-green-100 text-green-700 px-3 py-1.5 rounded-full font-medium">‚úì Camera Setups</div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              {/* DPR Form */}
                              <div className="bg-gray-50 rounded-xl p-6 mb-6">
                                <div className="flex items-center justify-between mb-6">
                                  <h3 className="text-xl font-bold text-gray-800">Create Daily Production Report</h3>
                                  <button
                                    onClick={() => setCurrentDPR({
                                      title: '', date: '', dayNumber: '', producer: '', director: '',
                                      firstShootDate: '', scheduledFinish: '', revisedFinish: '', location: '',
                                      crewCall: '', rollTime: '', firstShot: '', mealBreakStart: '', mealBreakEnd: '',
                                      firstShotAfter: '', packup: '', lastPersonOut: '', lastPersonDept: '',
                                      scriptScenes: '', scriptPages: '', prevScenes: '', prevPages: '',
                                      todayScenes: '', todayPages: '', totalScenes: '', totalPages: '',
                                      remainingScenes: '', remainingPages: '',
                                      prevSetups: '', todaySetups: '', totalSetups: '', remainingSetups: '',
                                      comments: '', nextDate: '', nextLocation: '', nextCallTime: '', nextScenes: '',
                                      preparedBy: '', approvedBy: ''
                                    })}
                                    className="px-4 py-2 bg-amber-100 hover:bg-amber-200 text-amber-800 font-medium rounded-lg text-sm"
                                  >
                                    ‚ûï New DPR
                                  </button>
                                </div>

                                {/* Production Details */}
                                <div className="mb-5">
                                  <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2"><span className="w-6 h-6 bg-amber-500 text-white rounded text-xs flex items-center justify-center">1</span> Production Details</h4>
                                  <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Title</label><input type="text" value={currentDPR.title} onChange={(e) => setCurrentDPR({...currentDPR, title: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Project Title" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Date</label><input type="date" value={currentDPR.date} onChange={(e) => setCurrentDPR({...currentDPR, date: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Day #</label><input type="number" value={currentDPR.dayNumber} onChange={(e) => setCurrentDPR({...currentDPR, dayNumber: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="1" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Location</label><input type="text" value={currentDPR.location} onChange={(e) => setCurrentDPR({...currentDPR, location: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Shoot Location" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Producer</label><input type="text" value={currentDPR.producer} onChange={(e) => setCurrentDPR({...currentDPR, producer: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Producer Name" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Director</label><input type="text" value={currentDPR.director} onChange={(e) => setCurrentDPR({...currentDPR, director: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Director Name" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">First Shoot Date</label><input type="date" value={currentDPR.firstShootDate} onChange={(e) => setCurrentDPR({...currentDPR, firstShootDate: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Scheduled Finish</label><input type="date" value={currentDPR.scheduledFinish} onChange={(e) => setCurrentDPR({...currentDPR, scheduledFinish: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                  </div>
                                </div>

                                {/* Timing */}
                                <div className="mb-5">
                                  <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2"><span className="w-6 h-6 bg-amber-500 text-white rounded text-xs flex items-center justify-center">2</span> Timing Log</h4>
                                  <div className="grid grid-cols-3 md:grid-cols-6 gap-3">
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Crew Call</label><input type="time" value={currentDPR.crewCall} onChange={(e) => setCurrentDPR({...currentDPR, crewCall: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">First Shot</label><input type="time" value={currentDPR.firstShot} onChange={(e) => setCurrentDPR({...currentDPR, firstShot: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Meal Start</label><input type="time" value={currentDPR.mealBreakStart} onChange={(e) => setCurrentDPR({...currentDPR, mealBreakStart: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Meal End</label><input type="time" value={currentDPR.mealBreakEnd} onChange={(e) => setCurrentDPR({...currentDPR, mealBreakEnd: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Packup</label><input type="time" value={currentDPR.packup} onChange={(e) => setCurrentDPR({...currentDPR, packup: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Last Out</label><input type="time" value={currentDPR.lastPersonOut} onChange={(e) => setCurrentDPR({...currentDPR, lastPersonOut: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                  </div>
                                </div>

                                {/* Scenes & Setups */}
                                <div className="mb-5 grid grid-cols-1 md:grid-cols-2 gap-4">
                                  <div>
                                    <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2"><span className="w-6 h-6 bg-amber-500 text-white rounded text-xs flex items-center justify-center">3</span> Scenes & Pages</h4>
                                    <div className="bg-white rounded-lg p-3 border">
                                      <div className="grid grid-cols-3 gap-2 text-xs font-medium text-gray-500 mb-2"><div></div><div className="text-center">Scenes</div><div className="text-center">Pages</div></div>
                                      {[{l:'Script Total',s:'scriptScenes',p:'scriptPages'},{l:'Shot Today',s:'todayScenes',p:'todayPages'},{l:'Total',s:'totalScenes',p:'totalPages'},{l:'Remaining',s:'remainingScenes',p:'remainingPages'}].map(r=>(
                                        <div key={r.l} className="grid grid-cols-3 gap-2 mb-1"><div className="text-xs text-gray-600 py-1">{r.l}</div><input type="number" value={(currentDPR as any)[r.s]} onChange={(e)=>setCurrentDPR({...currentDPR,[r.s]:e.target.value})} className="px-2 py-1 border border-gray-200 rounded text-sm text-center" /><input type="number" value={(currentDPR as any)[r.p]} onChange={(e)=>setCurrentDPR({...currentDPR,[r.p]:e.target.value})} className="px-2 py-1 border border-gray-200 rounded text-sm text-center" /></div>
                                      ))}
                                    </div>
                                  </div>
                                  <div>
                                    <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2"><span className="w-6 h-6 bg-amber-500 text-white rounded text-xs flex items-center justify-center">4</span> Camera Setups</h4>
                                    <div className="bg-white rounded-lg p-3 border">
                                      {[{l:'Previous',k:'prevSetups'},{l:'Today',k:'todaySetups'},{l:'Total',k:'totalSetups'},{l:'Remaining',k:'remainingSetups'}].map(r=>(
                                        <div key={r.l} className="grid grid-cols-2 gap-2 mb-1"><div className="text-xs text-gray-600 py-1">{r.l}</div><input type="number" value={(currentDPR as any)[r.k]} onChange={(e)=>setCurrentDPR({...currentDPR,[r.k]:e.target.value})} className="px-2 py-1 border border-gray-200 rounded text-sm text-center" /></div>
                                      ))}
                                    </div>
                                  </div>
                                </div>

                                {/* Comments */}
                                <div className="mb-5">
                                  <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2"><span className="w-6 h-6 bg-amber-500 text-white rounded text-xs flex items-center justify-center">5</span> Comments / Delays / Solutions</h4>
                                  <textarea value={currentDPR.comments} onChange={(e) => setCurrentDPR({...currentDPR, comments: e.target.value})} rows={3} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Enter comments, delays, solutions..." />
                                </div>

                                {/* Next Shoot */}
                                <div className="mb-5">
                                  <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2"><span className="w-6 h-6 bg-amber-500 text-white rounded text-xs flex items-center justify-center">6</span> Next Shoot Details</h4>
                                  <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Date</label><input type="date" value={currentDPR.nextDate} onChange={(e) => setCurrentDPR({...currentDPR, nextDate: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Location</label><input type="text" value={currentDPR.nextLocation} onChange={(e) => setCurrentDPR({...currentDPR, nextLocation: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Next Location" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Call Time</label><input type="time" value={currentDPR.nextCallTime} onChange={(e) => setCurrentDPR({...currentDPR, nextCallTime: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" /></div>
                                    <div><label className="block text-xs font-medium text-gray-500 mb-1">Scenes</label><input type="text" value={currentDPR.nextScenes} onChange={(e) => setCurrentDPR({...currentDPR, nextScenes: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Scene numbers" /></div>
                                  </div>
                                </div>

                                {/* Prepared By */}
                                <div className="grid grid-cols-2 gap-4">
                                  <div><label className="block text-xs font-medium text-gray-500 mb-1">Prepared By</label><input type="text" value={currentDPR.preparedBy} onChange={(e) => setCurrentDPR({...currentDPR, preparedBy: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Name & Designation" /></div>
                                  <div><label className="block text-xs font-medium text-gray-500 mb-1">Approved By</label><input type="text" value={currentDPR.approvedBy} onChange={(e) => setCurrentDPR({...currentDPR, approvedBy: e.target.value})} className="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm" placeholder="Production Manager" /></div>
                                </div>
                              </div>

                              {/* Share & Export - Google Sheets Style */}
                              <div className="bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl p-5 mb-6">
                                <h3 className="text-white font-bold mb-4 flex items-center gap-2">üì§ Share & Export (Google Sheets Style)</h3>
                                <div className="grid grid-cols-2 md:grid-cols-6 gap-3">
                                  <button
                                    onClick={() => {
                                      const dpr = currentDPR;
                                      const newDPR = { id: 'dpr-' + Date.now(), title: dpr.title || 'Untitled DPR', data: {...dpr}, createdAt: new Date().toISOString(), sharedWith: [] };
                                      const updated = [...savedDPRs, newDPR];
                                      setSavedDPRs(updated);
                                      localStorage.setItem('saved_dprs', JSON.stringify(updated));
                                      alert('DPR saved!');
                                    }}
                                    className="flex flex-col items-center gap-2 p-3 bg-green-600 hover:bg-green-700 rounded-xl transition-all"
                                  >
                                    <span className="text-xl">üíæ</span>
                                    <span className="text-white text-xs font-medium">Save</span>
                                  </button>
                                  <button
                                    onClick={() => {
                                      const dpr = currentDPR;
                                      // Create Google Sheets compatible CSV
                                      const csvContent = `DAILY PRODUCTION REPORT\n\nTitle,${dpr.title}\nDate,${dpr.date}\nDay #,${dpr.dayNumber}\nProducer,${dpr.producer}\nDirector,${dpr.director}\nLocation,${dpr.location}\n\nTIMING LOG\nCrew Call,${dpr.crewCall}\nFirst Shot,${dpr.firstShot}\nMeal Break,${dpr.mealBreakStart} - ${dpr.mealBreakEnd}\nPackup,${dpr.packup}\nLast Out,${dpr.lastPersonOut}\n\nSCENES & PAGES\n,Scenes,Pages\nScript Total,${dpr.scriptScenes},${dpr.scriptPages}\nShot Today,${dpr.todayScenes},${dpr.todayPages}\nTotal,${dpr.totalScenes},${dpr.totalPages}\nRemaining,${dpr.remainingScenes},${dpr.remainingPages}\n\nCAMERA SETUPS\nPrevious,${dpr.prevSetups}\nToday,${dpr.todaySetups}\nTotal,${dpr.totalSetups}\nRemaining,${dpr.remainingSetups}\n\nCOMMENTS\n"${dpr.comments}"\n\nNEXT SHOOT\nDate,${dpr.nextDate}\nLocation,${dpr.nextLocation}\nCall Time,${dpr.nextCallTime}\n\nPrepared By,${dpr.preparedBy}\nApproved By,${dpr.approvedBy}`;
                                      const blob = new Blob([csvContent], { type: 'text/csv' });
                                      const url = URL.createObjectURL(blob);
                                      const a = document.createElement('a');
                                      a.href = url;
                                      a.download = `DPR_${dpr.title || 'Report'}_Day${dpr.dayNumber || '1'}.csv`;
                                      a.click();
                                      alert('CSV downloaded! Open in Google Sheets:\n1. Go to sheets.google.com\n2. File > Import > Upload\n3. Select this CSV file');
                                    }}
                                    className="flex flex-col items-center gap-2 p-3 bg-emerald-600 hover:bg-emerald-700 rounded-xl transition-all"
                                  >
                                    <span className="text-xl">üìä</span>
                                    <span className="text-white text-xs font-medium">Google Sheets</span>
                                  </button>
                                  <button
                                    onClick={() => {
                                      const dpr = currentDPR;
                                      const html = `<!DOCTYPE html><html><head><title>DPR - ${dpr.title}</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial;padding:30px;max-width:800px;margin:0 auto}h1{text-align:center;font-size:20px;margin-bottom:15px;border-bottom:3px solid #d97706;padding-bottom:8px}.section{margin-bottom:15px;background:#f9fafb;padding:12px;border-radius:6px;border-left:4px solid #d97706}.section-title{font-weight:bold;font-size:12px;color:#d97706;margin-bottom:8px}.row{display:flex;gap:10px;margin-bottom:5px;flex-wrap:wrap}.field{flex:1;min-width:120px}.label{font-size:10px;color:#666}.value{font-size:11px;font-weight:500;border-bottom:1px solid #ddd;padding:3px 0}table{width:100%;border-collapse:collapse;margin:8px 0}th,td{border:1px solid #ddd;padding:5px;text-align:center;font-size:10px}th{background:#f3f4f6}.comments{background:#fff;border:1px solid #ddd;padding:10px;border-radius:6px;min-height:40px;font-size:11px}.signature{display:flex;justify-content:space-between;margin-top:20px}.sig-box{width:45%;text-align:center}.sig-line{border-bottom:1px solid #333;height:30px;margin-bottom:3px}@media print{body{padding:15px}}</style></head><body><h1>üìä DAILY PRODUCTION REPORT</h1><div class="section"><div class="section-title">PRODUCTION DETAILS</div><div class="row"><div class="field"><div class="label">Title</div><div class="value">${dpr.title||'-'}</div></div><div class="field"><div class="label">Date</div><div class="value">${dpr.date||'-'}</div></div><div class="field"><div class="label">Day #</div><div class="value">${dpr.dayNumber||'-'}</div></div><div class="field"><div class="label">Location</div><div class="value">${dpr.location||'-'}</div></div></div><div class="row"><div class="field"><div class="label">Producer</div><div class="value">${dpr.producer||'-'}</div></div><div class="field"><div class="label">Director</div><div class="value">${dpr.director||'-'}</div></div></div></div><div class="section"><div class="section-title">TIMING LOG</div><div class="row"><div class="field"><div class="label">Crew Call</div><div class="value">${dpr.crewCall||'-'}</div></div><div class="field"><div class="label">First Shot</div><div class="value">${dpr.firstShot||'-'}</div></div><div class="field"><div class="label">Meal</div><div class="value">${dpr.mealBreakStart||'-'} - ${dpr.mealBreakEnd||'-'}</div></div><div class="field"><div class="label">Packup</div><div class="value">${dpr.packup||'-'}</div></div></div></div><div class="section"><div class="section-title">SCENES & CAMERA SETUPS</div><table><tr><th></th><th>Scenes</th><th>Pages</th><th>Setups</th></tr><tr><td>Script Total</td><td>${dpr.scriptScenes||'-'}</td><td>${dpr.scriptPages||'-'}</td><td>-</td></tr><tr><td>Shot Today</td><td>${dpr.todayScenes||'-'}</td><td>${dpr.todayPages||'-'}</td><td>${dpr.todaySetups||'-'}</td></tr><tr><td>Total</td><td>${dpr.totalScenes||'-'}</td><td>${dpr.totalPages||'-'}</td><td>${dpr.totalSetups||'-'}</td></tr><tr><td>Remaining</td><td>${dpr.remainingScenes||'-'}</td><td>${dpr.remainingPages||'-'}</td><td>${dpr.remainingSetups||'-'}</td></tr></table></div><div class="section"><div class="section-title">COMMENTS/DELAYS</div><div class="comments">${dpr.comments||'No comments'}</div></div><div class="section"><div class="section-title">NEXT SHOOT</div><div class="row"><div class="field"><div class="label">Date</div><div class="value">${dpr.nextDate||'-'}</div></div><div class="field"><div class="label">Location</div><div class="value">${dpr.nextLocation||'-'}</div></div><div class="field"><div class="label">Call</div><div class="value">${dpr.nextCallTime||'-'}</div></div></div></div><div class="signature"><div class="sig-box"><div class="sig-line"></div><div style="font-size:10px">Prepared: ${dpr.preparedBy||'_____'}</div></div><div class="sig-box"><div class="sig-line"></div><div style="font-size:10px">Approved: ${dpr.approvedBy||'_____'}</div></div></div><p style="text-align:center;margin-top:20px;color:#999;font-size:9px">üé¨ STAGE Production Portal</p></body></html>`;
                                      const blob = new Blob([html], { type: 'text/html' });
                                      const url = URL.createObjectURL(blob);
                                      const a = document.createElement('a');
                                      a.href = url;
                                      a.download = `DPR_${dpr.title || 'Report'}_Day${dpr.dayNumber || '1'}.html`;
                                      a.click();
                                      alert('PDF-ready file downloaded! Open and print as PDF.');
                                    }}
                                    className="flex flex-col items-center gap-2 p-3 bg-blue-600 hover:bg-blue-700 rounded-xl transition-all"
                                  >
                                    <span className="text-xl">üì•</span>
                                    <span className="text-white text-xs font-medium">Download PDF</span>
                                  </button>
                                  <button
                                    onClick={() => {
                                      const dpr = currentDPR;
                                      const html = `<!DOCTYPE html><html><head><title>DPR - ${dpr.title}</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial;padding:30px;max-width:800px;margin:0 auto}h1{text-align:center;font-size:20px;margin-bottom:15px;border-bottom:3px solid #d97706;padding-bottom:8px}.section{margin-bottom:15px;background:#f9fafb;padding:12px;border-radius:6px;border-left:4px solid #d97706}.section-title{font-weight:bold;font-size:12px;color:#d97706;margin-bottom:8px}.row{display:flex;gap:10px;margin-bottom:5px;flex-wrap:wrap}.field{flex:1;min-width:120px}.label{font-size:10px;color:#666}.value{font-size:11px;font-weight:500;border-bottom:1px solid #ddd;padding:3px 0}table{width:100%;border-collapse:collapse;margin:8px 0}th,td{border:1px solid #ddd;padding:5px;text-align:center;font-size:10px}th{background:#f3f4f6}.comments{background:#fff;border:1px solid #ddd;padding:10px;border-radius:6px;min-height:40px;font-size:11px}.signature{display:flex;justify-content:space-between;margin-top:20px}.sig-box{width:45%;text-align:center}.sig-line{border-bottom:1px solid #333;height:30px;margin-bottom:3px}</style></head><body><h1>üìä DAILY PRODUCTION REPORT</h1><div class="section"><div class="section-title">PRODUCTION DETAILS</div><div class="row"><div class="field"><div class="label">Title</div><div class="value">${dpr.title||'-'}</div></div><div class="field"><div class="label">Date</div><div class="value">${dpr.date||'-'}</div></div><div class="field"><div class="label">Day #</div><div class="value">${dpr.dayNumber||'-'}</div></div></div><div class="row"><div class="field"><div class="label">Producer</div><div class="value">${dpr.producer||'-'}</div></div><div class="field"><div class="label">Director</div><div class="value">${dpr.director||'-'}</div></div><div class="field"><div class="label">Location</div><div class="value">${dpr.location||'-'}</div></div></div></div><div class="section"><div class="section-title">TIMING</div><div class="row"><div class="field"><div class="label">Crew Call</div><div class="value">${dpr.crewCall||'-'}</div></div><div class="field"><div class="label">First Shot</div><div class="value">${dpr.firstShot||'-'}</div></div><div class="field"><div class="label">Meal</div><div class="value">${dpr.mealBreakStart||'-'} - ${dpr.mealBreakEnd||'-'}</div></div><div class="field"><div class="label">Packup</div><div class="value">${dpr.packup||'-'}</div></div></div></div><div class="section"><div class="section-title">PROGRESS</div><table><tr><th></th><th>Scenes</th><th>Pages</th><th>Setups</th></tr><tr><td>Today</td><td>${dpr.todayScenes||'-'}</td><td>${dpr.todayPages||'-'}</td><td>${dpr.todaySetups||'-'}</td></tr><tr><td>Total</td><td>${dpr.totalScenes||'-'}</td><td>${dpr.totalPages||'-'}</td><td>${dpr.totalSetups||'-'}</td></tr></table></div><div class="section"><div class="section-title">COMMENTS</div><div class="comments">${dpr.comments||'-'}</div></div><div class="section"><div class="section-title">NEXT: ${dpr.nextDate||'-'} at ${dpr.nextLocation||'-'}</div></div><div class="signature"><div class="sig-box"><div class="sig-line"></div><div style="font-size:10px">${dpr.preparedBy||'Prepared By'}</div></div><div class="sig-box"><div class="sig-line"></div><div style="font-size:10px">${dpr.approvedBy||'Approved By'}</div></div></div></body></html>`;
                                      const w = window.open('', '_blank');
                                      if (w) { w.document.write(html); w.document.close(); w.print(); }
                                    }}
                                    className="flex flex-col items-center gap-2 p-3 bg-indigo-600 hover:bg-indigo-700 rounded-xl transition-all"
                                  >
                                    <span className="text-xl">üñ®Ô∏è</span>
                                    <span className="text-white text-xs font-medium">Print</span>
                                  </button>
                                  <button
                                    onClick={() => {
                                      const dpr = currentDPR;
                                      const message = `*üìä DAILY PRODUCTION REPORT*\n\n*Title:* ${dpr.title}\n*Date:* ${dpr.date} | *Day:* ${dpr.dayNumber}\n*Location:* ${dpr.location}\n*Producer:* ${dpr.producer}\n*Director:* ${dpr.director}\n\n*‚è∞ TIMING*\nCrew Call: ${dpr.crewCall}\nFirst Shot: ${dpr.firstShot}\nMeal: ${dpr.mealBreakStart}-${dpr.mealBreakEnd}\nPackup: ${dpr.packup}\n\n*üé¨ PROGRESS*\nScenes Today: ${dpr.todayScenes} (${dpr.todayPages} pages)\nSetups Today: ${dpr.todaySetups}\nTotal: ${dpr.totalScenes} scenes\n\n*üìù COMMENTS*\n${dpr.comments||'None'}\n\n*‚û°Ô∏è NEXT SHOOT*\n${dpr.nextDate} | ${dpr.nextLocation}\n\n_Prepared: ${dpr.preparedBy}_\n\nüé¨ _STAGE Production Portal_`;
                                      window.open("https://wa.me/?text=" + encodeURIComponent(message), '_blank');
                                    }}
                                    className="flex flex-col items-center gap-2 p-3 bg-green-500 hover:bg-green-600 rounded-xl transition-all"
                                  >
                                    <span className="text-xl">üí¨</span>
                                    <span className="text-white text-xs font-medium">WhatsApp</span>
                                  </button>
                                  <button
                                    onClick={() => {
                                      const dpr = currentDPR;
                                      const subject = encodeURIComponent(`DPR - ${dpr.title} - Day ${dpr.dayNumber} - ${dpr.date}`);
                                      const body = encodeURIComponent(`DAILY PRODUCTION REPORT\n\nTitle: ${dpr.title}\nDate: ${dpr.date} | Day: ${dpr.dayNumber}\nLocation: ${dpr.location}\nProducer: ${dpr.producer}\nDirector: ${dpr.director}\n\nTIMING:\nCrew Call: ${dpr.crewCall}\nFirst Shot: ${dpr.firstShot}\nMeal: ${dpr.mealBreakStart} - ${dpr.mealBreakEnd}\nPackup: ${dpr.packup}\n\nPROGRESS:\nScenes Today: ${dpr.todayScenes} (${dpr.todayPages} pages)\nSetups Today: ${dpr.todaySetups}\n\nComments: ${dpr.comments}\n\nNext Shoot: ${dpr.nextDate} at ${dpr.nextLocation}\n\nPrepared by: ${dpr.preparedBy}\n\n---\nSTAGE Production Portal`);
                                      window.open(`mailto:?subject=${subject}&body=${body}`, '_blank');
                                    }}
                                    className="flex flex-col items-center gap-2 p-3 bg-purple-600 hover:bg-purple-700 rounded-xl transition-all"
                                  >
                                    <span className="text-xl">üìß</span>
                                    <span className="text-white text-xs font-medium">Email</span>
                                  </button>
                                </div>
                              </div>

                              {/* Saved DPRs */}
                              {savedDPRs.length > 0 && (
                                <div>
                                  <h3 className="text-lg font-bold text-gray-800 mb-4">üìÅ Saved DPRs ({savedDPRs.length})</h3>
                                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {savedDPRs.map(dpr => (
                                      <div key={dpr.id} className="bg-gradient-to-br from-amber-50 to-orange-50 border-2 border-amber-200 rounded-xl p-4">
                                        <div className="flex items-center justify-between mb-2">
                                          <h4 className="font-bold text-gray-900 text-sm">{dpr.title}</h4>
                                          <span className="text-xs text-gray-500">{new Date(dpr.createdAt).toLocaleDateString()}</span>
                                        </div>
                                        <p className="text-xs text-gray-600 mb-3">Day {dpr.data.dayNumber} ‚Ä¢ {dpr.data.date} ‚Ä¢ {dpr.data.location}</p>
                                        <div className="flex gap-2">
                                          <button onClick={() => setCurrentDPR(dpr.data)} className="flex-1 py-1.5 bg-amber-100 hover:bg-amber-200 text-amber-800 text-xs font-medium rounded-lg">üìÇ Load</button>
                                          <button onClick={() => {
                                            const msg = `*üìä DPR - ${dpr.title}*\nDay ${dpr.data.dayNumber} | ${dpr.data.date}\n${dpr.data.location}\n\nScenes: ${dpr.data.todayScenes} | Setups: ${dpr.data.todaySetups}\n\n_STAGE Portal_`;
                                            window.open("https://wa.me/?text=" + encodeURIComponent(msg), '_blank');
                                          }} className="py-1.5 px-2 bg-green-100 hover:bg-green-200 text-green-700 text-xs font-medium rounded-lg">üí¨</button>
                                          <button onClick={() => {
                                            const updated = savedDPRs.filter(d => d.id !== dpr.id);
                                            setSavedDPRs(updated);
                                            localStorage.setItem('saved_dprs', JSON.stringify(updated));
                                          }} className="py-1.5 px-2 bg-red-100 hover:bg-red-200 text-red-700 text-xs font-medium rounded-lg">üóëÔ∏è</button>
                                        </div>
                                      </div>
                                    ))}
                                  </div>
                                </div>
                              )}
                            </div>
                          )}

                          {/* Custom Documents Section for Others */}
                          {(selectedCat as any).hasCustomDocs && (
                            <div className="mb-8">
                              {/* Add Document Button */}
                              <div className="flex items-center justify-between mb-6">
                                <h3 className="text-lg font-bold text-gray-800">My Saved Documents</h3>
                                <button
                                  onClick={() => setShowAddDocModal(true)}
                                  className="px-5 py-2.5 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2"
                                >
                                  <span className="text-xl">‚ûï</span>
                                  <span>Add New Document</span>
                                </button>
                              </div>

                              {/* Add Document Modal */}
                              {showAddDocModal && (
                                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
                                  <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden">
                                    <div className="bg-gradient-to-r from-slate-800 to-slate-900 p-5 flex items-center justify-between">
                                      <div className="flex items-center gap-3">
                                        <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                                          <span className="text-2xl">üìù</span>
                                        </div>
                                        <div>
                                          <h3 className="text-xl font-bold text-white">Add New Document</h3>
                                          <p className="text-slate-300 text-sm">Create and save your document</p>
                                        </div>
                                      </div>
                                      <button
                                        onClick={() => {
                                          setShowAddDocModal(false);
                                          setNewDocName('');
                                          setNewDocContent('');
                                        }}
                                        className="w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center text-white text-xl"
                                      >
                                        √ó
                                      </button>
                                    </div>
                                    <div className="p-6">
                                      <div className="mb-4">
                                        <label className="block text-sm font-bold text-gray-700 mb-2">Document Name *</label>
                                        <input
                                          type="text"
                                          value={newDocName}
                                          onChange={(e) => setNewDocName(e.target.value)}
                                          placeholder="Enter document name..."
                                          className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"
                                        />
                                      </div>
                                      <div className="mb-6">
                                        <label className="block text-sm font-bold text-gray-700 mb-2">Document Content *</label>
                                        <textarea
                                          value={newDocContent}
                                          onChange={(e) => setNewDocContent(e.target.value)}
                                          placeholder="Write your document content here..."
                                          rows={12}
                                          className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all resize-none"
                                        />
                                      </div>
                                      <div className="flex gap-3">
                                        <button
                                          onClick={() => {
                                            if (newDocName.trim() && newDocContent.trim()) {
                                              const newDoc = {
                                                id: 'custom-' + Date.now(),
                                                name: newDocName.trim(),
                                                content: newDocContent.trim(),
                                                createdAt: new Date().toISOString()
                                              };
                                              const updatedDocs = [...customDocuments, newDoc];
                                              setCustomDocuments(updatedDocs);
                                              localStorage.setItem('custom_documents', JSON.stringify(updatedDocs));
                                              setShowAddDocModal(false);
                                              setNewDocName('');
                                              setNewDocContent('');
                                              alert('Document saved successfully!');
                                            } else {
                                              alert('Please fill in both name and content');
                                            }
                                          }}
                                          className="flex-1 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold rounded-xl transition-all flex items-center justify-center gap-2"
                                        >
                                          <span>üíæ</span> Save Document
                                        </button>
                                        <button
                                          onClick={() => {
                                            setShowAddDocModal(false);
                                            setNewDocName('');
                                            setNewDocContent('');
                                          }}
                                          className="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold rounded-xl transition-all"
                                        >
                                          Cancel
                                        </button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              )}

                              {/* Saved Documents List */}
                              {customDocuments.length > 0 ? (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                  {customDocuments.map((doc) => (
                                    <div key={doc.id} className="bg-gradient-to-br from-slate-50 to-gray-100 border-2 border-gray-200 rounded-xl p-5 hover:shadow-lg transition-all">
                                      <div className="flex items-start justify-between mb-3">
                                        <div className="flex items-center gap-3">
                                          <div className="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center">
                                            <span className="text-2xl">üìÑ</span>
                                          </div>
                                          <div>
                                            <h4 className="font-bold text-gray-900">{doc.name}</h4>
                                            <p className="text-xs text-gray-500">{new Date(doc.createdAt).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' })}</p>
                                          </div>
                                        </div>
                                      </div>
                                      <p className="text-sm text-gray-600 mb-4 line-clamp-3">{doc.content.substring(0, 150)}...</p>
                                      <div className="flex gap-2">
                                        <button
                                          onClick={() => {
                                            const html = "<!DOCTYPE html><html><head><title>" + doc.name + "</title><style>body{font-family:Arial;padding:40px;max-width:800px;margin:0 auto;white-space:pre-wrap}h1{color:#1e40af;border-bottom:2px solid #1e40af;padding-bottom:10px}@media print{body{padding:20px}}</style></head><body><h1>" + doc.name + "</h1><p>" + doc.content + "</p><p style='margin-top:40px;color:#9ca3af;font-size:12px'>STAGE Production Portal</p></body></html>";
                                            const printWindow = window.open('', '_blank');
                                            if (printWindow) {
                                              printWindow.document.write(html);
                                              printWindow.document.close();
                                            }
                                          }}
                                          className="flex-1 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 font-medium rounded-lg text-sm flex items-center justify-center gap-1"
                                        >
                                          üëÅÔ∏è View
                                        </button>
                                        <button
                                          onClick={() => {
                                            navigator.clipboard.writeText(doc.name + "\n\n" + doc.content);
                                            alert('Document copied! Share via WhatsApp or Email.');
                                          }}
                                          className="flex-1 py-2 bg-green-100 hover:bg-green-200 text-green-700 font-medium rounded-lg text-sm flex items-center justify-center gap-1"
                                        >
                                          üì§ Share
                                        </button>
                                        <button
                                          onClick={() => {
                                            const message = "*" + doc.name + "*\n\n" + doc.content + "\n\n_Sent via STAGE Portal_";
                                            const whatsappUrl = "https://wa.me/?text=" + encodeURIComponent(message);
                                            window.open(whatsappUrl, '_blank');
                                          }}
                                          className="py-2 px-3 bg-emerald-100 hover:bg-emerald-200 text-emerald-700 font-medium rounded-lg text-sm"
                                        >
                                          üí¨
                                        </button>
                                        <button
                                          onClick={() => {
                                            if (confirm('Delete this document?')) {
                                              const updatedDocs = customDocuments.filter(d => d.id !== doc.id);
                                              setCustomDocuments(updatedDocs);
                                              localStorage.setItem('custom_documents', JSON.stringify(updatedDocs));
                                            }
                                          }}
                                          className="py-2 px-3 bg-red-100 hover:bg-red-200 text-red-700 font-medium rounded-lg text-sm"
                                        >
                                          üóëÔ∏è
                                        </button>
                                      </div>
                                    </div>
                                  ))}
                                </div>
                              ) : (
                                <div className="bg-gray-50 border-2 border-dashed border-gray-300 rounded-2xl p-12 text-center">
                                  <div className="w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <span className="text-4xl">üìÅ</span>
                                  </div>
                                  <h3 className="text-xl font-bold text-gray-700 mb-2">No Documents Yet</h3>
                                  <p className="text-gray-500 mb-6">Add your first document to get started. Save production notes, checklists, reports and more.</p>
                                  <button
                                    onClick={() => setShowAddDocModal(true)}
                                    className="px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all inline-flex items-center gap-2"
                                  >
                                    <span className="text-xl">‚ûï</span>
                                    <span>Add Your First Document</span>
                                  </button>
                                </div>
                              )}
                            </div>
                          )}

                          {/* SOP Full Sections View - Clickable Cards */}
                          {(selectedCat as any).isSopFull && (selectedCat as any).sopSections ? (
                            <div className="space-y-3">
                              {(selectedCat as any).sopSections.map((section: any) => (
                                <div
                                  key={section.id}
                                  className={`bg-gradient-to-br ${section.gradient} rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 border-2`}
                                >
                                  {/* Section Header - Clickable */}
                                  <div
                                    onClick={() => setExpandedSopSections(prev => ({ ...prev, [section.id]: !prev[section.id] }))}
                                    className="px-5 py-4 flex items-center justify-between cursor-pointer hover:bg-white/30 transition-all"
                                  >
                                    <div className="flex items-center gap-4">
                                      <div className="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg flex-shrink-0">
                                        <span className="text-2xl">{section.emoji}</span>
                                      </div>
                                      <div>
                                        <h3 className="text-lg font-bold text-gray-900">{section.title}</h3>
                                        <p className="text-sm text-gray-600">{section.items.length} items</p>
                                      </div>
                                    </div>
                                    <div className="flex items-center gap-2">
                                      {/* Share & Download for individual section */}
                                      <button
                                        onClick={(e) => {
                                          e.stopPropagation();
                                          const content = `${section.title}\n\n${section.items.map((i: string) => `‚Ä¢ ${i}`).join('\n')}`;
                                          navigator.clipboard.writeText(content);
                                          alert('Section copied!');
                                        }}
                                        className="p-2 bg-white/50 hover:bg-white/70 rounded-lg text-gray-700 text-sm"
                                        title="Share this section"
                                      >
                                        üì§
                                      </button>
                                      <button
                                        onClick={(e) => {
                                          e.stopPropagation();
                                          const html = `<!DOCTYPE html><html><head><title>${section.title}</title><style>body{font-family:Arial;padding:40px;max-width:800px;margin:0 auto}h1{color:#1e40af;border-bottom:2px solid #1e40af;padding-bottom:10px}ul{color:#4b5563;line-height:1.8}li{margin:10px 0}@media print{body{padding:20px}}</style></head><body><h1>${section.emoji} ${section.title}</h1><ul>${section.items.map((i: string) => `<li>${i}</li>`).join('')}</ul><p style="margin-top:40px;color:#9ca3af;font-size:12px">STAGE Production Portal</p></body></html>`;
                                          const printWindow = window.open('', '_blank');
                                          if (printWindow) {
                                            printWindow.document.write(html);
                                            printWindow.document.close();
                                            printWindow.print();
                                          }
                                        }}
                                        className="p-2 bg-white/50 hover:bg-white/70 rounded-lg text-gray-700 text-sm"
                                        title="Download PDF"
                                      >
                                        üì•
                                      </button>
                                      <svg
                                        className={`w-6 h-6 text-gray-700 transition-transform duration-300 ${expandedSopSections[section.id] ? 'rotate-90' : ''}`}
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                        strokeWidth={2}
                                      >
                                        <path strokeLinecap="round" strokeLinejoin="round" d="M9 5l7 7-7 7" />
                                      </svg>
                                    </div>
                                  </div>

                                  {/* Section Content - Expandable */}
                                  {expandedSopSections[section.id] && (
                                    <div className="px-5 py-4 bg-white/50 backdrop-blur-sm border-t-2 border-gray-200">
                                      <ul className="space-y-3">
                                        {section.items.map((item: string, index: number) => (
                                          <li key={index} className="flex items-start gap-3">
                                            <span className="text-purple-600 font-bold text-lg mt-0.5 flex-shrink-0">‚Ä¢</span>
                                            <span className="text-gray-800 font-medium text-sm leading-relaxed">{item}</span>
                                          </li>
                                        ))}
                                      </ul>
                                    </div>
                                  )}
                                </div>
                              ))}
                            </div>
                          ) : (
                            /* Regular category view */
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                              {selectedCat.content.sections.map((section, idx) => (
                                <div key={idx} className="bg-gray-50 rounded-lg p-4">
                                  <h3 className="font-bold text-gray-800 mb-3 pb-2 border-b border-gray-200">{section.heading}</h3>
                                  <ul className="space-y-2">
                                    {section.items.map((item, i) => (
                                      <li key={i} className="text-sm text-gray-600 flex items-start gap-2">
                                        <span className="text-blue-500 mt-1">‚Ä¢</span>
                                        {item}
                                      </li>
                                    ))}
                                  </ul>
                                </div>
                              ))}
                            </div>
                          )}

                          {/* Uploaded files for this category */}
                          {productionDocs.filter(d => d.category === selectedCat.name).length > 0 && (
                            <div className="mt-6 pt-6 border-t border-gray-200">
                              <h3 className="font-bold text-gray-700 mb-3">Uploaded Files</h3>
                              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                {productionDocs.filter(d => d.category === selectedCat.name).map(doc => (
                                  <div key={doc.id} className="bg-gray-50 rounded-lg p-3 flex items-center justify-between">
                                    <div className="flex items-center gap-2">
                                      <span className="text-lg">{doc.name.endsWith('.pdf') ? 'üìï' : 'üìÑ'}</span>
                                      <span className="text-sm text-gray-700 truncate max-w-[150px]">{doc.name}</span>
                                    </div>
                                    <div className="flex gap-1">
                                      <a href={doc.url} target="_blank" className="px-2 py-1 bg-blue-100 text-blue-600 rounded text-xs">View</a>
                                      <button onClick={() => {
                                        const updatedDocs = productionDocs.filter(d => d.id !== doc.id);
                                        setProductionDocs(updatedDocs);
                                        localStorage.setItem('production_docs', JSON.stringify(updatedDocs));
                                      }} className="px-2 py-1 bg-red-100 text-red-600 rounded text-xs">√ó</button>
                                    </div>
                                  </div>
                                ))}
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    )}
                  </>
                );
              })()}

              {/* STAGE Production SOPs & Specifications */}
              <div className="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl p-6 mb-6 text-white">
                <h2 className="text-xl font-bold mb-2">üìã STAGE Production Specifications</h2>
                <p className="text-blue-100 text-sm mb-4">Standard specifications for all STAGE productions</p>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                  {[
                    {
                      title: 'Video Specifications',
                      items: [
                        'Resolution: 4K (3840x2160) preferred, 1080p minimum',
                        'Frame Rate: 24fps for cinematic, 30fps for web',
                        'Codec: H.264/H.265, ProRes for masters',
                        'Aspect Ratio: 16:9 (Landscape), 9:16 (Shorts)',
                        'Bitrate: Min 25 Mbps for 4K',
                      ]
                    },
                    {
                      title: 'Audio Specifications',
                      items: [
                        'Sample Rate: 48kHz',
                        'Bit Depth: 24-bit',
                        'Format: WAV/AIFF for masters',
                        'Dialogue: -12dB to -6dB',
                        'Music: -18dB to -12dB',
                      ]
                    },
                    {
                      title: 'Delivery Requirements',
                      items: [
                        'Master File: ProRes 422 HQ or DNxHR',
                        'Web Version: H.264 MP4',
                        'Thumbnail: 1920x1080 JPG',
                        'Subtitles: SRT format (Hindi + English)',
                        'Poster: 2000x3000 px minimum',
                      ]
                    },
                    {
                      title: 'Content Guidelines',
                      items: [
                        'Regional language with Hindi subtitles',
                        'No explicit content without approval',
                        'Brand guidelines compliance',
                        'Copyright clearance for music',
                        'Talent releases required',
                      ]
                    },
                    {
                      title: 'Budget Categories',
                      items: [
                        'Pre-Production: 10-15%',
                        'Production: 50-60%',
                        'Post-Production: 20-25%',
                        'Marketing: 5-10%',
                        'Contingency: 5-10%',
                      ]
                    },
                    {
                      title: 'Timeline Standards',
                      items: [
                        'Mini Film: 4-6 weeks total',
                        'Feature Film: 12-16 weeks total',
                        'Series (per episode): 2-3 weeks',
                        'Post-Production: 30% of total time',
                        'Final delivery: 1 week before launch',
                      ]
                    },
                  ].map((spec, idx) => (
                    <div key={idx} className="bg-white/10 backdrop-blur rounded-lg p-4">
                      <h3 className="font-bold text-white mb-2">{spec.title}</h3>
                      <ul className="space-y-1">
                        {spec.items.map((item, i) => (
                          <li key={i} className="text-blue-100 text-xs flex items-start gap-2">
                            <span className="text-blue-300">‚Ä¢</span>
                            {item}
                          </li>
                        ))}
                      </ul>
                    </div>
                  ))}
                </div>
              </div>

              {/* All Documents List */}
              <div className="bg-white rounded-xl border border-gray-200 overflow-hidden">
                <div className="bg-gray-50 px-4 py-3 border-b border-gray-200">
                  <h2 className="font-bold text-gray-700">Uploaded Documents ({productionDocs.length})</h2>
                </div>
                {productionDocs.length === 0 ? (
                  <div className="p-8 text-center text-gray-400">
                    <div className="text-4xl mb-2">üìÅ</div>
                    <p>No documents uploaded yet</p>
                    <p className="text-sm">Click on any category above to upload your files</p>
                  </div>
                ) : (
                  <div className="divide-y divide-gray-100">
                    {productionDocs.map(doc => (
                      <div key={doc.id} className="px-4 py-3 flex items-center justify-between hover:bg-gray-50">
                        <div className="flex items-center gap-3">
                          <div className="w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center text-lg">
                            {doc.name.endsWith('.pdf') ? 'üìï' : doc.name.endsWith('.xlsx') || doc.name.endsWith('.xls') ? 'üìó' : doc.name.endsWith('.docx') || doc.name.endsWith('.doc') ? 'üìò' : 'üìÑ'}
                          </div>
                          <div>
                            <h4 className="font-medium text-gray-800">{doc.name}</h4>
                            <p className="text-xs text-gray-400">{doc.category} ‚Ä¢ {new Date(doc.uploadedAt).toLocaleDateString()}</p>
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          <a
                            href={doc.url}
                            target="_blank"
                            rel="noopener noreferrer"
                            className="px-3 py-1.5 bg-blue-50 text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-100"
                          >
                            View
                          </a>
                          <button
                            onClick={() => {
                              navigator.clipboard.writeText(doc.url);
                              alert('Link copied! Share with your team.');
                            }}
                            className="px-3 py-1.5 bg-green-50 text-green-600 rounded-lg text-sm font-medium hover:bg-green-100"
                          >
                            Share
                          </button>
                          <button
                            onClick={() => {
                              if (confirm('Delete this document?')) {
                                const updatedDocs = productionDocs.filter(d => d.id !== doc.id);
                                setProductionDocs(updatedDocs);
                                localStorage.setItem('production_docs', JSON.stringify(updatedDocs));
                              }
                            }}
                            className="px-3 py-1.5 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100"
                          >
                            Delete
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>

              {/* Quick Templates Section */}
              <div className="mt-6 bg-slate-900 rounded-2xl border border-slate-700 p-6">
                <h2 className="text-xl font-bold text-white mb-4">Quick Templates</h2>
                <p className="text-slate-400 text-sm mb-4">Pre-made templates for common production needs</p>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-3">
                  {[
                    { name: 'Shooting Schedule', icon: 'üìÖ' },
                    { name: 'Equipment List', icon: 'üé•' },
                    { name: 'Location Permit', icon: 'üìç' },
                    { name: 'Talent Agreement', icon: 'ü§ù' },
                    { name: 'Payment Voucher', icon: 'üí≥' },
                    { name: 'Production Report', icon: 'üìä' },
                    { name: 'Insurance Form', icon: 'üõ°Ô∏è' },
                    { name: 'Wrap Report', icon: '‚úÖ' },
                  ].map(template => (
                    <button
                      key={template.name}
                      className="bg-slate-800 hover:bg-slate-700 rounded-xl p-4 text-left transition-all"
                      onClick={() => alert('Template: ' + template.name + '\n\nThis would open/download the template in production.')}
                    >
                      <div className="text-2xl mb-2">{template.icon}</div>
                      <div className="text-white text-sm font-medium">{template.name}</div>
                    </button>
                  ))}
                </div>
              </div>
            </div>
          )}

          {/* Invites Tab */}
          {activeTab === 'invites' && (
            <div className="space-y-6">
              <InviteTracker />
            </div>
          )}
        </div>

        {/* Add Project Modal */}
        {showAddProjectModal && (
          <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
            <div className="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
              <div className="bg-gradient-to-r from-red-600 to-pink-600 text-white p-5 rounded-t-2xl">
                <div className="flex items-center justify-between">
                  <div>
                    <h3 className="text-2xl font-black">‚ûï Add New Project</h3>
                    <p className="text-sm opacity-80">Create a new project manually</p>
                  </div>
                  <button onClick={() => setShowAddProjectModal(false)} className="w-10 h-10 bg-white/20 hover:bg-white/30 rounded-xl flex items-center justify-center text-xl">√ó</button>
                </div>
              </div>
              <div className="p-6 space-y-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Project Name *</label>
                    <input type="text" value={newProject.projectName} onChange={(e) => setNewProject({...newProject, projectName: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="Project Title" />
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Creator Name *</label>
                    <input type="text" value={newProject.creator} onChange={(e) => setNewProject({...newProject, creator: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="Creator/Director Name" />
                  </div>
                </div>
                <div className="grid grid-cols-3 gap-4">
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Culture/Language</label>
                    <select value={newProject.culture} onChange={(e) => setNewProject({...newProject, culture: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none">
                      <option value="">Select</option>
                      <option value="Haryanvi">Haryanvi</option>
                      <option value="Bhojpuri">Bhojpuri</option>
                      <option value="Rajasthani">Rajasthani</option>
                      <option value="Punjabi">Punjabi</option>
                      <option value="Marathi">Marathi</option>
                      <option value="Tamil">Tamil</option>
                      <option value="Telugu">Telugu</option>
                      <option value="Hindi">Hindi</option>
                      <option value="Other">Other</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Format</label>
                    <select value={newProject.format} onChange={(e) => setNewProject({...newProject, format: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none">
                      <option value="">Select</option>
                      <option value="Feature Film">Feature Film</option>
                      <option value="Long Series">Long Series</option>
                      <option value="Mini Series">Mini Series</option>
                      <option value="Short Film">Short Film</option>
                      <option value="Web Series">Web Series</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Genre</label>
                    <select value={newProject.genre} onChange={(e) => setNewProject({...newProject, genre: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none">
                      <option value="">Select</option>
                      <option value="Drama">Drama</option>
                      <option value="Comedy">Comedy</option>
                      <option value="Action">Action</option>
                      <option value="Romance">Romance</option>
                      <option value="Thriller">Thriller</option>
                      <option value="Horror">Horror</option>
                      <option value="Mythology">Mythology</option>
                    </select>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Total Budget (‚Çπ)</label>
                    <input type="number" value={newProject.totalBudget} onChange={(e) => setNewProject({...newProject, totalBudget: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="e.g. 5000000" />
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Episodes</label>
                    <input type="number" value={newProject.episodes} onChange={(e) => setNewProject({...newProject, episodes: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="Number of episodes" />
                  </div>
                </div>

                {/* POC Section */}
                <div className="border-t pt-4 mt-4">
                  <h4 className="font-bold text-gray-800 mb-3">Production POC (Point of Contact)</h4>
                  <div className="grid grid-cols-3 gap-3">
                    <div><input type="text" value={newProject.productionPOC} onChange={(e) => setNewProject({...newProject, productionPOC: e.target.value})} className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="Name" /></div>
                    <div><input type="tel" value={newProject.productionPOCPhone} onChange={(e) => setNewProject({...newProject, productionPOCPhone: e.target.value})} className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="Phone" /></div>
                    <div><input type="email" value={newProject.productionPOCEmail} onChange={(e) => setNewProject({...newProject, productionPOCEmail: e.target.value})} className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="Email" /></div>
                  </div>
                </div>
                <div className="border-t pt-4">
                  <h4 className="font-bold text-gray-800 mb-3">Content POC (Point of Contact)</h4>
                  <div className="grid grid-cols-3 gap-3">
                    <div><input type="text" value={newProject.contentPOC} onChange={(e) => setNewProject({...newProject, contentPOC: e.target.value})} className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="Name" /></div>
                    <div><input type="tel" value={newProject.contentPOCPhone} onChange={(e) => setNewProject({...newProject, contentPOCPhone: e.target.value})} className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="Phone" /></div>
                    <div><input type="email" value={newProject.contentPOCEmail} onChange={(e) => setNewProject({...newProject, contentPOCEmail: e.target.value})} className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="Email" /></div>
                  </div>
                </div>

                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-1">Logline</label>
                  <input type="text" value={newProject.logline} onChange={(e) => setNewProject({...newProject, logline: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="One-line description of the project" />
                </div>
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-1">Synopsis</label>
                  <textarea value={newProject.synopsis} onChange={(e) => setNewProject({...newProject, synopsis: e.target.value})} rows={3} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none resize-none" placeholder="Brief synopsis of the project..." />
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Language</label>
                    <input type="text" value={newProject.language} onChange={(e) => setNewProject({...newProject, language: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="e.g. Haryanvi with Hindi subtitles" />
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Production Company</label>
                    <input type="text" value={newProject.productionCompany} onChange={(e) => setNewProject({...newProject, productionCompany: e.target.value})} className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-red-500 focus:outline-none" placeholder="Production house name" />
                  </div>
                </div>

                <div className="flex gap-3 pt-4">
                  <button
                    onClick={() => {
                      if (!newProject.projectName.trim() || !newProject.creator.trim()) {
                        alert('Please fill in Project Name and Creator Name');
                        return;
                      }
                      const project = {
                        id: Date.now(),
                        projectName: newProject.projectName,
                        creator: newProject.creator,
                        culture: newProject.culture || 'Not specified',
                        format: newProject.format || 'Not specified',
                        genre: newProject.genre || 'Not specified',
                        totalBudget: parseInt(newProject.totalBudget) || 0,
                        episodes: parseInt(newProject.episodes) || 1,
                        status: 'pending',
                        submittedDate: new Date().toISOString().split('T')[0],
                        completeness: 50,
                        warnings: 0,
                        productionPOC: newProject.productionPOC,
                        productionPOCPhone: newProject.productionPOCPhone,
                        productionPOCEmail: newProject.productionPOCEmail,
                        contentPOC: newProject.contentPOC,
                        contentPOCPhone: newProject.contentPOCPhone,
                        contentPOCEmail: newProject.contentPOCEmail,
                        logline: newProject.logline,
                        synopsis: newProject.synopsis,
                        language: newProject.language,
                        productionCompany: newProject.productionCompany,
                        activityLog: [
                          { date: new Date().toISOString().split('T')[0], time: new Date().toLocaleTimeString(), action: 'Project Created', description: 'Project added manually by admin', user: 'Admin', type: 'create' }
                        ],
                        isLocalSubmission: true
                      };
                      const updatedSubmissions = [...submissions, project];
                      setSubmissions(updatedSubmissions);
                      // Save to localStorage
                      const existingLocal = JSON.parse(localStorage.getItem('creator_submissions') || '[]');
                      existingLocal.push({
                        id: project.id,
                        creatorName: project.creator,
                        projectTitle: project.projectName,
                        ...newProject
                      });
                      localStorage.setItem('creator_submissions', JSON.stringify(existingLocal));
                      setShowAddProjectModal(false);
                      setNewProject({
                        projectName: '', creator: '', culture: '', format: '', genre: '',
                        totalBudget: '', episodes: '', status: 'pending',
                        productionPOC: '', productionPOCPhone: '', productionPOCEmail: '',
                        contentPOC: '', contentPOCPhone: '', contentPOCEmail: '',
                        logline: '', synopsis: '', language: '', productionCompany: ''
                      });
                      alert('Project added successfully!');
                    }}
                    className="flex-1 py-3 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white font-bold rounded-xl transition-all"
                  >
                    ‚ûï Add Project
                  </button>
                  <button onClick={() => setShowAddProjectModal(false)} className="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold rounded-xl transition-all">
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Add Talent Modal */}
        {showAddTalentModal && (
          <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
            <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto">
              <div className="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-5 rounded-t-2xl">
                <h3 className="text-2xl font-black">‚ûï Add New Talent</h3>
                <p className="text-sm opacity-80">Add crew/cast member to library</p>
              </div>
              <div className="p-6 space-y-4">
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-1">Name *</label>
                  <input
                    type="text"
                    value={newTalent.name}
                    onChange={(e) => setNewTalent({...newTalent, name: e.target.value})}
                    className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                    placeholder="Full Name"
                  />
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Role *</label>
                    <input
                      type="text"
                      value={newTalent.role}
                      onChange={(e) => setNewTalent({...newTalent, role: e.target.value})}
                      className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                      placeholder="Director, DOP, etc."
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Department</label>
                    <select
                      value={newTalent.department}
                      onChange={(e) => setNewTalent({...newTalent, department: e.target.value})}
                      className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                    >
                      <option value="direction">Direction</option>
                      <option value="production">Production</option>
                      <option value="writing">Writing</option>
                      <option value="camera">Camera</option>
                      <option value="editing">Editing</option>
                      <option value="sound">Sound</option>
                      <option value="music">Music</option>
                      <option value="art">Art</option>
                      <option value="costume">Costume & Makeup</option>
                      <option value="vfx">VFX</option>
                      <option value="cast">Cast</option>
                    </select>
                  </div>
                </div>
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Phone</label>
                    <input
                      type="text"
                      value={newTalent.phone}
                      onChange={(e) => setNewTalent({...newTalent, phone: e.target.value})}
                      className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                      placeholder="+91 98765 43210"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-bold text-gray-700 mb-1">Email</label>
                    <input
                      type="email"
                      value={newTalent.email}
                      onChange={(e) => setNewTalent({...newTalent, email: e.target.value})}
                      className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                      placeholder="email@example.com"
                    />
                  </div>
                </div>
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-1">Work Link / Portfolio</label>
                  <input
                    type="url"
                    value={newTalent.workLink}
                    onChange={(e) => setNewTalent({...newTalent, workLink: e.target.value})}
                    className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                    placeholder="https://portfolio.com or YouTube link"
                  />
                </div>
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-1">Culture</label>
                  <select
                    value={newTalent.culture}
                    onChange={(e) => setNewTalent({...newTalent, culture: e.target.value})}
                    className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                  >
                    <option value="Haryanvi">Haryanvi</option>
                    <option value="Rajasthani">Rajasthani</option>
                    <option value="Bhojpuri">Bhojpuri</option>
                    <option value="Gujarati">Gujarati</option>
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-bold text-gray-700 mb-1">Notes</label>
                  <textarea
                    value={newTalent.notes}
                    onChange={(e) => setNewTalent({...newTalent, notes: e.target.value})}
                    className="w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none resize-none"
                    rows={2}
                    placeholder="Any additional notes..."
                  />
                </div>
                <div className="flex gap-3 pt-4">
                  <button
                    onClick={() => setShowAddTalentModal(false)}
                    className="flex-1 py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold rounded-xl transition-all"
                  >
                    Cancel
                  </button>
                  <button
                    onClick={handleAddTalent}
                    className="flex-1 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 text-white font-black rounded-xl transition-all"
                  >
                    Add Talent
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Talent Detail Modal */}
        {selectedTalent && (
          <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
            <div className="bg-white rounded-2xl shadow-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
              <div className="bg-gradient-to-r from-purple-600 to-indigo-600 text-white p-6 rounded-t-2xl">
                <div className="flex items-center gap-4">
                  <div className="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center text-4xl font-black">
                    {selectedTalent.name.charAt(0).toUpperCase()}
                  </div>
                  <div>
                    <h3 className="text-2xl font-black">{selectedTalent.name}</h3>
                    <p className="text-lg opacity-90 font-semibold">{selectedTalent.role}</p>
                    <span className="px-3 py-1 bg-white/20 rounded-full text-sm font-bold mt-1 inline-block">
                      {selectedTalent.department}
                    </span>
                  </div>
                </div>
              </div>
              <div className="p-6 space-y-4">
                {/* Contact Info */}
                <div className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                  <h4 className="font-bold text-gray-700 mb-3">üìû Contact Information</h4>
                  <div className="space-y-2">
                    <div className="flex items-center gap-3">
                      <span className="text-gray-500">üì± Phone:</span>
                      <input
                        type="text"
                        value={selectedTalent.phone || ''}
                        onChange={(e) => handleUpdateTalent({...selectedTalent, phone: e.target.value})}
                        className="flex-1 px-3 py-1 border border-gray-300 rounded-lg text-sm"
                        placeholder="Add phone..."
                      />
                    </div>
                    <div className="flex items-center gap-3">
                      <span className="text-gray-500">üìß Email:</span>
                      <input
                        type="email"
                        value={selectedTalent.email || ''}
                        onChange={(e) => handleUpdateTalent({...selectedTalent, email: e.target.value})}
                        className="flex-1 px-3 py-1 border border-gray-300 rounded-lg text-sm"
                        placeholder="Add email..."
                      />
                    </div>
                  </div>
                </div>

                {/* Work Link */}
                <div className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                  <h4 className="font-bold text-gray-700 mb-3">üîó Work Link / Portfolio</h4>
                  <input
                    type="url"
                    value={selectedTalent.workLink || ''}
                    onChange={(e) => handleUpdateTalent({...selectedTalent, workLink: e.target.value})}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"
                    placeholder="https://portfolio.com or demo reel link"
                  />
                  {selectedTalent.workLink && (
                    <a
                      href={selectedTalent.workLink}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="inline-block mt-2 text-blue-500 text-sm hover:underline"
                    >
                      üîó Open Link ‚Üí
                    </a>
                  )}
                </div>

                {/* Culture */}
                <div className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                  <h4 className="font-bold text-gray-700 mb-3">üé≠ Culture</h4>
                  <span className="px-4 py-2 bg-purple-100 text-purple-700 font-bold rounded-full">
                    {selectedTalent.culture}
                  </span>
                </div>

                {/* STAGE Projects */}
                <div className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                  <h4 className="font-bold text-gray-700 mb-3">üé¨ STAGE Projects</h4>
                  {selectedTalent.projects && selectedTalent.projects.length > 0 ? (
                    <div className="space-y-2">
                      {selectedTalent.projects.map((proj: any, i: number) => (
                        <div key={i} className="flex items-center justify-between bg-white p-3 rounded-lg border border-gray-200">
                          <span className="font-semibold text-gray-800">{proj.name || proj}</span>
                          {proj.status && (
                            <span className={`px-2 py-0.5 text-xs font-bold rounded-full ${
                              proj.status === 'approved' ? 'bg-green-100 text-green-700' :
                              proj.status === 'in-production' ? 'bg-purple-100 text-purple-700' :
                              'bg-gray-100 text-gray-600'
                            }`}>
                              {proj.status}
                            </span>
                          )}
                        </div>
                      ))}
                    </div>
                  ) : (
                    <p className="text-gray-500 text-sm">No STAGE projects yet</p>
                  )}
                </div>

                {/* Notes */}
                <div className="bg-gray-50 rounded-xl p-4 border border-gray-200">
                  <h4 className="font-bold text-gray-700 mb-3">üìù Notes</h4>
                  <textarea
                    value={selectedTalent.notes || ''}
                    onChange={(e) => handleUpdateTalent({...selectedTalent, notes: e.target.value})}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm resize-none"
                    rows={3}
                    placeholder="Add notes about this talent..."
                  />
                </div>

                {/* Added Info */}
                <div className="text-xs text-gray-400 text-center">
                  Added from: {selectedTalent.addedFrom || 'Manual'} ‚Ä¢ {selectedTalent.addedAt ? new Date(selectedTalent.addedAt).toLocaleDateString() : ''}
                </div>

                {/* Share & Download Actions */}
                <div className="flex gap-2 pt-4 border-t border-gray-200">
                  {/* Share Button */}
                  <div className="relative">
                    <button
                      onClick={() => { setShowTalentShareMenu(!showTalentShareMenu); setShowTalentDownloadMenu(false); }}
                      className="px-4 py-2.5 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-bold rounded-lg transition-all flex items-center gap-2 text-sm"
                    >
                      <span>‚Üó</span> Share
                    </button>
                    {showTalentShareMenu && (
                      <div className="absolute bottom-full left-0 mb-2 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 min-w-[160px] z-50">
                        <button onClick={() => shareTalentProfile(selectedTalent, 'whatsapp')} className="w-full px-4 py-2 text-left hover:bg-green-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span className="text-green-500">üí¨</span> WhatsApp
                        </button>
                        <button onClick={() => shareTalentProfile(selectedTalent, 'twitter')} className="w-full px-4 py-2 text-left hover:bg-blue-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span className="text-blue-400">ùïè</span> Twitter
                        </button>
                        <button onClick={() => shareTalentProfile(selectedTalent, 'linkedin')} className="w-full px-4 py-2 text-left hover:bg-blue-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span className="text-blue-600">in</span> LinkedIn
                        </button>
                        <button onClick={() => shareTalentProfile(selectedTalent, 'email')} className="w-full px-4 py-2 text-left hover:bg-gray-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span>üìß</span> Email
                        </button>
                        <div className="border-t border-gray-100 my-1"></div>
                        <button onClick={() => shareTalentProfile(selectedTalent, 'copy')} className="w-full px-4 py-2 text-left hover:bg-gray-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span>üìã</span> Copy
                        </button>
                      </div>
                    )}
                  </div>

                  {/* Download Button */}
                  <div className="relative">
                    <button
                      onClick={() => { setShowTalentDownloadMenu(!showTalentDownloadMenu); setShowTalentShareMenu(false); }}
                      className="px-4 py-2.5 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold rounded-lg transition-all flex items-center gap-2 text-sm"
                    >
                      <span>‚Üì</span> Download
                    </button>
                    {showTalentDownloadMenu && (
                      <div className="absolute bottom-full left-0 mb-2 bg-white rounded-xl shadow-2xl border border-gray-200 py-2 min-w-[160px] z-50">
                        <button onClick={() => downloadTalentProfile(selectedTalent, 'pdf')} className="w-full px-4 py-2 text-left hover:bg-red-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span className="text-red-500">üìÑ</span> PDF Profile
                        </button>
                        <button onClick={() => downloadTalentProfile(selectedTalent, 'vcard')} className="w-full px-4 py-2 text-left hover:bg-blue-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span className="text-blue-500">üë§</span> vCard (.vcf)
                        </button>
                        <button onClick={() => downloadTalentProfile(selectedTalent, 'json')} className="w-full px-4 py-2 text-left hover:bg-gray-50 text-gray-700 font-semibold text-sm flex items-center gap-2">
                          <span className="text-gray-500">{ }</span> JSON Data
                        </button>
                      </div>
                    )}
                  </div>

                  {/* Spacer */}
                  <div className="flex-1"></div>

                  {/* Close Button */}
                  <button
                    onClick={() => { setSelectedTalent(null); setShowTalentShareMenu(false); setShowTalentDownloadMenu(false); }}
                    className="px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-600 font-bold rounded-lg transition-all text-sm"
                  >
                    Close
                  </button>

                  {/* Delete Button */}
                  <button
                    onClick={() => handleDeleteTalent(selectedTalent.id)}
                    className="px-4 py-2.5 bg-red-100 hover:bg-red-200 text-red-600 font-bold rounded-lg transition-all text-sm"
                  >
                    üóëÔ∏è
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Delete Confirmation Modal */}
        {showDeleteConfirm && (
          <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
            <div className="bg-gradient-to-br from-gray-900 to-gray-800 border-2 border-red-500 rounded-2xl shadow-2xl p-6 max-w-md w-full">
              <div className="text-center">
                <div className="text-6xl mb-4">üóëÔ∏è</div>
                <h3 className="text-2xl font-black text-white mb-2">Delete this project?</h3>
                <p className="text-gray-300 font-semibold mb-6">
                  This action cannot be undone. All project data will be permanently deleted.
                </p>
                <div className="flex gap-4">
                  <button
                    onClick={() => {
                      handleDeleteProject(showDeleteConfirm);
                      setShowDeleteConfirm(null);
                    }}
                    className="flex-1 py-3 bg-red-600 hover:bg-red-700 text-white font-black rounded-xl transition-all shadow-lg hover:shadow-xl"
                  >
                    Yes, Delete
                  </button>
                  <button
                    onClick={() => setShowDeleteConfirm(null)}
                    className="flex-1 py-3 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded-xl transition-all"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Status Change Modal */}
        {showStatusMenu && (
          <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm overflow-y-auto">
            <div className="bg-gradient-to-br from-gray-900 to-gray-800 border-2 border-blue-500 rounded-2xl shadow-2xl p-6 max-w-md w-full my-4 max-h-[90vh] overflow-y-auto">
              <div className="text-center mb-4">
                <div className="text-5xl mb-3">üîÑ</div>
                <h3 className="text-xl font-black text-white mb-1">Change Project Status</h3>
                <p className="text-gray-400 text-sm font-semibold">
                  Select a new status for this project
                </p>
              </div>
              {/* Status Flow: Pending ‚Üí Under Review ‚Üí Approved ‚Üí Agreement Signed ‚Üí In Production */}
              <div className="text-[10px] text-gray-500 mb-3 flex items-center gap-1 flex-wrap justify-center">
                <span className="font-bold">Workflow:</span>
                <span className="px-1.5 py-0.5 bg-yellow-500/20 rounded text-yellow-400">Pending</span>
                <span>‚Üí</span>
                <span className="px-1.5 py-0.5 bg-blue-500/20 rounded text-blue-400">Review</span>
                <span>‚Üí</span>
                <span className="px-1.5 py-0.5 bg-green-500/20 rounded text-green-400">Approved</span>
                <span>‚Üí</span>
                <span className="px-1.5 py-0.5 bg-cyan-500/20 rounded text-cyan-400">Agreement</span>
                <span>‚Üí</span>
                <span className="px-1.5 py-0.5 bg-purple-500/20 rounded text-purple-400">Production</span>
              </div>
              <div className="space-y-2 mb-4">
                {[
                  { value: 'pending', label: 'Pending Review', icon: '‚è≥', color: 'bg-yellow-500/20 border-yellow-500 text-yellow-300', step: 1 },
                  { value: 'under-review', label: 'Under Review', icon: 'üëÅÔ∏è', color: 'bg-blue-500/20 border-blue-500 text-blue-300', step: 2 },
                  { value: 'approved', label: 'Approved', icon: '‚úÖ', color: 'bg-green-500/20 border-green-500 text-green-300', step: 3 },
                  { value: 'agreement-signed', label: 'Agreement Signed', icon: 'üìÑ', color: 'bg-cyan-500/20 border-cyan-500 text-cyan-300', step: 4 },
                  { value: 'in-production', label: 'In Production', icon: 'üé¨', color: 'bg-purple-500/20 border-purple-500 text-purple-300', step: 5 },
                  { value: 'revision-requested', label: 'Revision Needed', icon: 'üìù', color: 'bg-orange-500/20 border-orange-500 text-orange-300', step: 0 },
                  { value: 'on-hold', label: 'On Hold', icon: '‚è∏Ô∏è', color: 'bg-gray-500/20 border-gray-500 text-gray-300', step: 0 },
                  { value: 'scrapped', label: 'Scrapped', icon: 'üóëÔ∏è', color: 'bg-red-500/20 border-red-500 text-red-300', step: 0 },
                ].map((status) => {
                  const currentSubmission = submissions.find(s => s.id === showStatusMenu);
                  const isCurrentStatus = currentSubmission?.status === status.value;
                  return (
                    <button
                      key={status.value}
                      onClick={() => {
                        handleStatusChange(showStatusMenu, status.value);
                        setShowStatusMenu(null);
                      }}
                      className={`w-full text-left px-3 py-2.5 rounded-lg border-2 font-bold flex items-center gap-2 transition-all hover:scale-[1.01] text-sm ${
                        isCurrentStatus
                          ? 'bg-white/20 border-white text-white'
                          : `${status.color} hover:bg-white/10`
                      }`}
                    >
                      <span className="text-lg">{status.icon}</span>
                      <span className="flex-1">{status.label}</span>
                      {isCurrentStatus && (
                        <span className="text-green-400 font-black text-xs">‚úì Current</span>
                      )}
                    </button>
                  );
                })}
              </div>
              <button
                onClick={() => setShowStatusMenu(null)}
                className="w-full py-2.5 bg-gray-600 hover:bg-gray-500 text-white font-bold rounded-lg transition-all text-sm"
              >
                Cancel
              </button>
            </div>
          </div>
        )}

        {/* Detailed Review Modal */}
        {selectedSubmission && (
          <div className="fixed inset-0 z-50 flex items-center justify-center p-2 md:p-6 bg-black/80 backdrop-blur-sm">
            <div className="relative w-full max-w-7xl h-[96vh] bg-gradient-to-br from-gray-900 to-black border border-white/20 rounded-2xl shadow-2xl flex flex-col overflow-hidden">
              {/* Modal Header - OPTION 2: Two-Row Horizontal Layout */}
              <div className="flex-shrink-0 bg-gradient-to-r from-gray-900/95 to-black/95 backdrop-blur-xl border-b border-white/10 p-3 md:p-4">
                <div className="flex items-start justify-between gap-3 mb-2">
                  <div className="flex-1 space-y-2">
                    {/* Row 1: Title + Status */}
                    <div className="flex items-center gap-3">
                      <h2 className="text-xl md:text-2xl font-black text-white">{selectedSubmission.projectName}</h2>
                      <span className={`inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-xs font-black border-2 ${getStatusConfig(selectedSubmission.status).badge}`}>
                        <span>{getStatusConfig(selectedSubmission.status).icon}</span>
                        <span>{getStatusConfig(selectedSubmission.status).text}</span>
                      </span>
                    </div>

                    {/* Row 2: Metadata + POC */}
                    <div className="flex items-center gap-2 flex-wrap">
                      <span className="px-2 py-0.5 bg-purple-500/20 border border-purple-500/50 rounded text-xs font-bold text-purple-300">{selectedSubmission.format}</span>
                      <span className="px-2 py-0.5 bg-pink-500/20 border border-pink-500/50 rounded text-xs font-bold text-pink-300">{selectedSubmission.culture}</span>
                      <span className="px-2 py-0.5 bg-blue-500/20 border border-blue-500/50 rounded text-xs font-bold text-blue-300">{selectedSubmission.genre}</span>
                      <span className="text-gray-500">‚Ä¢</span>
                      {selectedSubmission.productionPOC && (
                        <span className="px-2 py-0.5 bg-indigo-500/30 border border-indigo-400/50 rounded text-xs font-bold text-indigo-200">üé¨ {selectedSubmission.productionPOC}</span>
                      )}
                      {selectedSubmission.contentPOC && (
                        <span className="px-2 py-0.5 bg-purple-500/30 border border-purple-400/50 rounded text-xs font-bold text-purple-200">üìù {selectedSubmission.contentPOC}</span>
                      )}
                      {!selectedSubmission.productionPOC && !selectedSubmission.contentPOC && (
                        <span className="text-xs font-bold text-gray-400 italic">No POC assigned</span>
                      )}
                    </div>
                  </div>
                  <button onClick={() => { setSelectedSubmission(null); setDetailView('project'); }} className="text-gray-400 hover:text-white text-2xl font-bold transition-colors">√ó</button>
                </div>

                {/* Tabs - Like Creator Onboarding Steps */}
                <div className="flex items-center gap-1 overflow-x-auto pb-1 scrollbar-thin">
                  {[
                    { id: 'project', icon: 'üìã', label: 'Project' },
                    { id: 'creator', icon: 'üë§', label: 'Creator' },
                    { id: 'budget', icon: 'üí∞', label: 'Budget' },
                    { id: 'timeline', icon: 'üìÖ', label: 'Timeline' },
                    { id: 'crew', icon: 'üé¨', label: 'Crew' },
                    { id: 'cast', icon: '‚≠ê', label: 'Cast' },
                    { id: 'technical', icon: 'üìπ', label: 'Technical' },
                    { id: 'cashflow', icon: 'üí≥', label: 'Cash Flow' },
                    { id: 'documents', icon: 'üìÅ', label: 'Documents' },
                    { id: 'missing', icon: '‚ö†Ô∏è', label: 'Missing' },
                    { id: 'sop', icon: 'üí¨', label: 'SOP Comments', badge: selectedSubmission?.sopComments?.length || 0 },
                    { id: 'agreement', icon: 'üìù', label: 'Agreement' },
                    { id: 'activity', icon: 'üìã', label: 'Activity Log' },
                  ].map((tab: any, index) => (
                    <button
                      key={tab.id}
                      onClick={() => setDetailView(tab.id as any)}
                      className={`flex items-center gap-1.5 px-3 py-2 rounded-lg text-xs font-bold whitespace-nowrap transition-all ${
                        detailView === tab.id
                          ? 'bg-gradient-to-r from-red-500 to-pink-500 text-white shadow-lg scale-105'
                          : tab.id === 'sop' && tab.badge > 0
                            ? 'bg-blue-500/20 text-blue-400 hover:bg-blue-500/30 border border-blue-500/50 hover:text-blue-300'
                            : 'bg-white/5 text-gray-400 hover:bg-white/10 border border-white/10 hover:text-white'
                      }`}
                    >
                      <span className="text-sm">{tab.icon}</span>
                      <span>{tab.label}</span>
                      {tab.badge > 0 && (
                        <span className={`ml-1 px-1.5 py-0.5 text-xs font-black rounded-full ${
                          detailView === tab.id ? 'bg-white text-red-500' : 'bg-blue-500 text-white'
                        }`}>
                          {tab.badge}
                        </span>
                      )}
                      {detailView === tab.id && !tab.badge && <span className="ml-1 w-2 h-2 bg-white rounded-full animate-pulse"></span>}
                    </button>
                  ))}
                </div>
              </div>

              {/* Modal Content */}
              <div className="flex-1 overflow-y-auto p-4 md:p-6">
                {/* Project Tab */}
                {detailView === 'project' && (
                  <div className="space-y-4">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üìã</span>
                        <div>
                          <h3 className="text-white font-black">Project Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download project information</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'project')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'project')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* POC (Point of Contact) Section */}
                    <div className="bg-white rounded-xl p-5 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üë•</span>
                        <span>Point of Contact (POC)</span>
                      </h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {/* Production POC */}
                        <div>
                          <label className="text-sm font-bold text-gray-700 mb-3 block">üé¨ PRODUCTION POC</label>
                          <input
                            type="text"
                            value={selectedSubmission.productionPOC || ''}
                            onChange={(e) => {
                              const updatedSubmission = { ...selectedSubmission, productionPOC: e.target.value };
                              setSelectedSubmission(updatedSubmission);
                              setSubmissions(prevSubmissions =>
                                prevSubmissions.map(s =>
                                  s.id === selectedSubmission.id ? updatedSubmission : s
                                )
                              );
                            }}
                            placeholder="Enter Production POC name"
                            className="w-full px-4 py-3 bg-blue-50 border-2 border-blue-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition-all font-semibold"
                          />
                        </div>

                        {/* Content POC */}
                        <div>
                          <label className="text-sm font-bold text-gray-700 mb-3 block">üìù CONTENT POC</label>
                          <input
                            type="text"
                            value={selectedSubmission.contentPOC || ''}
                            onChange={(e) => {
                              const updatedSubmission = { ...selectedSubmission, contentPOC: e.target.value };
                              setSelectedSubmission(updatedSubmission);
                              setSubmissions(prevSubmissions =>
                                prevSubmissions.map(s =>
                                  s.id === selectedSubmission.id ? updatedSubmission : s
                                )
                              );
                            }}
                            placeholder="Enter Content POC name"
                            className="w-full px-4 py-3 bg-purple-50 border-2 border-purple-200 rounded-lg text-gray-900 placeholder:text-gray-400 focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition-all font-semibold"
                          />
                        </div>
                      </div>

                      {/* POC Display on Cards */}
                      {(selectedSubmission.productionPOC || selectedSubmission.contentPOC) && (
                        <div className="mt-6 p-4 bg-gray-50 rounded-xl border-2 border-gray-200">
                          <div className="text-sm font-bold text-gray-700 mb-3">ASSIGNED POCs:</div>
                          <div className="flex flex-wrap gap-3">
                            {selectedSubmission.productionPOC && (
                              <span className="px-4 py-2 bg-blue-100 border-2 border-blue-300 rounded-lg text-sm font-bold text-blue-900">
                                üé¨ {selectedSubmission.productionPOC}
                              </span>
                            )}
                            {selectedSubmission.contentPOC && (
                              <span className="px-4 py-2 bg-purple-100 border-2 border-purple-300 rounded-lg text-sm font-bold text-purple-900">
                                üìù {selectedSubmission.contentPOC}
                              </span>
                            )}
                          </div>
                        </div>
                      )}
                    </div>

                    {/* Project Synopsis */}
                    <div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-8 border-2 border-green-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üìù</span>
                        <span>Project Synopsis</span>
                      </h3>
                      <div className="space-y-4">
                        {selectedSubmission.logline && (
                          <div className="bg-white rounded-xl p-4 border-2 border-green-200">
                            <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">LOGLINE</div>
                            <div className="text-base font-semibold text-gray-900">{selectedSubmission.logline}</div>
                          </div>
                        )}
                        {selectedSubmission.synopsis && (
                          <div className="bg-white rounded-xl p-4 border-2 border-green-200">
                            <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">SYNOPSIS</div>
                            <div className="text-base font-semibold text-gray-900">{selectedSubmission.synopsis}</div>
                          </div>
                        )}
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {selectedSubmission.targetAudience && (
                            <div className="bg-white rounded-xl p-4 border-2 border-green-200">
                              <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">TARGET AUDIENCE</div>
                              <div className="text-base font-semibold text-gray-900">{selectedSubmission.targetAudience}</div>
                            </div>
                          )}
                          {selectedSubmission.language && (
                            <div className="bg-white rounded-xl p-4 border-2 border-green-200">
                              <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">LANGUAGE</div>
                              <div className="text-base font-semibold text-gray-900">{selectedSubmission.language}</div>
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Complete Project Details */}
                    <div className="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 border-2 border-blue-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üé¨</span>
                        <span>Complete Project Details</span>
                      </h3>
                      <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">PROJECT NAME</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.projectName || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">PRODUCTION COMPANY</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.productionCompany || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">CULTURE</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.culture || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">FORMAT</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.format || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">GENRE</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.genre || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">SUB-GENRE</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.subGenre || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">CONTENT RATING</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.contentRating || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">PRODUCTION TYPE</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.productionType || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">SOURCE MATERIAL</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.sourceMaterial || 'N/A'}</div>
                        </div>
                        {selectedSubmission.ipRightsStatus && (
                          <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                            <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">IP RIGHTS STATUS</div>
                            <div className="text-base font-bold text-gray-900">{selectedSubmission.ipRightsStatus}</div>
                          </div>
                        )}
                        <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">SHOOT DAYS</div>
                          <div className="text-base font-bold text-gray-900">{selectedSubmission.shootDays || 'N/A'}</div>
                        </div>
                        {selectedSubmission.episodes && (
                          <div className="bg-white rounded-lg p-4 border-2 border-blue-200">
                            <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">EPISODES</div>
                            <div className="text-base font-bold text-gray-900">{selectedSubmission.episodes}</div>
                          </div>
                        )}
                      </div>
                    </div>

                    {/* Quick Navigation Cards */}
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                      <button
                        onClick={() => setDetailView('timeline')}
                        className="bg-gradient-to-br from-cyan-50 to-teal-50 rounded-xl p-4 border-2 border-cyan-200 hover:shadow-lg transition-all text-left"
                      >
                        <div className="text-2xl mb-2">üìÖ</div>
                        <div className="text-sm font-black text-gray-900">Timeline</div>
                        <div className="text-xs text-cyan-700 font-semibold">{selectedSubmission.shootDays || 0} Shoot Days</div>
                      </button>
                      <button
                        onClick={() => setDetailView('crew')}
                        className="bg-gradient-to-br from-indigo-50 to-violet-50 rounded-xl p-4 border-2 border-indigo-200 hover:shadow-lg transition-all text-left"
                      >
                        <div className="text-2xl mb-2">üé¨</div>
                        <div className="text-sm font-black text-gray-900">Crew</div>
                        <div className="text-xs text-indigo-700 font-semibold">{[selectedSubmission.director, selectedSubmission.dop, selectedSubmission.editor].filter(Boolean).length}+ Members</div>
                      </button>
                      <button
                        onClick={() => setDetailView('cast')}
                        className="bg-gradient-to-br from-pink-50 to-rose-50 rounded-xl p-4 border-2 border-pink-200 hover:shadow-lg transition-all text-left"
                      >
                        <div className="text-2xl mb-2">‚≠ê</div>
                        <div className="text-sm font-black text-gray-900">Cast</div>
                        <div className="text-xs text-pink-700 font-semibold">{selectedSubmission.castData?.primaryCast?.length || 0} Primary</div>
                      </button>
                      <button
                        onClick={() => setDetailView('cashflow')}
                        className="bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-4 border-2 border-emerald-200 hover:shadow-lg transition-all text-left"
                      >
                        <div className="text-2xl mb-2">üí≥</div>
                        <div className="text-sm font-black text-gray-900">Cash Flow</div>
                        <div className="text-xs text-emerald-700 font-semibold">{selectedSubmission.cashFlowTranches?.length || 0} Tranches</div>
                      </button>
                    </div>

                    {/* Submission Info */}
                    <div className="bg-gradient-to-br from-gray-100 to-slate-100 rounded-2xl p-6 border-2 border-gray-300">
                      <div className="flex items-center justify-between text-sm">
                        <div>
                          <span className="text-gray-600 font-semibold">Submitted: </span>
                          <span className="text-gray-900 font-bold">{selectedSubmission.submittedDate || selectedSubmission.submitted_at?.split('T')[0]}</span>
                        </div>
                        {selectedSubmission.updated_at && (
                          <div>
                            <span className="text-gray-600 font-semibold">Last Updated: </span>
                            <span className="text-gray-900 font-bold">{selectedSubmission.updated_at.split('T')[0]}</span>
                          </div>
                        )}
                        {selectedSubmission.isLocalSubmission && (
                          <span className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-bold">
                            Local Submission
                          </span>
                        )}
                      </div>
                    </div>
                  </div>
                )}

                {/* Budget Tab - Redesigned */}
                {detailView === 'budget' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üí∞</span>
                        <div>
                          <h3 className="text-white font-black">Budget Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download budget breakdown</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'budget')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'budget')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* Total Budget Overview Card */}
                    <div className="bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl p-8 border-2 border-emerald-200 shadow-lg">
                      <div className="flex items-center justify-between">
                        <div>
                          <div className="text-sm font-bold text-emerald-700 mb-2 uppercase tracking-wide">üí∞ Total Project Budget</div>
                          <div className="text-5xl font-black text-emerald-900 mb-2">
                            {formatBudgetInWords(selectedSubmission.totalBudget)}
                          </div>
                          <div className="text-lg text-emerald-700 font-semibold">
                            ‚Çπ{selectedSubmission.totalBudget.toLocaleString('en-IN')}
                          </div>
                        </div>
                        <div className="text-6xl">üíµ</div>
                      </div>
                    </div>

                    {/* Budget Breakdown Summary */}
                    <div className="bg-white rounded-xl p-5 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üìã</span>
                        <span>Budget Breakdown Summary</span>
                      </h3>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        {/* Production Cost */}
                        <div className="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-200">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-xl">üé¨</span>
                            <span className="text-sm font-bold text-blue-800">Production Cost</span>
                          </div>
                          <div className="text-xl font-black text-blue-900">
                            ‚Çπ{(selectedSubmission.budgetCategories?.reduce((sum: number, cat: any) => sum + (cat.amount || 0), 0) || 0).toLocaleString('en-IN')}
                          </div>
                        </div>

                        {/* Creator Margin */}
                        <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 border-2 border-purple-200">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-xl">üíº</span>
                            <span className="text-sm font-bold text-purple-800">Creator Margin</span>
                          </div>
                          <div className="text-xl font-black text-purple-900">
                            ‚Çπ{(selectedSubmission.budgetCreatorMargin || 0).toLocaleString('en-IN')}
                          </div>
                          <div className="text-xs text-purple-600 font-semibold">
                            {selectedSubmission.budgetCreatorMarginPercent || 0}% of Production
                          </div>
                        </div>

                        {/* Insurance */}
                        <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-4 border-2 border-amber-200">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-xl">üõ°Ô∏è</span>
                            <span className="text-sm font-bold text-amber-800">Insurance</span>
                          </div>
                          <div className="text-xl font-black text-amber-900">
                            ‚Çπ{(selectedSubmission.budgetInsuranceAmount || 0).toLocaleString('en-IN')}
                          </div>
                        </div>

                        {/* Celebrity Fees */}
                        <div className="bg-gradient-to-br from-rose-50 to-red-50 rounded-xl p-4 border-2 border-rose-200">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-xl">‚≠ê</span>
                            <span className="text-sm font-bold text-rose-800">Celebrity Fees</span>
                          </div>
                          <div className="text-xl font-black text-rose-900">
                            ‚Çπ{(selectedSubmission.budgetCelebrityFees?.reduce((sum: number, c: any) => sum + (c.amount || 0), 0) || 0).toLocaleString('en-IN')}
                          </div>
                          {selectedSubmission.budgetCelebrityFees?.length > 0 && (
                            <div className="text-xs text-rose-600 font-semibold">
                              {selectedSubmission.budgetCelebrityFees.length} celebrities
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Celebrity Details - if any */}
                      {selectedSubmission.budgetCelebrityFees && selectedSubmission.budgetCelebrityFees.length > 0 && (
                        <div className="mt-4 p-4 bg-rose-50 rounded-xl border-2 border-rose-200">
                          <div className="text-sm font-bold text-rose-800 mb-2">‚≠ê Celebrity Breakdown</div>
                          <div className="space-y-2">
                            {selectedSubmission.budgetCelebrityFees.map((celeb: any, idx: number) => (
                              <div key={idx} className="flex justify-between items-center bg-white rounded-lg p-2 border border-rose-100">
                                <span className="font-semibold text-gray-800">{celeb.name || `Celebrity ${idx + 1}`}</span>
                                <span className="font-bold text-rose-700">‚Çπ{(celeb.amount || 0).toLocaleString('en-IN')}</span>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>

                    {/* Department-wise Budget Breakdown */}
                    <div className="bg-white rounded-xl p-5 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üìä</span>
                        <span>Department-wise Budget Allocation</span>
                      </h3>
                      <div className="space-y-3">
                        {selectedSubmission.budgetCategories && selectedSubmission.budgetCategories.length > 0 ? (
                          selectedSubmission.budgetCategories.map((category: any, index: number) => {
                            const isExpanded = expandedDepartment === category.id;
                            const categoryAmount = category.amount || 0;
                            const categoryPercentage = category.yourPercentage || 0;
                            const hasItems = category.items && category.items.length > 0;
                            const filledItems = hasItems ? category.items.filter((item: any) => item.total > 0 || item.description) : [];

                            return (
                              <div key={index} className="border-2 border-blue-200 rounded-xl overflow-hidden">
                                {/* Category Header - Clickable */}
                                <div
                                  className={`bg-gradient-to-r from-blue-50 to-indigo-50 p-4 cursor-pointer hover:from-blue-100 hover:to-indigo-100 transition-all ${isExpanded ? 'border-b-2 border-blue-200' : ''}`}
                                  onClick={() => setExpandedDepartment(isExpanded ? null : category.id)}
                                >
                                  <div className="flex items-center justify-between">
                                    <div className="flex items-center gap-3">
                                      <span className="text-2xl">{category.icon || 'üìÅ'}</span>
                                      <div>
                                        <div className="flex items-center gap-2">
                                          <span className="text-lg font-black text-gray-900">{category.name}</span>
                                          <span className="px-2 py-0.5 bg-blue-100 border border-blue-300 rounded-full text-xs font-bold text-blue-700">
                                            {categoryPercentage.toFixed(1)}%
                                          </span>
                                          {filledItems.length > 0 && (
                                            <span className="px-2 py-0.5 bg-green-100 border border-green-300 rounded-full text-xs font-bold text-green-700">
                                              {filledItems.length} items
                                            </span>
                                          )}
                                        </div>
                                        <div className="text-lg font-bold text-blue-900">
                                          ‚Çπ{categoryAmount.toLocaleString('en-IN')}
                                        </div>
                                      </div>
                                    </div>
                                    <div className="flex items-center gap-3">
                                      <div className="w-32 h-2 bg-blue-100 rounded-full overflow-hidden">
                                        <div
                                          className="h-full bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full"
                                          style={{ width: `${Math.min(categoryPercentage, 100)}%` }}
                                        ></div>
                                      </div>
                                      <svg
                                        className={`w-5 h-5 text-gray-500 transition-transform ${isExpanded ? 'rotate-180' : ''}`}
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                      >
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                                      </svg>
                                    </div>
                                  </div>
                                </div>

                                {/* Expanded Items Table */}
                                {isExpanded && (
                                  <div className="bg-white p-4">
                                    {filledItems.length > 0 ? (
                                      <div className="overflow-x-auto">
                                        <table className="w-full text-sm">
                                          <thead>
                                            <tr className="bg-gray-100">
                                              <th className="text-left p-2 font-bold text-gray-700">Item Description</th>
                                              <th className="text-center p-2 font-bold text-gray-700">Days</th>
                                              <th className="text-center p-2 font-bold text-gray-700">People/Qty</th>
                                              <th className="text-right p-2 font-bold text-gray-700">Per Day (‚Çπ)</th>
                                              <th className="text-right p-2 font-bold text-gray-700">Lumpsum (‚Çπ)</th>
                                              <th className="text-right p-2 font-bold text-gray-700">Total (‚Çπ)</th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            {filledItems.map((item: any, itemIndex: number) => (
                                              <tr key={itemIndex} className="border-b border-gray-100 hover:bg-gray-50">
                                                <td className="p-2 font-semibold text-gray-900">{item.description || 'N/A'}</td>
                                                <td className="p-2 text-center text-gray-700">{item.noOfDays || item.days || '-'}</td>
                                                <td className="p-2 text-center text-gray-700">{item.noOfPeople || item.people || item.noOfRooms || '-'}</td>
                                                <td className="p-2 text-right text-gray-700">{item.perDay ? `‚Çπ${item.perDay.toLocaleString('en-IN')}` : '-'}</td>
                                                <td className="p-2 text-right text-gray-700">{(item.lumpsumFixed || item.lumpsum) ? `‚Çπ${(item.lumpsumFixed || item.lumpsum).toLocaleString('en-IN')}` : '-'}</td>
                                                <td className="p-2 text-right font-bold text-blue-900">‚Çπ{(item.total || 0).toLocaleString('en-IN')}</td>
                                              </tr>
                                            ))}
                                          </tbody>
                                          <tfoot>
                                            <tr className="bg-blue-50 font-bold">
                                              <td colSpan={5} className="p-2 text-right text-gray-900">Category Total:</td>
                                              <td className="p-2 text-right text-blue-900">‚Çπ{categoryAmount.toLocaleString('en-IN')}</td>
                                            </tr>
                                          </tfoot>
                                        </table>
                                      </div>
                                    ) : (
                                      <div className="text-center py-4 text-gray-500 font-semibold">
                                        No items added in this category
                                      </div>
                                    )}
                                  </div>
                                )}
                              </div>
                            );
                          })
                        ) : (
                          <div className="text-center py-8 text-gray-500">
                            <div className="text-4xl mb-2">üìä</div>
                            <div className="font-semibold">No budget breakdown available</div>
                            <div className="text-sm">Creator has not filled budget details yet</div>
                          </div>
                        )}
                      </div>

                      {/* Budget Summary */}
                      {selectedSubmission.budgetCategories && selectedSubmission.budgetCategories.length > 0 && (
                        <div className="mt-4 pt-4 border-t-2 border-gray-200">
                          <div className="flex items-center justify-between bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border-2 border-green-200">
                            <div className="flex items-center gap-3">
                              <span className="text-2xl">üí∞</span>
                              <span className="text-lg font-black text-gray-900">Total Budget Allocated</span>
                            </div>
                            <div className="text-right">
                              <div className="text-2xl font-black text-green-700">
                                ‚Çπ{(selectedSubmission.budgetCategories.reduce((sum: number, cat: any) => sum + (cat.amount || 0), 0)).toLocaleString('en-IN')}
                              </div>
                              <div className="text-sm font-semibold text-green-600">
                                {formatBudgetInWords(selectedSubmission.budgetCategories.reduce((sum: number, cat: any) => sum + (cat.amount || 0), 0))}
                              </div>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>

                    {/* Payment Tranches - Collapsible */}
                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl border-2 border-purple-200 shadow-lg overflow-hidden">
                      <div
                        className="p-6 cursor-pointer hover:bg-purple-100/50 transition-all"
                        onClick={() => toggleSection('paymentTranches')}
                      >
                        <div className="flex items-center justify-between">
                          <h3 className="text-xl font-black text-gray-900 flex items-center gap-2">
                            <span className="text-2xl">üí≥</span>
                            <span>Payment Schedule & Tranches</span>
                            <span className="px-2 py-1 bg-purple-100 border border-purple-300 rounded-full text-xs font-bold text-purple-700">4 Tranches</span>
                          </h3>
                          <svg
                            className={`w-6 h-6 text-purple-500 transition-transform ${!collapsedSections.paymentTranches ? 'rotate-180' : ''}`}
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                          >
                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                          </svg>
                        </div>
                        {collapsedSections.paymentTranches && (
                          <div className="mt-2 text-sm font-semibold text-purple-700">
                            Total: {formatBudgetInWords(selectedSubmission.totalBudget)} (Click to expand)
                          </div>
                        )}
                      </div>

                      {!collapsedSections.paymentTranches && (
                        <div className="px-6 pb-6 space-y-4">
                          {/* Tranche 1 */}
                          <div className="bg-white rounded-xl p-6 border-2 border-purple-200 hover:shadow-md transition-all">
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <span className="w-10 h-10 bg-purple-500 text-white rounded-full flex items-center justify-center font-black">1</span>
                                <div>
                                  <div className="text-lg font-black text-gray-900">First Tranche - On Signing</div>
                                  <div className="text-sm text-gray-600 font-semibold">Contract Execution</div>
                                </div>
                              </div>
                              <div className="text-right">
                                <div className="text-2xl font-black text-purple-900">20%</div>
                                <div className="text-sm text-purple-700 font-bold">{formatBudgetInWords(selectedSubmission.totalBudget * 0.20)}</div>
                              </div>
                            </div>
                          </div>

                          {/* Tranche 2 */}
                          <div className="bg-white rounded-xl p-6 border-2 border-purple-200 hover:shadow-md transition-all">
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <span className="w-10 h-10 bg-purple-500 text-white rounded-full flex items-center justify-center font-black">2</span>
                                <div>
                                  <div className="text-lg font-black text-gray-900">Second Tranche - Pre-Production</div>
                                  <div className="text-sm text-gray-600 font-semibold">Before Shoot Begins</div>
                                </div>
                              </div>
                              <div className="text-right">
                                <div className="text-2xl font-black text-purple-900">30%</div>
                                <div className="text-sm text-purple-700 font-bold">{formatBudgetInWords(selectedSubmission.totalBudget * 0.30)}</div>
                              </div>
                            </div>
                          </div>

                          {/* Tranche 3 */}
                          <div className="bg-white rounded-xl p-6 border-2 border-purple-200 hover:shadow-md transition-all">
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <span className="w-10 h-10 bg-purple-500 text-white rounded-full flex items-center justify-center font-black">3</span>
                                <div>
                                  <div className="text-lg font-black text-gray-900">Third Tranche - Mid-Production</div>
                                  <div className="text-sm text-gray-600 font-semibold">50% Shoot Completion</div>
                                </div>
                              </div>
                              <div className="text-right">
                                <div className="text-2xl font-black text-purple-900">25%</div>
                                <div className="text-sm text-purple-700 font-bold">{formatBudgetInWords(selectedSubmission.totalBudget * 0.25)}</div>
                              </div>
                            </div>
                          </div>

                          {/* Tranche 4 */}
                          <div className="bg-white rounded-xl p-6 border-2 border-purple-200 hover:shadow-md transition-all">
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <span className="w-10 h-10 bg-purple-500 text-white rounded-full flex items-center justify-center font-black">4</span>
                                <div>
                                  <div className="text-lg font-black text-gray-900">Final Tranche - Delivery</div>
                                  <div className="text-sm text-gray-600 font-semibold">Post Final Delivery</div>
                                </div>
                              </div>
                              <div className="text-right">
                                <div className="text-2xl font-black text-purple-900">25%</div>
                                <div className="text-sm text-purple-700 font-bold">{formatBudgetInWords(selectedSubmission.totalBudget * 0.25)}</div>
                              </div>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>

                    {/* Budget Summary Stats */}
                    <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-8 border-2 border-amber-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üìà</span>
                        <span>Budget Health & Analysis</span>
                      </h3>
                      <div className="grid grid-cols-3 gap-4">
                        <div className="bg-white rounded-xl p-6 border-2 border-amber-200 text-center">
                          <div className="text-sm font-bold text-amber-700 mb-3 uppercase">Budget Alignment</div>
                          <div className="text-4xl font-black mb-2">
                            {(() => {
                              const breakdown = selectedSubmission.budgetBreakdown || [];
                              const industryStandards: any = {
                                'Cast': { min: 15, max: 35 },
                                'Crew': { min: 15, max: 25 },
                                'Production': { min: 20, max: 30 },
                                'Post-Production': { min: 10, max: 20 },
                                'Music & Songs': { min: 3, max: 12 },
                                'Music': { min: 3, max: 12 },
                              };

                              let normalCount = 0;
                              breakdown.forEach((item: any) => {
                                const standard = industryStandards[item.category];
                                if (standard && item.percentage >= standard.min && item.percentage <= standard.max) {
                                  normalCount++;
                                }
                              });

                              const score = breakdown.length > 0 ? Math.round((normalCount / breakdown.length) * 100) : 0;
                              return (
                                <span className={
                                  score >= 80 ? 'text-green-600' :
                                  score >= 60 ? 'text-yellow-600' :
                                  'text-red-600'
                                }>
                                  {score}%
                                </span>
                              );
                            })()}
                          </div>
                          <div className="text-xs font-bold text-gray-600">Industry Standards</div>
                        </div>

                        <div className="bg-white rounded-xl p-6 border-2 border-amber-200 text-center">
                          <div className="text-sm font-bold text-amber-700 mb-3 uppercase">Completeness</div>
                          <div className="text-4xl font-black text-blue-600 mb-2">
                            {selectedSubmission.completeness}%
                          </div>
                          <div className="text-xs font-bold text-gray-600">Data Filled</div>
                        </div>

                        <div className="bg-white rounded-xl p-6 border-2 border-amber-200 text-center">
                          <div className="text-sm font-bold text-amber-700 mb-3 uppercase">Departments</div>
                          <div className="text-4xl font-black text-purple-600 mb-2">
                            {selectedSubmission.budgetBreakdown?.length || 0}
                          </div>
                          <div className="text-xs font-bold text-gray-600">Budget Categories</div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* SOP Comments Tab */}
                {detailView === 'sop' && (
                  <div className="space-y-6">
                    {/* Header */}
                    <div className="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white">
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-4">
                          <div className="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center">
                            <span className="text-4xl">üí¨</span>
                          </div>
                          <div>
                            <h2 className="text-2xl font-black">SOP Questions & Comments</h2>
                            <p className="text-blue-100 font-semibold mt-1">
                              Creator's queries about Standard Operating Procedures
                            </p>
                          </div>
                        </div>
                        {selectedSubmission.sopComments && selectedSubmission.sopComments.length > 0 && (
                          <div className="text-right">
                            <div className="text-4xl font-black">{selectedSubmission.sopComments.length}</div>
                            <div className="text-blue-200 text-sm font-bold">Total Comments</div>
                          </div>
                        )}
                      </div>
                    </div>

                    {selectedSubmission.sopComments && selectedSubmission.sopComments.length > 0 ? (
                      <>
                        {/* Comments by Section */}
                        <div className="space-y-4">
                          {(() => {
                            // Group comments by section
                            const groupedComments: { [key: string]: any[] } = {};
                            selectedSubmission.sopComments.forEach((comment: any) => {
                              if (!groupedComments[comment.sectionTitle]) {
                                groupedComments[comment.sectionTitle] = [];
                              }
                              groupedComments[comment.sectionTitle].push(comment);
                            });

                            return Object.entries(groupedComments).map(([sectionTitle, comments], sectionIndex) => (
                              <div key={sectionIndex} className="bg-white rounded-2xl border-2 border-blue-200 shadow-lg overflow-hidden">
                                <div className="bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b-2 border-blue-200">
                                  <div className="flex items-center justify-between">
                                    <h3 className="text-lg font-black text-gray-900 flex items-center gap-2">
                                      <span className="text-xl">üìã</span>
                                      {sectionTitle}
                                    </h3>
                                    <span className="px-3 py-1 bg-blue-500 text-white text-xs font-bold rounded-full">
                                      {comments.length} {comments.length === 1 ? 'Comment' : 'Comments'}
                                    </span>
                                  </div>
                                </div>
                                <div className="p-4 space-y-3">
                                  {comments.map((comment: any, commentIndex: number) => (
                                    <div key={commentIndex} className="bg-gradient-to-r from-gray-50 to-blue-50 rounded-xl p-5 border border-blue-100">
                                      <div className="flex items-start gap-4">
                                        <div className="w-10 h-10 bg-blue-100 border-2 border-blue-300 rounded-full flex items-center justify-center flex-shrink-0">
                                          <span className="text-lg">‚ùì</span>
                                        </div>
                                        <div className="flex-1">
                                          <p className="text-gray-800 font-semibold text-base leading-relaxed">
                                            {comment.comment}
                                          </p>
                                          <p className="text-xs text-gray-500 mt-3 flex items-center gap-2">
                                            <span>üìÖ</span>
                                            {new Date(comment.timestamp).toLocaleString('en-IN', {
                                              day: '2-digit',
                                              month: 'short',
                                              year: 'numeric',
                                              hour: '2-digit',
                                              minute: '2-digit'
                                            })}
                                          </p>
                                        </div>
                                      </div>
                                    </div>
                                  ))}
                                </div>
                              </div>
                            ));
                          })()}
                        </div>

                        {/* Action Buttons */}
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border-2 border-amber-200">
                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                              <span className="text-3xl">‚ö†Ô∏è</span>
                              <div>
                                <h3 className="text-lg font-black text-amber-900">Action Required</h3>
                                <p className="text-amber-700 font-medium text-sm">Please review and respond to creator's queries</p>
                              </div>
                            </div>
                            <div className="flex gap-3">
                              <button className="px-5 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold rounded-xl hover:shadow-lg transition-all flex items-center gap-2">
                                <span>üìß</span>
                                Email Creator
                              </button>
                              <button className="px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl hover:shadow-lg transition-all flex items-center gap-2">
                                <span>‚úÖ</span>
                                Mark Resolved
                              </button>
                            </div>
                          </div>
                        </div>
                      </>
                    ) : (
                      <div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-12 border-2 border-green-200 text-center">
                        <div className="text-6xl mb-4">‚úÖ</div>
                        <h3 className="text-2xl font-black text-green-800 mb-2">No SOP Comments</h3>
                        <p className="text-green-700 font-semibold">
                          Creator has not submitted any questions or comments about the Standard Operating Procedures.
                        </p>
                      </div>
                    )}
                  </div>
                )}

                {/* Creator Tab */}
                {detailView === 'creator' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üë§</span>
                        <div>
                          <h3 className="text-white font-black">Creator Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download creator information</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'creator')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'creator')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* Creator Profile Card */}
                    <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-8 border-2 border-purple-200 shadow-lg">
                      <div className="flex items-start gap-6">
                        <div className="w-24 h-24 bg-gradient-to-br from-purple-500 to-pink-600 rounded-2xl flex items-center justify-center text-white text-4xl font-black shadow-lg">
                          {(selectedSubmission.creator || 'C').charAt(0).toUpperCase()}
                        </div>
                        <div className="flex-1">
                          <h2 className="text-3xl font-black text-gray-900 mb-2">{selectedSubmission.creator || 'Creator'}</h2>
                          <p className="text-purple-700 font-semibold mb-3">{selectedSubmission.yearsOfExperience} years of experience</p>
                          <div className="flex flex-wrap gap-3">
                            {selectedSubmission.imdbLink && (
                              <a href={selectedSubmission.imdbLink} target="_blank" rel="noopener noreferrer" className="px-4 py-2 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 font-bold rounded-lg text-sm transition-colors flex items-center gap-2">
                                üé¨ IMDB Profile
                              </a>
                            )}
                            {selectedSubmission.portfolioLink && (
                              <a href={selectedSubmission.portfolioLink} target="_blank" rel="noopener noreferrer" className="px-4 py-2 bg-purple-100 hover:bg-purple-200 text-purple-800 font-bold rounded-lg text-sm transition-colors flex items-center gap-2">
                                üìÅ Portfolio
                              </a>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Contact Information */}
                    <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-xl">üìû</span>
                        <span>Contact Information</span>
                      </h3>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div className="bg-blue-50 rounded-lg p-4 border border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase">Email</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.officialEmail || 'Not provided'}</div>
                        </div>
                        <div className="bg-green-50 rounded-lg p-4 border border-green-200">
                          <div className="text-xs font-bold text-green-700 mb-2 uppercase">Phone</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.phone || 'Not provided'}</div>
                        </div>
                        <div className="bg-purple-50 rounded-lg p-4 border border-purple-200">
                          <div className="text-xs font-bold text-purple-700 mb-2 uppercase">Age</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.creatorAge || 'Not provided'}</div>
                        </div>
                      </div>
                    </div>

                    {/* Business Information */}
                    <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-xl">üè¢</span>
                        <span>Business Information</span>
                      </h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div className="bg-amber-50 rounded-lg p-4 border border-amber-200">
                          <div className="text-xs font-bold text-amber-700 mb-2 uppercase">PAN Number</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.panNumber || 'Not provided'}</div>
                        </div>
                        <div className="bg-teal-50 rounded-lg p-4 border border-teal-200">
                          <div className="text-xs font-bold text-teal-700 mb-2 uppercase">GST Number</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.gstNumber || 'Not provided'}</div>
                        </div>
                        <div className="bg-indigo-50 rounded-lg p-4 border border-indigo-200">
                          <div className="text-xs font-bold text-indigo-700 mb-2 uppercase">Company Type</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.companyType || 'Not provided'}</div>
                        </div>
                        <div className="bg-rose-50 rounded-lg p-4 border border-rose-200">
                          <div className="text-xs font-bold text-rose-700 mb-2 uppercase">Team Size</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.teamSize || 'Not provided'}</div>
                        </div>
                      </div>
                    </div>

                    {/* Address Information */}
                    <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-xl">üìç</span>
                        <span>Address Information</span>
                      </h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div className="bg-slate-50 rounded-lg p-4 border border-slate-200">
                          <div className="text-xs font-bold text-slate-700 mb-2 uppercase">Permanent Address</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.permanentAddress || 'Not provided'}</div>
                        </div>
                        <div className="bg-slate-50 rounded-lg p-4 border border-slate-200">
                          <div className="text-xs font-bold text-slate-700 mb-2 uppercase">Current Address</div>
                          <div className="text-base font-semibold text-gray-900">{selectedSubmission.currentAddress || 'Not provided'}</div>
                        </div>
                      </div>
                    </div>

                    {/* Emergency Contact */}
                    {(selectedSubmission.emergencyContactName || selectedSubmission.emergencyContactPhone) && (
                      <div className="bg-red-50 rounded-xl p-6 border-2 border-red-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üö®</span>
                          <span>Emergency Contact</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                          <div className="bg-white rounded-lg p-4 border border-red-200">
                            <div className="text-xs font-bold text-red-700 mb-2 uppercase">Name</div>
                            <div className="text-base font-semibold text-gray-900">{selectedSubmission.emergencyContactName || 'Not provided'}</div>
                          </div>
                          <div className="bg-white rounded-lg p-4 border border-red-200">
                            <div className="text-xs font-bold text-red-700 mb-2 uppercase">Relation</div>
                            <div className="text-base font-semibold text-gray-900">{selectedSubmission.emergencyContactRelation || 'Not provided'}</div>
                          </div>
                          <div className="bg-white rounded-lg p-4 border border-red-200">
                            <div className="text-xs font-bold text-red-700 mb-2 uppercase">Phone</div>
                            <div className="text-base font-semibold text-gray-900">{selectedSubmission.emergencyContactPhone || 'Not provided'}</div>
                          </div>
                        </div>
                      </div>
                    )}

                    {/* Previous Work */}
                    {(selectedSubmission.previousProjects || selectedSubmission.notableWorks) && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üèÜ</span>
                          <span>Previous Work & Portfolio</span>
                        </h3>
                        <div className="space-y-4">
                          {selectedSubmission.previousProjects && (
                            <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-5 border border-blue-200">
                              <div className="text-xs font-bold text-blue-700 mb-3 uppercase">Previous Projects</div>
                              <div className="text-base font-semibold text-gray-900">{selectedSubmission.previousProjects}</div>
                            </div>
                          )}
                          {selectedSubmission.notableWorks && (
                            <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-5 border border-purple-200">
                              <div className="text-xs font-bold text-purple-700 mb-3 uppercase">Notable Works</div>
                              <div className="text-base font-semibold text-gray-900">{selectedSubmission.notableWorks}</div>
                            </div>
                          )}
                        </div>
                      </div>
                    )}
                  </div>
                )}

                {/* Crew Tab */}
                {detailView === 'crew' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üé¨</span>
                        <div>
                          <h3 className="text-white font-black">Crew Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download crew information</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'crew')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'crew')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    <div className="bg-white rounded-xl p-5 border-2 border-gray-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üë•</span>
                        <span>Complete Crew List - All Departments</span>
                      </h3>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">

                        {/* Direction Department */}
                        {(selectedSubmission.director || selectedSubmission.associateDirector || selectedSubmission.assistantDirector1) && (
                          <div className="bg-gradient-to-br from-red-50 to-pink-50 border-2 border-red-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-red-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üé¨</span>
                              <span>DIRECTION DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.director && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Director</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.director}</div>
                                    {selectedSubmission.directorLink && (
                                      <a href={selectedSubmission.directorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.associateDirector && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Associate Director</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.associateDirector}</div>
                                    {selectedSubmission.associateDirectorLink && (
                                      <a href={selectedSubmission.associateDirectorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.assistantDirector1 && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Assistant Director</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.assistantDirector1}</div>
                                    {selectedSubmission.assistantDirector1Link && (
                                      <a href={selectedSubmission.assistantDirector1Link} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.assistantDirector2 && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Assistant Director 2</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.assistantDirector2}</div>
                                    {selectedSubmission.assistantDirector2Link && (
                                      <a href={selectedSubmission.assistantDirector2Link} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Production Department */}
                        {(selectedSubmission.headOfProduction || selectedSubmission.executiveProducer || selectedSubmission.lineProducer || selectedSubmission.productionController || selectedSubmission.unitProductionManager || selectedSubmission.locationManager) && (
                          <div className="bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-orange-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-orange-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üéØ</span>
                              <span>PRODUCTION DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.headOfProduction && (
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <div className="text-xs text-orange-600 font-bold mb-1">Head of Production</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.headOfProduction}</div>
                                    {selectedSubmission.headOfProductionLink && (
                                      <a href={selectedSubmission.headOfProductionLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.executiveProducer && (
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <div className="text-xs text-orange-600 font-bold mb-1">Executive Producer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.executiveProducer}</div>
                                    {selectedSubmission.executiveProducerLink && (
                                      <a href={selectedSubmission.executiveProducerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.lineProducer && (
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <div className="text-xs text-orange-600 font-bold mb-1">Line Producer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.lineProducer}</div>
                                    {selectedSubmission.lineProducerLink && (
                                      <a href={selectedSubmission.lineProducerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.productionController && (
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <div className="text-xs text-orange-600 font-bold mb-1">Production Controller</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.productionController}</div>
                                    {selectedSubmission.productionControllerLink && (
                                      <a href={selectedSubmission.productionControllerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.unitProductionManager && (
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <div className="text-xs text-orange-600 font-bold mb-1">Unit Production Manager</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.unitProductionManager}</div>
                                    {selectedSubmission.unitProductionManagerLink && (
                                      <a href={selectedSubmission.unitProductionManagerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.locationManager && (
                                <div className="bg-white rounded-lg p-3 border border-orange-200">
                                  <div className="text-xs text-orange-600 font-bold mb-1">Location Manager</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.locationManager}</div>
                                    {selectedSubmission.locationManagerLink && (
                                      <a href={selectedSubmission.locationManagerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-orange-100 hover:bg-orange-200 text-orange-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Creative Department */}
                        {(selectedSubmission.showRunner || selectedSubmission.creativeDirector || selectedSubmission.projectHead || selectedSubmission.associateCreativeDirector) && (
                          <div className="bg-gradient-to-br from-purple-50 to-indigo-50 border-2 border-purple-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-purple-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üí°</span>
                              <span>CREATIVE DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.showRunner && (
                                <div className="bg-white rounded-lg p-3 border border-purple-200">
                                  <div className="text-xs text-purple-600 font-bold mb-1">Show Runner</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.showRunner}</div>
                                    {selectedSubmission.showRunnerLink && (
                                      <a href={selectedSubmission.showRunnerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-purple-100 hover:bg-purple-200 text-purple-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.projectHead && (
                                <div className="bg-white rounded-lg p-3 border border-purple-200">
                                  <div className="text-xs text-purple-600 font-bold mb-1">Project Head</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.projectHead}</div>
                                    {selectedSubmission.projectHeadLink && (
                                      <a href={selectedSubmission.projectHeadLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-purple-100 hover:bg-purple-200 text-purple-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.creativeDirector && (
                                <div className="bg-white rounded-lg p-3 border border-purple-200">
                                  <div className="text-xs text-purple-600 font-bold mb-1">Creative Director</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.creativeDirector}</div>
                                    {selectedSubmission.creativeDirectorLink && (
                                      <a href={selectedSubmission.creativeDirectorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-purple-100 hover:bg-purple-200 text-purple-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.associateCreativeDirector && (
                                <div className="bg-white rounded-lg p-3 border border-purple-200">
                                  <div className="text-xs text-purple-600 font-bold mb-1">Associate Creative Director</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.associateCreativeDirector}</div>
                                    {selectedSubmission.associateCreativeDirectorLink && (
                                      <a href={selectedSubmission.associateCreativeDirectorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-purple-100 hover:bg-purple-200 text-purple-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Writing Department */}
                        {(selectedSubmission.writer || selectedSubmission.storyBy || selectedSubmission.screenplayBy || selectedSubmission.dialoguesBy) && (
                          <div className="bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-yellow-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>‚úçÔ∏è</span>
                              <span>WRITING DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.writer && (
                                <div className="bg-white rounded-lg p-3 border border-yellow-200">
                                  <div className="text-xs text-yellow-600 font-bold mb-1">Writer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.writer}</div>
                                    {selectedSubmission.writerLink && (
                                      <a href={selectedSubmission.writerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.storyBy && (
                                <div className="bg-white rounded-lg p-3 border border-yellow-200">
                                  <div className="text-xs text-yellow-600 font-bold mb-1">Story By</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.storyBy}</div>
                                    {selectedSubmission.storyByLink && (
                                      <a href={selectedSubmission.storyByLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.screenplayBy && (
                                <div className="bg-white rounded-lg p-3 border border-yellow-200">
                                  <div className="text-xs text-yellow-600 font-bold mb-1">Screenplay By</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.screenplayBy}</div>
                                    {selectedSubmission.screenplayByLink && (
                                      <a href={selectedSubmission.screenplayByLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.dialoguesBy && (
                                <div className="bg-white rounded-lg p-3 border border-yellow-200">
                                  <div className="text-xs text-yellow-600 font-bold mb-1">Dialogues By</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.dialoguesBy}</div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Camera Department */}
                        {(selectedSubmission.dop || selectedSubmission.firstCameraOperator || selectedSubmission.steadicamOperator) && (
                          <div className="bg-gradient-to-br from-blue-50 to-cyan-50 border-2 border-blue-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-blue-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üìπ</span>
                              <span>CAMERA DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.dop && (
                                <div className="bg-white rounded-lg p-3 border border-blue-200">
                                  <div className="text-xs text-blue-600 font-bold mb-1">Director of Photography</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.dop}</div>
                                    {selectedSubmission.dopLink && (
                                      <a href={selectedSubmission.dopLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.firstCameraOperator && (
                                <div className="bg-white rounded-lg p-3 border border-blue-200">
                                  <div className="text-xs text-blue-600 font-bold mb-1">1st Camera Operator</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.firstCameraOperator}</div>
                                    {selectedSubmission.firstCameraOperatorLink && (
                                      <a href={selectedSubmission.firstCameraOperatorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.steadicamOperator && (
                                <div className="bg-white rounded-lg p-3 border border-blue-200">
                                  <div className="text-xs text-blue-600 font-bold mb-1">Steadicam Operator</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.steadicamOperator}</div>
                                    {selectedSubmission.steadicamOperatorLink && (
                                      <a href={selectedSubmission.steadicamOperatorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Editing Department */}
                        {(selectedSubmission.editor || selectedSubmission.colorist || selectedSubmission.onLocationEditor) && (
                          <div className="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-green-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>‚úÇÔ∏è</span>
                              <span>EDITING DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.editor && (
                                <div className="bg-white rounded-lg p-3 border border-green-200">
                                  <div className="text-xs text-green-600 font-bold mb-1">Editor</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.editor}</div>
                                    {selectedSubmission.editorLink && (
                                      <a href={selectedSubmission.editorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-green-100 hover:bg-green-200 text-green-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.colorist && (
                                <div className="bg-white rounded-lg p-3 border border-green-200">
                                  <div className="text-xs text-green-600 font-bold mb-1">Colorist</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.colorist}</div>
                                    {selectedSubmission.coloristLink && (
                                      <a href={selectedSubmission.coloristLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-green-100 hover:bg-green-200 text-green-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.onLocationEditor && (
                                <div className="bg-white rounded-lg p-3 border border-green-200">
                                  <div className="text-xs text-green-600 font-bold mb-1">On-Location Editor</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.onLocationEditor}</div>
                                    {selectedSubmission.onLocationEditorLink && (
                                      <a href={selectedSubmission.onLocationEditorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-green-100 hover:bg-green-200 text-green-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Sound Department */}
                        {(selectedSubmission.soundRecordist || selectedSubmission.soundDesigner || selectedSubmission.foleyArtist) && (
                          <div className="bg-gradient-to-br from-indigo-50 to-purple-50 border-2 border-indigo-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-indigo-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üéôÔ∏è</span>
                              <span>SOUND DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.soundRecordist && (
                                <div className="bg-white rounded-lg p-3 border border-indigo-200">
                                  <div className="text-xs text-indigo-600 font-bold mb-1">Sound Recordist</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.soundRecordist}</div>
                                    {selectedSubmission.soundRecordistLink && (
                                      <a href={selectedSubmission.soundRecordistLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.soundDesigner && (
                                <div className="bg-white rounded-lg p-3 border border-indigo-200">
                                  <div className="text-xs text-indigo-600 font-bold mb-1">Sound Designer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.soundDesigner}</div>
                                    {selectedSubmission.soundDesignerLink && (
                                      <a href={selectedSubmission.soundDesignerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.foleyArtist && (
                                <div className="bg-white rounded-lg p-3 border border-indigo-200">
                                  <div className="text-xs text-indigo-600 font-bold mb-1">Foley Artist</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.foleyArtist}</div>
                                    {selectedSubmission.foleyArtistLink && (
                                      <a href={selectedSubmission.foleyArtistLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Music Department */}
                        {(selectedSubmission.musicComposer || selectedSubmission.bgmComposer || selectedSubmission.playbackSinger) && (
                          <div className="bg-gradient-to-br from-pink-50 to-rose-50 border-2 border-pink-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-pink-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üéµ</span>
                              <span>MUSIC DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.musicComposer && (
                                <div className="bg-white rounded-lg p-3 border border-pink-200">
                                  <div className="text-xs text-pink-600 font-bold mb-1">Music Composer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.musicComposer}</div>
                                    {selectedSubmission.musicComposerLink && (
                                      <a href={selectedSubmission.musicComposerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-pink-100 hover:bg-pink-200 text-pink-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.bgmComposer && (
                                <div className="bg-white rounded-lg p-3 border border-pink-200">
                                  <div className="text-xs text-pink-600 font-bold mb-1">BGM Composer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.bgmComposer}</div>
                                    {selectedSubmission.bgmComposerLink && (
                                      <a href={selectedSubmission.bgmComposerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-pink-100 hover:bg-pink-200 text-pink-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.playbackSinger && (
                                <div className="bg-white rounded-lg p-3 border border-pink-200">
                                  <div className="text-xs text-pink-600 font-bold mb-1">Playback Singer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.playbackSinger}</div>
                                    {selectedSubmission.playbackSingerLink && (
                                      <a href={selectedSubmission.playbackSingerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-pink-100 hover:bg-pink-200 text-pink-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Art Department */}
                        {(selectedSubmission.productionDesigner || selectedSubmission.artDirector || selectedSubmission.setDesigner) && (
                          <div className="bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-amber-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üé®</span>
                              <span>ART DEPARTMENT</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.productionDesigner && (
                                <div className="bg-white rounded-lg p-3 border border-amber-200">
                                  <div className="text-xs text-amber-600 font-bold mb-1">Production Designer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.productionDesigner}</div>
                                    {selectedSubmission.productionDesignerLink && (
                                      <a href={selectedSubmission.productionDesignerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-amber-100 hover:bg-amber-200 text-amber-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.artDirector && (
                                <div className="bg-white rounded-lg p-3 border border-amber-200">
                                  <div className="text-xs text-amber-600 font-bold mb-1">Art Director</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.artDirector}</div>
                                    {selectedSubmission.artDirectorLink && (
                                      <a href={selectedSubmission.artDirectorLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-amber-100 hover:bg-amber-200 text-amber-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.setDesigner && (
                                <div className="bg-white rounded-lg p-3 border border-amber-200">
                                  <div className="text-xs text-amber-600 font-bold mb-1">Set Designer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.setDesigner}</div>
                                    {selectedSubmission.setDesignerLink && (
                                      <a href={selectedSubmission.setDesignerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-amber-100 hover:bg-amber-200 text-amber-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Costume & Makeup */}
                        {(selectedSubmission.costumeDesigner || selectedSubmission.makeupArtist || selectedSubmission.hairStylist) && (
                          <div className="bg-gradient-to-br from-rose-50 to-pink-50 border-2 border-rose-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-rose-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üëó</span>
                              <span>COSTUME & MAKEUP</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.costumeDesigner && (
                                <div className="bg-white rounded-lg p-3 border border-rose-200">
                                  <div className="text-xs text-rose-600 font-bold mb-1">Costume Designer</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.costumeDesigner}</div>
                                    {selectedSubmission.costumeDesignerLink && (
                                      <a href={selectedSubmission.costumeDesignerLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.makeupArtist && (
                                <div className="bg-white rounded-lg p-3 border border-rose-200">
                                  <div className="text-xs text-rose-600 font-bold mb-1">Makeup Artist</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.makeupArtist}</div>
                                    {selectedSubmission.makeupArtistLink && (
                                      <a href={selectedSubmission.makeupArtistLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                              {selectedSubmission.hairStylist && (
                                <div className="bg-white rounded-lg p-3 border border-rose-200">
                                  <div className="text-xs text-rose-600 font-bold mb-1">Hair Stylist</div>
                                  <div className="flex items-center justify-between">
                                    <div className="text-base font-bold text-gray-900">{selectedSubmission.hairStylist}</div>
                                    {selectedSubmission.hairStylistLink && (
                                      <a href={selectedSubmission.hairStylistLink} target="_blank" rel="noopener noreferrer" className="flex items-center gap-1 px-2 py-1 bg-rose-100 hover:bg-rose-200 text-rose-700 text-xs font-bold rounded-lg transition-colors">
                                        <span>üîó</span> Profile
                                      </a>
                                    )}
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* VFX & Post Production */}
                        {(selectedSubmission.vfxSupervisor || selectedSubmission.diArtist) && (
                          <div className="bg-gradient-to-br from-cyan-50 to-blue-50 border-2 border-cyan-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-cyan-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>‚ú®</span>
                              <span>VFX & POST PRODUCTION</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.vfxSupervisor && (
                                <div className="bg-white rounded-lg p-3 border border-cyan-200">
                                  <div className="text-xs text-cyan-600 font-bold mb-1">VFX Supervisor</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.vfxSupervisor}</div>
                                </div>
                              )}
                              {selectedSubmission.diArtist && (
                                <div className="bg-white rounded-lg p-3 border border-cyan-200">
                                  <div className="text-xs text-cyan-600 font-bold mb-1">DI Artist</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.diArtist}</div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Action & Choreography */}
                        {(selectedSubmission.actionDirector || selectedSubmission.stuntCoordinator || selectedSubmission.choreographer) && (
                          <div className="bg-gradient-to-br from-red-50 to-orange-50 border-2 border-red-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-red-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üí•</span>
                              <span>ACTION & CHOREOGRAPHY</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.actionDirector && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Action Director</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.actionDirector}</div>
                                </div>
                              )}
                              {selectedSubmission.stuntCoordinator && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Stunt Coordinator</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.stuntCoordinator}</div>
                                </div>
                              )}
                              {selectedSubmission.choreographer && (
                                <div className="bg-white rounded-lg p-3 border border-red-200">
                                  <div className="text-xs text-red-600 font-bold mb-1">Choreographer</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.choreographer}</div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}

                        {/* Casting */}
                        {selectedSubmission.castingDirector && (
                          <div className="bg-gradient-to-br from-violet-50 to-purple-50 border-2 border-violet-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-violet-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üé≠</span>
                              <span>CASTING</span>
                            </div>
                            <div className="space-y-3">
                              <div className="bg-white rounded-lg p-3 border border-violet-200">
                                <div className="text-xs text-violet-600 font-bold mb-1">Casting Director</div>
                                <div className="text-base font-bold text-gray-900">{selectedSubmission.castingDirector}</div>
                              </div>
                            </div>
                          </div>
                        )}

                        {/* Photography & Documentation */}
                        {(selectedSubmission.stillPhotographer || selectedSubmission.btsVideographer) && (
                          <div className="bg-gradient-to-br from-teal-50 to-cyan-50 border-2 border-teal-200 rounded-xl p-5">
                            <div className="text-xs font-bold text-teal-700 mb-4 flex items-center gap-2 uppercase tracking-wide">
                              <span>üì∏</span>
                              <span>PHOTOGRAPHY & DOCUMENTATION</span>
                            </div>
                            <div className="space-y-3">
                              {selectedSubmission.stillPhotographer && (
                                <div className="bg-white rounded-lg p-3 border border-teal-200">
                                  <div className="text-xs text-teal-600 font-bold mb-1">Still Photographer</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.stillPhotographer}</div>
                                </div>
                              )}
                              {selectedSubmission.btsVideographer && (
                                <div className="bg-white rounded-lg p-3 border border-teal-200">
                                  <div className="text-xs text-teal-600 font-bold mb-1">BTS Videographer</div>
                                  <div className="text-base font-bold text-gray-900">{selectedSubmission.btsVideographer}</div>
                                </div>
                              )}
                            </div>
                          </div>
                        )}
                      </div>

                      {/* Empty State */}
                      {!selectedSubmission.director && !selectedSubmission.dop && !selectedSubmission.editor && (
                        <div className="text-center py-12 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300">
                          <div className="text-6xl mb-4">üë•</div>
                          <div className="text-xl font-bold text-gray-700">No crew members added yet</div>
                          <div className="text-sm text-gray-500 mt-2 font-semibold">Crew details will appear here once submitted</div>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Timeline Tab */}
                {detailView === 'timeline' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üìÖ</span>
                        <div>
                          <h3 className="text-white font-black">Timeline Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download project schedule</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'timeline')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'timeline')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* Development Phase */}
                    <div className="bg-white rounded-xl p-5 border-2 border-purple-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üìù</span>
                        <span>Development Phase</span>
                      </h3>
                      <div className="grid md:grid-cols-2 gap-4">
                        <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border-2 border-purple-200">
                          <div className="text-xs font-bold text-purple-700 mb-2 uppercase tracking-wide">Detailed Screenplay Submission</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.detailedScreenplaySubmission ? formatDateLong(selectedSubmission.contentTimeline.detailedScreenplaySubmission) : 'Not set'}
                          </div>
                          {selectedSubmission.contentTimeline?.detailedScreenplayComments && (
                            <div className="mt-2 text-sm text-gray-600 bg-white/50 p-2 rounded-lg">
                              üí¨ {selectedSubmission.contentTimeline.detailedScreenplayComments}
                            </div>
                          )}
                        </div>
                        <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border-2 border-purple-200">
                          <div className="text-xs font-bold text-purple-700 mb-2 uppercase tracking-wide">Final Script Submission</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.scriptSubmission ? formatDateLong(selectedSubmission.contentTimeline.scriptSubmission) : 'Not set'}
                          </div>
                          {selectedSubmission.contentTimeline?.scriptComments && (
                            <div className="mt-2 text-sm text-gray-600 bg-white/50 p-2 rounded-lg">
                              üí¨ {selectedSubmission.contentTimeline.scriptComments}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Pre-Production Phase */}
                    <div className="bg-white rounded-xl p-5 border-2 border-blue-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üéØ</span>
                        <span>Pre-Production Phase</span>
                      </h3>
                      <div className="grid md:grid-cols-3 gap-4">
                        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">Start Date</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.preProductionStart ? formatDateLong(selectedSubmission.contentTimeline.preProductionStart) : 'Not set'}
                          </div>
                        </div>
                        <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-200">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">End Date</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.preProductionEnd ? formatDateLong(selectedSubmission.contentTimeline.preProductionEnd) : 'Not set'}
                          </div>
                        </div>
                        <div className="bg-gradient-to-r from-blue-100 to-indigo-100 rounded-xl p-4 border-2 border-blue-300">
                          <div className="text-xs font-bold text-blue-700 mb-2 uppercase tracking-wide">Duration</div>
                          <div className="text-lg font-black text-blue-900">
                            {selectedSubmission.contentTimeline?.preProductionDuration || 'Not calculated'}
                          </div>
                        </div>
                      </div>
                      {selectedSubmission.contentTimeline?.preProductionComments && (
                        <div className="mt-4 text-sm text-gray-600 bg-blue-50 p-3 rounded-lg border border-blue-200">
                          üí¨ {selectedSubmission.contentTimeline.preProductionComments}
                        </div>
                      )}
                    </div>

                    {/* Production Phase (Principal Photography) */}
                    <div className="bg-white rounded-xl p-5 border-2 border-green-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üé¨</span>
                        <span>Production Phase (Principal Photography)</span>
                      </h3>
                      <div className="grid md:grid-cols-3 gap-4">
                        <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border-2 border-green-200">
                          <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">Shoot Start Date</div>
                          <div className="text-lg font-bold text-gray-900">
                            {(selectedSubmission.contentTimeline?.shootStartDate || selectedSubmission.shootStartDate) ? formatDateLong(selectedSubmission.contentTimeline?.shootStartDate || selectedSubmission.shootStartDate) : 'Not set'}
                          </div>
                        </div>
                        <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border-2 border-green-200">
                          <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">Shoot End Date</div>
                          <div className="text-lg font-bold text-gray-900">
                            {(selectedSubmission.contentTimeline?.shootEndDate || selectedSubmission.shootEndDate) ? formatDateLong(selectedSubmission.contentTimeline?.shootEndDate || selectedSubmission.shootEndDate) : 'Not set'}
                          </div>
                        </div>
                        <div className="bg-gradient-to-r from-green-100 to-emerald-100 rounded-xl p-4 border-2 border-green-300">
                          <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">Total Shoot Days</div>
                          <div className="text-lg font-black text-green-900">
                            {selectedSubmission.contentTimeline?.shootDays || selectedSubmission.shootDays || 'Not calculated'}
                          </div>
                        </div>
                      </div>
                      {selectedSubmission.contentTimeline?.principalPhotographyComments && (
                        <div className="mt-4 text-sm text-gray-600 bg-green-50 p-3 rounded-lg border border-green-200">
                          üí¨ {selectedSubmission.contentTimeline.principalPhotographyComments}
                        </div>
                      )}
                    </div>

                    {/* Post-Production Phase */}
                    <div className="bg-white rounded-xl p-5 border-2 border-amber-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">‚úÇÔ∏è</span>
                        <span>Post-Production Phase</span>
                      </h3>

                      {/* First Cut */}
                      <div className="mb-4">
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border-2 border-amber-200">
                          <div className="text-xs font-bold text-amber-700 mb-2 uppercase tracking-wide">First Cut for STAGE QC</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.firstCutDate ? formatDateLong(selectedSubmission.contentTimeline.firstCutDate) : 'Not set'}
                          </div>
                          {selectedSubmission.contentTimeline?.firstCutComments && (
                            <div className="mt-2 text-sm text-gray-600 bg-white/50 p-2 rounded-lg">
                              üí¨ {selectedSubmission.contentTimeline.firstCutComments}
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Post-Production Duration */}
                      <div className="grid md:grid-cols-3 gap-4">
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border-2 border-amber-200">
                          <div className="text-xs font-bold text-amber-700 mb-2 uppercase tracking-wide">Post-Production Start</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.postProductionStart ? formatDateLong(selectedSubmission.contentTimeline.postProductionStart) : 'Not set'}
                          </div>
                        </div>
                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border-2 border-amber-200">
                          <div className="text-xs font-bold text-amber-700 mb-2 uppercase tracking-wide">Post-Production End</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.postProductionEnd ? formatDateLong(selectedSubmission.contentTimeline.postProductionEnd) : 'Not set'}
                          </div>
                        </div>
                        <div className="bg-gradient-to-r from-amber-100 to-orange-100 rounded-xl p-4 border-2 border-amber-300">
                          <div className="text-xs font-bold text-amber-700 mb-2 uppercase tracking-wide">Duration</div>
                          <div className="text-lg font-black text-amber-900">
                            {selectedSubmission.contentTimeline?.postProductionDuration || 'Not calculated'}
                          </div>
                        </div>
                      </div>
                      {selectedSubmission.contentTimeline?.postProductionComments && (
                        <div className="mt-4 text-sm text-gray-600 bg-amber-50 p-3 rounded-lg border border-amber-200">
                          üí¨ {selectedSubmission.contentTimeline.postProductionComments}
                        </div>
                      )}
                    </div>

                    {/* Final Delivery */}
                    <div className="bg-white rounded-xl p-5 border-2 border-rose-200 shadow-lg">
                      <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-2xl">üéâ</span>
                        <span>Final Delivery</span>
                      </h3>
                      <div className="grid md:grid-cols-2 gap-4">
                        <div className="bg-gradient-to-r from-rose-50 to-pink-50 rounded-xl p-4 border-2 border-rose-200">
                          <div className="text-xs font-bold text-rose-700 mb-2 uppercase tracking-wide">Final Cut for QC Date</div>
                          <div className="text-lg font-bold text-gray-900">
                            {selectedSubmission.contentTimeline?.finalCutQCDate ? formatDateLong(selectedSubmission.contentTimeline.finalCutQCDate) : 'Not set'}
                          </div>
                          {selectedSubmission.contentTimeline?.finalCutComments && (
                            <div className="mt-2 text-sm text-gray-600 bg-white/50 p-2 rounded-lg">
                              üí¨ {selectedSubmission.contentTimeline.finalCutComments}
                            </div>
                          )}
                        </div>
                        <div className="bg-gradient-to-r from-green-100 to-emerald-100 rounded-xl p-4 border-2 border-green-300">
                          <div className="text-xs font-bold text-green-700 mb-2 uppercase tracking-wide">Final Project Delivery</div>
                          <div className="text-lg font-black text-green-900">
                            {(selectedSubmission.contentTimeline?.finalDeliveryDate || selectedSubmission.finalDeliveryDate) ? formatDateLong(selectedSubmission.contentTimeline?.finalDeliveryDate || selectedSubmission.finalDeliveryDate) : 'Not set'}
                          </div>
                          {selectedSubmission.contentTimeline?.finalDeliveryComments && (
                            <div className="mt-2 text-sm text-gray-600 bg-white/50 p-2 rounded-lg">
                              üí¨ {selectedSubmission.contentTimeline.finalDeliveryComments}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Cast Tab */}
                {detailView === 'cast' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">‚≠ê</span>
                        <div>
                          <h3 className="text-white font-black">Cast Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download cast information</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'cast')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'cast')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* Cast Overview */}
                    <div className="bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl p-8 border-2 border-pink-200 shadow-lg">
                      <div className="flex items-center justify-between mb-6">
                        <h2 className="text-2xl font-black text-gray-900 flex items-center gap-3">
                          <span className="text-3xl">‚≠ê</span>
                          <span>Cast Members</span>
                        </h2>
                        <div className="flex gap-3">
                          <div className="px-4 py-2 bg-pink-100 rounded-lg border border-pink-300">
                            <div className="text-xs font-bold text-pink-700">Primary</div>
                            <div className="text-xl font-black text-pink-900">{selectedSubmission.castData?.primaryCast?.length || 0}</div>
                          </div>
                          <div className="px-4 py-2 bg-purple-100 rounded-lg border border-purple-300">
                            <div className="text-xs font-bold text-purple-700">Secondary</div>
                            <div className="text-xl font-black text-purple-900">{selectedSubmission.castData?.secondaryCast?.length || 0}</div>
                          </div>
                          <div className="px-4 py-2 bg-blue-100 rounded-lg border border-blue-300">
                            <div className="text-xs font-bold text-blue-700">Others</div>
                            <div className="text-xl font-black text-blue-900">{selectedSubmission.castData?.tertiaryCast?.length || 0}</div>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Primary Cast */}
                    {selectedSubmission.castData?.primaryCast && selectedSubmission.castData.primaryCast.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üåü</span>
                          <span>Primary Cast ({selectedSubmission.castData.primaryCast.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {selectedSubmission.castData.primaryCast.map((cast: any, idx: number) => (
                            <div key={idx} className="bg-gradient-to-r from-pink-50 to-rose-50 rounded-xl border-2 border-pink-200 overflow-hidden hover:shadow-lg transition-all">
                              <div className="flex">
                                {/* Photo */}
                                <div className="w-32 h-32 flex-shrink-0 bg-pink-100 flex items-center justify-center">
                                  {cast.photographUrl ? (
                                    <img src={cast.photographUrl} alt={cast.artistName} className="w-full h-full object-cover" />
                                  ) : (
                                    <span className="text-4xl">üë§</span>
                                  )}
                                </div>
                                {/* Details */}
                                <div className="flex-1 p-4">
                                  <div className="flex items-start justify-between">
                                    <div>
                                      <div className="text-lg font-black text-gray-900">{cast.artistName || 'Unknown Artist'}</div>
                                      <div className="text-sm text-pink-700 font-semibold">as {cast.characterName || 'N/A'}</div>
                                    </div>
                                    <span className="px-2 py-1 bg-pink-200 text-pink-800 text-xs font-bold rounded-full">PRIMARY</span>
                                  </div>

                                  {/* Links & Actions */}
                                  <div className="mt-3 flex flex-wrap gap-2">
                                    {cast.socialMediaLink && (
                                      <a href={cast.socialMediaLink} target="_blank" rel="noopener noreferrer" className="px-3 py-1.5 bg-gradient-to-r from-pink-500 to-rose-500 text-white text-xs font-bold rounded-lg hover:shadow-md transition-all flex items-center gap-1">
                                        üîó Profile/Portfolio
                                      </a>
                                    )}
                                    {cast.photographUrl && (
                                      <a href={cast.photographUrl} target="_blank" rel="noopener noreferrer" className="px-3 py-1.5 bg-gradient-to-r from-blue-500 to-indigo-500 text-white text-xs font-bold rounded-lg hover:shadow-md transition-all flex items-center gap-1">
                                        üì∑ View Photo
                                      </a>
                                    )}
                                  </div>

                                  {(cast.days || cast.remuneration) && (
                                    <div className="mt-2 pt-2 border-t border-pink-200 flex gap-4 text-sm">
                                      {cast.days && <span className="text-gray-600 font-semibold">üìÖ {cast.days} days</span>}
                                      {cast.remuneration && <span className="text-green-600 font-bold">‚Çπ{cast.remuneration.toLocaleString('en-IN')}</span>}
                                    </div>
                                  )}
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Secondary Cast */}
                    {selectedSubmission.castData?.secondaryCast && selectedSubmission.castData.secondaryCast.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">‚ú®</span>
                          <span>Secondary Cast ({selectedSubmission.castData.secondaryCast.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                          {selectedSubmission.castData.secondaryCast.map((cast: any, idx: number) => (
                            <div key={idx} className="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl border-2 border-purple-200 overflow-hidden hover:shadow-lg transition-all">
                              <div className="flex">
                                {/* Photo */}
                                <div className="w-20 h-20 flex-shrink-0 bg-purple-100 flex items-center justify-center">
                                  {cast.photographUrl ? (
                                    <img src={cast.photographUrl} alt={cast.artistName} className="w-full h-full object-cover" />
                                  ) : (
                                    <span className="text-2xl">üë§</span>
                                  )}
                                </div>
                                {/* Details */}
                                <div className="flex-1 p-3">
                                  <div className="text-base font-black text-gray-900">{cast.artistName || 'Unknown'}</div>
                                  <div className="text-sm text-purple-700 font-semibold">as {cast.characterName || 'N/A'}</div>
                                  <div className="mt-2 flex gap-2">
                                    {cast.socialMediaLink && (
                                      <a href={cast.socialMediaLink} target="_blank" rel="noopener noreferrer" className="px-2 py-1 bg-purple-500 text-white text-xs font-bold rounded hover:shadow-md transition-all">
                                        üîó Profile
                                      </a>
                                    )}
                                    {cast.photographUrl && (
                                      <a href={cast.photographUrl} target="_blank" rel="noopener noreferrer" className="px-2 py-1 bg-blue-500 text-white text-xs font-bold rounded hover:shadow-md transition-all">
                                        üì∑
                                      </a>
                                    )}
                                  </div>
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Tertiary Cast */}
                    {selectedSubmission.castData?.tertiaryCast && selectedSubmission.castData.tertiaryCast.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üë•</span>
                          <span>Other Cast ({selectedSubmission.castData.tertiaryCast.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                          {selectedSubmission.castData.tertiaryCast.map((cast: any, idx: number) => (
                            <div key={idx} className="bg-gradient-to-r from-blue-50 to-cyan-50 rounded-xl border-2 border-blue-200 overflow-hidden hover:shadow-lg transition-all">
                              <div className="flex">
                                {/* Photo */}
                                <div className="w-16 h-16 flex-shrink-0 bg-blue-100 flex items-center justify-center">
                                  {cast.photographUrl ? (
                                    <img src={cast.photographUrl} alt={cast.artistName} className="w-full h-full object-cover" />
                                  ) : (
                                    <span className="text-xl">üë§</span>
                                  )}
                                </div>
                                {/* Details */}
                                <div className="flex-1 p-2">
                                  <div className="text-sm font-bold text-gray-900">{cast.artistName || 'Unknown'}</div>
                                  <div className="text-xs text-blue-700">as {cast.characterName || 'N/A'}</div>
                                  {(cast.socialMediaLink || cast.photographUrl) && (
                                    <div className="mt-1 flex gap-1">
                                      {cast.socialMediaLink && (
                                        <a href={cast.socialMediaLink} target="_blank" rel="noopener noreferrer" className="text-blue-600 text-xs font-bold hover:underline">üîó</a>
                                      )}
                                      {cast.photographUrl && (
                                        <a href={cast.photographUrl} target="_blank" rel="noopener noreferrer" className="text-blue-600 text-xs font-bold hover:underline">üì∑</a>
                                      )}
                                    </div>
                                  )}
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Empty State */}
                    {(!selectedSubmission.castData || (!selectedSubmission.castData.primaryCast?.length && !selectedSubmission.castData.secondaryCast?.length && !selectedSubmission.castData.tertiaryCast?.length)) && (
                      <div className="bg-gray-50 rounded-xl p-12 border-2 border-dashed border-gray-300 text-center">
                        <div className="text-6xl mb-4">‚≠ê</div>
                        <div className="text-xl font-bold text-gray-700">No cast members added</div>
                        <div className="text-sm text-gray-500 font-semibold mt-2">Cast details will appear here once submitted</div>
                      </div>
                    )}
                  </div>
                )}

                {/* Technical Tab */}
                {detailView === 'technical' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üìπ</span>
                        <div>
                          <h3 className="text-white font-black">Technical Specs</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download technical details</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'technical')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'technical')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* Technical Overview */}
                    <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-8 border-2 border-amber-200 shadow-lg">
                      <h2 className="text-2xl font-black text-gray-900 mb-6 flex items-center gap-3">
                        <span className="text-3xl">üìπ</span>
                        <span>Technical Specifications</span>
                      </h2>

                      {selectedSubmission.technicalSpecs ? (
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                          {/* Camera */}
                          {selectedSubmission.technicalSpecs.cameraModel && (
                            <div className="bg-white rounded-xl p-5 border-2 border-amber-200">
                              <div className="text-xs font-bold text-amber-700 mb-2 uppercase">Camera Model</div>
                              <div className="text-lg font-black text-gray-900">{selectedSubmission.technicalSpecs.cameraModel}</div>
                              {selectedSubmission.technicalSpecs.cameraSetupType && (
                                <div className="text-sm text-gray-600 font-semibold mt-1 capitalize">{selectedSubmission.technicalSpecs.cameraSetupType} Camera Setup</div>
                              )}
                            </div>
                          )}

                          {/* Camera Setup Type */}
                          {selectedSubmission.technicalSpecs.cameraSetupType && !selectedSubmission.technicalSpecs.cameraModel && (
                            <div className="bg-white rounded-xl p-5 border-2 border-amber-200">
                              <div className="text-xs font-bold text-amber-700 mb-2 uppercase">Camera Setup</div>
                              <div className="text-lg font-black text-gray-900 capitalize">{selectedSubmission.technicalSpecs.cameraSetupType} Camera</div>
                            </div>
                          )}
                        </div>
                      ) : (
                        <div className="text-center py-8 text-gray-500 font-semibold">No technical specifications provided</div>
                      )}
                    </div>

                    {/* Lenses */}
                    {selectedSubmission.technicalSpecs?.lensTypes?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üî≠</span>
                          <span>Lenses ({selectedSubmission.technicalSpecs.lensTypes.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.lensTypes.map((lens: any, idx: number) => (
                            <div key={idx} className="bg-blue-50 border border-blue-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-blue-800">{typeof lens === 'string' ? lens : lens.name || 'Unknown'}</span>
                              {typeof lens !== 'string' && lens.quantity && (
                                <span className="px-2 py-1 bg-blue-200 text-blue-900 text-xs font-bold rounded">x{lens.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Camera Others */}
                    {selectedSubmission.technicalSpecs?.cameraOthers?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üì∑</span>
                          <span>Other Camera Equipment ({selectedSubmission.technicalSpecs.cameraOthers.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.cameraOthers.map((item: any, idx: number) => (
                            <div key={idx} className="bg-cyan-50 border border-cyan-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-cyan-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-cyan-200 text-cyan-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Lighting Equipment */}
                    {selectedSubmission.technicalSpecs?.lightingEquipment?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üí°</span>
                          <span>Lighting Equipment ({selectedSubmission.technicalSpecs.lightingEquipment.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.lightingEquipment.map((item: any, idx: number) => (
                            <div key={idx} className="bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-yellow-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-yellow-200 text-yellow-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Lighting Others */}
                    {selectedSubmission.technicalSpecs?.lightingOthers?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üîÜ</span>
                          <span>Other Lighting Equipment ({selectedSubmission.technicalSpecs.lightingOthers.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.lightingOthers.map((item: any, idx: number) => (
                            <div key={idx} className="bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-amber-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-amber-200 text-amber-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Cinematic Tools */}
                    {selectedSubmission.technicalSpecs?.cinematicTools?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üé¨</span>
                          <span>Cinematic Tools ({selectedSubmission.technicalSpecs.cinematicTools.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.cinematicTools.map((item: any, idx: number) => (
                            <div key={idx} className="bg-purple-50 border border-purple-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-purple-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-purple-200 text-purple-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Cinematic Others */}
                    {selectedSubmission.technicalSpecs?.cinematicOthers?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üéûÔ∏è</span>
                          <span>Other Cinematic Equipment ({selectedSubmission.technicalSpecs.cinematicOthers.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.cinematicOthers.map((item: any, idx: number) => (
                            <div key={idx} className="bg-violet-50 border border-violet-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-violet-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-violet-200 text-violet-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Drones */}
                    {selectedSubmission.technicalSpecs?.droneModels?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üöÅ</span>
                          <span>Drones ({selectedSubmission.technicalSpecs.droneModels.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.droneModels.map((drone: any, idx: number) => (
                            <div key={idx} className="bg-indigo-50 border border-indigo-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-indigo-800">{typeof drone === 'string' ? drone : drone.name || 'Unknown'}</span>
                              {typeof drone !== 'string' && drone.quantity && (
                                <span className="px-2 py-1 bg-indigo-200 text-indigo-900 text-xs font-bold rounded">x{drone.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Drone Others */}
                    {selectedSubmission.technicalSpecs?.droneOthers?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üéÆ</span>
                          <span>Other Drone Equipment ({selectedSubmission.technicalSpecs.droneOthers.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.droneOthers.map((item: any, idx: number) => (
                            <div key={idx} className="bg-sky-50 border border-sky-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-sky-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-sky-200 text-sky-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Sound Equipment */}
                    {selectedSubmission.technicalSpecs?.soundEquipment?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üé§</span>
                          <span>Sound Equipment ({selectedSubmission.technicalSpecs.soundEquipment.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.soundEquipment.map((item: any, idx: number) => (
                            <div key={idx} className="bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-green-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-green-200 text-green-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Sound Others */}
                    {selectedSubmission.technicalSpecs?.soundOthers?.length > 0 && (
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üîä</span>
                          <span>Other Sound Equipment ({selectedSubmission.technicalSpecs.soundOthers.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                          {selectedSubmission.technicalSpecs.soundOthers.map((item: any, idx: number) => (
                            <div key={idx} className="bg-emerald-50 border border-emerald-200 rounded-lg p-3 flex items-center justify-between">
                              <span className="font-bold text-emerald-800">{typeof item === 'string' ? item : item.name || 'Unknown'}</span>
                              {typeof item !== 'string' && item.quantity && (
                                <span className="px-2 py-1 bg-emerald-200 text-emerald-900 text-xs font-bold rounded">x{item.quantity}</span>
                              )}
                            </div>
                          ))}
                        </div>
                      </div>
                    )}

                    {/* Empty State */}
                    {(!selectedSubmission.technicalSpecs ||
                      (!selectedSubmission.technicalSpecs.cameraModel &&
                       !selectedSubmission.technicalSpecs.cameraSetupType &&
                       !selectedSubmission.technicalSpecs.lensTypes?.length &&
                       !selectedSubmission.technicalSpecs.lightingEquipment?.length &&
                       !selectedSubmission.technicalSpecs.soundEquipment?.length &&
                       !selectedSubmission.technicalSpecs.droneModels?.length &&
                       !selectedSubmission.technicalSpecs.cinematicTools?.length)) && (
                      <div className="bg-gray-50 rounded-xl p-12 border-2 border-dashed border-gray-300 text-center">
                        <div className="text-6xl mb-4">üìπ</div>
                        <div className="text-xl font-bold text-gray-700">No technical specifications added</div>
                        <div className="text-sm text-gray-500 font-semibold mt-2">Technical details will appear here once submitted</div>
                      </div>
                    )}
                  </div>
                )}

                {/* Cash Flow Tab */}
                {detailView === 'cashflow' && (
                  <div className="space-y-6">
                    {/* Download Options */}
                    <div className="bg-gradient-to-r from-gray-900 to-gray-800 rounded-xl p-4 flex items-center justify-between border border-white/10">
                      <div className="flex items-center gap-3">
                        <span className="text-2xl">üí≥</span>
                        <div>
                          <h3 className="text-white font-black">Cash Flow Details</h3>
                          <p className="text-gray-400 text-sm font-semibold">Download payment schedule</p>
                        </div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => exportTabToExcel(selectedSubmission, 'cashflow')}
                          className="px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìä</span> Excel
                        </button>
                        <button
                          onClick={() => exportTabToPDF(selectedSubmission, 'cashflow')}
                          className="px-4 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg text-sm transition-all flex items-center gap-2"
                        >
                          <span>üìÑ</span> PDF
                        </button>
                      </div>
                    </div>

                    {/* Total Budget Overview */}
                    <div className="bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl p-8 border-2 border-emerald-200 shadow-lg">
                      <div className="flex items-center justify-between">
                        <div>
                          <h2 className="text-2xl font-black text-gray-900 mb-2 flex items-center gap-3">
                            <span className="text-3xl">üí≥</span>
                            <span>Cash Flow & Payment Schedule</span>
                          </h2>
                          <p className="text-emerald-700 font-semibold">Payment tranches, terms, and GST breakdown</p>
                        </div>
                        <div className="text-right">
                          <div className="text-xs font-bold text-emerald-700 mb-1 uppercase">Total Budget</div>
                          <div className="text-3xl font-black text-emerald-900">‚Çπ{(selectedSubmission.totalBudget || 0).toLocaleString('en-IN')}</div>
                        </div>
                      </div>
                    </div>

                    {/* Payment Tranches */}
                    <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                      {(() => {
                        // Use saved tranches or generate default based on format
                        const displayTranches = (selectedSubmission.cashFlowTranches && selectedSubmission.cashFlowTranches.length > 0)
                          ? selectedSubmission.cashFlowTranches
                          : getDefaultTranches(selectedSubmission.format, selectedSubmission.totalBudget || 0);
                        const isDefaultTranches = !selectedSubmission.cashFlowTranches || selectedSubmission.cashFlowTranches.length === 0;

                        return (
                          <>
                            <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                              <span className="text-xl">üìä</span>
                              <span>Payment Tranches</span>
                              <span className="ml-2 px-3 py-1 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-full">
                                {displayTranches.length} Tranches
                              </span>
                              {isDefaultTranches && (
                                <span className="ml-2 px-3 py-1 bg-amber-100 text-amber-700 text-xs font-bold rounded-full">
                                  Default Structure
                                </span>
                              )}
                            </h3>

                            <div className="space-y-3">
                              {displayTranches.map((tranche: any, idx: number) => {
                            const baseAmount = tranche.amount || (selectedSubmission.totalBudget * (tranche.percentage || 0) / 100);
                            const gstAmount = baseAmount * 0.18;
                            const totalWithGst = baseAmount + gstAmount;
                            const isExpanded = expandedTranche === idx;
                            return (
                              <div key={idx} className="border-2 border-emerald-200 rounded-xl overflow-hidden">
                                {/* Tranche Header - Clickable */}
                                <div
                                  className={`bg-gradient-to-r from-emerald-50 to-green-50 p-4 cursor-pointer hover:from-emerald-100 hover:to-green-100 transition-all ${isExpanded ? 'border-b-2 border-emerald-200' : ''}`}
                                  onClick={() => setExpandedTranche(isExpanded ? null : idx)}
                                >
                                  <div className="flex items-center justify-between">
                                    <div className="flex items-center gap-4">
                                      <div className="w-12 h-12 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl flex items-center justify-center text-white font-black text-lg">
                                        {idx + 1}
                                      </div>
                                      <div>
                                        <div className="text-lg font-black text-gray-900">{tranche.name || tranche.milestone || `Tranche ${idx + 1}`}</div>
                                        <div className="flex items-center gap-3 mt-1">
                                          <span className="px-2 py-0.5 bg-blue-100 border border-blue-300 rounded-full text-xs font-bold text-blue-700">
                                            {tranche.percentage || 0}%
                                          </span>
                                          <span className="text-emerald-700 font-bold">‚Çπ{baseAmount.toLocaleString('en-IN')}</span>
                                          <span className="text-gray-400">‚Üí</span>
                                          <span className="text-emerald-900 font-black">‚Çπ{totalWithGst.toLocaleString('en-IN', { maximumFractionDigits: 0 })} (with GST)</span>
                                        </div>
                                      </div>
                                    </div>
                                    <div className="flex items-center gap-4">
                                      <div className="text-right">
                                        <div className="text-xs text-gray-500 font-semibold">Due Date</div>
                                        <div className="text-sm font-bold text-gray-700">{tranche.date || tranche.dueDate || 'TBD'}</div>
                                      </div>
                                      <svg
                                        className={`w-6 h-6 text-emerald-600 transition-transform ${isExpanded ? 'rotate-180' : ''}`}
                                        fill="none"
                                        viewBox="0 0 24 24"
                                        stroke="currentColor"
                                      >
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                                      </svg>
                                    </div>
                                  </div>
                                </div>

                                {/* Expanded Details */}
                                {isExpanded && (
                                  <div className="bg-white p-5">
                                    {/* Description */}
                                    <div className="mb-4">
                                      <div className="text-xs font-bold text-gray-500 uppercase mb-2">üìã Milestone Description</div>
                                      <div className="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                                        <p className="text-gray-800 font-medium leading-relaxed">
                                          {tranche.description || 'No description provided for this milestone.'}
                                        </p>
                                      </div>
                                    </div>

                                    {/* Payment Breakdown */}
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                      <div className="bg-blue-50 rounded-lg p-3 border border-blue-200">
                                        <div className="text-xs font-bold text-blue-700 uppercase">Percentage</div>
                                        <div className="text-xl font-black text-blue-900">{tranche.percentage || 0}%</div>
                                      </div>
                                      <div className="bg-gray-50 rounded-lg p-3 border border-gray-200">
                                        <div className="text-xs font-bold text-gray-600 uppercase">Base Amount</div>
                                        <div className="text-xl font-black text-gray-900">‚Çπ{baseAmount.toLocaleString('en-IN')}</div>
                                      </div>
                                      <div className="bg-amber-50 rounded-lg p-3 border border-amber-200">
                                        <div className="text-xs font-bold text-amber-700 uppercase">GST @ 18%</div>
                                        <div className="text-xl font-black text-amber-900">‚Çπ{gstAmount.toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                                      </div>
                                      <div className="bg-emerald-50 rounded-lg p-3 border border-emerald-200">
                                        <div className="text-xs font-bold text-emerald-700 uppercase">Total with GST</div>
                                        <div className="text-xl font-black text-emerald-900">‚Çπ{totalWithGst.toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                                      </div>
                                    </div>

                                    {/* Status & Terms */}
                                    <div className="mt-4 pt-4 border-t border-gray-200">
                                      <div className="flex items-center justify-between">
                                        <div className="flex items-center gap-3">
                                          <span className={`px-3 py-1 rounded-full text-xs font-bold ${
                                            tranche.status === 'paid' ? 'bg-green-100 text-green-800' :
                                            tranche.status === 'processing' ? 'bg-yellow-100 text-yellow-800' :
                                            'bg-gray-100 text-gray-700'
                                          }`}>
                                            {tranche.status === 'paid' ? '‚úì Paid' : tranche.status === 'processing' ? '‚è≥ Processing' : '‚è∏Ô∏è Pending'}
                                          </span>
                                          {tranche.condition && (
                                            <span className="text-xs text-gray-500 font-semibold">Condition: {tranche.condition}</span>
                                          )}
                                        </div>
                                        <div className="text-xs text-gray-500 font-medium">
                                          üí° Payment within 15 days of approved invoice
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                )}
                              </div>
                            );
                          })}

                              {/* Total Summary */}
                              <div className="bg-gradient-to-r from-emerald-100 to-green-100 rounded-xl p-4 border-2 border-emerald-300">
                                <div className="flex items-center justify-between">
                                  <div className="flex items-center gap-3">
                                    <span className="text-2xl">üí∞</span>
                                    <span className="text-lg font-black text-gray-900">Total</span>
                                    <span className="px-3 py-1 bg-emerald-200 text-emerald-900 rounded-full text-sm font-bold">
                                      {displayTranches.reduce((sum: number, t: any) => sum + (t.percentage || 0), 0)}%
                                    </span>
                                  </div>
                                  <div className="flex items-center gap-6">
                                    <div className="text-right">
                                      <div className="text-xs text-gray-600 font-semibold">Base Total</div>
                                      <div className="font-bold text-gray-900">‚Çπ{(selectedSubmission.totalBudget || 0).toLocaleString('en-IN')}</div>
                                    </div>
                                    <div className="text-right">
                                      <div className="text-xs text-amber-700 font-semibold">GST Total</div>
                                      <div className="font-bold text-amber-800">‚Çπ{((selectedSubmission.totalBudget || 0) * 0.18).toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                                    </div>
                                    <div className="text-right">
                                      <div className="text-xs text-emerald-700 font-semibold">Grand Total</div>
                                      <div className="text-xl font-black text-emerald-900">‚Çπ{((selectedSubmission.totalBudget || 0) * 1.18).toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </>
                        );
                      })()}
                    </div>

                    {/* GST Summary */}
                    <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-6 border-2 border-amber-200 shadow-lg">
                      <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-xl">üìë</span>
                        <span>GST Summary</span>
                      </h3>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div className="bg-white rounded-lg p-4 border border-amber-200 text-center">
                          <div className="text-xs font-bold text-amber-700 mb-2">Base Amount</div>
                          <div className="text-xl font-black text-gray-900">‚Çπ{(selectedSubmission.totalBudget || 0).toLocaleString('en-IN')}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border border-amber-200 text-center">
                          <div className="text-xs font-bold text-amber-700 mb-2">CGST @ 9%</div>
                          <div className="text-xl font-black text-gray-900">‚Çπ{((selectedSubmission.totalBudget || 0) * 0.09).toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border border-amber-200 text-center">
                          <div className="text-xs font-bold text-amber-700 mb-2">SGST @ 9%</div>
                          <div className="text-xl font-black text-gray-900">‚Çπ{((selectedSubmission.totalBudget || 0) * 0.09).toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                        </div>
                        <div className="bg-emerald-100 rounded-lg p-4 border border-emerald-300 text-center">
                          <div className="text-xs font-bold text-emerald-700 mb-2">Total with GST</div>
                          <div className="text-xl font-black text-emerald-900">‚Çπ{((selectedSubmission.totalBudget || 0) * 1.18).toLocaleString('en-IN', { maximumFractionDigits: 0 })}</div>
                        </div>
                      </div>
                    </div>

                    {/* Important Notes */}
                    <div className="bg-slate-50 rounded-xl p-6 border-2 border-slate-200">
                      <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-xl">üìå</span>
                        <span>Important Notes</span>
                      </h3>
                      <ul className="space-y-2 text-sm text-gray-700 font-semibold">
                        <li className="flex items-start gap-2">
                          <span className="text-emerald-500">‚úì</span>
                          All payments subject to successful completion of milestones
                        </li>
                        <li className="flex items-start gap-2">
                          <span className="text-emerald-500">‚úì</span>
                          GST invoice to be raised within 7 days of milestone completion
                        </li>
                        <li className="flex items-start gap-2">
                          <span className="text-emerald-500">‚úì</span>
                          TDS certificate to be issued quarterly as per IT Act
                        </li>
                        <li className="flex items-start gap-2">
                          <span className="text-emerald-500">‚úì</span>
                          All payments via NEFT/RTGS to registered bank account only
                        </li>
                      </ul>
                    </div>
                  </div>
                )}

                {/* Documents Tab */}
                {detailView === 'documents' && (
                  <div className="space-y-6">
                    {/* Uploaded Files */}
                    {selectedSubmission.uploadedFiles && selectedSubmission.uploadedFiles.length > 0 && (
                      <div className="bg-white rounded-xl p-5 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-2xl">üìé</span>
                          <span>Uploaded Files ({selectedSubmission.uploadedFiles.length})</span>
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                          {selectedSubmission.uploadedFiles.map((file: any, index: number) => {
                            const isPDF = file.name?.toLowerCase().endsWith('.pdf') || file.type === 'application/pdf';
                            const isImage = file.type?.startsWith('image/') || /\.(jpg|jpeg|png|gif|webp)$/i.test(file.name || '');
                            const isPreviewable = isPDF || isImage;

                            return (
                              <div key={index} className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border-2 border-blue-200 hover:shadow-md transition-shadow">
                                <div className="flex items-start gap-3">
                                  <div className={`w-12 h-12 rounded-lg flex items-center justify-center text-2xl ${
                                    isPDF ? 'bg-red-100' : isImage ? 'bg-green-100' : 'bg-gray-100'
                                  }`}>
                                    {isPDF ? 'üìï' : isImage ? 'üñºÔ∏è' : 'üìÑ'}
                                  </div>
                                  <div className="flex-1 min-w-0">
                                    <div className="text-sm font-bold text-gray-900 truncate" title={file.name}>{file.name}</div>
                                    <div className="text-xs text-gray-600 font-semibold mt-1">
                                      {(file.size / 1024 / 1024).toFixed(2)} MB ‚Ä¢ {formatDate(file.uploadDate)}
                                    </div>
                                    <div className="flex gap-2 mt-3">
                                      {isPreviewable && (
                                        <button
                                          onClick={() => setPreviewDocument({
                                            url: file.url || file.dataUrl || `#preview-${index}`,
                                            name: file.name,
                                            type: isPDF ? 'pdf' : 'image'
                                          })}
                                          className="px-3 py-1.5 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white text-xs font-bold rounded-lg transition-all shadow-sm"
                                        >
                                          üëÅÔ∏è Preview
                                        </button>
                                      )}
                                      <button className="px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white text-xs font-bold rounded-lg transition-all shadow-sm">
                                        ‚¨áÔ∏è Download
                                      </button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    )}

                    {/* Cloud Links */}
                    {selectedSubmission.cloudLinks && selectedSubmission.cloudLinks.length > 0 && (
                      <div className="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 border-2 border-purple-200 shadow-lg">
                        <h3 className="text-xl font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-2xl">‚òÅÔ∏è</span>
                          <span>Cloud Links ({selectedSubmission.cloudLinks.length})</span>
                        </h3>
                        <div className="space-y-3">
                          {selectedSubmission.cloudLinks.map((link: string, index: number) => {
                            const isGoogleDrive = link.includes('drive.google.com');
                            const isDropbox = link.includes('dropbox.com');
                            const isOneDrive = link.includes('onedrive') || link.includes('sharepoint');

                            return (
                              <div key={index} className="bg-white rounded-xl p-4 flex items-center justify-between border-2 border-purple-200 hover:shadow-md transition-shadow">
                                <div className="flex items-center gap-3 flex-1 min-w-0">
                                  <div className={`w-10 h-10 rounded-lg flex items-center justify-center text-xl ${
                                    isGoogleDrive ? 'bg-blue-100' : isDropbox ? 'bg-blue-50' : isOneDrive ? 'bg-sky-100' : 'bg-gray-100'
                                  }`}>
                                    {isGoogleDrive ? 'üìÅ' : isDropbox ? 'üì¶' : isOneDrive ? '‚òÅÔ∏è' : 'üîó'}
                                  </div>
                                  <div className="flex-1 min-w-0">
                                    <div className="text-sm font-bold text-gray-700">
                                      {isGoogleDrive ? 'Google Drive' : isDropbox ? 'Dropbox' : isOneDrive ? 'OneDrive' : 'External Link'}
                                    </div>
                                    <div className="text-xs text-blue-600 truncate">{link}</div>
                                  </div>
                                </div>
                                <a
                                  href={link}
                                  target="_blank"
                                  rel="noopener noreferrer"
                                  className="ml-3 px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white text-xs font-bold rounded-lg transition-all shadow-md hover:shadow-lg whitespace-nowrap"
                                >
                                  üîó Open
                                </a>
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    )}

                    {(!selectedSubmission.uploadedFiles || selectedSubmission.uploadedFiles.length === 0) &&
                      (!selectedSubmission.cloudLinks || selectedSubmission.cloudLinks.length === 0) && (
                        <div className="text-center py-12 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300">
                          <div className="text-6xl mb-4">üì≠</div>
                          <div className="text-xl font-bold text-gray-700">No files uploaded yet</div>
                          <div className="text-sm text-gray-500 mt-2 font-semibold">Files will appear here once uploaded</div>
                        </div>
                      )}
                  </div>
                )}

                {/* Missing Details Tab */}
                {detailView === 'missing' && (
                  <div className="space-y-6">
                    {/* Header */}
                    <div className="bg-gradient-to-br from-red-50 to-orange-50 rounded-2xl p-8 border-2 border-red-200 shadow-lg">
                      <div className="flex items-center justify-between">
                        <div>
                          <h2 className="text-2xl font-black text-gray-900 mb-2 flex items-center gap-3">
                            <span className="text-3xl">‚ö†Ô∏è</span>
                            <span>Missing Information</span>
                          </h2>
                          <p className="text-red-700 font-semibold">Fields that need to be filled by the creator</p>
                        </div>
                        <div className="text-right">
                          <div className="text-xs font-bold text-red-700 mb-1 uppercase">Completion</div>
                          <div className="text-3xl font-black text-red-900">{selectedSubmission.completeness || 0}%</div>
                        </div>
                      </div>
                    </div>

                    {/* Missing Fields Sections */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                      {/* Project Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üìã</span>
                          <span>Project Information</span>
                        </h3>
                        <div className="space-y-2">
                          {!selectedSubmission.projectName && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Project Name
                            </div>
                          )}
                          {!selectedSubmission.productionCompany && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Production Company
                            </div>
                          )}
                          {!selectedSubmission.culture && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Culture
                            </div>
                          )}
                          {!selectedSubmission.format && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Format
                            </div>
                          )}
                          {!selectedSubmission.genre && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Genre
                            </div>
                          )}
                          {!selectedSubmission.logline && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Logline
                            </div>
                          )}
                          {!selectedSubmission.synopsis && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Synopsis
                            </div>
                          )}
                          {!selectedSubmission.language && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Language
                            </div>
                          )}
                          {selectedSubmission.projectName && selectedSubmission.productionCompany && selectedSubmission.culture && selectedSubmission.format && selectedSubmission.genre && selectedSubmission.logline && selectedSubmission.synopsis && selectedSubmission.language && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> All project information complete
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Creator Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üë§</span>
                          <span>Creator Information</span>
                        </h3>
                        <div className="space-y-2">
                          {!selectedSubmission.creator && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Creator Name
                            </div>
                          )}
                          {!selectedSubmission.officialEmail && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Official Email
                            </div>
                          )}
                          {!selectedSubmission.phone && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Phone Number
                            </div>
                          )}
                          {!selectedSubmission.panNumber && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> PAN Number
                            </div>
                          )}
                          {!selectedSubmission.gstNumber && (
                            <div className="flex items-center gap-2 text-amber-600 font-semibold text-sm bg-amber-50 p-2 rounded-lg">
                              <span>‚ö†</span> GST Number (Optional)
                            </div>
                          )}
                          {!selectedSubmission.permanentAddress && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Permanent Address
                            </div>
                          )}
                          {selectedSubmission.creator && selectedSubmission.officialEmail && selectedSubmission.phone && selectedSubmission.panNumber && selectedSubmission.permanentAddress && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> All required creator info complete
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Budget Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üí∞</span>
                          <span>Budget Information</span>
                        </h3>
                        <div className="space-y-2">
                          {!selectedSubmission.totalBudget && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Total Budget
                            </div>
                          )}
                          {(!selectedSubmission.budgetCategories || selectedSubmission.budgetCategories.length === 0) && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Budget Breakdown
                            </div>
                          )}
                          {(!selectedSubmission.cashFlowTranches || selectedSubmission.cashFlowTranches.length === 0) && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Cash Flow Tranches
                            </div>
                          )}
                          {selectedSubmission.totalBudget && selectedSubmission.budgetCategories?.length > 0 && selectedSubmission.cashFlowTranches?.length > 0 && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> All budget info complete
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Timeline Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üìÖ</span>
                          <span>Timeline Information</span>
                        </h3>
                        <div className="space-y-2">
                          {!selectedSubmission.shootStartDate && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Shoot Start Date
                            </div>
                          )}
                          {!selectedSubmission.shootEndDate && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Shoot End Date
                            </div>
                          )}
                          {!selectedSubmission.shootDays && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Total Shoot Days
                            </div>
                          )}
                          {!selectedSubmission.totalDuration && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Total Duration
                            </div>
                          )}
                          {selectedSubmission.shootStartDate && selectedSubmission.shootEndDate && selectedSubmission.shootDays && selectedSubmission.totalDuration && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> All timeline info complete
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Crew Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üé¨</span>
                          <span>Key Crew</span>
                        </h3>
                        <div className="space-y-2">
                          {!selectedSubmission.director && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Director
                            </div>
                          )}
                          {!selectedSubmission.dop && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Director of Photography
                            </div>
                          )}
                          {!selectedSubmission.editor && (
                            <div className="flex items-center gap-2 text-amber-600 font-semibold text-sm bg-amber-50 p-2 rounded-lg">
                              <span>‚ö†</span> Editor (Optional)
                            </div>
                          )}
                          {!selectedSubmission.musicComposer && (
                            <div className="flex items-center gap-2 text-amber-600 font-semibold text-sm bg-amber-50 p-2 rounded-lg">
                              <span>‚ö†</span> Music Composer (Optional)
                            </div>
                          )}
                          {selectedSubmission.director && selectedSubmission.dop && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> Required crew filled
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Cast Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">‚≠ê</span>
                          <span>Cast Information</span>
                        </h3>
                        <div className="space-y-2">
                          {(!selectedSubmission.castData || !selectedSubmission.castData.primaryCast || selectedSubmission.castData.primaryCast.length === 0) && (
                            <div className="flex items-center gap-2 text-red-600 font-semibold text-sm bg-red-50 p-2 rounded-lg">
                              <span>‚úó</span> Primary Cast
                            </div>
                          )}
                          {selectedSubmission.castData?.primaryCast?.length > 0 && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> {selectedSubmission.castData.primaryCast.length} Primary cast added
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Technical Information */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üìπ</span>
                          <span>Technical Specs</span>
                        </h3>
                        <div className="space-y-2">
                          {(!selectedSubmission.technicalSpecs || !selectedSubmission.technicalSpecs.cameraModel) && (
                            <div className="flex items-center gap-2 text-amber-600 font-semibold text-sm bg-amber-50 p-2 rounded-lg">
                              <span>‚ö†</span> Camera Model
                            </div>
                          )}
                          {(!selectedSubmission.technicalSpecs || !selectedSubmission.technicalSpecs.cameraSetupType) && (
                            <div className="flex items-center gap-2 text-amber-600 font-semibold text-sm bg-amber-50 p-2 rounded-lg">
                              <span>‚ö†</span> Camera Setup Type
                            </div>
                          )}
                          {selectedSubmission.technicalSpecs?.cameraModel && selectedSubmission.technicalSpecs?.cameraSetupType && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> Technical specs filled
                            </div>
                          )}
                        </div>
                      </div>

                      {/* Documents */}
                      <div className="bg-white rounded-xl p-6 border-2 border-gray-200 shadow-lg">
                        <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                          <span className="text-xl">üìÅ</span>
                          <span>Documents</span>
                        </h3>
                        <div className="space-y-2">
                          {(!selectedSubmission.cloudLinks || selectedSubmission.cloudLinks.length === 0) && (!selectedSubmission.uploadedFiles || selectedSubmission.uploadedFiles.length === 0) && (
                            <div className="flex items-center gap-2 text-amber-600 font-semibold text-sm bg-amber-50 p-2 rounded-lg">
                              <span>‚ö†</span> No documents uploaded
                            </div>
                          )}
                          {(selectedSubmission.cloudLinks?.length > 0 || selectedSubmission.uploadedFiles?.length > 0) && (
                            <div className="flex items-center gap-2 text-green-600 font-bold text-sm bg-green-50 p-3 rounded-lg">
                              <span>‚úì</span> {(selectedSubmission.cloudLinks?.length || 0) + (selectedSubmission.uploadedFiles?.length || 0)} documents attached
                            </div>
                          )}
                        </div>
                      </div>
                    </div>

                    {/* Summary */}
                    <div className="bg-gradient-to-br from-slate-50 to-gray-100 rounded-xl p-6 border-2 border-slate-200">
                      <h3 className="text-lg font-black text-gray-900 mb-4 flex items-center gap-2">
                        <span className="text-xl">üìä</span>
                        <span>Submission Summary</span>
                      </h3>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div className="bg-white rounded-lg p-4 border border-gray-200 text-center">
                          <div className="text-xs font-bold text-gray-500 mb-1">Status</div>
                          <div className="text-sm font-black text-gray-900">{getStatusConfig(selectedSubmission.status).text}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border border-gray-200 text-center">
                          <div className="text-xs font-bold text-gray-500 mb-1">Submitted</div>
                          <div className="text-sm font-black text-gray-900">{selectedSubmission.submittedDate || selectedSubmission.submitted_at?.split('T')[0] || 'N/A'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border border-gray-200 text-center">
                          <div className="text-xs font-bold text-gray-500 mb-1">Budget</div>
                          <div className="text-sm font-black text-gray-900">{selectedSubmission.totalBudget ? `‚Çπ${selectedSubmission.totalBudget.toLocaleString('en-IN')}` : 'Not set'}</div>
                        </div>
                        <div className="bg-white rounded-lg p-4 border border-gray-200 text-center">
                          <div className="text-xs font-bold text-gray-500 mb-1">Shoot Days</div>
                          <div className="text-sm font-black text-gray-900">{selectedSubmission.shootDays || 'Not set'}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Agreement Tab */}
                {detailView === 'agreement' && (
                  <div className="space-y-6">
                    {/* Export Header */}
                    <div className="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-2xl p-8 text-white shadow-2xl border-2 border-emerald-500/30">
                      <div className="flex items-center justify-between">
                        <div>
                          <h2 className="text-3xl font-black mb-2 bg-gradient-to-r from-emerald-400 to-green-400 bg-clip-text text-transparent">Agreement Export</h2>
                          <p className="text-gray-400 font-semibold">Export all project details for agreement documentation</p>
                        </div>
                        <div className="text-6xl bg-gradient-to-br from-emerald-500/20 to-green-500/20 p-4 rounded-2xl border border-emerald-500/30">üìã</div>
                      </div>
                    </div>

                    {/* Export Buttons */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <button
                        onClick={() => exportToExcel(selectedSubmission)}
                        className="bg-gradient-to-br from-gray-800 to-gray-900 hover:from-emerald-900 hover:to-green-900 border-2 border-emerald-500/50 hover:border-emerald-400 text-white p-6 rounded-2xl font-black text-lg shadow-lg hover:shadow-emerald-500/20 hover:shadow-xl transition-all flex items-center justify-center gap-3"
                      >
                        <span className="text-3xl">üìä</span>
                        <div className="text-left">
                          <div className="text-emerald-400">Export to Excel</div>
                          <div className="text-sm font-semibold text-gray-400">Download .xlsx file</div>
                        </div>
                      </button>
                      <button
                        onClick={() => exportToPDF(selectedSubmission)}
                        className="bg-gradient-to-br from-gray-800 to-gray-900 hover:from-red-900 hover:to-pink-900 border-2 border-red-500/50 hover:border-red-400 text-white p-6 rounded-2xl font-black text-lg shadow-lg hover:shadow-red-500/20 hover:shadow-xl transition-all flex items-center justify-center gap-3"
                      >
                        <span className="text-3xl">üìÑ</span>
                        <div className="text-left">
                          <div className="text-red-400">Export to PDF</div>
                          <div className="text-sm font-semibold text-gray-400">Download .pdf file</div>
                        </div>
                      </button>
                    </div>

                    {/* Agreement Preview */}
                    <div className="bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl border-2 border-white/10 shadow-2xl overflow-hidden">
                      <div className="bg-gradient-to-r from-emerald-600 to-green-600 text-white p-5">
                        <h3 className="text-2xl font-black flex items-center gap-3">
                          <span>üìã</span> Agreement Details Preview
                        </h3>
                      </div>
                      <div className="p-6 space-y-6">
                        {/* 1. Agreement Date */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-1">1. Agreement Date</div>
                          <div className="text-lg font-bold text-white">{new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' })}</div>
                        </div>

                        {/* 2. Content Name */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-1">2. Content Name</div>
                          <div className="text-lg font-bold text-white">{selectedSubmission.projectName || 'N/A'}</div>
                        </div>

                        {/* 3. Creator/Company Details */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">3. Creator / Company Details</div>
                          <div className="grid grid-cols-2 gap-4 text-sm">
                            <div><span className="text-gray-400">Name:</span> <span className="font-bold text-white">{selectedSubmission.creatorName || selectedSubmission.creator || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Company:</span> <span className="font-bold text-white">{selectedSubmission.productionCompany || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Father's Name:</span> <span className="font-bold text-white">{selectedSubmission.fatherName || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Authorized Signatory:</span> <span className="font-bold text-white">{selectedSubmission.authorizedSignatory || 'N/A'}</span></div>
                            <div className="col-span-2"><span className="text-gray-400">Address:</span> <span className="font-bold text-white">{selectedSubmission.permanentAddress || selectedSubmission.currentAddress || 'N/A'}</span></div>
                            <div><span className="text-gray-400">PAN:</span> <span className="font-bold text-white">{selectedSubmission.panNumber || 'N/A'}</span></div>
                            <div><span className="text-gray-400">GST:</span> <span className="font-bold text-white">{selectedSubmission.gstNumber || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Email:</span> <span className="font-bold text-white">{selectedSubmission.officialEmail || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Phone:</span> <span className="font-bold text-white">{selectedSubmission.phone || 'N/A'}</span></div>
                          </div>
                        </div>

                        {/* 4. Budget */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-1">4. Total Budget</div>
                          <div className="text-2xl font-black text-emerald-400">{formatBudget(selectedSubmission.totalBudget || selectedSubmission.estimatedBudget || 0)}</div>
                        </div>

                        {/* 4.1 Detailed Budget Breakdown */}
                        {selectedSubmission.budgetCategories && selectedSubmission.budgetCategories.length > 0 && (
                          <div className="border-b-2 border-white/10 pb-4">
                            <div className="text-xs font-bold text-emerald-400 uppercase mb-3">4.1 Detailed Budget Breakdown (Department-wise)</div>
                            <div className="space-y-3 max-h-96 overflow-y-auto">
                              {selectedSubmission.budgetCategories.filter((cat: any) => cat.amount > 0 || (cat.items && cat.items.some((item: any) => item.total > 0))).map((category: any, catIndex: number) => {
                                const filledItems = category.items?.filter((item: any) => item.total > 0 || item.description) || [];
                                return (
                                  <div key={catIndex} className="bg-white/5 border border-white/10 rounded-lg overflow-hidden">
                                    <div className="bg-white/10 px-4 py-2 flex items-center justify-between">
                                      <span className="font-bold text-white flex items-center gap-2">
                                        <span>{category.icon || 'üìÅ'}</span>
                                        {category.name}
                                      </span>
                                      <span className="font-black text-emerald-400">‚Çπ{(category.amount || 0).toLocaleString('en-IN')}</span>
                                    </div>
                                    {filledItems.length > 0 && (
                                      <div className="p-3">
                                        <table className="w-full text-xs">
                                          <thead>
                                            <tr className="text-gray-400">
                                              <th className="text-left p-1">Item</th>
                                              <th className="text-center p-1">Days</th>
                                              <th className="text-center p-1">Qty</th>
                                              <th className="text-right p-1">Per Day</th>
                                              <th className="text-right p-1">Lumpsum</th>
                                              <th className="text-right p-1">Total</th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            {filledItems.map((item: any, itemIdx: number) => (
                                              <tr key={itemIdx} className="text-gray-300 border-t border-white/5">
                                                <td className="p-1 text-white">{item.description || 'N/A'}</td>
                                                <td className="p-1 text-center">{item.noOfDays || item.days || '-'}</td>
                                                <td className="p-1 text-center">{item.noOfPeople || item.people || item.noOfRooms || '-'}</td>
                                                <td className="p-1 text-right">{item.perDay ? `‚Çπ${item.perDay.toLocaleString('en-IN')}` : '-'}</td>
                                                <td className="p-1 text-right">{(item.lumpsumFixed || item.lumpsum) ? `‚Çπ${(item.lumpsumFixed || item.lumpsum).toLocaleString('en-IN')}` : '-'}</td>
                                                <td className="p-1 text-right font-bold text-emerald-400">‚Çπ{(item.total || 0).toLocaleString('en-IN')}</td>
                                              </tr>
                                            ))}
                                          </tbody>
                                        </table>
                                      </div>
                                    )}
                                  </div>
                                );
                              })}
                            </div>
                            <div className="mt-4 bg-emerald-500/20 border border-emerald-400/30 rounded-lg p-4">
                              <div className="flex items-center justify-between">
                                <span className="font-bold text-white">Grand Total (All Departments)</span>
                                <span className="text-2xl font-black text-emerald-400">
                                  ‚Çπ{(selectedSubmission.budgetCategories.reduce((sum: number, cat: any) => sum + (cat.amount || 0), 0)).toLocaleString('en-IN')}
                                </span>
                              </div>
                            </div>
                          </div>
                        )}

                        {/* 5. Director & Writer */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">5. Director & Writer</div>
                          <div className="grid grid-cols-2 gap-4 text-sm">
                            <div><span className="text-gray-400">Director:</span> <span className="font-bold text-white">{selectedSubmission.director || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Story By:</span> <span className="font-bold text-white">{selectedSubmission.storyBy || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Screenplay:</span> <span className="font-bold text-white">{selectedSubmission.screenplayBy || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Dialogues:</span> <span className="font-bold text-white">{selectedSubmission.dialoguesBy || 'N/A'}</span></div>
                          </div>
                        </div>

                        {/* 6. Content Duration & Episodes */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">6. Total Minutes of Content & Episodes</div>
                          <div className="grid grid-cols-3 gap-4 text-sm">
                            <div><span className="text-gray-400">Total Duration:</span> <span className="font-bold text-white">{selectedSubmission.totalDuration || 'N/A'} mins</span></div>
                            <div><span className="text-gray-400">Episodes:</span> <span className="font-bold text-white">{selectedSubmission.episodes || selectedSubmission.episodesPerSeason || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Format:</span> <span className="font-bold text-white">{selectedSubmission.format || 'N/A'}</span></div>
                          </div>
                        </div>

                        {/* 7. Project Delivery Date */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">7. Project Delivery Date</div>
                          <div className="grid grid-cols-3 gap-4 text-sm">
                            <div><span className="text-gray-400">Final Delivery:</span> <span className="font-bold text-white">{selectedSubmission.contentTimeline?.finalDeliveryDate || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Shoot Start:</span> <span className="font-bold text-white">{selectedSubmission.shootStartDate || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Shoot End:</span> <span className="font-bold text-white">{selectedSubmission.shootEndDate || 'N/A'}</span></div>
                          </div>
                        </div>

                        {/* 8. Cash Flow / Payment Terms */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-3">8. Cash Flow (Payment Terms)</div>
                          {selectedSubmission.cashFlowTranches && selectedSubmission.cashFlowTranches.length > 0 ? (
                            <div className="space-y-3">
                              {selectedSubmission.cashFlowTranches.map((tranche: any, idx: number) => (
                                <div key={idx} className="bg-gradient-to-br from-white/5 to-white/10 border border-white/20 rounded-xl overflow-hidden">
                                  {/* Tranche Header */}
                                  <div className="bg-gradient-to-r from-emerald-600/30 to-green-600/30 px-4 py-3 flex items-center justify-between border-b border-white/10">
                                    <div className="flex items-center gap-3">
                                      <div className="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center text-white font-black text-sm">
                                        {idx + 1}
                                      </div>
                                      <span className="font-black text-white">{tranche.name || tranche.milestone || `Tranche ${idx + 1}`}</span>
                                    </div>
                                    <div className="flex items-center gap-4">
                                      <span className="bg-emerald-500/20 border border-emerald-400/50 px-3 py-1 rounded-full text-emerald-400 font-black text-sm">
                                        {tranche.percentage}%
                                      </span>
                                      <span className="font-black text-emerald-400 text-lg">
                                        {formatBudget(tranche.amount || 0)}
                                      </span>
                                    </div>
                                  </div>
                                  {/* Tranche Details */}
                                  <div className="p-4 space-y-3">
                                    {/* Description */}
                                    <div>
                                      <div className="text-xs font-bold text-gray-500 uppercase mb-1">Description / Terms</div>
                                      <p className="text-gray-300 text-sm font-semibold leading-relaxed">
                                        {tranche.description || 'No description provided'}
                                      </p>
                                    </div>
                                    {/* Payment Breakdown */}
                                    <div className="grid grid-cols-3 gap-3">
                                      <div className="bg-white/5 border border-white/10 rounded-lg p-3">
                                        <div className="text-xs font-bold text-gray-500 uppercase">Base Amount</div>
                                        <div className="text-white font-black">{formatBudget(tranche.amount || 0)}</div>
                                      </div>
                                      <div className="bg-white/5 border border-white/10 rounded-lg p-3">
                                        <div className="text-xs font-bold text-gray-500 uppercase">GST @ 18%</div>
                                        <div className="text-amber-400 font-black">{formatBudget(Math.round((tranche.amount || 0) * 0.18))}</div>
                                      </div>
                                      <div className="bg-emerald-500/20 border border-emerald-400/30 rounded-lg p-3">
                                        <div className="text-xs font-bold text-emerald-400 uppercase">Total with GST</div>
                                        <div className="text-emerald-400 font-black">{formatBudget(Math.round((tranche.amount || 0) * 1.18))}</div>
                                      </div>
                                    </div>
                                    {/* Expected Date & Status */}
                                    <div className="flex items-center gap-4 pt-2 border-t border-white/10">
                                      {tranche.expectedDate && (
                                        <div className="flex items-center gap-2">
                                          <span className="text-gray-500 text-xs font-bold">Expected Date:</span>
                                          <span className="text-white font-bold text-sm">{tranche.expectedDate}</span>
                                        </div>
                                      )}
                                      <div className="flex items-center gap-2">
                                        <span className="text-gray-500 text-xs font-bold">Status:</span>
                                        <span className={`px-2 py-1 rounded-full text-xs font-bold ${
                                          tranche.status === 'completed' ? 'bg-green-500/20 text-green-400' :
                                          tranche.status === 'in-progress' ? 'bg-blue-500/20 text-blue-400' :
                                          'bg-gray-500/20 text-gray-400'
                                        }`}>
                                          {tranche.status === 'completed' ? '‚úÖ Completed' :
                                           tranche.status === 'in-progress' ? 'üîÑ In Progress' :
                                           '‚è≥ Pending'}
                                        </span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              ))}
                              {/* Total Summary */}
                              <div className="bg-gradient-to-r from-emerald-600/30 to-green-600/30 border-2 border-emerald-400/50 rounded-xl p-4 mt-4">
                                <div className="flex items-center justify-between">
                                  <span className="text-white font-black text-lg">Total Payment</span>
                                  <div className="text-right">
                                    <div className="text-emerald-400 font-black text-2xl">
                                      {formatBudget(Math.round(selectedSubmission.cashFlowTranches.reduce((sum: number, t: any) => sum + (t.amount || 0), 0) * 1.18))}
                                    </div>
                                    <div className="text-gray-400 text-xs font-bold">Including 18% GST</div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          ) : (
                            <div className="text-gray-500">No cash flow tranches defined</div>
                          )}
                        </div>

                        {/* 9. Content Creation Schedule */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">9. Content Creation Schedule</div>
                          <div className="grid grid-cols-2 gap-4 text-sm">
                            <div><span className="text-gray-400">Pre-Production:</span> <span className="font-bold text-white">{selectedSubmission.contentTimeline?.preProductionStart || 'N/A'} - {selectedSubmission.contentTimeline?.preProductionEnd || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Principal Photography:</span> <span className="font-bold text-white">{selectedSubmission.shootStartDate || 'N/A'} - {selectedSubmission.shootEndDate || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Post-Production:</span> <span className="font-bold text-white">{selectedSubmission.contentTimeline?.postProductionStart || 'N/A'} - {selectedSubmission.contentTimeline?.postProductionEnd || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Shoot Days:</span> <span className="font-bold text-white">{selectedSubmission.shootDays || 'N/A'} days</span></div>
                          </div>
                        </div>

                        {/* 10. Technical Specifications */}
                        <div className="border-b-2 border-white/10 pb-4">
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">10. Technical Specifications</div>
                          <div className="grid grid-cols-2 gap-4 text-sm">
                            <div><span className="text-gray-400">Camera:</span> <span className="font-bold text-white">{selectedSubmission.technicalSpecs?.cameraModel || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Setup:</span> <span className="font-bold text-white">{selectedSubmission.technicalSpecs?.cameraSetupType || 'N/A'}</span></div>
                            <div><span className="text-gray-400">Lenses:</span> <span className="font-bold text-white">{selectedSubmission.technicalSpecs?.lensTypes?.length || 0} types</span></div>
                            <div><span className="text-gray-400">Lighting:</span> <span className="font-bold text-white">{selectedSubmission.technicalSpecs?.lightingEquipment?.length || 0} items</span></div>
                          </div>
                        </div>

                        {/* 11. Budget Sheet Summary */}
                        <div>
                          <div className="text-xs font-bold text-emerald-400 uppercase mb-2">11. Budget Sheet (Category-wise)</div>
                          {selectedSubmission.budgetBreakdown && selectedSubmission.budgetBreakdown.length > 0 ? (
                            <div className="space-y-2">
                              {selectedSubmission.budgetBreakdown.slice(0, 5).map((item: any, idx: number) => (
                                <div key={idx} className="flex justify-between bg-white/5 border border-white/10 p-3 rounded-lg">
                                  <span className="font-semibold text-gray-300">{item.category}</span>
                                  <span className="font-bold text-cyan-400">{formatBudget(item.amount || 0)}</span>
                                </div>
                              ))}
                              {selectedSubmission.budgetBreakdown.length > 5 && (
                                <div className="text-sm text-gray-500 text-center">+{selectedSubmission.budgetBreakdown.length - 5} more categories in Excel export</div>
                              )}
                            </div>
                          ) : (
                            <div className="text-gray-500">Budget breakdown will be included in full export</div>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Activity Log Tab */}
                {detailView === 'activity' && (
                  <div className="space-y-6">
                    {/* Activity Log Header */}
                    <div className="bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 rounded-2xl p-8 text-white shadow-2xl border-2 border-blue-500/30">
                      <div className="flex items-center justify-between">
                        <div>
                          <h2 className="text-3xl font-black mb-2 bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">Activity Log</h2>
                          <p className="text-gray-400 font-semibold">Track all updates, actions & feedback for this project</p>
                        </div>
                        <div className="text-6xl bg-gradient-to-br from-blue-500/20 to-cyan-500/20 p-4 rounded-2xl border border-blue-500/30">üìã</div>
                      </div>
                    </div>

                    {/* Project Status Summary */}
                    <div className="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-white/10 p-6">
                      <div className="flex items-center justify-between mb-4">
                        <h3 className="text-lg font-bold text-white">Current Status</h3>
                        <span className={`px-4 py-2 rounded-full text-sm font-black ${getStatusConfig(selectedSubmission.status).badge}`}>
                          {getStatusConfig(selectedSubmission.status).text}
                        </span>
                      </div>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div className="bg-white/5 rounded-lg p-3 border border-white/10">
                          <div className="text-xs text-gray-500 font-bold uppercase">Submitted</div>
                          <div className="text-white font-bold">{formatDate(selectedSubmission.submittedDate)}</div>
                        </div>
                        <div className="bg-white/5 rounded-lg p-3 border border-white/10">
                          <div className="text-xs text-gray-500 font-bold uppercase">Production POC</div>
                          <div className="text-white font-bold">{selectedSubmission.productionPOC || 'Not Assigned'}</div>
                        </div>
                        <div className="bg-white/5 rounded-lg p-3 border border-white/10">
                          <div className="text-xs text-gray-500 font-bold uppercase">Content POC</div>
                          <div className="text-white font-bold">{selectedSubmission.contentPOC || 'Not Assigned'}</div>
                        </div>
                        <div className="bg-white/5 rounded-lg p-3 border border-white/10">
                          <div className="text-xs text-gray-500 font-bold uppercase">Days Since Submission</div>
                          <div className="text-white font-bold">{Math.floor((new Date().getTime() - new Date(selectedSubmission.submittedDate).getTime()) / (1000 * 60 * 60 * 24))} days</div>
                        </div>
                      </div>
                    </div>

                    {/* Activity Timeline */}
                    <div className="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-white/10 overflow-hidden">
                      <div className="bg-gradient-to-r from-blue-600 to-cyan-600 text-white p-5">
                        <h3 className="text-xl font-black flex items-center gap-3">
                          <span>üìú</span> Activity Timeline
                        </h3>
                      </div>
                      <div className="p-6">
                        {/* Activity Items */}
                        <div className="space-y-0">
                          {/* Generate activity from available data */}
                          {(() => {
                            const activities: { date: string; time: string; action: string; description: string; user: string; type: string; timestamp?: string; changes?: any[] }[] = [];

                            // 1. Load real activity logs from localStorage
                            const savedLogs = getActivityLogs(selectedSubmission.id);
                            if (savedLogs && savedLogs.length > 0) {
                              activities.push(...savedLogs);
                            }

                            // 2. Load change history from submission
                            if (selectedSubmission.changeHistory && selectedSubmission.changeHistory.length > 0) {
                              selectedSubmission.changeHistory.forEach((change: any) => {
                                activities.push({
                                  date: formatDate(change.timestamp),
                                  time: new Date(change.timestamp).toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit', hour12: true }),
                                  action: change.changedBy === 'creator' ? 'Creator Updated Project' : 'Project Updated',
                                  description: change.summary || `${change.changes?.length || 0} field(s) changed`,
                                  user: change.changedBy === 'creator' ? (selectedSubmission.creator || 'Creator') : 'Admin',
                                  type: 'edit',
                                  timestamp: change.timestamp,
                                  changes: change.changes
                                });
                              });
                            }

                            // 3. If no activities, add default submission entry
                            if (activities.length === 0) {
                              // Add initial submission entry
                              activities.push({
                                date: formatDate(selectedSubmission.submittedDate),
                                time: new Date(selectedSubmission.submittedDate).toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit', hour12: true }),
                                action: 'Project Submitted',
                                description: `Project "${selectedSubmission.projectName}" submitted for review`,
                                user: selectedSubmission.creator || 'Creator',
                                type: 'submit',
                                timestamp: selectedSubmission.submittedDate
                              });
                            }

                            // 4. Sort by timestamp (newest first)
                            activities.sort((a, b) => {
                              const dateA = a.timestamp ? new Date(a.timestamp).getTime() : 0;
                              const dateB = b.timestamp ? new Date(b.timestamp).getTime() : 0;
                              return dateB - dateA;
                            });

                            const totalActivities = activities.length;
                            return activities.length > 0 ? activities.map((activity: any, index) => (
                              <div key={index} className="flex gap-4 relative">
                                {/* Timeline Line */}
                                {index < activities.length - 1 && (
                                  <div className="absolute left-[19px] top-10 bottom-0 w-0.5 bg-gradient-to-b from-blue-500 to-transparent"></div>
                                )}

                                {/* Serial Number Badge */}
                                <div className="absolute -left-8 top-2 w-6 h-6 bg-gradient-to-br from-blue-600 to-cyan-600 rounded-full flex items-center justify-center text-white text-xs font-black shadow-lg">
                                  {totalActivities - index}
                                </div>

                                {/* Icon */}
                                <div className={`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center text-lg ${
                                  activity.type === 'submit' ? 'bg-green-500/20 border-2 border-green-500 text-green-400' :
                                  activity.type === 'status' ? 'bg-blue-500/20 border-2 border-blue-500 text-blue-400' :
                                  activity.type === 'edit' ? 'bg-orange-500/20 border-2 border-orange-500 text-orange-400' :
                                  activity.type === 'assign' ? 'bg-purple-500/20 border-2 border-purple-500 text-purple-400' :
                                  activity.type === 'feedback' ? 'bg-amber-500/20 border-2 border-amber-500 text-amber-400' :
                                  activity.type === 'review' ? 'bg-cyan-500/20 border-2 border-cyan-500 text-cyan-400' :
                                  activity.type === 'access' ? 'bg-teal-500/20 border-2 border-teal-500 text-teal-400' :
                                  activity.type === 'note' ? 'bg-indigo-500/20 border-2 border-indigo-500 text-indigo-400' :
                                  activity.type === 'issue' ? 'bg-red-500/20 border-2 border-red-500 text-red-400' :
                                  'bg-gray-500/20 border-2 border-gray-500 text-gray-400'
                                }`}>
                                  {activity.type === 'submit' ? 'üì§' :
                                   activity.type === 'status' ? 'üîÑ' :
                                   activity.type === 'edit' ? '‚úèÔ∏è' :
                                   activity.type === 'assign' ? 'üë§' :
                                   activity.type === 'feedback' ? 'üí¨' :
                                   activity.type === 'review' ? 'üëÅÔ∏è' :
                                   activity.type === 'access' ? 'üîê' :
                                   activity.type === 'note' ? 'üìå' :
                                   activity.type === 'issue' ? '‚ö†Ô∏è' : 'üìã'}
                                </div>

                                {/* Content */}
                                <div className="flex-1 pb-6">
                                  <div className={`border rounded-xl p-4 hover:shadow-lg transition-all ${
                                    activity.source === 'creator'
                                      ? 'bg-gradient-to-r from-green-500/10 to-emerald-500/5 border-green-500/30'
                                      : 'bg-gradient-to-r from-blue-500/10 to-cyan-500/5 border-blue-500/30'
                                  }`}>
                                    <div className="flex items-center justify-between mb-2">
                                      <div className="flex items-center gap-2">
                                        <span className="text-white font-bold">{activity.action}</span>
                                        <span className={`text-xs px-2 py-0.5 rounded-full font-bold ${
                                          activity.source === 'creator'
                                            ? 'bg-green-500/30 text-green-400 border border-green-500/50'
                                            : 'bg-blue-500/30 text-blue-400 border border-blue-500/50'
                                        }`}>
                                          {activity.source === 'creator' ? 'üë§ Creator' : 'üè¢ Admin'}
                                        </span>
                                      </div>
                                      <div className="text-right">
                                        <div className="text-white text-sm font-bold">{activity.date}</div>
                                        <div className="text-gray-500 text-xs">{activity.time}</div>
                                      </div>
                                    </div>
                                    <p className="text-gray-400 text-sm mb-2">{activity.description}</p>

                                    {/* Show changes if available */}
                                    {activity.changes && activity.changes.length > 0 && (
                                      <div className="mt-3 bg-black/30 rounded-lg p-3 space-y-2 border border-orange-500/30">
                                        <div className="text-xs font-bold text-orange-400 mb-2 flex items-center gap-2">
                                          <span>üìù</span> Fields Changed:
                                        </div>
                                        {activity.changes.slice(0, 5).map((change: any, idx: number) => (
                                          <div key={idx} className="text-xs py-1 border-b border-white/5 last:border-0">
                                            <span className="text-gray-400 font-semibold">{change.label}:</span>
                                            <div className="flex items-center gap-2 mt-1 ml-4">
                                              <span className="text-red-400 bg-red-500/10 px-2 py-0.5 rounded line-through">
                                                {String(change.oldValue || '-').substring(0, 30)}{String(change.oldValue || '').length > 30 ? '...' : ''}
                                              </span>
                                              <span className="text-gray-500">‚Üí</span>
                                              <span className="text-green-400 bg-green-500/10 px-2 py-0.5 rounded">
                                                {String(change.newValue || '-').substring(0, 30)}{String(change.newValue || '').length > 30 ? '...' : ''}
                                              </span>
                                            </div>
                                          </div>
                                        ))}
                                        {activity.changes.length > 5 && (
                                          <div className="text-xs text-gray-500 italic">+ {activity.changes.length - 5} more changes</div>
                                        )}
                                      </div>
                                    )}

                                    <div className="flex items-center gap-2 mt-3">
                                      <span className="text-xs px-2 py-1 bg-white/10 rounded-full text-gray-300 font-semibold">
                                        üë§ {activity.user}
                                      </span>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            )) : (
                              <div className="text-center py-8 text-gray-500">
                                <span className="text-4xl mb-4 block">üìã</span>
                                <p className="font-semibold">No activity recorded yet</p>
                                <p className="text-sm">Activities will appear here as actions are taken</p>
                              </div>
                            );
                          })()}
                        </div>
                      </div>
                    </div>

                    {/* Add Activity Note */}
                    <div className="bg-gradient-to-br from-gray-800 to-gray-900 rounded-xl border border-white/10 p-6">
                      <h3 className="text-lg font-bold text-white mb-4 flex items-center gap-2">
                        <span>üìù</span> Add Activity Note
                      </h3>
                      <div className="space-y-4">
                        <textarea
                          value={activityNote}
                          onChange={(e) => setActivityNote(e.target.value)}
                          placeholder="Add a note, feedback, or update about this project..."
                          className="w-full px-4 py-3 bg-white/5 border border-white/20 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 resize-none"
                          rows={3}
                        ></textarea>
                        <div className="flex items-center gap-3">
                          <select
                            value={activityNoteType}
                            onChange={(e) => setActivityNoteType(e.target.value)}
                            className="px-4 py-2 bg-white/5 border border-white/20 rounded-lg text-white text-sm focus:outline-none focus:border-blue-500"
                          >
                            <option value="note">üìå General Note</option>
                            <option value="feedback">üí¨ Feedback</option>
                            <option value="review">üëÅÔ∏è Review Update</option>
                            <option value="issue">‚ö†Ô∏è Issue/Concern</option>
                          </select>
                          <button
                            onClick={() => {
                              if (activityNote.trim() && selectedSubmission) {
                                const actionLabels: { [key: string]: string } = {
                                  note: 'Note Added',
                                  feedback: 'Feedback Added',
                                  review: 'Review Update',
                                  issue: 'Issue Reported'
                                };
                                addActivityLog(
                                  selectedSubmission.id,
                                  actionLabels[activityNoteType] || 'Note Added',
                                  activityNote.trim(),
                                  activityNoteType
                                );
                                setActivityNote('');
                                setActivityNoteType('note');
                                // Force re-render by updating selectedSubmission
                                setSelectedSubmission({...selectedSubmission});
                              }
                            }}
                            disabled={!activityNote.trim()}
                            className={`px-6 py-2 bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 text-white font-bold rounded-lg transition-all ${!activityNote.trim() ? 'opacity-50 cursor-not-allowed' : ''}`}
                          >
                            Add Note
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>

              {/* Modal Footer Actions */}
              <div className="flex-shrink-0 bg-gradient-to-r from-gray-900/95 to-black/95 backdrop-blur-xl border-t border-white/10 p-3 md:p-4">
                <div className="flex items-center gap-2 md:gap-3">
                  {/* Close Button */}
                  <button
                    onClick={() => {
                      setSelectedSubmission(null);
                      setDetailView('overview');
                    }}
                    className="px-4 py-2.5 bg-white/5 hover:bg-white/10 text-white text-sm font-bold rounded-lg border border-white/20 transition-all"
                  >
                    Close
                  </button>

                  {/* Current Status Display */}
                  <div className={`px-4 py-2.5 rounded-lg border-2 flex items-center gap-2 ${getStatusConfig(selectedSubmission.status).badge}`}>
                    <span className="text-lg">{getStatusConfig(selectedSubmission.status).icon.split(' ')[0]}</span>
                    <span className="font-black text-sm">{getStatusConfig(selectedSubmission.status).text}</span>
                  </div>

                  {/* Change Status Button - Opens Modal with All Options */}
                  <button
                    onClick={() => setShowStatusMenu(selectedSubmission.id)}
                    className="flex-1 px-4 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white text-sm font-black rounded-lg shadow-lg transition-all flex items-center justify-center gap-2"
                  >
                    <span>üîÑ</span>
                    <span>Change Status</span>
                    <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
                    </svg>
                  </button>

                  {/* Quick Status Actions - Context Aware */}
                  {selectedSubmission.status === 'pending' && (
                    <button
                      onClick={() => handleStatusChange(selectedSubmission.id, 'under-review')}
                      className="px-4 py-2.5 bg-gradient-to-r from-blue-500 to-cyan-600 hover:from-blue-600 hover:to-cyan-700 text-white text-sm font-black rounded-lg shadow-lg transition-all"
                    >
                      üëÅÔ∏è Start Review
                    </button>
                  )}

                  {selectedSubmission.status === 'under-review' && (
                    <button
                      onClick={() => handleStatusChange(selectedSubmission.id, 'approved')}
                      className="px-4 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white text-sm font-black rounded-lg shadow-lg transition-all"
                    >
                      ‚úÖ Approve
                    </button>
                  )}

                  {selectedSubmission.status === 'approved' && (
                    <button
                      onClick={() => handleStatusChange(selectedSubmission.id, 'agreement-signed')}
                      className="px-4 py-2.5 bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white text-sm font-black rounded-lg shadow-lg transition-all"
                    >
                      üìÑ Sign Agreement
                    </button>
                  )}

                  {selectedSubmission.status === 'agreement-signed' && (
                    <button
                      onClick={() => handleStatusChange(selectedSubmission.id, 'in-production')}
                      className="px-4 py-2.5 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white text-sm font-black rounded-lg shadow-lg transition-all"
                    >
                      üé¨ Start Production
                    </button>
                  )}

                  {/* Delete Button - Always Available */}
                  <div className="relative">
                    <button
                      onClick={() => setShowDeleteConfirm(selectedSubmission.id)}
                      className="px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white text-sm font-black rounded-lg shadow-lg transition-all border-2 border-red-500"
                      title="Delete Project"
                    >
                      üóëÔ∏è
                    </button>
                    {showDeleteConfirm === selectedSubmission.id && (
                      <div className="absolute right-0 bottom-full mb-2 bg-gray-900 border-2 border-red-500 rounded-lg shadow-2xl z-50 p-4 min-w-[300px]">
                        <div className="text-sm font-bold text-white mb-3">‚ö†Ô∏è Permanently Delete "{selectedSubmission.projectName}"?</div>
                        <div className="text-xs text-gray-300 mb-4">
                          This action cannot be undone. All project data, files, and history will be permanently deleted.
                        </div>
                        <div className="flex gap-2">
                          <button
                            onClick={() => {
                              handleDeleteProject(selectedSubmission.id);
                              setSelectedSubmission(null);
                            }}
                            className="flex-1 py-2 bg-red-600 hover:bg-red-700 text-white font-black rounded text-sm"
                          >
                            Yes, Delete Forever
                          </button>
                          <button
                            onClick={() => setShowDeleteConfirm(null)}
                            className="flex-1 py-2 bg-white/10 hover:bg-white/20 text-white font-bold rounded text-sm"
                          >
                            Cancel
                          </button>
                        </div>
                      </div>
                    )}
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Edit Access Requests Slide Panel */}
        {showEditRequestsPanel && (
          <div className="fixed inset-0 z-50 flex justify-end">
            {/* Backdrop */}
            <div
              className="absolute inset-0 bg-black/60 backdrop-blur-sm"
              onClick={() => setShowEditRequestsPanel(false)}
            ></div>

            {/* Panel */}
            <div className="relative w-full max-w-lg bg-gradient-to-br from-gray-900 to-gray-800 h-full overflow-y-auto border-l border-white/10 shadow-2xl">
              {/* Header */}
              <div className="sticky top-0 bg-gradient-to-r from-purple-600 to-pink-600 p-6 z-10">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-4">
                    <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                      <span className="text-2xl">‚úèÔ∏è</span>
                    </div>
                    <div>
                      <h3 className="text-xl font-black text-white">Edit Access Requests</h3>
                      <p className="text-purple-200 text-sm font-semibold">
                        {pendingEditRequestsCount} pending request{pendingEditRequestsCount !== 1 ? 's' : ''}
                      </p>
                    </div>
                  </div>
                  <button
                    onClick={() => setShowEditRequestsPanel(false)}
                    className="p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-all"
                  >
                    <span className="text-xl">‚úï</span>
                  </button>
                </div>
              </div>

              {/* Requests List */}
              <div className="p-6 space-y-4">
                {editAccessRequests.length === 0 ? (
                  <div className="text-center py-12">
                    <span className="text-6xl">üì≠</span>
                    <p className="text-gray-400 mt-4 font-semibold">No edit access requests</p>
                    <p className="text-gray-500 text-sm">Requests will appear here when creators need to edit locked projects</p>
                  </div>
                ) : (
                  <>
                    {/* Pending Requests */}
                    {editAccessRequests.filter(r => r.status === 'pending').length > 0 && (
                      <div className="mb-6">
                        <h4 className="text-sm font-bold text-yellow-400 mb-3 flex items-center gap-2">
                          <span>‚è≥</span> Pending Requests
                        </h4>
                        {editAccessRequests
                          .filter(r => r.status === 'pending')
                          .map((request) => (
                            <div key={request.id} className="bg-yellow-500/10 border-2 border-yellow-500/50 rounded-xl p-4 mb-3">
                              <div className="flex items-start justify-between mb-3">
                                <div>
                                  <h5 className="text-white font-black">{request.projectName}</h5>
                                  <p className="text-gray-400 text-sm">{request.creatorEmail}</p>
                                </div>
                                <span className="px-3 py-1 bg-yellow-500/20 text-yellow-400 text-xs font-bold rounded-full">
                                  PENDING
                                </span>
                              </div>
                              <div className="bg-white/5 rounded-lg p-3 mb-3">
                                <p className="text-sm text-gray-300 font-semibold">Reason for Request:</p>
                                <p className="text-white text-sm mt-1">{request.reason}</p>
                              </div>
                              <div className="text-xs text-gray-500 mb-4">
                                Requested: {new Date(request.requestedAt).toLocaleString('en-IN')}
                              </div>
                              <div className="flex gap-2">
                                <button
                                  onClick={() => handleGrantEditAccess(request)}
                                  className="flex-1 px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white font-bold rounded-lg transition-all"
                                >
                                  ‚úÖ Grant Access
                                </button>
                                <button
                                  onClick={() => {
                                    const reason = prompt('Enter reason for denying (optional):');
                                    handleDenyEditAccess(request, reason || '');
                                  }}
                                  className="flex-1 px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 font-bold rounded-lg transition-all border border-red-500/50"
                                >
                                  ‚ùå Deny
                                </button>
                              </div>
                            </div>
                          ))}
                      </div>
                    )}

                    {/* Approved Requests (with Revoke option) */}
                    {editAccessRequests.filter(r => r.status === 'approved').length > 0 && (
                      <div className="mb-6">
                        <h4 className="text-sm font-bold text-green-400 mb-3 flex items-center gap-2">
                          <span>‚úÖ</span> Granted Access
                        </h4>
                        {editAccessRequests
                          .filter(r => r.status === 'approved')
                          .map((request) => (
                            <div key={request.id} className="bg-green-500/10 border border-green-500/30 rounded-xl p-4 mb-3">
                              <div className="flex items-start justify-between mb-2">
                                <div>
                                  <h5 className="text-white font-bold">{request.projectName}</h5>
                                  <p className="text-gray-400 text-sm">{request.creatorEmail}</p>
                                </div>
                                <span className="px-3 py-1 bg-green-500/20 text-green-400 text-xs font-bold rounded-full">
                                  GRANTED
                                </span>
                              </div>
                              <div className="text-xs text-gray-500 mb-3">
                                Granted: {request.respondedAt ? new Date(request.respondedAt).toLocaleString('en-IN') : 'N/A'}
                              </div>
                              <button
                                onClick={() => handleRevokeEditAccess(request.projectId)}
                                className="w-full px-4 py-2 bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 font-bold rounded-lg transition-all border border-orange-500/50"
                              >
                                üîí Revoke Access
                              </button>
                            </div>
                          ))}
                      </div>
                    )}

                    {/* Denied/Revoked Requests */}
                    {editAccessRequests.filter(r => r.status === 'denied' || r.status === 'revoked').length > 0 && (
                      <div>
                        <h4 className="text-sm font-bold text-gray-400 mb-3 flex items-center gap-2">
                          <span>üìã</span> History
                        </h4>
                        {editAccessRequests
                          .filter(r => r.status === 'denied' || r.status === 'revoked')
                          .slice(0, 5)
                          .map((request) => (
                            <div key={request.id} className="bg-white/5 border border-white/10 rounded-xl p-4 mb-3 opacity-70">
                              <div className="flex items-start justify-between mb-2">
                                <div>
                                  <h5 className="text-white font-semibold">{request.projectName}</h5>
                                  <p className="text-gray-500 text-xs">{request.creatorEmail}</p>
                                </div>
                                <span className={`px-2 py-1 text-xs font-bold rounded-full ${
                                  request.status === 'denied'
                                    ? 'bg-red-500/20 text-red-400'
                                    : 'bg-orange-500/20 text-orange-400'
                                }`}>
                                  {request.status === 'denied' ? 'DENIED' : 'REVOKED'}
                                </span>
                              </div>
                              {request.adminMessage && (
                                <p className="text-gray-400 text-xs mt-1">Reason: {request.adminMessage}</p>
                              )}
                              <div className="text-xs text-gray-600 mt-2">
                                {request.respondedAt ? new Date(request.respondedAt).toLocaleString('en-IN') : 'N/A'}
                              </div>
                            </div>
                          ))}
                      </div>
                    )}
                  </>
                )}
              </div>
            </div>
          </div>
        )}

        {/* Notifications Slide Panel */}
        {showNotificationsPanel && (
          <div className="fixed inset-0 z-50 flex justify-end">
            {/* Backdrop */}
            <div
              className="absolute inset-0 bg-black/60 backdrop-blur-sm"
              onClick={() => setShowNotificationsPanel(false)}
            ></div>

            {/* Panel */}
            <div className="relative w-full max-w-lg bg-gradient-to-br from-gray-900 to-gray-800 h-full overflow-y-auto border-l border-white/10 shadow-2xl">
              {/* Header */}
              <div className="sticky top-0 bg-gradient-to-r from-red-500 to-pink-600 p-6 z-10">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-4">
                    <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                      <span className="text-2xl">üîî</span>
                    </div>
                    <div>
                      <h3 className="text-xl font-black text-white">New Submissions</h3>
                      <p className="text-red-200 text-sm font-semibold">
                        {newSubmissionsCount > 0 ? `${newSubmissionsCount} new project${newSubmissionsCount !== 1 ? 's' : ''}` : 'All caught up!'}
                      </p>
                    </div>
                  </div>
                  <button
                    onClick={() => setShowNotificationsPanel(false)}
                    className="p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-all"
                  >
                    <span className="text-xl">‚úï</span>
                  </button>
                </div>
                {/* Action Buttons - Always visible */}
                <div className="space-y-2 mt-4">
                  <div className="flex gap-2">
                    {newSubmissionsCount > 0 && (
                      <button
                        onClick={() => {
                          // Mark all as viewed at once
                          const newSubmissionIds = submissions
                            .filter(s => isNewSubmission(s.submittedDate, s.id))
                            .map(s => s.id);

                          setViewedProjects(prev => {
                            const newSet = new Set(prev);
                            newSubmissionIds.forEach(id => newSet.add(id));
                            // Save to localStorage
                            if (typeof window !== 'undefined') {
                              localStorage.setItem('stage_viewed_projects', JSON.stringify([...newSet]));
                            }
                            return newSet;
                          });
                        }}
                        className="flex-1 px-4 py-2 bg-white/20 hover:bg-white/30 text-white text-sm font-bold rounded-lg transition-all"
                      >
                        ‚úì Mark all as seen
                      </button>
                    )}
                    <button
                      onClick={() => {
                        // Mark ALL submissions as seen (clear all from notifications)
                        const allIds = submissions.map(s => s.id);
                        setViewedProjects(prev => {
                          const newSet = new Set(prev);
                          allIds.forEach(id => newSet.add(id));
                          if (typeof window !== 'undefined') {
                            localStorage.setItem('stage_viewed_projects', JSON.stringify([...newSet]));
                          }
                          return newSet;
                        });
                      }}
                      className={`${newSubmissionsCount > 0 ? 'flex-1' : 'w-full'} px-4 py-2 bg-white/10 hover:bg-white/20 text-white/80 text-sm font-bold rounded-lg transition-all`}
                    >
                      üóëÔ∏è Clear all
                    </button>
                  </div>
                  <button
                    onClick={() => {
                      // Reset viewed projects list (will show as new again)
                      setViewedProjects(new Set());
                      if (typeof window !== 'undefined') {
                        localStorage.removeItem('stage_viewed_projects');
                      }
                    }}
                    className="w-full px-4 py-2 bg-orange-500/20 hover:bg-orange-500/30 text-orange-300 text-sm font-bold rounded-lg transition-all border border-orange-500/30"
                  >
                    üîÑ Reset notifications
                  </button>
                </div>
              </div>

              {/* Submissions List */}
              <div className="p-4">
                {newSubmissionsCount === 0 ? (
                  <div className="text-center py-16">
                    <span className="text-6xl">üì≠</span>
                    <p className="text-gray-400 mt-4 font-bold text-lg">No new submissions</p>
                    <p className="text-gray-500 text-sm mt-2">New project submissions will appear here</p>
                  </div>
                ) : (
                  <div className="space-y-3">
                    {submissions
                      .filter(s => isNewSubmission(s.submittedDate, s.id))
                      .map((submission) => (
                        <div
                          key={submission.id}
                          onClick={() => {
                            markAsViewed(submission.id);
                            setSelectedSubmission(submission);
                            setShowNotificationsPanel(false);
                            setActiveTab('submissions');
                          }}
                          className="p-4 rounded-xl cursor-pointer transition-all bg-blue-500/10 border border-blue-500/30 hover:bg-blue-500/20"
                        >
                          <div className="flex items-start gap-3">
                            <div className="w-12 h-12 bg-gradient-to-br from-red-500 to-pink-600 rounded-xl flex items-center justify-center flex-shrink-0">
                              <span className="text-white font-black text-lg">
                                {(submission.projectName || 'U')[0].toUpperCase()}
                              </span>
                            </div>
                            <div className="flex-1 min-w-0">
                              <div className="flex items-center gap-2">
                                <h4 className="text-white font-bold truncate">{submission.projectName}</h4>
                                <span className="px-2 py-0.5 bg-green-500/20 text-green-400 text-xs font-bold rounded-full">NEW</span>
                              </div>
                              <p className="text-gray-400 text-sm mt-1">
                                {submission.creator} ‚Ä¢ {submission.culture}
                              </p>
                              <div className="flex items-center justify-between mt-2">
                                <span className="text-red-400 font-bold text-sm">{formatBudget(submission.totalBudget)}</span>
                                <span className="text-gray-500 text-xs">{getTimeElapsed(submission.submittedDate)}</span>
                              </div>
                            </div>
                            <div className="w-3 h-3 bg-blue-500 rounded-full flex-shrink-0 animate-pulse"></div>
                          </div>
                        </div>
                      ))}
                  </div>
                )}

                {/* Recent Submissions Section */}
                <div className="mt-6">
                  <h4 className="text-sm font-bold text-gray-400 mb-3 flex items-center gap-2">
                    <span>üìã</span> Recent Submissions
                  </h4>
                  <div className="space-y-2">
                    {submissions
                      .filter(s => !isNewSubmission(s.submittedDate, s.id))
                      .slice(0, 5)
                      .map((submission) => (
                        <div
                          key={submission.id}
                          onClick={() => {
                            setSelectedSubmission(submission);
                            setShowNotificationsPanel(false);
                            setActiveTab('submissions');
                          }}
                          className="p-3 rounded-lg cursor-pointer transition-all bg-white/5 border border-white/10 hover:bg-white/10"
                        >
                          <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-gray-700 rounded-lg flex items-center justify-center flex-shrink-0">
                              <span className="text-white font-bold text-sm">
                                {(submission.projectName || 'U')[0].toUpperCase()}
                              </span>
                            </div>
                            <div className="flex-1 min-w-0">
                              <h5 className="text-gray-300 font-semibold text-sm truncate">{submission.projectName}</h5>
                              <p className="text-gray-500 text-xs">{submission.culture} ‚Ä¢ {getTimeElapsed(submission.submittedDate)}</p>
                            </div>
                            <span className={`px-2 py-1 text-xs font-bold rounded-full ${
                              submission.status === 'approved' ? 'bg-green-500/20 text-green-400' :
                              submission.status === 'in-production' ? 'bg-purple-500/20 text-purple-400' :
                              submission.status === 'rejected' ? 'bg-red-500/20 text-red-400' :
                              submission.status === 'under-review' ? 'bg-blue-500/20 text-blue-400' :
                              'bg-yellow-500/20 text-yellow-400'
                            }`}>
                              {submission.status?.replace('-', ' ').toUpperCase() || 'PENDING'}
                            </span>
                          </div>
                        </div>
                      ))}
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Status Change Modal with Comment */}
        {showStatusChangeModal && pendingStatusChange && (
          <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
            <div className="bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl max-w-lg w-full shadow-2xl overflow-hidden border border-white/10">
              {/* Modal Header */}
              <div className={`p-6 ${
                pendingStatusChange.newStatus === 'approved' ? 'bg-gradient-to-r from-green-600 to-emerald-600' :
                pendingStatusChange.newStatus === 'in-production' ? 'bg-gradient-to-r from-cyan-600 to-blue-600' :
                pendingStatusChange.newStatus === 'revision-requested' ? 'bg-gradient-to-r from-orange-600 to-amber-600' :
                pendingStatusChange.newStatus === 'rejected' || pendingStatusChange.newStatus === 'scrapped' ? 'bg-gradient-to-r from-red-600 to-pink-600' :
                'bg-gradient-to-r from-purple-600 to-pink-600'
              }`}>
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center">
                    <span className="text-3xl">
                      {pendingStatusChange.newStatus === 'approved' ? '‚úÖ' :
                       pendingStatusChange.newStatus === 'in-production' ? 'üé¨' :
                       pendingStatusChange.newStatus === 'revision-requested' ? 'üìù' :
                       pendingStatusChange.newStatus === 'rejected' || pendingStatusChange.newStatus === 'scrapped' ? '‚ùå' :
                       pendingStatusChange.newStatus === 'on-hold' ? '‚è∏Ô∏è' :
                       pendingStatusChange.newStatus === 'under-review' ? 'üëÅÔ∏è' :
                       'üìã'}
                    </span>
                  </div>
                  <div>
                    <h3 className="text-2xl font-black text-white">Change Status</h3>
                    <p className="text-white/80 text-sm font-semibold">
                      {submissions.find(s => s.id === pendingStatusChange.submissionId)?.projectName || 'Project'}
                    </p>
                  </div>
                </div>
              </div>

              {/* Modal Body */}
              <div className="p-6">
                {/* Status Change Info */}
                <div className="bg-white/5 rounded-xl p-4 mb-6 border border-white/10">
                  <div className="flex items-center gap-3">
                    <div className="text-center">
                      <div className="text-xs text-gray-500 font-semibold mb-1">Current</div>
                      <div className="px-3 py-1.5 bg-gray-600/50 text-gray-300 font-bold rounded-lg text-sm">
                        {submissions.find(s => s.id === pendingStatusChange.submissionId)?.status?.toUpperCase().replace('-', ' ') || 'PENDING'}
                      </div>
                    </div>
                    <div className="text-2xl text-gray-500">‚Üí</div>
                    <div className="text-center">
                      <div className="text-xs text-gray-500 font-semibold mb-1">New Status</div>
                      <div className={`px-3 py-1.5 font-bold rounded-lg text-sm ${
                        pendingStatusChange.newStatus === 'approved' ? 'bg-green-500/30 text-green-300' :
                        pendingStatusChange.newStatus === 'in-production' ? 'bg-cyan-500/30 text-cyan-300' :
                        pendingStatusChange.newStatus === 'revision-requested' ? 'bg-orange-500/30 text-orange-300' :
                        pendingStatusChange.newStatus === 'rejected' || pendingStatusChange.newStatus === 'scrapped' ? 'bg-red-500/30 text-red-300' :
                        pendingStatusChange.newStatus === 'on-hold' ? 'bg-gray-500/30 text-gray-300' :
                        'bg-blue-500/30 text-blue-300'
                      }`}>
                        {pendingStatusChange.newStatus.toUpperCase().replace('-', ' ')}
                      </div>
                    </div>
                  </div>
                </div>

                {/* Comment Field */}
                <div className="mb-6">
                  <label className="block text-white font-bold mb-2">
                    üí¨ Add Comment for Creator
                    <span className="text-gray-400 font-normal text-sm ml-2">(Optional)</span>
                  </label>
                  <textarea
                    value={statusChangeComment}
                    onChange={(e) => setStatusChangeComment(e.target.value)}
                    placeholder={
                      pendingStatusChange.newStatus === 'revision-requested'
                        ? "Please describe what changes or revisions are needed..."
                        : pendingStatusChange.newStatus === 'approved'
                        ? "Add any feedback or congratulations message..."
                        : pendingStatusChange.newStatus === 'rejected' || pendingStatusChange.newStatus === 'scrapped'
                        ? "Provide reason for rejection (if any)..."
                        : "Add any notes or comments for the creator..."
                    }
                    rows={4}
                    className="w-full bg-white/10 border border-white/20 rounded-xl p-4 text-white placeholder-gray-500 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/30 transition-all resize-none"
                  />
                  <p className="text-gray-500 text-xs mt-2">
                    This comment will be visible to the creator in their activity log and notifications.
                  </p>
                </div>

                {/* Action Buttons */}
                <div className="flex gap-3">
                  <button
                    onClick={() => {
                      setShowStatusChangeModal(false);
                      setStatusChangeComment('');
                      setPendingStatusChange(null);
                    }}
                    className="flex-1 px-4 py-3 bg-white/10 hover:bg-white/20 text-white font-bold rounded-xl transition-all"
                  >
                    Cancel
                  </button>
                  <button
                    onClick={confirmStatusChange}
                    className={`flex-1 px-4 py-3 font-black rounded-xl transition-all shadow-lg hover:shadow-xl ${
                      pendingStatusChange.newStatus === 'approved' ? 'bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700' :
                      pendingStatusChange.newStatus === 'in-production' ? 'bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700' :
                      pendingStatusChange.newStatus === 'revision-requested' ? 'bg-gradient-to-r from-orange-500 to-amber-600 hover:from-orange-600 hover:to-amber-700' :
                      pendingStatusChange.newStatus === 'rejected' || pendingStatusChange.newStatus === 'scrapped' ? 'bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700' :
                      'bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700'
                    } text-white`}
                  >
                    Confirm Change
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Creator Updates Panel */}
        {showCreatorUpdatesPanel && (
          <div className="fixed inset-0 z-50 flex justify-end">
            {/* Backdrop */}
            <div
              className="absolute inset-0 bg-black/60 backdrop-blur-sm"
              onClick={() => setShowCreatorUpdatesPanel(false)}
            ></div>

            {/* Panel */}
            <div className="relative w-full max-w-lg bg-gradient-to-br from-gray-900 to-gray-800 h-full overflow-y-auto border-l border-white/10 shadow-2xl">
              {/* Header */}
              <div className="sticky top-0 bg-gradient-to-r from-blue-600 to-cyan-600 p-6 z-10">
                <div className="flex items-center justify-between">
                  <div className="flex items-center gap-4">
                    <div className="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                      <span className="text-2xl">üìù</span>
                    </div>
                    <div>
                      <h3 className="text-xl font-black text-white">Creator Updates</h3>
                      <p className="text-blue-200 text-sm font-semibold">
                        {adminNotifications.filter(n => !n.read).length} unread update{adminNotifications.filter(n => !n.read).length !== 1 ? 's' : ''}
                      </p>
                    </div>
                  </div>
                  <button
                    onClick={() => setShowCreatorUpdatesPanel(false)}
                    className="p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-all"
                  >
                    <span className="text-xl">‚úï</span>
                  </button>
                </div>
                {/* Actions */}
                <div className="flex gap-2 mt-4">
                  <button
                    onClick={() => {
                      const updated = adminNotifications.map(n => ({ ...n, read: true }));
                      setAdminNotifications(updated);
                      localStorage.setItem('stage_admin_notifications', JSON.stringify(updated));
                    }}
                    className="flex-1 px-4 py-2 bg-white/20 hover:bg-white/30 text-white text-sm font-bold rounded-lg transition-all"
                  >
                    ‚úì Mark all as read
                  </button>
                  <button
                    onClick={() => {
                      setAdminNotifications([]);
                      localStorage.setItem('stage_admin_notifications', JSON.stringify([]));
                    }}
                    className="px-4 py-2 bg-white/10 hover:bg-white/20 text-white/80 text-sm font-bold rounded-lg transition-all"
                  >
                    üóëÔ∏è Clear
                  </button>
                </div>
              </div>

              {/* Notifications List */}
              <div className="p-4 space-y-3">
                {adminNotifications.length === 0 ? (
                  <div className="text-center py-16">
                    <span className="text-6xl">üì≠</span>
                    <p className="text-gray-400 mt-4 font-bold text-lg">No creator updates</p>
                    <p className="text-gray-500 text-sm mt-2">Updates from creators will appear here</p>
                  </div>
                ) : (
                  adminNotifications.map((notif: any) => (
                    <div
                      key={notif.id}
                      className={`rounded-xl p-4 border-2 transition-all cursor-pointer ${
                        notif.read
                          ? 'bg-white/5 border-white/10'
                          : 'bg-blue-500/10 border-blue-500/50'
                      }`}
                      onClick={() => {
                        // Mark as read
                        const updated = adminNotifications.map(n =>
                          n.id === notif.id ? { ...n, read: true } : n
                        );
                        setAdminNotifications(updated);
                        localStorage.setItem('stage_admin_notifications', JSON.stringify(updated));

                        // Find and select the project
                        const project = submissions.find(s =>
                          s.id === notif.projectId ||
                          s.projectName === notif.projectName
                        );
                        if (project) {
                          setSelectedSubmission(project);
                          setDetailView('activity');
                          setShowCreatorUpdatesPanel(false);
                        }
                      }}
                    >
                      <div className="flex items-start gap-3">
                        <div className={`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${
                          notif.type === 'creator_edit' ? 'bg-blue-500/30' :
                          notif.type === 'new_submission' ? 'bg-green-500/30' :
                          'bg-purple-500/30'
                        }`}>
                          <span className="text-lg">
                            {notif.type === 'creator_edit' ? '‚úèÔ∏è' :
                             notif.type === 'new_submission' ? 'üÜï' : 'üìã'}
                          </span>
                        </div>
                        <div className="flex-1 min-w-0">
                          <div className="text-white font-bold text-sm">{notif.projectName}</div>
                          <div className="text-gray-400 text-xs mt-0.5">{notif.creatorEmail}</div>
                          <div className="text-gray-300 text-sm mt-2">{notif.message}</div>

                          {/* Creator Comment */}
                          {notif.creatorComment && (
                            <div className="mt-3 bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-lg p-3 border border-blue-500/30">
                              <div className="flex items-center gap-2 mb-2">
                                <span className="text-sm">üí¨</span>
                                <span className="text-xs font-bold text-blue-400">Creator's Note:</span>
                              </div>
                              <p className="text-sm text-white italic">"{notif.creatorComment}"</p>
                            </div>
                          )}

                          {/* Show changes grouped by department */}
                          {notif.changesByDepartment && Object.keys(notif.changesByDepartment).length > 0 && (
                            <div className="mt-3 bg-black/30 rounded-lg p-3 space-y-3">
                              <div className="flex items-center justify-between">
                                <span className="text-xs font-bold text-blue-400">Changes by Department:</span>
                                <span className="text-xs text-gray-500">{notif.changes?.length || 0} total changes</span>
                              </div>

                              {Object.entries(notif.changesByDepartment).map(([dept, changes]: [string, any]) => (
                                <div key={dept} className="bg-white/5 rounded-lg p-2">
                                  <div className="flex items-center gap-2 mb-2">
                                    <span className="text-xs px-2 py-0.5 bg-purple-500/30 rounded text-purple-300 font-bold">{dept}</span>
                                    <span className="text-xs text-gray-500">({Array.isArray(changes) ? changes.length : changes} change{(Array.isArray(changes) ? changes.length : changes) > 1 ? 's' : ''})</span>
                                  </div>
                                  {Array.isArray(changes) && changes.slice(0, 3).map((change: any, idx: number) => (
                                    <div key={idx} className="text-xs ml-2 py-1 border-l-2 border-gray-700 pl-2">
                                      <span className="text-gray-400 font-medium">{change.label}:</span>
                                      <div className="flex items-center gap-2 mt-0.5 flex-wrap">
                                        <span className="text-red-400 bg-red-500/10 px-1.5 py-0.5 rounded line-through text-[10px]">
                                          {String(change.oldValue).substring(0, 25)}{String(change.oldValue).length > 25 ? '...' : ''}
                                        </span>
                                        <span className="text-gray-500 text-[10px]">‚Üí</span>
                                        <span className="text-green-400 bg-green-500/10 px-1.5 py-0.5 rounded text-[10px]">
                                          {String(change.newValue).substring(0, 25)}{String(change.newValue).length > 25 ? '...' : ''}
                                        </span>
                                      </div>
                                    </div>
                                  ))}
                                  {Array.isArray(changes) && changes.length > 3 && (
                                    <div className="text-[10px] text-gray-500 ml-4 mt-1">+{changes.length - 3} more in this department</div>
                                  )}
                                </div>
                              ))}
                            </div>
                          )}

                          {/* Fallback: Show simple changes if no department grouping */}
                          {(!notif.changesByDepartment || Object.keys(notif.changesByDepartment).length === 0) && notif.changes && notif.changes.length > 0 && (
                            <div className="mt-3 bg-black/30 rounded-lg p-3 space-y-2">
                              <div className="text-xs font-bold text-blue-400 mb-2">Changes Made:</div>
                              {notif.changes.slice(0, 5).map((change: any, idx: number) => (
                                <div key={idx} className="text-xs">
                                  <span className="text-gray-400">{change.label}:</span>
                                  <div className="flex items-center gap-2 mt-1">
                                    <span className="text-red-400 line-through">{String(change.oldValue).substring(0, 30)}{String(change.oldValue).length > 30 ? '...' : ''}</span>
                                    <span className="text-gray-500">‚Üí</span>
                                    <span className="text-green-400">{String(change.newValue).substring(0, 30)}{String(change.newValue).length > 30 ? '...' : ''}</span>
                                  </div>
                                </div>
                              ))}
                              {notif.changes.length > 5 && (
                                <div className="text-xs text-gray-500">+{notif.changes.length - 5} more changes</div>
                              )}
                            </div>
                          )}

                          <div className="text-gray-500 text-xs mt-2">
                            {new Date(notif.timestamp).toLocaleString('en-IN')}
                          </div>
                        </div>
                        {!notif.read && (
                          <div className="w-3 h-3 bg-blue-500 rounded-full flex-shrink-0"></div>
                        )}
                      </div>
                    </div>
                  ))
                )}
              </div>
            </div>
          </div>
        )}

        {/* Document Preview Modal */}
        {previewDocument && (
          <div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm">
            <div className="relative w-full max-w-5xl h-[90vh] bg-gradient-to-br from-gray-900 to-black border border-white/20 rounded-2xl shadow-2xl flex flex-col overflow-hidden">
              {/* Preview Header */}
              <div className="flex-shrink-0 bg-gradient-to-r from-purple-600 to-pink-600 p-4 flex items-center justify-between">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                    <span className="text-xl">{previewDocument.type === 'pdf' ? 'üìï' : 'üñºÔ∏è'}</span>
                  </div>
                  <div>
                    <h3 className="text-lg font-black text-white">{previewDocument.name}</h3>
                    <p className="text-purple-200 text-sm font-semibold">
                      {previewDocument.type === 'pdf' ? 'PDF Document' : 'Image File'}
                    </p>
                  </div>
                </div>
                <div className="flex items-center gap-2">
                  <button
                    onClick={() => window.open(previewDocument.url, '_blank')}
                    className="px-4 py-2 bg-white/20 hover:bg-white/30 text-white font-bold rounded-lg transition-all text-sm"
                  >
                    ‚ÜóÔ∏è Open in New Tab
                  </button>
                  <button
                    onClick={() => setPreviewDocument(null)}
                    className="p-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-all"
                  >
                    <span className="text-xl">‚úï</span>
                  </button>
                </div>
              </div>

              {/* Preview Content */}
              <div className="flex-1 overflow-hidden bg-gray-800">
                {previewDocument.type === 'pdf' ? (
                  <div className="w-full h-full flex flex-col items-center justify-center">
                    {previewDocument.url.startsWith('#') ? (
                      <div className="text-center p-8">
                        <div className="text-6xl mb-4">üìÑ</div>
                        <h3 className="text-xl font-bold text-white mb-2">PDF Preview</h3>
                        <p className="text-gray-400 mb-6">
                          PDF preview requires the file to be hosted. For local files, please download to view.
                        </p>
                        <div className="flex gap-3 justify-center">
                          <button className="px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold rounded-xl">
                            ‚¨áÔ∏è Download PDF
                          </button>
                        </div>
                      </div>
                    ) : (
                      <iframe
                        src={previewDocument.url}
                        className="w-full h-full"
                        title={previewDocument.name}
                      />
                    )}
                  </div>
                ) : (
                  <div className="w-full h-full flex items-center justify-center p-4">
                    {previewDocument.url.startsWith('#') ? (
                      <div className="text-center p-8">
                        <div className="text-6xl mb-4">üñºÔ∏è</div>
                        <h3 className="text-xl font-bold text-white mb-2">Image Preview</h3>
                        <p className="text-gray-400 mb-6">
                          Image preview requires the file URL. For local files, please download to view.
                        </p>
                        <button className="px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold rounded-xl">
                          ‚¨áÔ∏è Download Image
                        </button>
                      </div>
                    ) : (
                      <img
                        src={previewDocument.url}
                        alt={previewDocument.name}
                        className="max-w-full max-h-full object-contain rounded-lg shadow-2xl"
                      />
                    )}
                  </div>
                )}
              </div>

              {/* Preview Footer */}
              <div className="flex-shrink-0 bg-black/50 p-3 flex items-center justify-between">
                <div className="text-gray-400 text-sm font-semibold">
                  {previewDocument.type === 'pdf' ? 'üìï PDF Document' : 'üñºÔ∏è Image File'}
                </div>
                <div className="flex gap-2">
                  <button className="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm font-bold rounded-lg transition-all">
                    ‚¨áÔ∏è Download
                  </button>
                  <button
                    onClick={() => setPreviewDocument(null)}
                    className="px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white text-sm font-bold rounded-lg transition-all"
                  >
                    Close
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Invite Creator Modal */}
        <InviteCreatorModal
          isOpen={showInviteCreatorModal}
          onClose={() => setShowInviteCreatorModal(false)}
        />
      </div>
    </div>
  );
}
